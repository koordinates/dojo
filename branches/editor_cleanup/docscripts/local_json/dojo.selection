{"dojo.selection.Selection":{"meta":{"requires":{"common":["dojo.lang.array","dojo.lang.func","dojo.math"]},"functions":{"dojo.selection.Selection":{"_":{"meta":{"summary":"","parameters":{"items":{"type":""},"isCollection":{"type":""}},"src":"\tthis.items = [];\n\tthis.selection = [];\n\tthis._pivotItems = [];\n\tthis.clearItems();\n\n\tif(items) {\n\t\tif(isCollection) {\n\t\t\tthis.setItemsCollection(items);\n\t\t} else {\n\t\t\tthis.setItems(items);\n\t\t}\n\t}","this_variables":["items","selection","_pivotItems","items","items.length","items","lastSelected","length","lastSelected","lastSelected","length","lastSelected","length","_pivotItem","_pivotItems","_pivotItem","_pivotItems.length","length"],"protovariables":{"items":"","selection":"","lastSelected":"","allowImplicit":"","length":"","isGrowable":"","_pivotItems":"","_pivotItem":""}}}},"dojo.selection.Selection.onSelect":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.onDeselect":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.onSelectChange":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"selected":{"type":""}},"src":"","this":"dojo.selection.Selection"}}},"dojo.selection.Selection._find":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"inSelection":{"type":""}},"src":"\t\tif(inSelection) {\n\t\t\treturn dojo.lang.find(this.selection, item);\n\t\t} else {\n\t\t\treturn dojo.lang.find(this.items, item);\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.isSelectable":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.setItems":{"_":{"meta":{"summary":"","src":"\t\tthis.clearItems();\n\t\tthis.addItems.call(this, arguments);","this_inherits":["this.addItems"],"this":"dojo.selection.Selection"}}},"dojo.selection.Selection.setItemsCollection":{"_":{"meta":{"summary":"","parameters":{"collection":{"type":""}},"src":"\t\tthis.items = collection;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.addItems":{"_":{"meta":{"summary":"","src":"\t\tvar args = dojo.lang.unnest(arguments);\n\t\tfor(var i = 0; i < args.length; i++) {\n\t\t\tthis.items.push(args[i]);\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.addItemsAt":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"before":{"type":"..."}},"src":"\t\tif(this.items.length == 0) {                      \n\t\t\treturn this.addItems(dojo.lang.toArray(arguments, 2));\n\t\t}\n\n\t\tif(!this.isItem(item)) {\n\t\t\titem = this.items[item];\n\t\t}\n\t\tif(!item) { throw new Error(\"addItemsAt: item doesn't exist\"); }\n\t\tvar idx = this._find(item);\n\t\tif(idx > 0 && before) { idx--; }\n\t\tfor(var i = 2; i < arguments.length; i++) {\n\t\t\tif(!this.isItem(arguments[i])) {\n\t\t\t\tthis.items.splice(idx++, 0, arguments[i]);\n\t\t\t}\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.removeItem":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"\t\tif(idx > -1) {\n\t\t\tthis.items.splice(idx, 1);\n\t\t}\n\t\t\/\/ remove from selection\n\t\t\/\/ FIXME: do we call deselect? I don't think so because this isn't how\n\t\t\/\/ you usually want to deselect an item. For example, if you deleted an\n\t\t\/\/ item, you don't really want to deselect it -- you want it gone. -DS\n\t\tidx = this._find(item, true);\n\t\tif(idx > -1) {\n\t\t\tthis.selection.splice(idx, 1);\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.clearItems":{"_":{"meta":{"summary":"","src":"\t\tthis.items = [];\n\t\tthis.deselectAll();","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.isItem":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"\t\treturn this._find(item) > -1;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.isSelected":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"\t\treturn this._find(item, true) > -1;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.selectFilter":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"selection":{"type":""},"add":{"type":""},"grow":{"type":""}},"src":"\t\treturn true;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.update":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"add":{"type":""},"grow":{"type":""},"noToggle":{"type":""}},"src":"\t\tif(!this.isItem(item)) { return false; }\n\n\t\tif(this.isGrowable && grow) {\n\t\t\tif(!this.isSelected(item)\n\t\t\t\t&& this.selectFilter(item, this.selection, false, true)) {\n\t\t\t\tthis.grow(item);\n\t\t\t\tthis.lastSelected = item;\n\t\t\t}\n\t\t} else if(add) {\n\t\t\tif(this.selectFilter(item, this.selection, true, false)) {\n\t\t\t\tif(noToggle) {\n\t\t\t\t\tif(this.select(item)) {\n\t\t\t\t\t\tthis.lastSelected = item;\n\t\t\t\t\t}\n\t\t\t\t} else if(this.toggleSelected(item)) {\n\t\t\t\t\tthis.lastSelected = item;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.deselectAll();\n\t\t\tthis.select(item);\n\t\t}\n\n\t\tthis.length = this.selection.length;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.grow":{"_":{"meta":{"summary":"","parameters":{"toItem":{"type":""},"fromItem":{"type":""}},"src":"\t\tif(!this.isGrowable) { return; }\n\n\t\tif(arguments.length == 1) {\n\t\t\tfromItem = this._pivotItem;\n\t\t\tif(!fromItem && this.allowImplicit) {\n\t\t\t\tfromItem = this.items[0];\n\t\t\t}\n\t\t}\n\t\tif(!toItem || !fromItem) { return false; }\n\n\t\tvar fromIdx = this._find(fromItem);\n\n\t\t\/\/ get items to deselect (fromItem, lastSelected]\n\t\tvar toDeselect = {};\n\t\tvar lastIdx = -1;\n\t\tif(this.lastSelected) {\n\t\t\tlastIdx = this._find(this.lastSelected);\n\t\t\tvar step = fromIdx < lastIdx ? -1 : 1;\n\t\t\tvar range = dojo.math.range(lastIdx, fromIdx, step);\n\t\t\tfor(var i = 0; i < range.length; i++) {\n\t\t\t\ttoDeselect[range[i]] = true;\n\t\t\t}\n\t\t}\n\n\t\t\/\/ add selection (fromItem, toItem]\n\t\tvar toIdx = this._find(toItem);\n\t\tvar step = fromIdx < toIdx ? -1 : 1;\n\t\tvar shrink = lastIdx >= 0 && step == 1 ? lastIdx < toIdx : lastIdx > toIdx;\n\t\tvar range = dojo.math.range(toIdx, fromIdx, step);\n\t\tif(range.length) {\n\t\t\tfor(var i = range.length-1; i >= 0; i--) {\n\t\t\t\tvar item = this.items[range[i]];\n\t\t\t\tif(this.selectFilter(item, this.selection, false, true)) {\n\t\t\t\t\tif(this.select(item, true) || shrink) {\n\t\t\t\t\t\tthis.lastSelected = item;\n\t\t\t\t\t}\n\t\t\t\t\tif(range[i] in toDeselect) {\n\t\t\t\t\t\tdelete toDeselect[range[i]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.lastSelected = fromItem;\n\t\t}\n\n\t\t\/\/ now deselect...\n\t\tfor(var i in toDeselect) {\n\t\t\tif(this.items[i] == this.lastSelected) {\n\t\t\t\t\/\/dojo.debug(\"oops!\");\n\t\t\t}\n\t\t\tthis.deselect(this.items[i]);\n\t\t}\n\n\t\t\/\/ make sure everything is all kosher after selections+deselections\n\t\tthis._updatePivot();","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.growUp":{"_":{"meta":{"summary":"","src":"\t\tif(!this.isGrowable) { return; }\n\n\t\tvar idx = this._find(this.lastSelected) - 1;\n\t\twhile(idx >= 0) {\n\t\t\tif(this.selectFilter(this.items[idx], this.selection, false, true)) {\n\t\t\t\tthis.grow(this.items[idx]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tidx--;\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.growDown":{"_":{"meta":{"summary":"","src":"\t\tif(!this.isGrowable) { return; }\n\n\t\tvar idx = this._find(this.lastSelected);\n\t\tif(idx < 0 && this.allowImplicit) {\n\t\t\tthis.select(this.items[0]);\n\t\t\tidx = 0;\n\t\t}\n\t\tidx++;\n\t\twhile(idx > 0 && idx < this.items.length) {\n\t\t\tif(this.selectFilter(this.items[idx], this.selection, false, true)) {\n\t\t\t\tthis.grow(this.items[idx]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tidx++;\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.toggleSelected":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"noPivot":{"type":""}},"src":"\t\tif(this.isItem(item)) {\n\t\t\tif(this.select(item, noPivot)) { return 1; }\n\t\t\tif(this.deselect(item)) { return -1; }\n\t\t}\n\t\treturn 0;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.select":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"noPivot":{"type":""}},"src":"\t\tif(this.isItem(item) && !this.isSelected(item)\n\t\t\t&& this.isSelectable(item)) {\n\t\t\tthis.selection.push(item);\n\t\t\tthis.lastSelected = item;\n\t\t\tthis.onSelect(item);\n\t\t\tthis.onSelectChange(item, true);\n\t\t\tif(!noPivot) {\n\t\t\t\tthis._addPivot(item);\n\t\t\t}\n\t\t\tthis.length = this.selection.length;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.deselect":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"\t\tvar idx = this._find(item, true);\n\t\tif(idx > -1) {\n\t\t\tthis.selection.splice(idx, 1);\n\t\t\tthis.onDeselect(item);\n\t\t\tthis.onSelectChange(item, false);\n\t\t\tif(item == this.lastSelected) {\n\t\t\t\tthis.lastSelected = null;\n\t\t\t}\n\t\t\tthis._removePivot(item);\n\t\t\tthis.length = this.selection.length;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.selectAll":{"_":{"meta":{"summary":"","src":"\t\tfor(var i = 0; i < this.items.length; i++) {\n\t\t\tthis.select(this.items[i]);\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.deselectAll":{"_":{"meta":{"summary":"","src":"\t\twhile(this.selection && this.selection.length) {\n\t\t\tthis.deselect(this.selection[0]);\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.selectNext":{"_":{"meta":{"summary":"","src":"\t\tvar idx = this._find(this.lastSelected);\n\t\twhile(idx > -1 && ++idx < this.items.length) {\n\t\t\tif(this.isSelectable(this.items[idx])) {\n\t\t\t\tthis.deselectAll();\n\t\t\t\tthis.select(this.items[idx]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.selectPrevious":{"_":{"meta":{"summary":"","src":"\t\twhile(idx-- > 0) {\n\t\t\tif(this.isSelectable(this.items[idx])) {\n\t\t\t\tthis.deselectAll();\n\t\t\t\tthis.select(this.items[idx]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.selectFirst":{"_":{"meta":{"summary":"","src":"\t\tthis.deselectAll();\n\t\tvar idx = 0;\n\t\twhile(this.items[idx] && !this.select(this.items[idx])) {\n\t\t\tidx++;\n\t\t}\n\t\treturn this.items[idx] ? true : false;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.selectLast":{"_":{"meta":{"summary":"","src":"\t\tthis.deselectAll();\n\t\tvar idx = this.items.length-1;\n\t\twhile(this.items[idx] && !this.select(this.items[idx])) {\n\t\t\tidx--;\n\t\t}\n\t\treturn this.items[idx] ? true : false;","this":"dojo.selection.Selection"}}},"dojo.selection.Selection._addPivot":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"andClear":{"type":""}},"src":"\t\tthis._pivotItem = item;\n\t\tif(andClear) {\n\t\t\tthis._pivotItems = [item];\n\t\t} else {\n\t\t\tthis._pivotItems.push(item);\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection._removePivot":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"\t\tvar i = dojo.lang.find(this._pivotItems, item);\n\t\tif(i > -1) {\n\t\t\tthis._pivotItems.splice(i, 1);\n\t\t\tthis._pivotItem = this._pivotItems[this._pivotItems.length-1];\n\t\t}\n\n\t\tthis._updatePivot();","this":"dojo.selection.Selection"}}},"dojo.selection.Selection._updatePivot":{"_":{"meta":{"summary":"","src":"\t\tif(this._pivotItems.length == 0) {\n\t\t\tif(this.lastSelected) {\n\t\t\t\tthis._addPivot(this.lastSelected);\n\t\t\t}\n\t\t}","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.sorted":{"_":{"meta":{"summary":"","src":"\t\treturn dojo.lang.toArray(this.selection).sort(\n\t\t\tdojo.lang.hitch(this, function(a, b) {\n\t\t\t\tvar A = this._find(a), B = this._find(b);\n\t\t\t\tif(A > B) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if(A < B) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t})\n\t\t);","this":"dojo.selection.Selection"}}},"dojo.selection.Selection.updateSelected":{"_":{"meta":{"summary":"","src":"\t\tfor(var i = 0; i < this.selection.length; i++) {\n\t\t\tif(this._find(this.selection[i]) < 0) {\n\t\t\t\tvar removed = this.selection.splice(i, 1);\n\n\t\t\t\tthis._removePivot(removed[0]);\n\t\t\t}\n\t\t}\n\n\t\tthis.length = this.selection.length;","this":"dojo.selection.Selection"}}}}}}}