if(!mimetype) { mimetype = "text/xml"; }
if(typeof DOMParser != "undefined") {
	var parser = new DOMParser();
	return parser.parseFromString(str, mimetype);
}else if(typeof ActiveXObject != "undefined"){
	var domDoc = new ActiveXObject("Microsoft.XMLDOM");
	if(domDoc) {
		domDoc.async = false;
		domDoc.loadXML(str);
		return domDoc;
	}else{
		dojo.debug("toXml didn't work?");
	}
}else if((dojo.render.html.capable)&&(dojo.render.html.safari)){
	 FIXME: this doesn't appear to work!
	 from: http:web-graphics.com/mtarchive/001606.php
	 var xml = '<?xml version="1.0"?>'+str;
	var mtype = "text/xml";
	var xml = '<?xml version="1.0"?>'+str;
	var url = "data:"+mtype+";charset=utf-8,"+encodeURIComponent(xml);
	var req = new XMLHttpRequest();
	req.open("GET", url, false);
	req.overrideMimeType(mtype);
	req.send(null);
	return req.responseXML;
}else if(document.createElement){
	 FIXME: this may change all tags to uppercase!
	var tmp = document.createElement("xml");
	tmp.innerHTML = str;
	if(document.implementation && document.implementation.createDocument) {
		var xmlDoc = document.implementation.createDocument("foo", "", null);
		for(var i = 0; i < tmp.childNodes.length; i++) {
			xmlDoc.importNode(tmp.childNodes.item(i), true);
		}
		return xmlDoc;
	}
	 FIXME: probably not a good idea to have to return an HTML fragment
	 FIXME: the tmp.doc.firstChild is as tested from IE, so it may not
	 work that way across the board
	return tmp.document && tmp.document.firstChild ?
		tmp.document.firstChild : tmp;
}
return null;