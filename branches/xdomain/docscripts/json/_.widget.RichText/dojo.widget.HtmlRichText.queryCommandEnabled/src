if (this.object) {
	if (command == "forecolor") { command = "setforecolor"; }
	else if (command == "backcolor") { command = "setbackcolor"; }

	if (typeof this._activeX.command[command] == "undefined") { return false; }
	var status = this.object.QueryStatus(this._activeX.command[command]);
	return (status != this.activeX.status.notsupported && 
		status != this.activeX.status.diabled);
} else {
	 mozilla returns true always
	if (command == "unlink" && dojo.render.html.mozilla) {
		var node = this.getSelectedNode();
		while (node.parentNode && node.nodeName != "A") { node = node.parentNode; }
		return node.nodeName == "A";
	} else if (command == "inserttable" && dojo.render.html.mozilla) {
		return true;
	}

	 return this.document.queryCommandEnabled(command);
	var elem = (dojo.render.html.ie) ? this.document.selection.createRange() : this.document;
	return elem.queryCommandEnabled(command);
}