try {
	var cmd = item._name;
	var enabled = this._richText.queryCommandEnabled(cmd);
	item.setEnabled(enabled, false, true);

	var active = this._richText.queryCommandState(cmd);
	if(active && cmd == "underline") {
		 don't activate underlining if we are on a link
		active = !this._richText.queryCommandEnabled("unlink");
	}
	item.setSelected(active, false, true);
	return true;
} catch(err) {
	return false;
}