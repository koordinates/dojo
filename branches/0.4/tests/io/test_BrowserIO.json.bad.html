<html>
<head>
<title>dojo.io.bind mimetype text/json test</title>
<script type="text/javascript">
djConfig = { 
	isDebug: true,
	//debugAtAllCosts: true,
	dummyValue: 0
};
</script>
<script type="text/javascript" src="../../dojo.js"></script>
<script type="text/javascript">
dojo.require("dojo.io.*");
//Test to be sure that IframeIO does not handle the request.
dojo.require("dojo.io.IframeIO");
dojo.hostenv.writeIncludes();
</script>
<script type="text/javascript">

function doit() {
	var kw = {
		url: "data-json.jsbad",
		mimetype: "application/json",
		load: function(type, json, http) {
			dojo.debug("TEST FAILED. load callback was called, but error callback "
				+ "should have been called instead.");
		},
		error: function(type, error, http) {
			dojo.debug("TEST PASSED. Successfully got error callback on bad json evaluation.");
			dojo.debug(error);
			for(var key in error) {
				dojo.debug(key, ":", error[key]);
			}
		}
	};
	dojo.io.bind(kw);
}

dojo.addOnLoad(doit);
</script>
</head>

<body>
	<p>Stuff shoulda happened.</p>
</body>
</html>

