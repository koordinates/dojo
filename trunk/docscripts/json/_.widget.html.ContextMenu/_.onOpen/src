this.isShowing = 1;

 if I do this, I cant preventDefault in khtml
evt = dojo.event.browser.fixEvent(evt);
 
 stop default contextmenu, needed in khtml
if (evt.preventDefault){ evt.preventDefault(); }

 need to light up this one before we check width and height
this.domNode.style.left = "-9999px";
this.domNode.style.top  = "-9999px";
this.domNode.style.display = "block";

 calculate if menu is going to apear within window
 or if its partially out of visable area
with(dojo.html){

	var menuW = getInnerWidth(this.domNode);
	var menuH = getInnerHeight(this.domNode);

	var viewport = getViewportSize();
	var scrolloffset = getScrollOffset();
}

var minX = viewport[0];
var minY = viewport[1];

var maxX = (viewport[0] + scrolloffset[0]) - menuW;
var maxY = (viewport[1] + scrolloffset[1]) - menuH;

var posX = evt.clientX + scrolloffset[0];
var posY = evt.clientY + scrolloffset[1];

if (posX > maxX){ posX = posX - menuW; }
if (posY > maxY){ posY = posY - menuH; }

this.domNode.style.left = posX + "px";
this.domNode.style.top = posY + "px";

 block the onclick that follows this particular right click
 not if the eventtrigger is documentElement and always when
 we use onmousedown hack
_blockHide = (evt.currentTarget!=doc || eventType=='onmousedown');

return false;  