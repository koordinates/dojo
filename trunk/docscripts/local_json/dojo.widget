{"dojo.widget.AccordionContainer":{"meta":{"requires":{"common":["dojo.widget.*","dojo.html.*","dojo.widget.AccordionPane"]},"methods":{"dojo.widget.AccordionContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"isContainer":"","labelNodeClass":"","containerNodeClass":"","allowCollapse":""}}}},"dojo.widget.AccordionContainer.addChild":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""},"overrideContainerNode":{"type":""},"pos":{"type":""},"ref":{"type":""},"insertIndex":{"type":""}},"src":"\t\t\tif (widget.widgetType != \"AccordionPane\") {\n\t\t\t\tvar wrapper=dojo.widget.createWidget(\"AccordionPane\",{label: widget.label, open: widget.open, labelNodeClass: this.labelNodeClass, containerNodeClass: this.containerNodeClass, allowCollapse: this.allowCollapse });\n\t\t\t\twrapper.addChild(widget);\n\t\t\t\tthis.addWidgetAsDirectChild(wrapper);\n\t\t\t\tthis.registerChild(wrapper);\n\t\t\t\twrapper.setSizes();\n\t\t\t\treturn wrapper;\n\t\t\t} else {\n\t\t\t\tdojo.html.addClass(widget.containerNode, this.containerNodeClass);\n\t\t\t\tdojo.html.addClass(widget.labelNode, this.labelNodeClass);\n\t\t\t\tthis.addWidgetAsDirectChild(widget);\n\t\t\t\tthis.registerChild(widget);\t\n\t\t\t\twidget.setSizes();\n\t\t\t\treturn widget;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.AccordionContainer.label":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""},"overrideContainerNode":{"type":""},"pos":{"type":""},"ref":{"type":""},"insertIndex":{"type":""}},"src":"\t\t\tif (widget.widgetType != \"AccordionPane\") {\n\t\t\t\tvar wrapper=dojo.widget.createWidget(\"AccordionPane\",{label: widget.label, open: widget.open, labelNodeClass: this.labelNodeClass, containerNodeClass: this.containerNodeClass, allowCollapse: this.allowCollapse });\n\t\t\t\twrapper.addChild(widget);\n\t\t\t\tthis.addWidgetAsDirectChild(wrapper);\n\t\t\t\tthis.registerChild(wrapper);\n\t\t\t\twrapper.setSizes();\n\t\t\t\treturn wrapper;\n\t\t\t} else {\n\t\t\t\tdojo.html.addClass(widget.containerNode, this.containerNodeClass);\n\t\t\t\tdojo.html.addClass(widget.labelNode, this.labelNodeClass);\n\t\t\t\tthis.addWidgetAsDirectChild(widget);\n\t\t\t\tthis.registerChild(widget);\t\n\t\t\t\twidget.setSizes();\n\t\t\t\treturn widget;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.AccordionContainer.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tvar tmpChildren = this.children;\n\t\t\tthis.children=[];\n\t\t\tdojo.html.removeChildren(this.domNode);\n\t\t\tdojo.lang.forEach(tmpChildren, dojo.lang.hitch(this,\"addChild\"));","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["children"]}}},"dojo.widget.AccordionContainer.removeChild":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""}},"src":"\t\t\tdojo.widget.AccordionContainer.superclass.removeChild.call(this, widget);\n\t\t\tif(this.children[0]){\n\t\t\t\tthis.children[0].setSizes();\n\t\t\t}","this_inherits":["dojo.widget.AccordionContainer.superclass.removeChild"],"this":"dojo.widget.HtmlWidget"}}},"dojo.widget.AccordionContainer.onResized":{"_":{"meta":{"summary":"","src":"\t\t\tthis.children[0].setSizes();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Widget":{"_":{"meta":{"protovariables":{"label":"","open":""}}}}}}},"dojo.widget.AccordionPane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.TitlePane","dojo.html.selection"]},"methods":{"dojo.widget.AccordionPane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.TitlePane"],"this_inherits":["dojo.widget.TitlePane"]}}}}}},"dojo.widget.AnimatedPng":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.AnimatedPng":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"isContainer":"","domNode":"","width":"","height":"","aniSrc":"","interval":"","cellWidth":"","cellHeight":"","aniCols":"","aniRows":"","aniCells":"","blankSrc":"","templateString":""}}}},"dojo.widget.AnimatedPng.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tthis.cellWidth = this.width;\n\t\t\tthis.cellHeight = this.height;\n\n\t\t\tvar img = new Image();\n\t\t\tvar self = this;\n\n\t\t\timg.onload = function(){ self.initAni(img.width, img.height); };\n\t\t\timg.src = this.aniSrc;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["cellWidth","cellHeight","domNode.src","domNode.width","domNode.height","domNode.style.backgroundImage","domNode.style.backgroundRepeat","aniCols","aniRows","aniCells","aniFrame","domNode.style.backgroundPosition"]}}},"dojo.widget.AnimatedPng.initAni":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\t\tthis.domNode.src = this.blankSrc;\n\t\t\tthis.domNode.width = this.cellWidth;\n\t\t\tthis.domNode.height = this.cellHeight;\n\t\t\tthis.domNode.style.backgroundImage = 'url('+this.aniSrc+')';\n\t\t\tthis.domNode.style.backgroundRepeat = 'no-repeat';\n\n\t\t\tthis.aniCols = Math.floor(w\/this.cellWidth);\n\t\t\tthis.aniRows = Math.floor(h\/this.cellHeight);\n\t\t\tthis.aniCells = this.aniCols * this.aniRows;\n\t\t\tthis.aniFrame = 0;\n\n\t\t\twindow.setInterval(dojo.lang.hitch(this, 'tick'), this.interval);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.AnimatedPng.tick":{"_":{"meta":{"summary":"","src":"\t\t\tthis.aniFrame++;\n\t\t\tif (this.aniFrame == this.aniCells) this.aniFrame = 0;\n\n\t\t\tvar col = this.aniFrame % this.aniCols;\n\t\t\tvar row = Math.floor(this.aniFrame \/ this.aniCols);\n\n\t\t\tvar bx = -1 * col * this.cellWidth;\n\t\t\tvar by = -1 * row * this.cellHeight;\n\n\t\t\tthis.domNode.style.backgroundPosition = bx+'px '+by+'px';","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.Button":{"meta":{"requires":{"common":["dojo.lang.extras","dojo.html.*","dojo.html.selection","dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.Button":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"isContainer":"","caption":"","disabled":"","templatePath":"","templateCssPath":"","inactiveImg":"","activeImg":"","pressedImg":"","disabledImg":"","width2height":"","containerNode":"","leftImage":"","centerImage":"","rightImage":""},"this_variables":["arrow","arrow.src","height","containerWidth","leftImage.height","arrowBackgroundImage.height","leftImage.width","centerImage.width","leftPart.style.height","leftPart.style.width","arrowBackgroundImage.width","rightImage.width","rightPart.style.height","rightPart.style.width","domNode.style.height","domNode.style.width","leftImage.src","centerImage.src","arrowBackgroundImage.src","rightImage.src"]}}},"dojo.widget.Button.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tif(this.caption != \"\"){\n\t\t\t\tthis.containerNode.appendChild(document.createTextNode(this.caption));\n\t\t\t}\n\t\t\tdojo.html.disableSelection(this.containerNode);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.postCreate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tthis.sizeMyself();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.sizeMyself":{"_":{"meta":{"summary":"","src":"\t\t\t\tvar placeHolder = document.createElement(\"span\");\n\t\t\t\tdojo.html.insertBefore(placeHolder, this.domNode);\n\t\t\t}\n\t\t\tdojo.body().appendChild(this.domNode);\n\t\t\t\n\t\t\tthis.sizeMyselfHelper();\n\t\t\t\n\t\t\t\/\/ Put this.domNode back where it was originally\n\t\t\tif(placeHolder){\n\t\t\t\tdojo.html.insertBefore(this.domNode, placeHolder);\n\t\t\t\tdojo.html.removeNode(placeHolder);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.sizeMyselfHelper":{"_":{"meta":{"summary":"","src":"\t\t\tvar mb = dojo.html.getMarginBox(this.containerNode);\n\t\t\tthis.height = mb.height;\n\t\t\tthis.containerWidth = mb.width;\n\t\t\tvar endWidth= this.height * this.width2height;\n\t\n\t\t\tthis.containerNode.style.left=endWidth+\"px\";\n\t\n\t\t\tthis.leftImage.height = this.rightImage.height = this.centerImage.height = this.height;\n\t\t\tthis.leftImage.width = this.rightImage.width = endWidth+1;\n\t\t\tthis.centerImage.width = this.containerWidth;\n\t\t\tthis.centerImage.style.left=endWidth+\"px\";\n\t\t\tthis._setImage(this.disabled ? this.disabledImg : this.inactiveImg);\n\n\t\t\tif ( this.disabled ) {\n\t\t\t\tdojo.html.prependClass(this.domNode, \"dojoButtonDisabled\");\n\t\t\t} else {\n\t\t\t\tdojo.html.removeClass(this.domNode, \"dojoButtonDisabled\");\n\t\t\t}\n\t\t\t\t\n\t\t\tthis.domNode.style.height=this.height + \"px\";\n\t\t\tthis.domNode.style.width= (this.containerWidth+2*endWidth) + \"px\";","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["height","containerWidth","containerNode.style.left","leftImage.height","leftImage.width","centerImage.width","centerImage.style.left","domNode.style.height","domNode.style.width","leftImage.src","centerImage.src","rightImage.src","caption","containerNode.innerHTML","disabled"]}}},"dojo.widget.Button.onMouseOver":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.domNode, \"dojoButtonHover\");\n\t\t\tthis._setImage(this.activeImg);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.onMouseDown":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.domNode, \"dojoButtonDepressed\");\n\t\t\tdojo.html.removeClass(this.domNode, \"dojoButtonHover\");\n\t\t\tthis._setImage(this.pressedImg);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.onMouseUp":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.domNode, \"dojoButtonHover\");\n\t\t\tdojo.html.removeClass(this.domNode, \"dojoButtonDepressed\");\n\t\t\tthis._setImage(this.activeImg);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.onMouseOut":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tif( e.toElement && dojo.html.isDescendantOf(e.toElement, this.domNode) ){\n\t\t\t\treturn; \/\/ Ignore IE mouseOut events that dont actually leave button - Prevents hover image flicker in IE\n\t\t\t}\n\t\t\tdojo.html.removeClass(this.domNode, \"dojoButtonHover\");\n\t\t\tthis._setImage(this.inactiveImg);","returns":"Ignore IE mouseOut events that dont actually leave button - Prevents hover image flicker in IE","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.buttonClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( !this.disabled ) { this.onClick(e); }","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.onClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button._setImage":{"_":{"meta":{"summary":"","parameters":{"prefix":{"type":""}},"src":"\t\t\tthis.leftImage.src=dojo.uri.dojoUri(prefix + \"l.gif\");\n\t\t\tthis.centerImage.src=dojo.uri.dojoUri(prefix + \"c.gif\");\n\t\t\tthis.rightImage.src=dojo.uri.dojoUri(prefix + \"r.gif\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button._toggleMenu":{"_":{"meta":{"summary":"","parameters":{"menuId":{"type":""}},"src":"\t\t\tvar menu = dojo.widget.getWidgetById(menuId);\n\t\t\tif ( !menu ) { return; }\n\t\n\t\t\tif ( menu.open && !menu.isShowingNow) {\n\t\t\t\tvar pos = dojo.html.getAbsolutePosition(this.domNode, false);\n\t\t\t\tmenu.open(pos.x, pos.y+this.height, this);\n\t\t\t} else if ( menu.close && menu.isShowingNow ){\n\t\t\t\tmenu.close();\n\t\t\t} else {\n\t\t\t\tmenu.toggle();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.setCaption":{"_":{"meta":{"summary":"","parameters":{"content":{"type":""}},"src":"\t\t\tthis.caption=content;\n\t\t\tthis.containerNode.innerHTML=content;\n\t\t\tthis.sizeMyself();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Button.setDisabled":{"_":{"meta":{"summary":"","parameters":{"disabled":{"type":""}},"src":"\t\t\tthis.disabled=disabled;\n\t\t\tthis.sizeMyself();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DropDownButton":{"_":{"meta":{"summary":"","inherits":["dojo.widget.Button"],"this_inherits":["dojo.widget.Button"],"protovariables":{"menuId":"","arrow":"","downArrow":"","disabledDownArrow":""}}}},"dojo.widget.DropDownButton.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.widget.DropDownButton.superclass.fillInTemplate.call(this, args, frag);\n\t\n\t\t\tthis.arrow = document.createElement(\"img\");\n\t\t\tdojo.html.setClass(this.arrow, \"downArrow\");","this_inherits":["dojo.widget.DropDownButton.superclass.fillInTemplate"],"this":"dojo.widget.Button"}}},"dojo.widget.DropDownButton.sizeMyselfHelper":{"_":{"meta":{"summary":"","src":"\t\t\tthis.containerNode.appendChild(this.arrow);\n\n\t\t\tdojo.widget.DropDownButton.superclass.sizeMyselfHelper.call(this);","this":"dojo.widget.Button"}}},"dojo.widget.DropDownButton.onClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis._toggleMenu(this.menuId);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton":{"_":{"meta":{"summary":"","inherits":["dojo.widget.Button"],"this_inherits":["dojo.widget.Button"],"protovariables":{"menuId":"","templatePath":"","leftPart":"","rightPart":"","arrowBackgroundImage":"","splitWidth":"","arrowWidth":""}}}},"dojo.widget.ComboButton.sizeMyselfHelper":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tvar mb = dojo.html.getMarginBox(this.containerNode);\n\t\t\tthis.height = mb.height;\n\t\t\tthis.containerWidth = mb.width;\n\t\t\tvar endWidth= this.height\/3;\n\t\n\t\t\t\/\/ left part\n\t\t\tthis.leftImage.height = this.rightImage.height = this.centerImage.height = \n\t\t\t\tthis.arrowBackgroundImage.height = this.height;\n\t\t\tthis.leftImage.width = endWidth+1;\n\t\t\tthis.centerImage.width = this.containerWidth;\n\t\t\tthis.leftPart.style.height = this.height + \"px\";\n\t\t\tthis.leftPart.style.width = endWidth + this.containerWidth + \"px\";\n\t\t\tthis._setImageL(this.disabled ? this.disabledImg : this.inactiveImg);\n\t\n\t\t\t\/\/ right part\n\t\t\tthis.arrowBackgroundImage.width=this.arrowWidth;\n\t\t\tthis.rightImage.width = endWidth+1;\n\t\t\tthis.rightPart.style.height = this.height + \"px\";\n\t\t\tthis.rightPart.style.width = this.arrowWidth + endWidth + \"px\";\n\t\t\tthis._setImageR(this.disabled ? this.disabledImg : this.inactiveImg);\n\t\n\t\t\t\/\/ outer container\n\t\t\tthis.domNode.style.height=this.height + \"px\";\n\t\t\tvar totalWidth = this.containerWidth+this.splitWidth+this.arrowWidth+2*endWidth;\n\t\t\tthis.domNode.style.width= totalWidth + \"px\";","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.leftOver":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.leftPart, \"dojoButtonHover\");\n\t\t\tthis._setImageL(this.activeImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.leftDown":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.leftPart, \"dojoButtonDepressed\");\n\t\t\tdojo.html.removeClass(this.leftPart, \"dojoButtonHover\");\n\t\t\tthis._setImageL(this.pressedImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.leftUp":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.leftPart, \"dojoButtonHover\");\n\t\t\tdojo.html.removeClass(this.leftPart, \"dojoButtonDepressed\");\n\t\t\tthis._setImageL(this.activeImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.leftOut":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.removeClass(this.leftPart, \"dojoButtonHover\");\n\t\t\tthis._setImageL(this.inactiveImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.leftClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif ( !this.disabled ) {\n\t\t\t\tthis.onClick(e);\n\t\t\t}","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton._setImageL":{"_":{"meta":{"summary":"","parameters":{"prefix":{"type":""}},"src":"\t\t\tthis.leftImage.src=dojo.uri.dojoUri(prefix + \"l.gif\");\n\t\t\tthis.centerImage.src=dojo.uri.dojoUri(prefix + \"c.gif\");","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.rightOver":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.rightPart, \"dojoButtonHover\");\n\t\t\tthis._setImageR(this.activeImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.rightDown":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.rightPart, \"dojoButtonDepressed\");\n\t\t\tdojo.html.removeClass(this.rightPart, \"dojoButtonHover\");\n\t\t\tthis._setImageR(this.pressedImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.rightUp":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.prependClass(this.rightPart, \"dojoButtonHover\");\n\t\t\tdojo.html.removeClass(this.rightPart, \"dojoButtonDepressed\");\n\t\t\tthis._setImageR(this.activeImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.rightOut":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tdojo.html.removeClass(this.rightPart, \"dojoButtonHover\");\n\t\t\tthis._setImageR(this.inactiveImg);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton.rightClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif( this.disabled ){ return; }\n\t\t\tthis._toggleMenu(this.menuId);","this":"dojo.widget.Button"}}},"dojo.widget.ComboButton._setImageR":{"_":{"meta":{"summary":"","parameters":{"prefix":{"type":""}},"src":"\t\t\tthis.arrowBackgroundImage.src=dojo.uri.dojoUri(prefix + \"c.gif\");\n\t\t\tthis.rightImage.src=dojo.uri.dojoUri(prefix + \"r.gif\");","this":"dojo.widget.Button"}}}}}},"dojo.widget.Chart":{"meta":{"requires":{"common":["dojo.widget.*","dojo.graphics.color","dojo.graphics.color.hsl"]},"methods":{"dojo.widget.Chart":{"_":{"meta":{"summary":"","src":"\tdojo.widget.Widget.call(this);\n\tthis.widgetType = \"Chart\";\n\tthis.isContainer = false;\n\tthis.series = [];\n\t\/\/ FIXME: why is this a mixin method?\n\tthis.assignColors = function(){\n\t\tvar hue=30;\n\t\tvar sat=120;\n\t\tvar lum=120;\n\t\tvar steps = Math.round(330\/this.series.length);\n\n\t\tfor(var i=0; i<this.series.length; i++){\n\t\t\tvar c=dojo.graphics.color.hsl2rgb(hue,sat,lum);\n\t\t\tif(!this.series[i].color){\n\t\t\t\tthis.series[i].color = dojo.graphics.color.rgb2hex(c[0],c[1],c[2]);\n\t\t\t}\n\t\t\thue += steps;\n\t\t}\n\t};","this_variables":["widgetType","isContainer","series","assignColors"],"inherits":["dojo.widget.Widget"]}}},"dojo.widget.Chart.assignColors":{"_":{"meta":{"summary":"","src":"\t\tvar hue=30;\n\t\tvar sat=120;\n\t\tvar lum=120;\n\t\tvar steps = Math.round(330\/this.series.length);\n\n\t\tfor(var i=0; i<this.series.length; i++){\n\t\t\tvar c=dojo.graphics.color.hsl2rgb(hue,sat,lum);\n\t\t\tif(!this.series[i].color){\n\t\t\t\tthis.series[i].color = dojo.graphics.color.rgb2hex(c[0],c[1],c[2]);\n\t\t\t}\n\t\t\thue += steps;\n\t\t}"}}},"dojo.widget.Chart.DataSeries":{"_":{"meta":{"summary":"","parameters":{"key":{"type":""},"label":{"type":""},"plotType":{"type":""},"color":{"type":""}},"src":"\tthis.key = key;\n\tthis.label = label||this.id;\n\tthis.plotType = plotType||0;\n\tthis.color = color;\n\tthis.values = [];","this_variables":["id","key","label","plotType","color","values","values"]}}},"dojo.widget.Chart.DataSeries.add":{"_":{"meta":{"summary":"","parameters":{"v":{"type":""}},"src":"\t\tif(v.x==null||v.value==null){\n\t\t\tdojo.raise(\"dojo.widget.Chart.DataSeries.add: v must have both an 'x' and 'value' property.\");\n\t\t}\n\t\tthis.values.push(v);","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.clear":{"_":{"meta":{"summary":"","src":"\t\tthis.values=[];","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.createRange":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar idx = this.values.length-1;\n\t\tvar length = (len||this.values.length);\n\t\treturn { \"index\": idx, \"length\": length, \"start\":Math.max(idx-length,0) };","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getMean":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar range = this.createRange(len);\n\t\tif(range.index<0){ return 0; }\n\t\tvar t = 0;\n\t\tvar c = 0;\n\t\tfor(var i=range.index; i>=range.start; i--){\n\t\t\tvar n = parseFloat(this.values[i].value);\n\t\t\tif(!isNaN(n)){ t += n; c++; }\n\t\t}\n\t\tt \/= Math.max(c,1);\n\t\treturn t;","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getMovingAverage":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar range = this.createRange(len);\n\t\tif(range.index<0){ return 0; }\n\t\tvar t = 0;\n\t\tvar c = 0;\n\t\tfor(var i=range.index; i>=range.start; i--){\n\t\t\tvar n = parseFloat(this.values[i].value);\n\t\t\tif(!isNaN(n)){ t += n; c++; }\n\t\t}\n\t\tt \/= Math.max(c,1);\n\t\treturn t;","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getVariance":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar range = this.createRange(len);\n\t\tif(range.index < 0){ return 0; }\n\t\tvar t = 0; \/\/ FIXME: for tom: wtf are t, c, and s?\n\t\tvar s = 0;\n\t\tvar c = 0;\n\t\tfor(var i=range.index; i>=range.start; i--){\n\t\t\tvar n = parseFloat(this.values[i].value);\n\t\t\tif(!isNaN(n)){\n\t\t\t\tt += n;\n\t\t\t\ts += Math.pow(n,2);\n\t\t\t\tc++;\n\t\t\t}\n\t\t}\n\t\treturn (s\/c)-Math.pow(t\/c,2);","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getStandardDeviation":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\treturn Math.sqrt(this.getVariance(len));","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getMax":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar range = this.createRange(len);\n\t\tif(range.index < 0){ return 0; }\n\t\tvar t = 0;\n\t\tfor (var i=range.index; i>=range.start; i--){\n\t\t\tvar n=parseFloat(this.values[i].value);\n\t\t\tif (!isNaN(n)){\n\t\t\t\tt=Math.max(n,t);\n\t\t\t}\n\t\t}\n\t\treturn t;","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getMin":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar range=this.createRange(len);\n\t\tif(range.index < 0){ return 0; }\n\t\tvar t = 0;\n\t\tfor(var i=range.index; i>=range.start; i--){\n\t\t\tvar n = parseFloat(this.values[i].value);\n\t\t\tif(!isNaN(n)){\n\t\t\t\tt=Math.min(n,t);\n\t\t\t}\n\t\t}\n\t\treturn t;","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getMedian":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar range = this.createRange(len);\n\n\t\tif(range.index<0){ return 0; }\n\n\t\tvar a = [];\n\t\tfor (var i=range.index; i>=range.start; i--){\n\t\t\tvar n=parseFloat(this.values[i].value);\n\t\t\tif (!isNaN(n)){\n\t\t\t\tvar b=false;\n\t\t\t\tfor(var j=0; j<a.length&&!b; j++){\n\t\t\t\t\tif (n==a[j]) b=true; \n\t\t\t\t}\n\t\t\t\tif(!b){ a.push(n); }\n\t\t\t}\n\t\t}\n\t\ta.sort();\n\t\tif(a.length>0){ return a[Math.ceil(a.length\/2)]; }\n\t\treturn 0;","this":"dojo.widget.Chart.DataSeries"}}},"dojo.widget.Chart.DataSeries.getMode":{"_":{"meta":{"summary":"","parameters":{"len":{"type":""}},"src":"\t\tvar range=this.createRange(len);\n\t\tif(range.index<0){ return 0; }\n\t\tvar o = {};\n\t\tvar ret = 0\n\t\tvar m = 0;\n\t\tfor(var i=range.index; i>=range.start; i--){\n\t\t\tvar n=parseFloat(this.values[i].value);\n\t\t\tif(!isNaN(n)){\n\t\t\t\tif (!o[this.values[i].value]) o[this.values[i].value] = 1;\n\t\t\t\telse o[this.values[i].value]++;\n\t\t\t}\n\t\t}\n\t\tfor(var p in o){\n\t\t\tif(m<o[p]){ m=o[p]; ret=p; }\n\t\t}\n\t\treturn parseFloat(ret);","this":"dojo.widget.Chart.DataSeries"}}}}}},"dojo.widget.Checkbox":{"meta":{"requires":{"common":["dojo.widget.*","dojo.event","dojo.html.style"]},"methods":{"dojo.widget.Checkbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":"","disabled":"","name":"","checked":"","tabIndex":"","id":"","inputNode":""}}}},"dojo.widget.Checkbox.postMixInProperties":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["disabled","inputNode.id","checked","inputNode.checked"]}}},"dojo.widget.Checkbox.postCreate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tvar inputId = this.inputNode.id;\n\t\t\tif(inputId != null){\n\t\t\t\tvar labels = document.getElementsByTagName(\"label\");\n\t\t\t\tif (labels != null && labels.length > 0){\n\t\t\t\t\tfor(var i=0; i<labels.length; i++){\n\t\t\t\t\t\tif (labels[i].htmlFor == inputId){\n\t\t\t\t\t\t\tlabels[i].id = (labels[i].htmlFor + \"label\"); \n\t\t\t\t\t\t\tdojo.widget.wai.setAttr(this.domNode, \"waiState\", \"labelledby\", labels[i].id);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Checkbox.fillInTemplate":{"_":{"meta":{"summary":"","src":"\t\t\tthis._setInfo();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Checkbox.onClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif(this.disabled == \"enabled\"){\n\t\t\t\tthis.checked = !this.checked;\n\t\t\t\tthis._setInfo();\n\t\t\t}\n\t\t\te.preventDefault();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Checkbox.keyPress":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tif(e.keyCode==k.KEY_SPACE || e.charCode==k.KEY_SPACE){\n\t \t\t\tthis.onClick(e);\n\t \t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Checkbox._setInfo":{"_":{"meta":{"summary":"","src":"\t\t\tvar prefix = (this.disabled == \"enabled\" ? \"dojoHtmlCheckbox\" : \"dojoHtmlCheckboxDisabled\");\n\t\t\tvar state = prefix + (this.checked ? \"On\" : \"Off\");\n\t\t\tdojo.html.setClass(this.domNode, \"dojoHtmlCheckbox \" + state);\n\t\t\tthis.inputNode.checked = this.checked;\n\t\t\tdojo.widget.wai.setAttr(this.domNode, \"waiState\", \"checked\", this.checked);","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.CiviCrmDatePicker":{"meta":{"requires":{"common":["dojo.widget.*","dojo.event.*","dojo.widget.DatePicker","dojo.widget.DatePicker","dojo.widget.TimePicker","dojo.html.common"]},"methods":{"dojo.widget.HtmlCiviCrmDatePicker":{"_":{"meta":{"summary":"","src":"\tthis.widgetType = \"CiviCrmDatePicker\";\n\tthis.idPrefix = \"scheduled_date_time\";\n\tthis.mode = \"datetime\"; \/\/ can also be date or time\n\n\tthis.datePicker = null;\n\tthis.timePicker = null;\n\n\t\/\/ html nodes\n\tthis.dateHolderTd = null;\n\tthis.timeHolderTd = null;\n\tthis.formItemsTd = null;\n\tthis.formItemsTr = null;\n\n\tthis.monthSelect = null;\n\tthis.daySelect = null;\n\tthis.yearSelect = null;\n\tthis.hourSelect = null;\n\tthis.minSelect = null;\n\tthis.apSelect = null;\n\n\tthis.templatePath = dojo.uri.dojoUri(\"src\/widget\/templates\/HtmlCiviCrmDatePicker.html\");\n\n\tthis.modeFormats = {\n\t\tdate: \"MdY\",\n\t\ttime: \"hiA\"\n\t};\n\n\tthis.formatMappings = {\n\t\t\"M\": \"monthSelect\",\n\t\t\"d\": \"daySelect\",\n\t\t\"Y\": \"yearSelect\",\n\t\t\"h\": \"hourSelect\",\n\t\t\"i\": \"minSelect\",\n\t\t\"A\": \"apSelect\"\n\t};\n\n\tthis.setDateSelects = function(){\n\t\tvar dateObj = this.datePicker.date;\n\t\tthis.monthSelect.value = new String(dateObj.getMonth()+1);\n\t\tthis.daySelect.value = new String(dateObj.getDate());\n\t\tthis.yearSelect.value = new String(dateObj.getFullYear());\n\t}\n\n\tthis.setTimeSelects = function(){\n\t\tvar st = this.timePicker.selectedTime;\n\t\tthis.hourSelect.value = new String(st.hour);\n\t\tthis.minSelect.value = new String(st.minute);\n\t\tthis.apSelect.value = st.amPm.toUpperCase();\n\t}\n\n\tthis.fillInTemplate = function(args, frag){\n\t\tvar nr = frag[\"dojo:\"+this.widgetType.toLowerCase()][\"nodeRef\"];\n\t\tvar sref = {};\n\t\twhile(nr.firstChild){\n\t\t\tif(nr.firstChild.name){\n\t\t\t\tsref[nr.firstChild.name] = nr.firstChild;\n\t\t\t}\n\t\t\tthis.formItemsTd.appendChild(nr.firstChild);\n\t\t}\n\n\t\tif(this.mode.indexOf(\"date\") != -1){\n\t\t\tthis.datePicker = dojo.widget.createWidget(\"DatePicker\", {}, this.dateHolderTd);\n\t\t\tdojo.event.connect(\tthis.datePicker, \"onSetDate\", \n\t\t\t\t\t\t\t\tthis, \"setDateSelects\");\n\n\t\t\tvar mfd = this.modeFormats.date;\n\t\t\tfor(var x=0; x<mfd.length; x++){\n\t\t\t\tthis[this.formatMappings[mfd[x]]] = sref[this.idPrefix+\"[\"+mfd[x]+\"]\"];\n\t\t\t}\n\t\t}\n\t\tif(this.mode.indexOf(\"time\") != -1){\n\t\t\tthis.timePicker = dojo.widget.createWidget(\"TimePicker\", {}, this.timeHolderTd);\n\t\t\tdojo.event.connect(\tthis.timePicker, \"onSetTime\", \n\t\t\t\t\t\t\t\tthis, \"setTimeSelects\");\n\t\t\tvar mfd = this.modeFormats.time;\n\t\t\tfor(var x=0; x<mfd.length; x++){\n\t\t\t\tthis[this.formatMappings[mfd[x]]] = sref[this.idPrefix+\"[\"+mfd[x]+\"]\"];\n\t\t\t}\n\t\t}\n\t}\n\n\tthis.unhide = function(){\n\t\tthis.formItemsTr.style.display = \"\";\n\t}\n\n\tthis.postCreate = function(){\n\t\tdojo.event.kwConnect({\n\t\t\ttype: \"before\", \n\t\t\tsrcObj: dojo.html.getParentByType(this.domNode, \"form\"),\n\t\t\tsrcFunc: \"onsubmit\", \n\t\t\ttargetObj: this,\n\t\t\ttargetFunc: \"unhide\"\n\t\t});\n\t}","this_variables":["widgetType","idPrefix","mode","datePicker","timePicker","dateHolderTd","timeHolderTd","formItemsTd","formItemsTr","monthSelect","daySelect","yearSelect","hourSelect","minSelect","apSelect","templatePath","modeFormats","formatMappings","setDateSelects","monthSelect.value","daySelect.value","yearSelect.value","setTimeSelects","hourSelect.value","minSelect.value","apSelect.value","fillInTemplate","unhide","formItemsTr.style.display","postCreate"],"inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.HtmlCiviCrmDatePicker.setDateSelects":{"_":{"meta":{"summary":"","src":"\t\tvar dateObj = this.datePicker.date;\n\t\tthis.monthSelect.value = new String(dateObj.getMonth()+1);\n\t\tthis.daySelect.value = new String(dateObj.getDate());\n\t\tthis.yearSelect.value = new String(dateObj.getFullYear());","this_variables":["monthSelect.value","daySelect.value","yearSelect.value"]}}},"dojo.widget.HtmlCiviCrmDatePicker.setTimeSelects":{"_":{"meta":{"summary":"","src":"\t\tvar st = this.timePicker.selectedTime;\n\t\tthis.hourSelect.value = new String(st.hour);\n\t\tthis.minSelect.value = new String(st.minute);\n\t\tthis.apSelect.value = st.amPm.toUpperCase();","this_variables":["hourSelect.value","minSelect.value","apSelect.value"]}}},"dojo.widget.HtmlCiviCrmDatePicker.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tvar nr = frag[\"dojo:\"+this.widgetType.toLowerCase()][\"nodeRef\"];\n\t\tvar sref = {};\n\t\twhile(nr.firstChild){\n\t\t\tif(nr.firstChild.name){\n\t\t\t\tsref[nr.firstChild.name] = nr.firstChild;\n\t\t\t}\n\t\t\tthis.formItemsTd.appendChild(nr.firstChild);\n\t\t}\n\n\t\tif(this.mode.indexOf(\"date\") != -1){\n\t\t\tthis.datePicker = dojo.widget.createWidget(\"DatePicker\", {}, this.dateHolderTd);\n\t\t\tdojo.event.connect(\tthis.datePicker, \"onSetDate\", \n\t\t\t\t\t\t\t\tthis, \"setDateSelects\");\n\n\t\t\tvar mfd = this.modeFormats.date;\n\t\t\tfor(var x=0; x<mfd.length; x++){\n\t\t\t\tthis[this.formatMappings[mfd[x]]] = sref[this.idPrefix+\"[\"+mfd[x]+\"]\"];\n\t\t\t}\n\t\t}\n\t\tif(this.mode.indexOf(\"time\") != -1){\n\t\t\tthis.timePicker = dojo.widget.createWidget(\"TimePicker\", {}, this.timeHolderTd);\n\t\t\tdojo.event.connect(\tthis.timePicker, \"onSetTime\", \n\t\t\t\t\t\t\t\tthis, \"setTimeSelects\");\n\t\t\tvar mfd = this.modeFormats.time;\n\t\t\tfor(var x=0; x<mfd.length; x++){\n\t\t\t\tthis[this.formatMappings[mfd[x]]] = sref[this.idPrefix+\"[\"+mfd[x]+\"]\"];\n\t\t\t}\n\t\t}","this_variables":["datePicker","timePicker"]}}},"dojo.widget.HtmlCiviCrmDatePicker.unhide":{"_":{"meta":{"summary":"","src":"\t\tthis.formItemsTr.style.display = \"\";","this_variables":["formItemsTr.style.display"]}}},"dojo.widget.HtmlCiviCrmDatePicker.postCreate":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.kwConnect({\n\t\t\ttype: \"before\", \n\t\t\tsrcObj: dojo.html.getParentByType(this.domNode, \"form\"),\n\t\t\tsrcFunc: \"onsubmit\", \n\t\t\ttargetObj: this,\n\t\t\ttargetFunc: \"unhide\"\n\t\t});"}}}}}},"dojo.widget.ColorPalette":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.Toolbar","dojo.html.layout","dojo.html.display","dojo.html.selection"]},"methods":{"dojo.widget.ToolbarColorDialog":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarDialog"],"this_inherits":["dojo.widget.ToolbarDialog"]}}},"dojo.widget.ColorPalette":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.ComboBox":{"meta":{"requires":{"common":["dojo.widget.*","dojo.event.*","dojo.io.*","dojo.lfx.*","dojo.html.*","dojo.html.display","dojo.html.layout","dojo.html.iframe","dojo.string","dojo.widget.html.stabile","dojo.widget.Menu2"]},"methods":{"dojo.widget.ComboBox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"isContainer":"","forceValidOption":"","searchType":"","dataProvider":"","autoComplete":"","formInputName":"","name":"","textInputNode":"","comboBoxValue":"","comboBoxSelectionValue":"","optionsListWrapper":"","optionsListNode":"","downArrowNode":"","cbTableNode":"","searchTimer":"","searchDelay":"","dataUrl":"","fadeTime":"","maxListLength":"","mode":"","selectedResult":"","_highlighted_option":"","_prev_key_backspace":"","_prev_key_esc":"","_gotFocus":"","_mouseover_list":"","dataProviderClass":"","dropdownToggle":"","templatePath":"","templateCssPath":""}}}},"dojo.widget.ComboBox.startSearch":{"_":{"meta":{"summary":"","parameters":{"searchString":{"type":""}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.selectNextResult":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.selectPrevResult":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.setSelectedResult":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.setValue":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tthis.comboBoxValue.value = value;\n\t\t\tif (this.textInputNode.value != value) { \/\/ prevent mucking up of selection\n\t\t\t\tthis.textInputNode.value = value;\n\t\t\t}\n\t\t\tdojo.widget.html.stabile.setState(this.widgetId, this.getState(), true);\n\t\t\tthis.onValueChanged(value);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["comboBoxValue.value","textInputNode.value","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","_prev_key_backspace","_prev_key_esc","searchTimer","comboBoxSelectionValue.value","_highlighted_option","_highlighted_option","_highlighted_option","comboBoxValue.name","comboBoxSelectionValue.name","mode","dataProviderClass","dataProvider","popupWidget","optionsListNode","comboBoxValue.name","comboBoxSelectionValue.name","mode","dataProviderClass","dataProvider","popupWidget","optionsListNode","_hasFocus","_hasFocus","blurTimer","_mouseover_list","_mouseover_list","textInputNode.value","selectedResult","textInputNode.value","selectedResult","optionsListNode.innerHTML"]}}},"dojo.widget.ComboBox.onValueChanged":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.getValue":{"_":{"meta":{"summary":"","src":"\t\t\treturn this.comboBoxValue.value;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.getState":{"_":{"meta":{"summary":"","src":"\t\t\treturn {value: this.getValue()};","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.value":{"_":{"meta":{"summary":"","src":"\t\t\treturn {value: this.getValue()};","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.setState":{"_":{"meta":{"summary":"","parameters":{"state":{"type":""}},"src":"\t\t\tthis.setValue(state.value);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.getCaretPos":{"_":{"meta":{"summary":"","parameters":{"element":{"type":""}},"src":"\t\t\t\t\/\/ FIXME: this is totally borked on Moz < 1.3. Any recourse?\n\t\t\t\treturn element.selectionStart;\n\t\t\t}else if(dojo.render.html.ie){\n\t\t\t\t\/\/ in the case of a mouse click in a popup being handled,\n\t\t\t\t\/\/ then the document.selection is not the textarea, but the popup\n\t\t\t\t\/\/ var r = document.selection.createRange();\n\t\t\t\t\/\/ hack to get IE 6 to play nice. What a POS browser.\n\t\t\t\tvar tr = document.selection.createRange().duplicate();\n\t\t\t\tvar ntr = element.createTextRange();\n\t\t\t\ttr.move(\"character\",0);\n\t\t\t\tntr.move(\"character\",0);\n\t\t\t\ttry {\n\t\t\t\t\t\/\/ If control doesnt have focus, you get an exception.\n\t\t\t\t\t\/\/ Seems to happen on reverse-tab, but can also happen on tab (seems to be a race condition - only happens sometimes).\n\t\t\t\t\t\/\/ There appears to be no workaround for this - googled for quite a while.\n\t\t\t\t\tntr.setEndPoint(\"EndToEnd\", tr);\n\t\t\t\t\treturn String(ntr.text).replace(\/\\r\/g,\"\").length;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn 0; \/\/ If focus has shifted, 0 is fine for caret pos.\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}","returns":"If focus has shifted, 0 is fine for caret pos.","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.setCaretPos":{"_":{"meta":{"summary":"","parameters":{"element":{"type":""},"location":{"type":""}},"src":"\t\t\tlocation = parseInt(location);\n\t\t\tthis.setSelectedRange(element, location, location);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.setSelectedRange":{"_":{"meta":{"summary":"","parameters":{"element":{"type":""},"start":{"type":""},"end":{"type":""}},"src":"\t\t\tif(!end){ end = element.value.length; }                                                                  \n\t\t\t\/\/ Mozilla\n\t\t\t\/\/ parts borrowed from http:\/\/www.faqts.com\/knowledge_base\/view.phtml\/aid\/13562\/fid\/130\n\t\t\tif(element.setSelectionRange){\n\t\t\t\telement.focus();\n\t\t\t\telement.setSelectionRange(start, end);\n\t\t\t}else if(element.createTextRange){ \/\/ IE\n\t\t\t\tvar range = element.createTextRange();\n\t\t\t\twith(range){\n\t\t\t\t\tcollapse(true);\n\t\t\t\t\tmoveEnd('character', end);\n\t\t\t\t\tmoveStart('character', start);\n\t\t\t\t\tselect();\n\t\t\t\t}\n\t\t\t}else{ \/\/otherwise try the event-creation hack (our own invention)\n\t\t\t\t\/\/ do we need these?\n\t\t\t\telement.value = element.value;\n\t\t\t\telement.blur();\n\t\t\t\telement.focus();\n\t\t\t\t\/\/ figure out how far back to go\n\t\t\t\tvar dist = parseInt(element.value.length)-end;\n\t\t\t\tvar tchar = String.fromCharCode(37);\n\t\t\t\tvar tcc = tchar.charCodeAt(0);\n\t\t\t\tfor(var x = 0; x < dist; x++){\n\t\t\t\t\tvar te = document.createEvent(\"KeyEvents\");\n\t\t\t\t\tte.initKeyEvent(\"keypress\", true, true, null, false, false, false, false, tcc, tcc);\n\t\t\t\t\telement.dispatchEvent(te);\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox._handleKeyEvents":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.63232":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.63233":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_DOWN_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_UP_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_ENTER":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_TAB":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_SPACE":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_ESCAPE":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_BACKSPACE":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_RIGHT_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_LEFT_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.k.KEY_SHIFT":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.default":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.ctrlKey || evt.altKey){ return; }\n\n\t\t\t\/\/ reset these\n\t\t\tthis._prev_key_backspace = false;\n\t\t\tthis._prev_key_esc = false;\n\n\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar doSearch = true;\n\n\t\t\t\/\/ mozilla quirk \n\t\t\t\/\/ space has no keyCode in mozilla\n\t\t\tvar keyCode = evt.keyCode;\n\t\t\tif(keyCode==0 && evt.charCode==k.KEY_SPACE){\n\t\t\t\tkeyCode = k.KEY_SPACE;\n\t\t\t}\n\t\t\t\/\/ Safari quirk. keyCodes for arrow keys are different\n\t\t\tif (dojo.render.html.safari) {\n\t\t\t\tswitch(keyCode) {\n\t\t\t\t\tcase 63232: keyCode = k.KEY_UP_ARROW; break;\n\t\t\t\t\tcase 63233: keyCode = k.KEY_DOWN_ARROW; break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(keyCode){\n\t \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tif(!this.popupWidget.isShowingNow){\n\t\t\t\t\t\tthis.startSearchFromInput();\n\t\t\t\t\t}\n\t\t\t\t\tthis.highlightNextOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tthis.highlightPrevOption();\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_ENTER:\n\t\t\t\t\t\/\/ prevent submitting form if we press enter with list open\n\t\t\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/ fallthrough\n\t\t\t\tcase k.KEY_TAB:\n\t\t\t\t\t\/\/ using linux alike tab for autocomplete\n\t\t\t\t\tif(!this.autoComplete && this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption({ 'target': this._highlighted_option, 'noHide': false});\n\t\n\t\t\t\t\t\t\/\/ put caret last\n\t\t\t\t\t\tthis.setSelectedRange(this.textInputNode, this.textInputNode.value.length, null);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_SPACE:\n\t\t\t\t\tif(this.popupWidget.isShowingNow && this._highlighted_option){\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tthis.selectOption();\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_ESCAPE:\n\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\tthis._prev_key_esc = true;\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_BACKSPACE:\n\t\t\t\t\tthis._prev_key_backspace = true;\n\t\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\t\tthis.hideResultList();\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase k.KEY_RIGHT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_LEFT_ARROW: \/\/ fall through\n\t\t\t\tcase k.KEY_SHIFT:\n\t\t\t\t\tdoSearch = false;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\/\/ non char keys (F1-F12 etc..)  shouldn't open list\n\t\t\t\t\tif(evt.charCode==0){\n\t\t\t\t\t\tdoSearch = false;\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.searchTimer){\n\t\t\t\tclearTimeout(this.searchTimer);\n\t\t\t}\n\t\t\tif(doSearch){\n\t\t\t\t\/\/ if we have gotten this far we dont want to keep our highlight\n\t\t\t\tthis.blurOptionNode();\n\t\n\t\t\t\t\/\/ need to wait a tad before start search so that the event bubbles through DOM and we have value visible\n\t\t\t\tthis.searchTimer = setTimeout(dojo.lang.hitch(this, this.startSearchFromInput), this.searchDelay);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.onKeyDown":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\t\tthis._handleKeyEvents(evt);\n\t\t\t}\n\t\t\t\/\/ FIXME: What about ESC ??","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.onKeyPress":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(document.createEvent){            \n\t\t\t\tthis._handleKeyEvents(evt);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.compositionEnd":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis._handleKeyEvents(evt);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.onKeyUp":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis.setValue(this.textInputNode.value);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.setSelectedValue":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.setAllValues":{"_":{"meta":{"summary":"","parameters":{"value1":{"type":""},"value2":{"type":""}},"src":"\t\t\tthis.setValue(value1);\n\t\t\tthis.setSelectedValue(value2);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.focusOptionNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\tif(this._highlighted_option != node){\n\t\t\t\tthis.blurOptionNode();\n\t\t\t\tthis._highlighted_option = node;\n\t\t\t\tdojo.html.addClass(this._highlighted_option, \"dojoComboBoxItemHighlight\");\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.blurOptionNode":{"_":{"meta":{"summary":"","src":"\t\t\tif(this._highlighted_option){\n\t\t\t\tdojo.html.removeClass(this._highlighted_option, \"dojoComboBoxItemHighlight\");\n\t\t\t\tthis._highlighted_option = null;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.highlightNextOption":{"_":{"meta":{"summary":"","src":"\t\t\tif((!this._highlighted_option) || !this._highlighted_option.parentNode){\n\t\t\t\tthis.focusOptionNode(this.optionsListNode.firstChild);\n\t\t\t}else if(this._highlighted_option.nextSibling){\n\t\t\t\tthis.focusOptionNode(this._highlighted_option.nextSibling);\n\t\t\t}\n\t\t\tdojo.html.scrollIntoView(this._highlighted_option);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.highlightPrevOption":{"_":{"meta":{"summary":"","src":"\t\t\tif(this._highlighted_option && this._highlighted_option.previousSibling){\n\t\t\t\tthis.focusOptionNode(this._highlighted_option.previousSibling);\n\t\t\t}else{\n\t\t\t\tthis._highlighted_option = null;\n\t\t\t\tthis.hideResultList();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdojo.html.scrollIntoView(this._highlighted_option);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.itemMouseOver":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif (evt.target === this.optionsListNode) { return; }\n\t\t\tthis.focusOptionNode(evt.target);\n\t\t\tdojo.html.addClass(this._highlighted_option, \"dojoComboBoxItemHighlight\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.itemMouseOut":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif (evt.target === this.optionsListNode) { return; }\n\t\t\tthis.blurOptionNode();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tthis.comboBoxSelectionValue.name = this.name+\"_selected\";\n\n\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\tdojo.html.copyStyle(this.domNode, source);\n\n\t\t\tvar dpClass;\n\t\t\tif(this.mode == \"remote\"){\n\t\t\t\tdpClass = dojo.widget.incrementalComboBoxDataProvider;\n\t\t\t}else if(typeof this.dataProviderClass == \"string\"){\n\t\t\t\tdpClass = dojo.evalObjPath(this.dataProviderClass)\n\t\t\t}else{\n\t\t\t\tdpClass = this.dataProviderClass;\n\t\t\t}\n\t\t\tthis.dataProvider = new dpClass();\n\t\t\tthis.dataProvider.init(this, this.getFragNodeRef(frag));\n\n\t\t\tthis.popupWidget = new dojo.widget.createWidget(\"PopupContainer\", \n\t\t\t\t{toggle: this.dropdownToggle, toggleDuration: this.toggleDuration});\n\t\t\tdojo.event.connect(this, 'destroy', this.popupWidget, 'destroy');\n\t\t\tthis.optionsListNode = this.popupWidget.domNode;\n\t\t\tthis.domNode.appendChild(this.optionsListNode);\n\t\t\tdojo.html.addClass(this.optionsListNode, 'dojoComboBoxOptions');\n\t\t\tdojo.event.connect(this.optionsListNode, 'onclick', this, 'selectOption');\n\t\t\tdojo.event.connect(this.optionsListNode, 'onmouseover', this, '_onMouseOver');\n\t\t\tdojo.event.connect(this.optionsListNode, 'onmouseout', this, '_onMouseOut');\n\t\t\t\n\t\t\tdojo.event.connect(this.optionsListNode, \"onmouseover\", this, \"itemMouseOver\");\n\t\t\tdojo.event.connect(this.optionsListNode, \"onmouseout\", this, \"itemMouseOut\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.toggle":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tthis.comboBoxSelectionValue.name = this.name+\"_selected\";\n\n\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\tdojo.html.copyStyle(this.domNode, source);\n\n\t\t\tvar dpClass;\n\t\t\tif(this.mode == \"remote\"){\n\t\t\t\tdpClass = dojo.widget.incrementalComboBoxDataProvider;\n\t\t\t}else if(typeof this.dataProviderClass == \"string\"){\n\t\t\t\tdpClass = dojo.evalObjPath(this.dataProviderClass)\n\t\t\t}else{\n\t\t\t\tdpClass = this.dataProviderClass;\n\t\t\t}\n\t\t\tthis.dataProvider = new dpClass();\n\t\t\tthis.dataProvider.init(this, this.getFragNodeRef(frag));\n\n\t\t\tthis.popupWidget = new dojo.widget.createWidget(\"PopupContainer\", \n\t\t\t\t{toggle: this.dropdownToggle, toggleDuration: this.toggleDuration});\n\t\t\tdojo.event.connect(this, 'destroy', this.popupWidget, 'destroy');\n\t\t\tthis.optionsListNode = this.popupWidget.domNode;\n\t\t\tthis.domNode.appendChild(this.optionsListNode);\n\t\t\tdojo.html.addClass(this.optionsListNode, 'dojoComboBoxOptions');\n\t\t\tdojo.event.connect(this.optionsListNode, 'onclick', this, 'selectOption');\n\t\t\tdojo.event.connect(this.optionsListNode, 'onmouseover', this, '_onMouseOver');\n\t\t\tdojo.event.connect(this.optionsListNode, 'onmouseout', this, '_onMouseOut');\n\t\t\t\n\t\t\tdojo.event.connect(this.optionsListNode, \"onmouseover\", this, \"itemMouseOver\");\n\t\t\tdojo.event.connect(this.optionsListNode, \"onmouseout\", this, \"itemMouseOut\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.focus":{"_":{"meta":{"summary":" set focus to input node from code","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.openResultList":{"_":{"meta":{"summary":"","parameters":{"results":{"type":""}},"src":"\t\t\tthis.clearResultList();\n\t\t\tif(!results.length){\n\t\t\t\tthis.hideResultList();\n\t\t\t}\n\n\t\t\tif(\t(this.autoComplete)&&\n\t\t\t\t(results.length)&&\n\t\t\t\t(!this._prev_key_backspace)&&\n\t\t\t\t(this.textInputNode.value.length > 0)){\n\t\t\t\tvar cpos = this.getCaretPos(this.textInputNode);\n\t\t\t\t\/\/ only try to extend if we added the last character at the end of the input\n\t\t\t\tif((cpos+1) > this.textInputNode.value.length){\n\t\t\t\t\t\/\/ only add to input node as we would overwrite Capitalisation of chars\n\t\t\t\t\tthis.textInputNode.value += results[0][0].substr(cpos);\n\t\t\t\t\t\/\/ build a new range that has the distance from the earlier\n\t\t\t\t\t\/\/ caret position to the end of the first string selected\n\t\t\t\t\tthis.setSelectedRange(this.textInputNode, cpos, this.textInputNode.value.length);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar even = true;\n\t\t\twhile(results.length){\n\t\t\t\tvar tr = results.shift();\n\t\t\t\tif(tr){\n\t\t\t\t\tvar td = document.createElement(\"div\");\n\t\t\t\t\ttd.appendChild(document.createTextNode(tr[0]));\n\t\t\t\t\ttd.setAttribute(\"resultName\", tr[0]);\n\t\t\t\t\ttd.setAttribute(\"resultValue\", tr[1]);\n\t\t\t\t\ttd.className = \"dojoComboBoxItem \"+((even) ? \"dojoComboBoxItemEven\" : \"dojoComboBoxItemOdd\");\n\t\t\t\t\teven = (!even);\n\t\t\t\t\tthis.optionsListNode.appendChild(td);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t\/\/ show our list (only if we have content, else nothing)\n\t\t\tthis.showResultList();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.onFocusInput":{"_":{"meta":{"summary":"","src":"\t\t\tthis._hasFocus = true;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.onBlurInput":{"_":{"meta":{"summary":"","src":"\t\t\tthis._hasFocus = false;\n\t\t\tthis._handleBlurTimer(true, 500);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox._handleBlurTimer":{"_":{"meta":{"summary":"","parameters":{"clear":{"type":"Boolean"},"millisec":{"type":"Number"}},"src":"\t\t\tif(this.blurTimer && (clear || millisec)){\n\t\t\t\tclearTimeout(this.blurTimer);\n\t\t\t}\n\t\t\tif(millisec){ \/\/ we ignore that zero is false and never sets as that never happens in this widget\n\t\t\t\tthis.blurTimer = dojo.lang.setTimeout(this, \"checkBlurred\", millisec);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox._onMouseOver":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(!this._mouseover_list){\n\t\t\t\tthis._handleBlurTimer(true, 0);\n\t\t\t\tthis._mouseover_list = true;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox._onMouseOut":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar relTarget = evt.relatedTarget;\n\t\t\tif(!relTarget || relTarget.parentNode!=this.optionsListNode){\n\t\t\t\tthis._mouseover_list = false;\n\t\t\t\tthis._handleBlurTimer(true, 100);\n\t\t\t\tthis.tryFocus();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox._isInputEqualToResult":{"_":{"meta":{"summary":"","parameters":{"result":{"type":""}},"src":"\t\t\tvar input = this.textInputNode.value;\n\t\t\tif(!this.dataProvider.caseSensitive){\n\t\t\t\tinput = input.toLowerCase();\n\t\t\t\tresult = result.toLowerCase();\n\t\t\t}\n\t\t\treturn (input == result);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox._isValidOption":{"_":{"meta":{"summary":"","src":"\t\t\tvar tgt = dojo.html.firstElement(this.optionsListNode);\n\t\t\tvar isValidOption = false;\n\t\t\tvar tgt = dojo.html.firstElement(this.optionsListNode);\n\t\t\tvar isValidOption = false;\n\t\t\twhile(!isValidOption && tgt){\n\t\t\t\tif(this._isInputEqualToResult(tgt.getAttribute(\"resultName\"))){\n\t\t\t\t\tisValidOption = true;\n\t\t\t\t}else{\n\t\t\t\t\ttgt = dojo.html.nextElement(tgt);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn isValidOption;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.checkBlurred":{"_":{"meta":{"summary":"","src":"\t\t\tif(!this._hasFocus && !this._mouseover_list){\n\t\t\t\tthis.hideResultList();\n\t\t\t\t\/\/ clear the list if the user empties field and moves away.\n\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar isValidOption = this._isValidOption();\n\t\t\t\t\/\/ enforce selection from option list\n\t\t\t\tif(this.forceValidOption && !isValidOption){\n\t\t\t\t\tthis.setAllValues(\"\", \"\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(!isValidOption){\/\/ clear\n\t\t\t\t\tthis.setSelectedValue(\"\");\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.sizeBackgroundIframe":{"_":{"meta":{"summary":"","src":"\t\t\tvar mb = dojo.html.getMarginBox(this.optionsListNode);\n\t\t\tif( mb.width==0 || mb.height==0 ){\n\t\t\t\t\/\/ need more time to calculate size\n\t\t\t\tdojo.lang.setTimeout(this, \"sizeBackgroundIframe\", 100);\n\t\t\t\treturn;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.selectOption":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar tgt = null;\n\t\t\tif(!evt){\n\t\t\t\tevt = { target: this._highlighted_option };\n\t\t\t}\n\n\t\t\tif(!dojo.html.isDescendantOf(evt.target, this.optionsListNode)){\n\t\t\t\t\/\/ handle autocompletion where the the user has hit ENTER or TAB\n\t\n\t\t\t\t\/\/ if the input is empty do nothing\n\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttgt = dojo.html.firstElement(this.optionsListNode);\n\n\t\t\t\t\/\/ user has input value not in option list\n\t\t\t\tif(!tgt || !this._isInputEqualToResult(tgt.getAttribute(\"resultName\"))){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\/\/ otherwise the user has accepted the autocompleted value\n\t\t\t}else{\n\t\t\t\ttgt = evt.target; \n\t\t\t}\n\n\t\t\twhile((tgt.nodeType!=1)||(!tgt.getAttribute(\"resultName\"))){\n\t\t\t\ttgt = tgt.parentNode;\n\t\t\t\tif(tgt === dojo.body()){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.textInputNode.value = tgt.getAttribute(\"resultName\");\n\t\t\tthis.selectedResult = [tgt.getAttribute(\"resultName\"), tgt.getAttribute(\"resultValue\")];\n\t\t\tthis.setAllValues(tgt.getAttribute(\"resultName\"), tgt.getAttribute(\"resultValue\"));\n\t\t\tif(!evt.noHide){\n\t\t\t\tthis.hideResultList();\n\t\t\t\tthis.setSelectedRange(this.textInputNode, 0, null);\n\t\t\t}\n\t\t\tthis.tryFocus();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.target":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar tgt = null;\n\t\t\tif(!evt){\n\t\t\t\tevt = { target: this._highlighted_option };\n\t\t\t}\n\n\t\t\tif(!dojo.html.isDescendantOf(evt.target, this.optionsListNode)){\n\t\t\t\t\/\/ handle autocompletion where the the user has hit ENTER or TAB\n\t\n\t\t\t\t\/\/ if the input is empty do nothing\n\t\t\t\tif(!this.textInputNode.value.length){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttgt = dojo.html.firstElement(this.optionsListNode);\n\n\t\t\t\t\/\/ user has input value not in option list\n\t\t\t\tif(!tgt || !this._isInputEqualToResult(tgt.getAttribute(\"resultName\"))){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\/\/ otherwise the user has accepted the autocompleted value\n\t\t\t}else{\n\t\t\t\ttgt = evt.target; \n\t\t\t}\n\n\t\t\twhile((tgt.nodeType!=1)||(!tgt.getAttribute(\"resultName\"))){\n\t\t\t\ttgt = tgt.parentNode;\n\t\t\t\tif(tgt === dojo.body()){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.textInputNode.value = tgt.getAttribute(\"resultName\");\n\t\t\tthis.selectedResult = [tgt.getAttribute(\"resultName\"), tgt.getAttribute(\"resultValue\")];\n\t\t\tthis.setAllValues(tgt.getAttribute(\"resultName\"), tgt.getAttribute(\"resultValue\"));\n\t\t\tif(!evt.noHide){\n\t\t\t\tthis.hideResultList();\n\t\t\t\tthis.setSelectedRange(this.textInputNode, 0, null);\n\t\t\t}\n\t\t\tthis.tryFocus();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.clearResultList":{"_":{"meta":{"summary":"","src":"\t\t\tthis.optionsListNode.innerHTML = \"\";                                                      ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.hideResultList":{"_":{"meta":{"summary":"","src":"\t\t\tthis.popupWidget.close();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.showResultList":{"_":{"meta":{"summary":"","src":"\t\t\tif(childs.length){\n\t\t\t\tvar visibleCount = this.maxListLength;\n\t\t\t\tif(childs.length < visibleCount){\n\t\t\t\t\tvisibleCount = childs.length;\n\t\t\t\t}\n\n\t\t\t\twith(this.optionsListNode.style)\n\t\t\t\t{\n\t\t\t\t\tdisplay = \"\";\n\t\t\t\t\tif(visibleCount == childs.length){\n\t\t\t\t\t\t\/\/no scrollbar is required, so unset height to let browser calcuate it,\n\t\t\t\t\t\t\/\/as in css, overflow is already set to auto\n\t\t\t\t\t\theight = \"\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\t\/\/show it first to get the correct dojo.style.getOuterHeight(childs[0])\n\t\t\t\t\t\t\/\/FIXME: shall we cache the height of the item?\n\t\t\t\t\t\theight = visibleCount * dojo.html.getMarginBox(childs[0]).height +\"px\";\n\t\t\t\t\t}\n\t\t\t\t\twidth = (dojo.html.getMarginBox(this.domNode).width-2)+\"px\";\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tthis.popupWidget.open(this.cbTableNode, this, this.downArrowNode);\n\t\t\t}else{\n\t\t\t\tthis.hideResultList();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.handleArrowClick":{"_":{"meta":{"summary":"","src":"\t\t\tthis._handleBlurTimer(true, 0);\n\t\t\tthis.tryFocus();\n\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\tthis.hideResultList();\n\t\t\t}else{\n\t\t\t\t\/\/ forces full population of results, if they click\n\t\t\t\t\/\/ on the arrow it means they want to see more options\n\t\t\t\tthis.startSearch(\"\");\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.tryFocus":{"_":{"meta":{"summary":"","src":"\t\t\ttry {\n\t\t\t\tthis.textInputNode.focus();\n\t\t\t} catch (e) {\n\t\t\t\t\/\/ element isn't focusable if disabled, or not visible etc - not easy to test for.\n\t \t\t};","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.startSearchFromInput":{"_":{"meta":{"summary":"","src":"\t\t\tthis.startSearch(this.textInputNode.value);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ComboBox.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.event.connect(this, \"startSearch\", this.dataProvider, \"startSearch\");\n\t\t\tdojo.event.connect(this.dataProvider, \"provideSearchResults\", this, \"openResultList\");\n\t\t\tdojo.event.connect(this.textInputNode, \"onblur\", this, \"onBlurInput\");\n\t\t\tdojo.event.connect(this.textInputNode, \"onfocus\", this, \"onFocusInput\");\n\n\t\t\tvar s = dojo.widget.html.stabile.getState(this.widgetId);\n\t\t\tif (s) {\n\t\t\t\tthis.setState(s);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.incrementalComboBoxDataProvider":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"limit":{"type":""},"timeout":{"type":""}},"src":"\tthis.searchUrl = url;\n\tthis.inFlight = false;\n\tthis.activeRequest = null;\n\tthis.allowCache = false;\n\n\tthis.cache = {};\n\n\tthis.init = function(cbox){\n\t\tthis.searchUrl = cbox.dataUrl;\n\t};\n\n\tthis.addToCache = function(keyword, data){\n\t\tif(this.allowCache){\n\t\t\tthis.cache[keyword] = data;\n\t\t}\n\t};\n\n\tthis.startSearch = function(searchStr, type, ignoreLimit){\n\t\tif(this.inFlight){\n\t\t\t\/\/ FIXME: implement backoff!\n\t\t}\n\t\tvar tss = encodeURIComponent(searchStr);\n\t\tvar realUrl = dojo.string.substituteParams(this.searchUrl, {\"searchString\": tss});\n\t\tvar _this = this;\n\t\tvar request = dojo.io.bind({\n\t\t\turl: realUrl,\n\t\t\tmethod: \"get\",\n\t\t\tmimetype: \"text\/json\",\n\t\t\tload: function(type, data, evt){\n\t\t\t\t_this.inFlight = false;\n\t\t\t\tif(!dojo.lang.isArray(data)){\n\t\t\t\t\tvar arrData = [];\n\t\t\t\t\tfor(var key in data){\n\t\t\t\t\t\tarrData.push([data[key], key]);\n\t\t\t\t\t}\n\t\t\t\t\tdata = arrData;\n\t\t\t\t}\n\t\t\t\t_this.addToCache(searchStr, data);\n\t\t\t\t_this.provideSearchResults(data);\n\t\t\t}\n\t\t});\n\t\tthis.inFlight = true;\n\t};","this_variables":["searchUrl","inFlight","activeRequest","allowCache","cache","init","addToCache","startSearch"]}}},"dojo.widget.incrementalComboBoxDataProvider.init":{"_":{"meta":{"summary":"","parameters":{"cbox":{"type":""}},"src":"\t\tthis.searchUrl = cbox.dataUrl;","this_variables":["searchUrl"]}}},"dojo.widget.incrementalComboBoxDataProvider.addToCache":{"_":{"meta":{"summary":"","parameters":{"keyword":{"type":""},"data":{"type":""}},"src":"\t\tif(this.allowCache){\n\t\t\tthis.cache[keyword] = data;\n\t\t}"}}},"dojo.widget.incrementalComboBoxDataProvider.startSearch":{"_":{"meta":{"summary":"","parameters":{"searchStr":{"type":""},"type":{"type":""},"ignoreLimit":{"type":""}},"src":"\t\tif(this.inFlight){\n\t\t\t\/\/ FIXME: implement backoff!\n\t\t}\n\t\tvar tss = encodeURIComponent(searchStr);\n\t\tvar realUrl = dojo.string.substituteParams(this.searchUrl, {\"searchString\": tss});\n\t\tvar _this = this;\n\t\tvar request = dojo.io.bind({\n\t\t\turl: realUrl,\n\t\t\tmethod: \"get\",\n\t\t\tmimetype: \"text\/json\",\n\t\t\tload: function(type, data, evt){\n\t\t\t\t_this.inFlight = false;\n\t\t\t\tif(!dojo.lang.isArray(data)){\n\t\t\t\t\tvar arrData = [];\n\t\t\t\t\tfor(var key in data){\n\t\t\t\t\t\tarrData.push([data[key], key]);\n\t\t\t\t\t}\n\t\t\t\t\tdata = arrData;\n\t\t\t\t}\n\t\t\t\t_this.addToCache(searchStr, data);\n\t\t\t\t_this.provideSearchResults(data);\n\t\t\t}\n\t\t});\n\t\tthis.inFlight = true;","this_variables":["inFlight"]}}},"dojo.widget.ComboBoxDataProvider":{"_":{"meta":{"summary":"","parameters":{"dataPairs":{"type":""},"limit":{"type":""},"timeout":{"type":""}},"src":"\tthis.searchTimeout = timeout || 500;\n\tthis.searchLimit = limit || 30;\n\tthis.searchType = \"STARTSTRING\"; \/\/ may also be \"STARTWORD\" or \"SUBSTRING\"\n\tthis.caseSensitive = false;\n\t\/\/ for caching optimizations\n\tthis._lastSearch = \"\";\n\tthis._lastSearchResults = null;\n\n\tthis.init = function(cbox, node){\n\t\tif(!dojo.string.isBlank(cbox.dataUrl)){\n\t\t\tthis.getData(cbox.dataUrl);\n\t\t}else{\n\t\t\t\/\/ check to see if we can populate the list from <option> elements\n\t\t\tif((node)&&(node.nodeName.toLowerCase() == \"select\")){\n\t\t\t\t\/\/ NOTE: we're not handling <optgroup> here yet\n\t\t\t\tvar opts = node.getElementsByTagName(\"option\");\n\t\t\t\tvar ol = opts.length;\n\t\t\t\tvar data = [];\n\t\t\t\tfor(var x=0; x<ol; x++){\n\t\t\t\t\tvar keyValArr = [String(opts[x].innerHTML), String(opts[x].value)];\n\t\t\t\t\tdata.push(keyValArr);\n\t\t\t\t\tif(opts[x].selected){ \n\t\t\t\t\t\tcbox.setAllValues(keyValArr[0], keyValArr[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.setData(data);\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.getData = function(url){\n\t\tdojo.io.bind({\n\t\t\turl: url,\n\t\t\tload: dojo.lang.hitch(this, function(type, data, evt){ \n\t\t\t\tif(!dojo.lang.isArray(data)){\n\t\t\t\t\tvar arrData = [];\n\t\t\t\t\tfor(var key in data){\n\t\t\t\t\t\tarrData.push([data[key], key]);\n\t\t\t\t\t}\n\t\t\t\t\tdata = arrData;\n\t\t\t\t}\n\t\t\t\tthis.setData(data);\n\t\t\t}),\n\t\t\tmimetype: \"text\/json\"\n\t\t});\n\t};\n\n\tthis.startSearch = function(searchStr, type, ignoreLimit){\n\t\t\/\/ FIXME: need to add timeout handling here!!\n\t\tthis._preformSearch(searchStr, type, ignoreLimit);\n\t};\n\n\tthis._preformSearch = function(searchStr, type, ignoreLimit){\n\t\t\/\/\n\t\t\/\/\tNOTE: this search is LINEAR, which means that it exhibits perhaps\n\t\t\/\/\tthe worst possible speed characteristics of any search type. It's\n\t\t\/\/\twritten this way to outline the responsibilities and interfaces for\n\t\t\/\/\ta search.\n\t\t\/\/\n\t\tvar st = type||this.searchType;\n\t\t\/\/ FIXME: this is just an example search, which means that we implement\n\t\t\/\/ only a linear search without any of the attendant (useful!) optimizations\n\t\tvar ret = [];\n\t\tif(!this.caseSensitive){\n\t\t\tsearchStr = searchStr.toLowerCase();\n\t\t}\n\t\tfor(var x=0; x<this.data.length; x++){\n\t\t\tif((!ignoreLimit)&&(ret.length >= this.searchLimit)){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\/\/ FIXME: we should avoid copies if possible!\n\t\t\tvar dataLabel = new String((!this.caseSensitive) ? this.data[x][0].toLowerCase() : this.data[x][0]);\n\t\t\tif(dataLabel.length < searchStr.length){\n\t\t\t\t\/\/ this won't ever be a good search, will it? What if we start\n\t\t\t\t\/\/ to support regex search?\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(st == \"STARTSTRING\"){\n\t\t\t\t\/\/ jum.debug(dataLabel.substr(0, searchStr.length))\n\t\t\t\t\/\/ jum.debug(searchStr);\n\t\t\t\tif(searchStr == dataLabel.substr(0, searchStr.length)){\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t}else if(st == \"SUBSTRING\"){\n\t\t\t\t\/\/ this one is a gimmie\n\t\t\t\tif(dataLabel.indexOf(searchStr) >= 0){\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t}else if(st == \"STARTWORD\"){\n\t\t\t\t\/\/ do a substring search and then attempt to determine if the\n\t\t\t\t\/\/ preceeding char was the beginning of the string or a\n\t\t\t\t\/\/ whitespace char.\n\t\t\t\tvar idx = dataLabel.indexOf(searchStr);\n\t\t\t\tif(idx == 0){\n\t\t\t\t\t\/\/ implicit match\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t\tif(idx <= 0){\n\t\t\t\t\t\/\/ if we didn't match or implicily matched, march onward\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\/\/ otherwise, we have to go figure out if the match was at the\n\t\t\t\t\/\/ start of a word...\n\t\t\t\t\/\/ this code is taken almost directy from nWidgets\n\t\t\t\tvar matches = false;\n\t\t\t\twhile(idx!=-1){\n\t\t\t\t\t\/\/ make sure the match either starts whole string, or\n\t\t\t\t\t\/\/ follows a space, or follows some punctuation\n\t\t\t\t\tif(\" ,\/(\".indexOf(dataLabel.charAt(idx-1)) != -1){\n\t\t\t\t\t\t\/\/ FIXME: what about tab chars?\n\t\t\t\t\t\tmatches = true; break;\n\t\t\t\t\t}\n\t\t\t\t\tidx = dataLabel.indexOf(searchStr, idx+1);\n\t\t\t\t}\n\t\t\t\tif(!matches){\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.provideSearchResults(ret);\n\t};\n\n\tthis.provideSearchResults = function(resultsDataPairs){\n\t};\n\n\tthis.addData = function(pairs){\n\t\t\/\/ FIXME: incredibly naive and slow!\n\t\tthis.data = this.data.concat(pairs);\n\t};\n\n\tthis.setData = function(pdata){\n\t\t\/\/ populate this.data and initialize lookup structures\n\t\tthis.data = pdata;\n\t};\n\t\n\tif(dataPairs){\n\t\tthis.setData(dataPairs);\n\t}","this_variables":["data","searchTimeout","searchLimit","searchType","caseSensitive","_lastSearch","_lastSearchResults","init","getData","startSearch","_preformSearch","provideSearchResults","addData","setData"]}}},"dojo.widget.ComboBoxDataProvider.init":{"_":{"meta":{"summary":"","parameters":{"cbox":{"type":""},"node":{"type":""}},"src":"\t\tif(!dojo.string.isBlank(cbox.dataUrl)){\n\t\t\tthis.getData(cbox.dataUrl);\n\t\t}else{\n\t\t\t\/\/ check to see if we can populate the list from <option> elements\n\t\t\tif((node)&&(node.nodeName.toLowerCase() == \"select\")){\n\t\t\t\t\/\/ NOTE: we're not handling <optgroup> here yet\n\t\t\t\tvar opts = node.getElementsByTagName(\"option\");\n\t\t\t\tvar ol = opts.length;\n\t\t\t\tvar data = [];\n\t\t\t\tfor(var x=0; x<ol; x++){\n\t\t\t\t\tvar keyValArr = [String(opts[x].innerHTML), String(opts[x].value)];\n\t\t\t\t\tdata.push(keyValArr);\n\t\t\t\t\tif(opts[x].selected){ \n\t\t\t\t\t\tcbox.setAllValues(keyValArr[0], keyValArr[1]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.setData(data);\n\t\t\t}\n\t\t}"}}},"dojo.widget.ComboBoxDataProvider.getData":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\tdojo.io.bind({\n\t\t\turl: url,\n\t\t\tload: dojo.lang.hitch(this, function(type, data, evt){ \n\t\t\t\tif(!dojo.lang.isArray(data)){\n\t\t\t\t\tvar arrData = [];\n\t\t\t\t\tfor(var key in data){\n\t\t\t\t\t\tarrData.push([data[key], key]);\n\t\t\t\t\t}\n\t\t\t\t\tdata = arrData;\n\t\t\t\t}\n\t\t\t\tthis.setData(data);\n\t\t\t}),\n\t\t\tmimetype: \"text\/json\"\n\t\t});"}}},"dojo.widget.ComboBoxDataProvider.startSearch":{"_":{"meta":{"summary":"","parameters":{"searchStr":{"type":""},"type":{"type":""},"ignoreLimit":{"type":""}},"src":""}}},"dojo.widget.ComboBoxDataProvider._preformSearch":{"_":{"meta":{"summary":"","parameters":{"searchStr":{"type":""},"type":{"type":""},"ignoreLimit":{"type":""}},"src":"\t\t\/\/ FIXME: this is just an example search, which means that we implement\n\t\t\/\/ only a linear search without any of the attendant (useful!) optimizations\n\t\tvar ret = [];\n\t\tif(!this.caseSensitive){\n\t\t\tsearchStr = searchStr.toLowerCase();\n\t\t}\n\t\tfor(var x=0; x<this.data.length; x++){\n\t\t\tif((!ignoreLimit)&&(ret.length >= this.searchLimit)){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\/\/ FIXME: we should avoid copies if possible!\n\t\t\tvar dataLabel = new String((!this.caseSensitive) ? this.data[x][0].toLowerCase() : this.data[x][0]);\n\t\t\tif(dataLabel.length < searchStr.length){\n\t\t\t\t\/\/ this won't ever be a good search, will it? What if we start\n\t\t\t\t\/\/ to support regex search?\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(st == \"STARTSTRING\"){\n\t\t\t\t\/\/ jum.debug(dataLabel.substr(0, searchStr.length))\n\t\t\t\t\/\/ jum.debug(searchStr);\n\t\t\t\tif(searchStr == dataLabel.substr(0, searchStr.length)){\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t}else if(st == \"SUBSTRING\"){\n\t\t\t\t\/\/ this one is a gimmie\n\t\t\t\tif(dataLabel.indexOf(searchStr) >= 0){\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t}else if(st == \"STARTWORD\"){\n\t\t\t\t\/\/ do a substring search and then attempt to determine if the\n\t\t\t\t\/\/ preceeding char was the beginning of the string or a\n\t\t\t\t\/\/ whitespace char.\n\t\t\t\tvar idx = dataLabel.indexOf(searchStr);\n\t\t\t\tif(idx == 0){\n\t\t\t\t\t\/\/ implicit match\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t\tif(idx <= 0){\n\t\t\t\t\t\/\/ if we didn't match or implicily matched, march onward\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\/\/ otherwise, we have to go figure out if the match was at the\n\t\t\t\t\/\/ start of a word...\n\t\t\t\t\/\/ this code is taken almost directy from nWidgets\n\t\t\t\tvar matches = false;\n\t\t\t\twhile(idx!=-1){\n\t\t\t\t\t\/\/ make sure the match either starts whole string, or\n\t\t\t\t\t\/\/ follows a space, or follows some punctuation\n\t\t\t\t\tif(\" ,\/(\".indexOf(dataLabel.charAt(idx-1)) != -1){\n\t\t\t\t\t\t\/\/ FIXME: what about tab chars?\n\t\t\t\t\t\tmatches = true; break;\n\t\t\t\t\t}\n\t\t\t\t\tidx = dataLabel.indexOf(searchStr, idx+1);\n\t\t\t\t}\n\t\t\t\tif(!matches){\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tret.push(this.data[x]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.provideSearchResults(ret);"}}},"dojo.widget.ComboBoxDataProvider.provideSearchResults":{"_":{"meta":{"summary":"","parameters":{"resultsDataPairs":{"type":""}},"src":""}}},"dojo.widget.ComboBoxDataProvider.addData":{"_":{"meta":{"summary":"","parameters":{"pairs":{"type":""}},"src":"","this_variables":["data"]}}},"dojo.widget.ComboBoxDataProvider.setData":{"_":{"meta":{"summary":"","parameters":{"pdata":{"type":""}},"src":"","this_variables":["data"]}}}}}},"dojo.widget.Console":{"meta":{"requires":{"common":["dojo.widget.*","dojo.lang.common"]},"methods":{"dojo.widget.Console":{"_":{"meta":{"protovariables":{"debug":""}}}},"dojo.widget.Console.runCommand":{"_":{"meta":{"summary":"To be implemented by subclass","parameters":{"command":{"type":"string"}},"src":"\t\tthis.printCommand(command);\n\t\tthis.printResult(command);","this":"dojo.widget.Console"}}},"dojo.widget.Console.printDebug":{"_":{"meta":{"summary":"Writes the debug statement to the screen.","parameters":{"line":{"type":"string"}},"src":"\t\t\/\/ summary: Writes the debug statement to the screen.","this":"dojo.widget.Console"}}},"dojo.widget.Console.printCommand":{"_":{"meta":{"summary":"Writes the command to the screen","parameters":{"command":{"type":"string"}},"src":"\t\t\/\/ summary: Writes the command to the screen","this":"dojo.widget.Console"}}},"dojo.widget.Console.printResult":{"_":{"meta":{"summary":"Writes the result to the screen","parameters":{"result":{"type":"string"}},"src":"\t\t\/\/ summary: Writes the result to the screen","this":"dojo.widget.Console"}}}}}},"dojo.widget.ContentPane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.io.*","dojo.widget.HtmlWidget","dojo.string","dojo.string.extras","dojo.html.style"]},"methods":{"dojo.widget.ContentPane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"isContainer":"","adjustPaths":"","href":"","extractContent":"","parseContent":"","cacheContent":"","preventCache":"","useCache":"","preload":"","refreshOnShow":"","handler":"","executeScripts":""}}}},"dojo.widget.ContentPane.postCreate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""},"parentComp":{"type":""}},"src":"\t\t\tif (this.handler!==\"\"){\n\t\t\t\tthis.setHandler(this.handler);\n\t\t\t}\n\t\t\tif(this.isShowing() || this.preload){\n\t\t\t\tthis.loadContents(); \n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.show":{"_":{"meta":{"summary":"","src":"\t\t\t\tthis.refresh();\n\t\t\t}else{\n\t\t\t\tthis.loadContents();\n\t\t\t}\n\t\t\tdojo.widget.ContentPane.superclass.show.call(this);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.refresh":{"_":{"meta":{"summary":"","src":"\t\t\tthis.isLoaded=false;\n\t\t\tthis.loadContents();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["isLoaded","isLoaded","href","isLoaded","_ioBindObj","_ioBindObj","_ioBindObj","_ioBindObj","_ioBindObj","_ioBindObj","_ioBindObj","_ioBindObj","_ioBindObj","returnValue","_callOnUnLoad","returnValue","_callOnUnLoad","_styleNodes","_callOnUnLoad","href","handler","scriptScope","_styleNodes","_callOnUnLoad","href","handler","scriptScope","_styleNodes","_callOnUnLoad","href","handler","scriptScope","_styleNodes","_callOnUnLoad","href","handler","scriptScope","_styleNodes","_callOnUnLoad","href","handler","scriptScope","_styleNodes","_callOnUnLoad","href","handler","scriptScope","_styleNodes","_callOnUnLoad","href","handler","scriptScope","_styleNodes","_callOnUnLoad","href","handler","scriptScope"]}}},"dojo.widget.ContentPane.loadContents":{"_":{"meta":{"summary":"","src":"\t\t\tif ( this.isLoaded ){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.isLoaded=true;\n\t\t\tif ( dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis._runHandler();\n\t\t\t} else if ( this.href != \"\" ) {\n\t\t\t\tthis._downloadExternalContent(this.href, this.cacheContent);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.setUrl":{"_":{"meta":{"summary":" Reset the (external defined) content of this pane and replace with new url","parameters":{"url":{"type":"String or dojo.uri.Uri"}},"src":"\t\t\tthis.isLoaded = false;\n\t\t\tif ( this.preload || this.isShowing() ){\n\t\t\t\tthis.loadContents();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.abort":{"_":{"meta":{"summary":" abort download of content","src":"\t\t\tif(!bind || !bind.abort){ return; }\n\t\t\tbind.abort();\n\t\t\tdelete this._ioBindObj;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._downloadExternalContent":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.url":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.mimetype":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.load":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.error":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.responseText":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.status":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.statusText":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.responseHeaders":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""},"useCache":{"type":""}},"src":"\t\t\tthis.abort();\n\t\t\tthis._handleDefaults(\"Loading...\", \"onDownloadStart\");\n\t\t\tvar self = this;\n\t\t\tthis._ioBindObj = dojo.io.bind(\n\t\t\t\tthis._cacheSetting({\n\t\t\t\t\turl: url,\n\t\t\t\t\tmimetype: \"text\/html\",\n\t\t\t\t\tload: function(type, data, xhr){\n\t\t\t\t\t\tself.onDownloadEnd.call(self, url, data);\n\t\t\t\t\t},\n\t\t\t\t\terror: function(type, err, xhr){\n\t\t\t\t\t\t\/\/ XHR insnt a normal JS object, IE doesnt have prototype on XHR so we cant extend it or shallowCopy it\n\t\t\t\t\t\tvar e = {\n\t\t\t\t\t\t\tresponseText: xhr.responseText,\n\t\t\t\t\t\t\tstatus: xhr.status,\n\t\t\t\t\t\t\tstatusText: xhr.statusText,\n\t\t\t\t\t\t\tresponseHeaders: xhr.getAllResponseHeaders(),\n\t\t\t\t\t\t\t_text: \"Error loading '\" + url + \"' (\" + xhr.status + \" \"+  xhr.statusText + \")\"\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself._handleDefaults.call(self, e, \"onDownloadError\");\n\t\t\t\t\t\tself.onLoad();\n\t\t\t\t\t}\n\t\t\t\t}, useCache)\n\t\t\t);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._text":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""},"handler":{"type":""},"useAlert":{"type":""}},"src":"\t\t\tif(!handler){ handler = \"onContentError\"; }\n\n\t\t\tif(dojo.lang.isString(e)){ e = {_text: e}; }\n\n\t\t\tif(!e._text){ e._text = e.toString(); }\n\n\t\t\te.toString = function(){ return this._text; };\n\n\t\t\tif(typeof e.returnValue != \"boolean\"){\n\t\t\t\te.returnValue = true; \n\t\t\t}\n\t\t\tif(typeof e.preventDefault != \"function\"){\n\t\t\t\te.preventDefault = function(){ this.returnValue = false; };\n\t\t\t}\n\t\t\t\/\/ call our handler\n\t\t\tthis[handler](e);\n\t\t\tif(e.returnValue){\n\t\t\t\tif(useAlert){\n\t\t\t\t\talert(e.toString());\n\t\t\t\t}else{\n\t\t\t\t\t\/\/ makes sure scripts can clean up after themselves, before we setContent\n\t\t\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); } \n\t\t\t\t\tthis._callOnUnLoad = false; \/\/ makes sure we dont try to call onUnLoad again on this event,\n\t\t\t\t\t\t\t\t\t\t\t\t\/\/ ie onUnLoad before 'Loading...' but not before clearing 'Loading...'\n\t\t\t\t\tthis._setContent(e.toString());\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._cacheSetting":{"_":{"meta":{"summary":"","parameters":{"bindObj":{"type":""},"useCache":{"type":""}},"src":"\t\t\tbindObj.preventCache = ((typeof this.preventCache != \"null\") ? this.preventCache : !useCache);\n\t\t\tbindObj.useCache = (typeof this.useCache != \"null\") ? this.useCache : useCache;\n\t\t\treturn bindObj;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.onLoad":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis._runStack(\"_onLoadStack\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.onUnLoad":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis._runStack(\"_onUnLoadStack\");\n\t\t\tdelete this.scriptScope;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._runStack":{"_":{"meta":{"summary":"","parameters":{"stName":{"type":""}},"src":"\t\t\tvar st = this[stName]; var err = \"\";\n\t\t\tvar scope = this.scriptScope || window;\n\t\t\tfor(var i = 0;i < st.length; i++){\n\t\t\t\ttry{\n\t\t\t\t\tst[i].call(scope);\n\t\t\t\t}catch(e){ \n\t\t\t\t\terr += \"\\n\"+st[i]+\" failed: \"+e.description;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis[stName] = [];\n\t\n\t\t\tif(err.length){\n\t\t\t\tvar name = (stName== \"_onLoadStack\") ? \"addOnLoad\" : \"addOnUnLoad\";\n\t\t\t\tthis._handleDefaults(name+\" failure\\n \"+err, \"onExecError\", true);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.addOnLoad":{"_":{"meta":{"summary":" same as to dojo.addOnLoad but does not take \"function_name\" as a string","parameters":{"obj":{"type":"Function or Object ?"},"func":{"type":"Function"}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.addOnUnLoad":{"_":{"meta":{"summary":" same as to dojo.addUnOnLoad but does not take \"function_name\" as a string","parameters":{"obj":{"type":"Function or Object ?"},"func":{"type":"Function"}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._pushOnStack":{"_":{"meta":{"summary":"","parameters":{"stack":{"type":""},"obj":{"type":""},"func":{"type":""}},"src":"\t\t\tif(typeof func == 'undefined') {\n\t\t\t\tstack.push(obj);\n\t\t\t}else{\n\t\t\t\tstack.push(function(){ obj[func](); });\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.destroy":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.ContentPane.superclass.destroy.call(this);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.onExecError":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"                            \/*stub*\/    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.onContentError":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"                               \/*stub*\/    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.onDownloadError":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"                                \/*stub*\/    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.onDownloadStart":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"                                \/*stub*\/    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.onDownloadEnd":{"_":{"meta":{"summary":"","parameters":{"url":{"type":"String"},"data":{"type":"content"}},"src":"\t\t\tdata = this.splitAndFixPaths(data, url);\n\t\t\tthis.setContent(data);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._handleDefaults":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""},"handler":{"type":""},"useAlert":{"type":""}},"src":"\t\t\tif(!handler){ handler = \"onContentError\"; }\n\n\t\t\tif(dojo.lang.isString(e)){ e = {_text: e}; }\n\n\t\t\tif(!e._text){ e._text = e.toString(); }\n\n\t\t\te.toString = function(){ return this._text; };\n\n\t\t\tif(typeof e.returnValue != \"boolean\"){\n\t\t\t\te.returnValue = true; \n\t\t\t}\n\t\t\tif(typeof e.preventDefault != \"function\"){\n\t\t\t\te.preventDefault = function(){ this.returnValue = false; };\n\t\t\t}\n\t\t\t\/\/ call our handler\n\t\t\tthis[handler](e);\n\t\t\tif(e.returnValue){\n\t\t\t\tif(useAlert){\n\t\t\t\t\talert(e.toString());\n\t\t\t\t}else{\n\t\t\t\t\t\/\/ makes sure scripts can clean up after themselves, before we setContent\n\t\t\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); } \n\t\t\t\t\tthis._callOnUnLoad = false; \/\/ makes sure we dont try to call onUnLoad again on this event,\n\t\t\t\t\t\t\t\t\t\t\t\t\/\/ ie onUnLoad before 'Loading...' but not before clearing 'Loading...'\n\t\t\t\t\tthis._setContent(e.toString());\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.splitAndFixPaths":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.default":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.path":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._setContent":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.setContent":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane.setHandler":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._runHandler":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.ContentPane._executeScripts":{"_":{"meta":{"summary":" fixes all relative paths in (hopefully) all cases for example images, remote scripts, links etc. splits up content in different pieces, scripts, title, style, link and whats left becomes .xml init vars","parameters":{"s":{"type":"String"},"url":{"type":"dojo.uri.Uri?"}},"src":"\t\t\tvar match = [], requires = [], attr = [], styles = [];\n\t\t\tvar str = '', path = '', fix = '', tagFix = '', tag = '', origPath = '';\n\t\n\t\t\tif(!url) { url = \".\/\"; } \/\/ point to this page if not set\n\n\t\t\tif(s){ \/\/ make sure we dont run regexes on empty content\n\n\t\t\t\t\/************** <title> ***********\/\n\t\t\t\t\/\/ khtml is picky about dom faults, you can't attach a <style> or <title> node as child of body\n\t\t\t\t\/\/ must go into head, so we need to cut out those tags\n\t\t\t\tvar regex = \/<title[^>]*>([\\s\\S]*?)<\\\/title>\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\ttitles.push(match[1]);\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\t\t\n\t\t\t\t\/************** adjust paths *****************\/\n\t\t\t\tif(this.adjustPaths){\n\t\t\t\t\t\/\/ attributepaths one tag can have multiple paths example:\n\t\t\t\t\t\/\/ <input src=\"...\" style=\"url(..)\"\/> or <a style=\"url(..)\" href=\"..\">\n\t\t\t\t\t\/\/ strip out the tag and run fix on that.\n\t\t\t\t\t\/\/ this guarantees that we won't run replace on another tag's attribute + it was easier do\n\t\t\t\t\tvar regexFindTag = \/<[a-z][a-z0-9]*[^>]*\\s(?:(?:src|href|style)=[^>])+[^>]*>\/i;\n\t\t\t\t\tvar regexFindAttr = \/\\s(src|href|style)=(['\"]?)([\\w()\\[\\]\\\/.,\\\\'\"-:;#=&?\\s@]+?)\\2\/i;\n\t\t\t\t\t\/\/ these are the supported protocols, all other is considered relative\n\t\t\t\t\tvar regexProtocols = \/^(?:[#]|(?:(?:https?|ftps?|file|javascript|mailto|news):))\/;\n\t\t\n\t\t\t\t\twhile(tag = regexFindTag.exec(s)){\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substring((tag.index + tag[0].length), s.length);\n\t\t\t\t\t\ttag = tag[0];\n\t\t\t\n\t\t\t\t\t\t\/\/ loop through attributes\n\t\t\t\t\t\ttagFix = '';\n\t\t\t\t\t\twhile(attr = regexFindAttr.exec(tag)){\n\t\t\t\t\t\t\tpath = \"\"; origPath = attr[3];\n\t\t\t\t\t\t\tswitch(attr[1].toLowerCase()){\n\t\t\t\t\t\t\t\tcase \"src\":\/\/ falltrough\n\t\t\t\t\t\t\t\tcase \"href\":\n\t\t\t\t\t\t\t\t\tif(regexProtocols.exec(origPath)){\n\t\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tpath = (new dojo.uri.Uri(url, origPath).toString());\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"style\":\/\/ style\n\t\t\t\t\t\t\t\t\tpath = dojo.html.fixPathsInCssText(origPath, url);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tpath = origPath;\n\t\t\t\t\t\t\t}\n\t\t\t\n\t\t\t\t\t\t\tfix = \" \" + attr[1] + \"=\" + attr[2] + path + attr[2];\n\t\t\n\t\t\t\t\t\t\t\/\/ slices up tag before next attribute check\n\t\t\t\t\t\t\ttagFix += tag.substring(0, attr.index) + fix;\n\t\t\t\t\t\t\ttag = tag.substring((attr.index + attr[0].length), tag.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstr += tagFix + tag; \/\/dojo.debug(tagFix + tag);\n\t\t\t\t\t}\n\t\t\t\t\ts = str+s;\n\t\t\t\t}\n\n\t\t\t\t\/****************  cut out all <style> and <link rel=\"stylesheet\" href=\"..\"> **************\/\n\t\t\t\tregex = \/(?:<(style)[^>]*>([\\s\\S]*?)<\\\/style>|<link ([^>]*rel=['\"]?stylesheet['\"]?[^>]*)>)\/i;\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(match[1] && match[1].toLowerCase() == \"style\"){\n\t\t\t\t\t\tstyles.push(dojo.html.fixPathsInCssText(match[2],url));\n\t\t\t\t\t}else if(attr = match[3].match(\/href=(['\"]?)([^'\">]*)\\1\/i)){\n\t\t\t\t\t\tstyles.push({path: attr[2]});\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substring(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t};\n\n\t\t\t\t\/***************** cut out all <script> tags, push them into scripts array ***************\/\n\t\t\t\tvar regex = \/<script([^>]*)>([\\s\\S]*?)<\\\/script>\/i;\n\t\t\t\tvar regexSrc = \/src=(['\"]?)([^\"']*)\\1\/i;\n\t\t\t\tvar regexDojoJs = \/.*(\\bdojo\\b\\.js(?:\\.uncompressed\\.js)?)$\/;\n\t\t\t\tvar regexInvalid = \/(?:var )?\\bdjConfig\\b(?:[\\s]*=[\\s]*\\{[^}]+\\}|\\.[\\w]*[\\s]*=[\\s]*[^;\\n]*)?;?|dojo\\.hostenv\\.writeIncludes\\(\\s*\\);?\/g;\n\t\t\t\tvar regexRequires = \/dojo\\.(?:(?:require(?:After)?(?:If)?)|(?:widget\\.(?:manager\\.)?registerWidgetPackage)|(?:(?:hostenv\\.)?setModulePrefix)|defineNamespace)\\((['\"]).*?\\1\\)\\s*;?\/;\n\n\t\t\t\twhile(match = regex.exec(s)){\n\t\t\t\t\tif(this.executeScripts && match[1]){\n\t\t\t\t\t\tif(attr = regexSrc.exec(match[1])){\n\t\t\t\t\t\t\t\/\/ remove a dojo.js or dojo.js.uncompressed.js from remoteScripts\n\t\t\t\t\t\t\t\/\/ we declare all files named dojo.js as bad, regardless of path\n\t\t\t\t\t\t\tif(regexDojoJs.exec(attr[2])){\n\t\t\t\t\t\t\t\tdojo.debug(\"Security note! inhibit:\"+attr[2]+\" from  beeing loaded again.\");\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscripts.push({path: attr[2]});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(match[2]){\n\t\t\t\t\t\t\/\/ remove all invalid variables etc like djConfig and dojo.hostenv.writeIncludes()\n\t\t\t\t\t\tvar sc = match[2].replace(regexInvalid, \"\");\n\t\t\t\t\t\tif(!sc){ continue; }\n\t\t\n\t\t\t\t\t\t\/\/ cut out all dojo.require (...) calls, if we have execute \n\t\t\t\t\t\t\/\/ scripts false widgets dont get there require calls\n\t\t\t\t\t\t\/\/ takes out possible widgetpackage registration as well\n\t\t\t\t\t\twhile(tmp = regexRequires.exec(sc)){\n\t\t\t\t\t\t\trequires.push(tmp[0]);\n\t\t\t\t\t\t\tsc = sc.substring(0, tmp.index) + sc.substr(tmp.index + tmp[0].length);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(this.executeScripts){\n\t\t\t\t\t\t\tscripts.push(sc);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ts = s.substr(0, match.index) + s.substr(match.index + match[0].length);\n\t\t\t\t}\n\n\t\t\t\t\/********* extract content *********\/\n\t\t\t\tif(this.extractContent){\n\t\t\t\t\tmatch = s.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\t\t\tif(match) { s = match[1]; }\n\t\t\t\t}\n\t\n\t\t\t\t\/******** scan for scriptScope in html eventHandlers and replace with link to this pane *********\/\n\t\t\t\tif(this.executeScripts){\n\t\t\t\t\tvar regex = \/(<[a-zA-Z][a-zA-Z0-9]*\\s[^>]*\\S=(['\"])[^>]*[^\\.\\]])scriptScope([^>]*>)\/;\n\t\t\t\t\tstr = \"\";\n\t\t\t\t\twhile(tag = regex.exec(s)){\n\t\t\t\t\t\ttmp = ((tag[2]==\"'\") ? '\"': \"'\");\n\t\t\t\t\t\tstr += s.substring(0, tag.index);\n\t\t\t\t\t\ts = s.substr(tag.index).replace(regex, \"$1dojo.widget.byId(\"+ tmp + this.widgetId + tmp + \").scriptScope$3\");\n\t\t\t\t\t}\n\t\t\t\t\ts = str + s;\n\t\t\t\t}\n\t \t\t}\n\n\t\t\treturn {\"xml\": \t\ts, \/\/ Object\n\t\t\t\t\"styles\":\t\tstyles,\n\t\t\t\t\"titles\": \t\ttitles,\n\t\t\t\t\"requires\": \trequires,\n\t\t\t\t\"scripts\": \t\tscripts,\n\t\t\t\t\"url\": \t\t\turl};\n\t\t},\n\t\n\t\t\n\t\t_setContent: function(cont){\n\t\t\tthis.destroyChildren();\n\t\n\t\t\t\/\/ remove old stylenodes from HEAD\n\t\t\tfor(var i = 0; i < this._styleNodes.length; i++){\n\t\t\t\tif(this._styleNodes[i] && this._styleNodes[i].parentNode){\n\t\t\t\t\tthis._styleNodes[i].parentNode.removeChild(this._styleNodes[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._styleNodes = [];\n\t\n\t\t\tvar node = this.containerNode || this.domNode;\n\t\t\twhile(node.firstChild){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.event.browser.clean(node.firstChild);\n\t\t\t\t}catch(e){}\n\t\t\t\tnode.removeChild(node.firstChild);\n\t\t\t}\n\t\t\ttry{\n\t\t\t\tif(typeof cont != \"string\"){\n\t\t\t\t\tnode.innerHTML = \"\";\n\t\t\t\t\tnode.appendChild(cont);\n\t\t\t\t}else{\n\t\t\t\t\tnode.innerHTML = cont;\n\t\t\t\t}\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Could'nt load content:\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onContentError\");\n\t\t\t}\n\t\t},\n\t\n\t\tsetContent: function(\/*String or DOMNode*\/ data){\n\t\t\t\/\/ summary:\n\t\t\t\/\/ \tDestroys old content and sets new content, and possibly initialize any widgets within 'data'\n\t\t\tthis.abort();\n\t\t\tif(this._callOnUnLoad){ this.onUnLoad(); }\/\/ this tells a remote script clean up after itself\n\t\t\tthis._callOnUnLoad = true;\n\t\n\t\t\tif(!data || dojo.html.isNode(data)){\n\t\t\t\t\/\/ if we do a clean using setContent(\"\"); or setContent(#node) bypass all parsing, extractContent etc\n\t\t\t\tthis._setContent(data);\n\t\t\t\tthis.onResized();\n\t\t\t\tthis.onLoad();\n\t\t\t}else{\n\t\t\t\t\/\/ need to run splitAndFixPaths? ie. manually setting content\n\t\t\t\t\/\/ adjustPaths is taken care of inside splitAndFixPaths\n\t\t\t\tif(!data.xml){ \n\t\t\t\t\tthis.href = \"\"; \/\/ so we can refresh safely\n\t\t\t\t\tdata = this.splitAndFixPaths(data); \n\t\t\t\t}\n\n\t\t\t\tthis._setContent(data.xml);\n\n\t\t\t\t\/\/ insert styles from content (in same order they came in)\n\t\t\t\tfor(var i = 0; i < data.styles.length; i++){\n\t\t\t\t\tif(data.styles[i].path){\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssFile(data.styles[i].path));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._styleNodes.push(dojo.html.insertCssText(data.styles[i]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif(this.parseContent){\n\t\t\t\t\tfor(var i = 0; i < data.requires.length; i++){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\teval(data.requires[i]);\n\t\t\t\t\t\t} catch(e){\n\t\t\t\t\t\t\te._text = \"Error in packageloading calls, \"+e.description;\n\t\t\t\t\t\t\tthis._handleDefaults(e, \"onContentError\", true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ need to allow async load, Xdomain uses it\n\t\t\t\t\/\/ is inline function because we cant send args to dojo.addOnLoad\n\t\t\t\tvar _self = this;\n\t\t\t\tfunction asyncParse(){\n\t\t\t\t\tif(_self.executeScripts){\n\t\t\t\t\t\t_self._executeScripts(data.scripts);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(_self.parseContent){\n\t\t\t\t\t\tvar node = _self.containerNode || _self.domNode;\n\t\t\t\t\t\tvar parser = new dojo.xml.Parse();\n\t\t\t\t\t\tvar frag = parser.parseElement(node, null, true);\n\t\t\t\t\t\t\/\/ createSubComponents not createComponents because frag has already been created\n\t\t\t\t\t\tdojo.widget.getParser().createSubComponents(frag, _self);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t_self.onResized();\n\t\t\t\t\t_self.onLoad();\n\t\t\t\t}\n\t\t\t\t\/\/ try as long as possible to make setContent sync call\n\t\t\t\tif(dojo.hostenv.isXDomain && data.requires.length){\n\t\t\t\t\tdojo.addOnLoad(asyncParse);\n\t\t\t\t}else{\n\t\t\t\t\tasyncParse();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\n\t\t\/\/ Generate pane content from given java function\n\t\tsetHandler: function(handler) {\n\t\t\tvar fcn = dojo.lang.isFunction(handler) ? handler : window[handler];\n\t\t\tif(!dojo.lang.isFunction(fcn)) {\n\t\t\t\t\/\/ FIXME: needs testing! somebody with java knowledge needs to try this\n\t\t\t\tthis._handleDefaults(\"Unable to set handler, '\" + handler + \"' not a function.\", \"onExecError\", true);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handler = function() {\n\t\t\t\treturn fcn.apply(this, arguments);\n\t\t\t}\n\t\t},\n\t\n\t\t_runHandler: function() {\n\t\t\tif(dojo.lang.isFunction(this.handler)) {\n\t\t\t\tthis.handler(this, this.domNode);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\n\t\t_executeScripts: function(scripts) {\n\t\t\t\/\/ loop through the scripts in the order they came in\n\t\t\tvar self = this;\n\t\t\tvar tmp = \"\", code = \"\";\n\t\t\tfor(var i = 0; i < scripts.length; i++){\n\t\t\t\tif(scripts[i].path){ \/\/ remotescript\n\t\t\t\t\tdojo.io.bind(this._cacheSetting({\n\t\t\t\t\t\t\"url\": \t\tscripts[i].path,\n\t\t\t\t\t\t\"load\":     function(type, scriptStr){\n\t\t\t\t\t\t\t\tdojo.lang.hitch(self, tmp = scriptStr);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"error\":    function(type, error){\n\t\t\t\t\t\t\t\terror._text = type + \" downloading remote script\";\n\t\t\t\t\t\t\t\tself._handleDefaults.call(self, error, \"onExecError\", true);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"mimetype\": \"text\/plain\",\n\t\t\t\t\t\t\"sync\":     true\n\t\t\t\t\t}, this.cacheContent));\n\t\t\t\t\tcode += tmp;\n\t\t\t\t}else{\n\t\t\t\t\tcode += scripts[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\ttry{\n\t\t\t\t\/\/ initialize a new anonymous container for our script, dont make it part of this widgets scope chain\n\t\t\t\t\/\/ instead send in a variable that points to this widget, usefull to connect events to onLoad, onUnLoad etc..\n\t\t\t\tdelete this.scriptScope;\n\t\t\t\tthis.scriptScope = new (new Function('_container_', code+'; return this;'))(self);\n\t\t\t}catch(e){\n\t\t\t\te._text = \"Error running scripts from content:\\n\"+e.description;\n\t\t\t\tthis._handleDefaults(e, \"onExecError\", true);\n\t\t\t}","returns":"Object","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.DatePicker":{"meta":{"requires":{"common":["dojo.date","dojo.widget.*","dojo.widget.HtmlWidget","dojo.event.*","dojo.dom","dojo.html.style","dojo.date","dojo.i18n.calendar.GregorianNames"]},"methods":{"dojo.widget.DatePicker":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"lang":"","classNames":"","previous":"","current":"","next":"","selectedDate":"","templatePath":"","templateCssPath":""}}}},"dojo.widget.DatePicker.fillInTemplate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.DatePicker.call(this);\n\t\t\tthis.initData();\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.initData":{"_":{"meta":{"summary":"","src":"\t\t\tthis.today = new Date();\n\t\t\tif(this.storedDate && (this.storedDate.split(\"-\").length > 2)) {\n\t\t\t\tthis.date = dojo.widget.DatePicker.util.fromRfcDate(this.storedDate);\n\t\t\t} else {\n\t\t\t\tthis.date = this.today;\n\t\t\t}\n\t\t\t\/\/ calendar math is simplified if time is set to 0\n\t\t\tthis.today.setHours(0);\n\t\t\tthis.date.setHours(0);\n\t\t\tvar month = this.date.getMonth();\n\t\t\tvar tempSaturday = dojo.widget.DatePicker.util.initFirstSaturday(this.date.getMonth().toString(), this.date.getFullYear());\n\t\t\tthis.firstSaturday.year = tempSaturday.year;\n\t\t\tthis.firstSaturday.month = tempSaturday.month;\n\t\t\tthis.firstSaturday.date = tempSaturday.date;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["today","date","firstSaturday.year","firstSaturday.month","firstSaturday.date","storedDate","selectedIsUsed","currentIsUsed","firstSaturday.date","firstSaturday.month","firstSaturday.year","firstSaturday.date","firstSaturday.month","firstSaturday.year","firstSaturday.date","firstSaturday.month","firstSaturday.year","firstSaturday.year","firstSaturday.month","firstSaturday.date","firstSaturday.year","firstSaturday.month","firstSaturday.date","firstSaturday.year","firstSaturday.month","firstSaturday.date","firstSaturday.year","firstSaturday.month","firstSaturday.date","firstSaturday.year","firstSaturday.month","firstSaturday.date","firstSaturday.year","firstSaturday.month","firstSaturday.date","monthLabelNode.innerHTML","previousYearLabelNode.innerHTML","currentYearLabelNode.innerHTML","nextYearLabelNode.innerHTML","selectedIsUsed","currentIsUsed","selectedIsUsed","todayIsUsed","date"]}}},"dojo.widget.DatePicker.setDate":{"_":{"meta":{"summary":"","parameters":{"rfcDate":{"type":""}},"src":"\t\t\tthis.storedDate = rfcDate;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.initUI":{"_":{"meta":{"summary":"","src":"\t\t\tvar dayLabels = dojo.i18n.calendar.GregorianNames.getNames('days', 'narrow', 'standAlone', this.lang);\n\t\t\tvar dayLabelNodes = this.dayLabelsRow.getElementsByTagName(\"td\");\n\t\t\tfor(var i=0; i<7; i++) {\n\t\t\t\tdayLabelNodes.item(i).innerHTML = dayLabels[i];\n\t\t\t}\n\n\t\t\tthis.selectedIsUsed = false;\n\t\t\tthis.currentIsUsed = false;\n\t\t\tvar currentClassName = \"\";\n\t\t\tvar previousDate = new Date();\n\t\t\tvar calendarNodes = this.calendarDatesContainerNode.getElementsByTagName(\"td\");\n\t\t\tvar currentCalendarNode;\n\t\t\t\/\/ set hours of date such that there is no chance of rounding error due to \n\t\t\t\/\/ time change in local time zones\n\t\t\tpreviousDate.setHours(8);\n\t\t\tvar nextDate = new Date(this.firstSaturday.year, this.firstSaturday.month, this.firstSaturday.date, 8);\n\t\t\t\n\t\t\tif(this.firstSaturday.date < 7) {\n\t\t\t\t\/\/ this means there are days to show from the previous month\n\t\t\t\tvar dayInWeek = 6;\n\t\t\t\tfor (var i=this.firstSaturday.date; i>0; i--) {\n\t\t\t\t\tcurrentCalendarNode = calendarNodes.item(dayInWeek);\n\t\t\t\t\tcurrentCalendarNode.innerHTML = nextDate.getDate();\n\t\t\t\t\tdojo.html.setClass(currentCalendarNode, this.getDateClassName(nextDate, \"current\"));\n\t\t\t\t\tdayInWeek--;\n\t\t\t\t\tpreviousDate = nextDate;\n\t\t\t\t\tnextDate = this.incrementDate(nextDate, false);\n\t\t\t\t}\n\t\t\t\tfor(var i=dayInWeek; i>-1; i--) {\n\t\t\t\t\tcurrentCalendarNode = calendarNodes.item(i);\n\t\t\t\t\tcurrentCalendarNode.innerHTML = nextDate.getDate();\n\t\t\t\t\tdojo.html.setClass(currentCalendarNode, this.getDateClassName(nextDate, \"previous\"));\n\t\t\t\t\tpreviousDate = nextDate;\n\t\t\t\t\tnextDate = this.incrementDate(nextDate, false);\t\t\t\t\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnextDate.setDate(this.firstSaturday.date-6);\n\t\t\t\tfor(var i=0; i<7; i++) {\n\t\t\t\t\tcurrentCalendarNode = calendarNodes.item(i);\n\t\t\t\t\tcurrentCalendarNode.innerHTML = nextDate.getDate();\n\t\t\t\t\tdojo.html.setClass(currentCalendarNode, this.getDateClassName(nextDate, \"current\"));\n\t\t\t\t\tpreviousDate = nextDate;\n\t\t\t\t\tnextDate = this.incrementDate(nextDate, true);\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\tpreviousDate.setDate(this.firstSaturday.date);\n\t\t\tpreviousDate.setMonth(this.firstSaturday.month);\n\t\t\tpreviousDate.setFullYear(this.firstSaturday.year);\n\t\t\tnextDate = this.incrementDate(previousDate, true);\n\t\t\tvar count = 7;\n\t\t\tcurrentCalendarNode = calendarNodes.item(count);\n\t\t\twhile((nextDate.getMonth() == previousDate.getMonth()) && (count<42)) {\n\t\t\t\tcurrentCalendarNode.innerHTML = nextDate.getDate();\n\t\t\t\tdojo.html.setClass(currentCalendarNode, this.getDateClassName(nextDate, \"current\"));\n\t\t\t\tcurrentCalendarNode = calendarNodes.item(++count);\n\t\t\t\tpreviousDate = nextDate;\n\t\t\t\tnextDate = this.incrementDate(nextDate, true);\n\t\t\t}\n\t\t\t\n\t\t\twhile(count < 42) {\n\t\t\t\tcurrentCalendarNode.innerHTML = nextDate.getDate();\n\t\t\t\tdojo.html.setClass(currentCalendarNode, this.getDateClassName(nextDate, \"next\"));\n\t\t\t\tcurrentCalendarNode = calendarNodes.item(++count);\n\t\t\t\tpreviousDate = nextDate;\n\t\t\t\tnextDate = this.incrementDate(nextDate, true);\n\t\t\t}\n\t\t\tthis.setMonthLabel(this.firstSaturday.month);\n\t\t\tthis.setYearLabels(this.firstSaturday.year);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.incrementDate":{"_":{"meta":{"summary":"","parameters":{"date":{"type":""},"bool":{"type":""}},"src":"\t\t\tvar increment = 1000 * 60 * 60 * 24;\n\t\t\ttime = (bool) ? (time + increment) : (time - increment);\n\t\t\tvar returnDate = new Date();\n\t\t\treturnDate.setTime(time);\n\t\t\treturn returnDate;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.incrementWeek":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar date = this.firstSaturday.date;\n\t\t\tvar month = this.firstSaturday.month;\n\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.target) {\n\t\t\t\tcase this.increaseWeekNode.getElementsByTagName(\"img\").item(0): \n\t\t\t\tcase this.increaseWeekNode:\n\t\t\t\t\tdate = date + 7;\n\t\t\t\t\tif (date>this._daysIn(month,year)) {\n\t\t\t\t\t\tdate = date - this._daysIn(month,year);\n\t\t\t\t\t\tif (month < 11) {\n\t\t\t\t\t\t\tmonth++;\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmonth=0;\n\t\t\t\t\t\t\tyear++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseWeekNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\tcase this.decreaseWeekNode:\n\t\t\t\t\tif (date > 7) {\n\t\t\t\t\t\tdate = date - 7;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar diff = 7 - date;\n\t\t\t\t\t\tif (month > 0) {\n\t\t\t\t\t\t\tmonth--;\n\t\t\t\t\t\t\tdate = this._daysIn(month,year) - diff;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tyear--;\n\t\t\t\t\t\t\tmonth=11;\n\t\t\t\t\t\t\tdate = 31 - diff;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\n\t\t\t}\n\t\n\t\t\tthis.firstSaturday.date=date;\n\t\t\tthis.firstSaturday.month=month;\n\t\t\tthis.firstSaturday.year=year;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.this.increaseWeekNode":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar date = this.firstSaturday.date;\n\t\t\tvar month = this.firstSaturday.month;\n\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.target) {\n\t\t\t\tcase this.increaseWeekNode.getElementsByTagName(\"img\").item(0): \n\t\t\t\tcase this.increaseWeekNode:\n\t\t\t\t\tdate = date + 7;\n\t\t\t\t\tif (date>this._daysIn(month,year)) {\n\t\t\t\t\t\tdate = date - this._daysIn(month,year);\n\t\t\t\t\t\tif (month < 11) {\n\t\t\t\t\t\t\tmonth++;\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmonth=0;\n\t\t\t\t\t\t\tyear++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseWeekNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\tcase this.decreaseWeekNode:\n\t\t\t\t\tif (date > 7) {\n\t\t\t\t\t\tdate = date - 7;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar diff = 7 - date;\n\t\t\t\t\t\tif (month > 0) {\n\t\t\t\t\t\t\tmonth--;\n\t\t\t\t\t\t\tdate = this._daysIn(month,year) - diff;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tyear--;\n\t\t\t\t\t\t\tmonth=11;\n\t\t\t\t\t\t\tdate = 31 - diff;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\n\t\t\t}\n\t\n\t\t\tthis.firstSaturday.date=date;\n\t\t\tthis.firstSaturday.month=month;\n\t\t\tthis.firstSaturday.year=year;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.this.decreaseWeekNode":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar date = this.firstSaturday.date;\n\t\t\tvar month = this.firstSaturday.month;\n\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.target) {\n\t\t\t\tcase this.increaseWeekNode.getElementsByTagName(\"img\").item(0): \n\t\t\t\tcase this.increaseWeekNode:\n\t\t\t\t\tdate = date + 7;\n\t\t\t\t\tif (date>this._daysIn(month,year)) {\n\t\t\t\t\t\tdate = date - this._daysIn(month,year);\n\t\t\t\t\t\tif (month < 11) {\n\t\t\t\t\t\t\tmonth++;\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmonth=0;\n\t\t\t\t\t\t\tyear++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseWeekNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\tcase this.decreaseWeekNode:\n\t\t\t\t\tif (date > 7) {\n\t\t\t\t\t\tdate = date - 7;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar diff = 7 - date;\n\t\t\t\t\t\tif (month > 0) {\n\t\t\t\t\t\t\tmonth--;\n\t\t\t\t\t\t\tdate = this._daysIn(month,year) - diff;\n\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\tyear--;\n\t\t\t\t\t\t\tmonth=11;\n\t\t\t\t\t\t\tdate = 31 - diff;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\n\t\t\t}\n\t\n\t\t\tthis.firstSaturday.date=date;\n\t\t\tthis.firstSaturday.month=month;\n\t\t\tthis.firstSaturday.year=year;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.incrementMonth":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar month = this.firstSaturday.month;\n\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.currentTarget) {\n\t\t\t\tcase this.increaseMonthNode:\n\t\t\t\t\tif(month < 11) {\n\t\t\t\t\t\tmonth++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\tyear++;\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseMonthNode:\n\t\t\t\t\tif(month > 0) {\n\t\t\t\t\t\tmonth--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\tyear--;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.increaseMonthNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\t\tif(month < 11) {\n\t\t\t\t\t\tmonth++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\tyear++;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseMonthNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\t\tif(month > 0) {\n\t\t\t\t\t\tmonth--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\tyear--;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar tempSaturday = dojo.widget.DatePicker.util.initFirstSaturday(month.toString(), year);\n\t\t\tthis.firstSaturday.year = tempSaturday.year;\n\t\t\tthis.firstSaturday.month = tempSaturday.month;\n\t\t\tthis.firstSaturday.date = tempSaturday.date;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.this.increaseMonthNode":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar month = this.firstSaturday.month;\n\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.currentTarget) {\n\t\t\t\tcase this.increaseMonthNode:\n\t\t\t\t\tif(month < 11) {\n\t\t\t\t\t\tmonth++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\tyear++;\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseMonthNode:\n\t\t\t\t\tif(month > 0) {\n\t\t\t\t\t\tmonth--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\tyear--;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.increaseMonthNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\t\tif(month < 11) {\n\t\t\t\t\t\tmonth++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\tyear++;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseMonthNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\t\tif(month > 0) {\n\t\t\t\t\t\tmonth--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\tyear--;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar tempSaturday = dojo.widget.DatePicker.util.initFirstSaturday(month.toString(), year);\n\t\t\tthis.firstSaturday.year = tempSaturday.year;\n\t\t\tthis.firstSaturday.month = tempSaturday.month;\n\t\t\tthis.firstSaturday.date = tempSaturday.date;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.this.decreaseMonthNode":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar month = this.firstSaturday.month;\n\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.currentTarget) {\n\t\t\t\tcase this.increaseMonthNode:\n\t\t\t\t\tif(month < 11) {\n\t\t\t\t\t\tmonth++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\tyear++;\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseMonthNode:\n\t\t\t\t\tif(month > 0) {\n\t\t\t\t\t\tmonth--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\tyear--;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.increaseMonthNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\t\tif(month < 11) {\n\t\t\t\t\t\tmonth++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 0;\n\t\t\t\t\t\tyear++;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.decreaseMonthNode.getElementsByTagName(\"img\").item(0):\n\t\t\t\t\tif(month > 0) {\n\t\t\t\t\t\tmonth--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmonth = 11;\n\t\t\t\t\t\tyear--;\n\t\t\t\t\t\tthis.setYearLabels(year);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar tempSaturday = dojo.widget.DatePicker.util.initFirstSaturday(month.toString(), year);\n\t\t\tthis.firstSaturday.year = tempSaturday.year;\n\t\t\tthis.firstSaturday.month = tempSaturday.month;\n\t\t\tthis.firstSaturday.date = tempSaturday.date;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.incrementYear":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.target) {\n\t\t\t\tcase this.nextYearLabelNode:\n\t\t\t\t\tyear++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.previousYearLabelNode:\n\t\t\t\t\tyear--;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar tempSaturday = dojo.widget.DatePicker.util.initFirstSaturday(this.firstSaturday.month.toString(), year);\n\t\t\tthis.firstSaturday.year = tempSaturday.year;\n\t\t\tthis.firstSaturday.month = tempSaturday.month;\n\t\t\tthis.firstSaturday.date = tempSaturday.date;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.this.nextYearLabelNode":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.target) {\n\t\t\t\tcase this.nextYearLabelNode:\n\t\t\t\t\tyear++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.previousYearLabelNode:\n\t\t\t\t\tyear--;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar tempSaturday = dojo.widget.DatePicker.util.initFirstSaturday(this.firstSaturday.month.toString(), year);\n\t\t\tthis.firstSaturday.year = tempSaturday.year;\n\t\t\tthis.firstSaturday.month = tempSaturday.month;\n\t\t\tthis.firstSaturday.date = tempSaturday.date;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.this.previousYearLabelNode":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar year = this.firstSaturday.year;\n\t\t\tswitch(evt.target) {\n\t\t\t\tcase this.nextYearLabelNode:\n\t\t\t\t\tyear++;\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.previousYearLabelNode:\n\t\t\t\t\tyear--;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar tempSaturday = dojo.widget.DatePicker.util.initFirstSaturday(this.firstSaturday.month.toString(), year);\n\t\t\tthis.firstSaturday.year = tempSaturday.year;\n\t\t\tthis.firstSaturday.month = tempSaturday.month;\n\t\t\tthis.firstSaturday.date = tempSaturday.date;\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker._daysIn":{"_":{"meta":{"summary":"","parameters":{"month":{"type":""},"ear":{"type":""}},"src":"\t\t\tvar daysIn = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; \n\t\t\t\n\t\t\tif (month==1) {\n\t\t\t\treturn (year%400 == 0) ? 29: (year%100 == 0) ? 28: (year%4 == 0) ? 29: 28;\n\t\t\t} else {\n\t\t\t\treturn daysIn[month];\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.29":{"_":{"meta":{"summary":"","parameters":{"month":{"type":""},"ear":{"type":""}},"src":"\t\t\tvar daysIn = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; \n\t\t\t\n\t\t\tif (month==1) {\n\t\t\t\treturn (year%400 == 0) ? 29: (year%100 == 0) ? 28: (year%4 == 0) ? 29: 28;\n\t\t\t} else {\n\t\t\t\treturn daysIn[month];\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.onIncrementDate":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tdojo.unimplemented('dojo.widget.DatePicker.onIncrementDate');","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.onIncrementWeek":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tevt.stopPropagation();\n\t\t\tthis.incrementWeek(evt);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.onIncrementMonth":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tevt.stopPropagation();\n\t\t\tthis.incrementMonth(evt);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.onIncrementYear":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tevt.stopPropagation();\n\t\t\tthis.incrementYear(evt);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.setMonthLabel":{"_":{"meta":{"summary":"","parameters":{"monthIndex":{"type":""}},"src":"\t\t\tthis.monthLabelNode.innerHTML = dojo.i18n.calendar.GregorianNames.getNames('months', 'wide', 'standAlone', this.lang)[monthIndex];","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.setYearLabels":{"_":{"meta":{"summary":"","parameters":{"year":{"type":""}},"src":"\t\t\tthis.previousYearLabelNode.innerHTML = year - 1;\n\t\t\tthis.currentYearLabelNode.innerHTML = year;\n\t\t\tthis.nextYearLabelNode.innerHTML = year + 1;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.getDateClassName":{"_":{"meta":{"summary":"","parameters":{"date":{"type":""},"monthState":{"type":""}},"src":"\t\t\tvar currentClassName = this.classNames[monthState];\n\t\t\tif ((!this.selectedIsUsed) && (date.getDate() == this.date.getDate()) && (date.getMonth() == this.date.getMonth()) && (date.getFullYear() == this.date.getFullYear())) {\n\t\t\t\tcurrentClassName = this.classNames.selectedDate + \" \" + currentClassName;\n\t\t\t\tthis.selectedIsUsed = 1;\n\t\t\t}\n\t\t\tif((!this.currentIsUsed) && (date.getDate() == this.today.getDate()) && (date.getMonth() == this.today.getMonth()) && (date.getFullYear() == this.today.getFullYear())) {\n\t\t\t\tcurrentClassName = currentClassName + \" \"  + this.classNames.currentDate;\n\t\t\t\tthis.currentIsUsed = 1;\n\t\t\t}\n\t\t\treturn currentClassName;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.onClick":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tdojo.event.browser.stopEvent(evt)","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.onSetDate":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(evt.target.nodeType == dojo.dom.ELEMENT_NODE) {\n\t\t\t\tvar eventTarget = evt.target;\n\t\t\t} else {\n\t\t\t\tvar eventTarget = evt.target.parentNode;\n\t\t\t}\n\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\tthis.selectedIsUsed = 0;\n\t\t\tthis.todayIsUsed = 0;\n\t\t\tvar month = this.firstSaturday.month;\n\t\t\tvar year = this.firstSaturday.year;\n\t\t\tif (dojo.html.hasClass(eventTarget, this.classNames[\"next\"])) {\n\t\t\t\tmonth = ++month % 12;\n\t\t\t\t\/\/ if month is now == 0, add a year\n\t\t\t\tyear = (month==0) ? ++year : year;\n\t\t\t} else if (dojo.html.hasClass(eventTarget, this.classNames[\"previous\"])) {\n\t\t\t\tmonth = --month % 12;\n\t\t\t\t\/\/ if month is now == 0, add a year\n\t\t\t\tyear = (month==11) ? --year : year;\n\t\t\t}\n\t\t\tthis.date = new Date(year, month, eventTarget.innerHTML);\n\t\t\tthis.setDate(dojo.widget.DatePicker.util.toRfcDate(this.date));\n\t\t\tthis.initUI();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DatePicker.util.toRfcDate":{"_":{"meta":{"summary":"","parameters":{"jsDate":{"type":""}},"src":"\t\tif(!jsDate) {\n\t\t\tvar jsDate = new Date();\n\t\t}\n\t\t\/\/ because this is a date picker and not a time picker, we don't return a time\n\t\treturn dojo.date.format(jsDate, \"%Y-%m-%d\");"}}},"dojo.widget.DatePicker.util.fromRfcDate":{"_":{"meta":{"summary":"","parameters":{"rfcDate":{"type":""}},"src":"\t\t\trfcDate = rfcDate.replace(\"Tany\",\"\");\n\t\t}\n\t\tvar jsDate = new Date();\n\t\tdojo.date.setIso8601(jsDate, rfcDate);\n\t\treturn jsDate;"}}},"dojo.widget.DatePicker.util.initFirstSaturday":{"_":{"meta":{"summary":"","parameters":{"month":{"type":""},"year":{"type":""}},"src":"\t\tif(!month) {\n\t\t\tmonth = this.date.getMonth();\n\t\t}\n\t\tif(!year) {\n\t\t\tyear = this.date.getFullYear();\n\t\t}\n\t\tvar firstOfMonth = new Date(year, month, 1);\n\t\treturn {year: year, month: month, date: 7 - firstOfMonth.getDay()};"}}}}}},"dojo.widget.DebugConsole":{"meta":{"requires":{"common":["dojo.widget.Widget","dojo.widget.*","dojo.widget.FloatingPane"]},"methods":{"dojo.widget.DebugConsole":{"_":{"meta":{"summary":"","inherits":["dojo.widget.FloatingPane"],"this_inherits":["dojo.widget.FloatingPane"]}}}}}},"dojo.widget.Dialog":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.ContentPane","dojo.event.*","dojo.graphics.color","dojo.html.layout","dojo.html.display","dojo.html.iframe"]},"methods":{"dojo.widget.Dialog":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ContentPane"],"this_inherits":["dojo.widget.ContentPane"],"protovariables":{"templatePath":"","isContainer":"","_scrollConnected":"","focusElement":"","bg":"","bgColor":"","bgOpacity":"","followScroll":"","_fromTrap":"","anim":"","blockDuration":"","lifetime":""}}}},"dojo.widget.Dialog.trapTabs":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif(e.target == this.tabStart) {\n\t\t\t\tif(this._fromTrap) {\n\t\t\t\t\tthis._fromTrap = false;\n\t\t\t\t} else {\n\t\t\t\t\tthis._fromTrap = true;\n\t\t\t\t\tthis.tabEnd.focus();\n\t\t\t\t}\n\t\t\t} else if(e.target == this.tabEnd) {\n\t\t\t\tif(this._fromTrap) {\n\t\t\t\t\tthis._fromTrap = false;\n\t\t\t\t} else {\n\t\t\t\t\tthis._fromTrap = true;\n\t\t\t\t\tthis.tabStart.focus();\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.ContentPane":{"_":{"meta":{"this_variables":["_fromTrap","bg","bg.className","bgIframe","bg.style.backgroundColor","bgColor","bgOpacity","bg.style.width","bg.style.height","bg.style.display","_scrollConnected","timeRemaining","timerNode.innerHTML","closeNode.style.visibility","closeNode.style.display","timer","bg.style.display","bg.style.width","_scrollConnected","timerNode","closeNode","closeNode.style.visibility","timerNode.innerHTML","domNode.style.display","domNode.style.display"]}}},"dojo.widget.Dialog.clearTrap":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tvar _this = this;\n\t\t\tsetTimeout(function() {\n\t\t\t\t_this._fromTrap = false;\n\t\t\t}, 100);","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.postCreate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""},"parentComp":{"type":""}},"src":"\t\t\twith(this.domNode.style) {\n\t\t\t\tposition = \"absolute\";\n\t\t\t\tzIndex = 999;\n\t\t\t\tdisplay = \"none\";\n\t\t\t\toverflow = \"visible\";\n\t\t\t}\n\t\t\tvar b = dojo.body();\n\t\t\tb.appendChild(this.domNode);\n\n\t\t\tthis.bg = document.createElement(\"div\");\n\t\t\tthis.bg.className = \"dialogUnderlay\";\n\t\t\twith(this.bg.style) {\n\t\t\t\tposition = \"absolute\";\n\t\t\t\tleft = top = \"0px\";\n\t\t\t\tzIndex = 998;\n\t\t\t\tdisplay = \"none\";\n\t\t\t}\n\t\t\tthis.setBackgroundColor(this.bgColor);\n\t\t\tb.appendChild(this.bg);\n\n\t\t\tthis.bgIframe = new dojo.html.BackgroundIframe(this.bg);","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.setBackgroundColor":{"_":{"meta":{"summary":"","parameters":{"color":{"type":""}},"src":"\t\t\tif(arguments.length >= 3) {\n\t\t\t\tcolor = new dojo.graphics.color.Color(arguments[0], arguments[1], arguments[2]);\n\t\t\t} else {\n\t\t\t\tcolor = new dojo.graphics.color.Color(color);\n\t\t\t}\n\t\t\tthis.bg.style.backgroundColor = color.toString();\n\t\t\treturn this.bgColor = color;","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.setBackgroundOpacity":{"_":{"meta":{"summary":"","parameters":{"op":{"type":""}},"src":"\t\t\tif(arguments.length == 0) { op = this.bgOpacity; }\n\t\t\tdojo.html.setOpacity(this.bg, op);\n\t\t\ttry {\n\t\t\t\tthis.bgOpacity = dojo.html.getOpacity(this.bg);\n\t\t\t} catch (e) {\n\t\t\t\tthis.bgOpacity = op;\n\t\t\t}\n\t\t\treturn this.bgOpacity;","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.sizeBackground":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.bgOpacity > 0) {\n\t\t\t\tvar viewport = dojo.html.getViewport();\n\t\t\t\tvar h = Math.max(\n\t\t\t\t\tdojo.doc().documentElement.scrollHeight || dojo.body().scrollHeight,\n\t\t\t\t\tviewport.height);\n\t\t\t\tvar w = viewport.width;\n\t\t\t\tthis.bg.style.width = w + \"px\";\n\t\t\t\tthis.bg.style.height = h + \"px\";\n\t\t\t}\n\t\t\tthis.bgIframe.onResized();","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.showBackground":{"_":{"meta":{"summary":"","src":"\t\t\tthis.sizeBackground();\n\t\t\tif(this.bgOpacity > 0) {\n\t\t\t\tthis.bg.style.display = \"block\";\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.placeDialog":{"_":{"meta":{"summary":"","src":"\t\t\tvar scroll_offset = dojo.html.getScroll().offset;\n\t\t\tvar viewport_size = dojo.html.getViewport();\n\n\t\t\t\/\/ find the size of the dialog\n\t\t\tvar mb = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\tvar x = scroll_offset.x + (viewport_size.width - mb.width)\/2;\n\t\t\tvar y = scroll_offset.y + (viewport_size.height - mb.height)\/2;\n\n\t\t\twith(this.domNode.style) {\n\t\t\t\tleft = x + \"px\";\n\t\t\t\ttop = y + \"px\";\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.show":{"_":{"meta":{"summary":"","src":"\t\t\tthis.setBackgroundOpacity();\n\t\t\tthis.showBackground();\n\n\t\t\tdojo.widget.Dialog.superclass.show.call(this);\n\n\t\t\t\/\/ FIXME: moz doesn't generate onscroll events for mouse or key scrolling (wtf)\n\t\t\t\/\/ we should create a fake event by polling the scrolltop\/scrollleft every X ms.\n\t\t\t\/\/ this smells like it should be a dojo feature rather than just for this widget.\n\n\t\t\tif (this.followScroll && !this._scrollConnected){\n\t\t\t\tthis._scrollConnected = true;\n\t\t\t\tdojo.event.connect(window, \"onscroll\", this, \"onScroll\");\n\t\t\t}\n\t\t\t\n\t\t\tif(this.lifetime){\n\t\t\t\tthis.timeRemaining = this.lifetime;\n\t\t\t\tif(!this.blockDuration){\n\t\t\t\t\tdojo.event.connect(this.bg, \"onclick\", this, \"hide\");\n\t\t\t\t}else{\n\t\t\t\t\tdojo.event.disconnect(this.bg, \"onclick\", this, \"hide\");\n\t\t\t\t}\n\t\t\t\tif(this.timerNode){\n\t\t\t\t\tthis.timerNode.innerHTML = Math.ceil(this.timeRemaining\/1000);\n\t\t\t\t}\n\t\t\t\tif(this.blockDuration && this.closeNode){\n\t\t\t\t\tif(this.lifetime > this.blockDuration){\n\t\t\t\t\t\tthis.closeNode.style.visibility = \"hidden\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.closeNode.style.display = \"none\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.timer = setInterval(dojo.lang.hitch(this, \"onTick\"), 100);\n\t\t\t}\n\n\t\t\tthis.checkSize();","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.onLoad":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.fillInTemplate":{"_":{"meta":{"summary":"","src":"\t\t\t\/\/ dojo.event.connect(this.domNode, \"onclick\", this, \"killEvent\");","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.hide":{"_":{"meta":{"summary":"","src":"\t\t\t\tdojo.byId(this.focusElement).focus(); \n\t\t\t\tdojo.byId(this.focusElement).blur();\n\t\t\t}\n\t\t\t\n\t\t\tif(this.timer){\n\t\t\t\tclearInterval(this.timer);\n\t\t\t}\n\n\t\t\tthis.bg.style.display = \"none\";\n\t\t\tthis.bg.style.width = this.bg.style.height = \"1px\";\n\n\t\t\tdojo.widget.Dialog.superclass.hide.call(this);\n\n\t\t\tif (this._scrollConnected){\n\t\t\t\tthis._scrollConnected = false;\n\t\t\t\tdojo.event.disconnect(window, \"onscroll\", this, \"onScroll\");\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.setTimerNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\tthis.timerNode = node;","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.setCloseControl":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\tthis.closeNode = node;\n\t\t\tdojo.event.connect(node, \"onclick\", this, \"hide\");","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.setShowControl":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\tdojo.event.connect(node, \"onclick\", this, \"show\");","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.onTick":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.timer){\n\t\t\t\tthis.timeRemaining -= 100;\n\t\t\t\tif(this.lifetime - this.timeRemaining >= this.blockDuration){\n\t\t\t\t\tdojo.event.connect(this.bg, \"onclick\", this, \"hide\");\n\t\t\t\t\tif(this.closeNode){\n\t\t\t\t\t\tthis.closeNode.style.visibility = \"visible\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!this.timeRemaining){\n\t\t\t\t\tclearInterval(this.timer);\n\t\t\t\t\tthis.hide();\n\t\t\t\t}else if(this.timerNode){\n\t\t\t\t\tthis.timerNode.innerHTML = Math.ceil(this.timeRemaining\/1000);\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.onScroll":{"_":{"meta":{"summary":"","src":"\t\t\tthis.placeDialog();\n\t\t\tthis.domNode.style.display = \"block\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.checkSize":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.isShowing()){\n\t\t\t\tthis.sizeBackground();\n\t\t\t\tthis.placeDialog();\n\t\t\t\tthis.domNode.style.display=\"block\";\n\t\t\t\tthis.onResized();\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Dialog.killEvent":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation();","this":"dojo.widget.ContentPane"}}}}}},"dojo.widget.DocPane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.io.*","dojo.event.*","dojo.widget.HtmlWidget","dojo.widget.Editor2","dojo.widget.Dialog","dojo.html.common","dojo.html.display"]},"methods":{"dojo.widget.DocPane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"dialog":"","dialogBg":"","dialogFg":"","logIn":"","edit":"","save":"","cancel":"","detail":"","result":"","packag":"","fn":"","fnLink":"","count":"","row":"","summary":"","variables":"","vRow":"","vLink":"","vDesc":"","methods":"","mRow":"","mLink":"","mDesc":"","requires":"","rRow":"","rRow2":"","rH3":"","rLink":"","parameters":"","pRow":"","pLink":"","pDesc":"","pOpt":"","pType":"","sType":"","sName":"","sParams":"","sPType":"","sPTypeSave":"","sPName":"","sPNameSave":"","pkgDescription":"","_appends":"","templatePath":"","templateCssPath":"","isContainer":""}}}},"dojo.widget.DocPane.description":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.pkgEditor){\n\t\t\t\tdojo.docs.savePackage(this._pkgPath, {\n\t\t\t\t\tdescription: this.pkgEditor.getEditorContent()\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane.fillInTemplate":{"_":{"meta":{"summary":"","src":"\t\t\tthis.requires = dojo.html.removeNode(this.requires);\n\t\t\tthis.rRow.style.display = \"none\";\n\t\t\tthis.rRow2.style.display = \"none\";\n\t\t\t\n\t\t\tthis.methods = dojo.html.removeNode(this.methods);\n\t\t\tthis.mRow.style.display = \"none\";\n\t\t\t\n\t\t\tthis.dialog = dojo.widget.createWidget(\"dialog\", {}, this.dialog);\n\t\t\tthis.dialog.setCloseControl(this.cancel);\n\t\t\tdojo.html.setOpacity(this.dialogBg, 0.8);\n\t\t\tdojo.html.setOpacity(this.dialogFg, 1);\n\n\t\t\tdojo.event.connect(this.edit, \"onclick\", dojo.lang.hitch(this, function(){\n\t\t\t\tif(!this._isLoggedIn){\n\t\t\t\t\tthis.dialog.show();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tdojo.event.connect(this.logIn, \"onclick\", this, \"_logIn\");\n\t\t\tdojo.event.connect(this.save, \"onclick\", this, \"_save\");\n\t\t\tdojo.event.connect(dojo.docs, \"logInSuccess\", this, \"_loggedIn\");\n\t\t\t\n\t\t\t\/*\n\t\t\tthis.pkgDescription = dojo.widget.createWidget(\"editor2\", {\n\t\t\t\ttoolbarAlwaysVisible: true\n\t\t\t}, this.pkgDescription);\n\t\t\t*\/\n\t\t\t\n\t\t\tthis.homeSave = this.containerNode.cloneNode(true);\n\t\t\tthis.detailSave = dojo.html.removeNode(this.detail);\n\t\t\tthis.resultSave = dojo.html.removeNode(this.result);\n\t\t\tthis.packageSave = dojo.html.removeNode(this.packag);\n\t\t\tthis.results = dojo.html.removeNode(this.results);\n\t\t\tthis.rowParent = this.row.parentNode;\n\t\t\tthis.rowSave = dojo.html.removeNode(this.row);\n\t\t\tthis.vParent = this.vRow.parentNode;\n\t\t\tthis.vSave = dojo.html.removeNode(this.vRow);\n\t\t\tthis.pParent = this.pRow.parentNode;\n\t\t\tthis.pSave = dojo.html.removeNode(this.pRow);\n\t\t\tthis.sPTypeSave = dojo.html.removeNode(this.sPType);\n\t\t\tthis.sPNameSave = dojo.html.removeNode(this.sPName);\n\t\t\tthis.navSave = dojo.html.removeNode(this.nav);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["requires","rRow.style.display","rRow2.style.display","methods","mRow.style.display","homeSave","detailSave","resultSave","packageSave","results","rowParent","rowSave","vParent","vSave","pParent","pSave","sPTypeSave","sPNameSave","navSave","_isLoggedIn","pkgEditor","_isLoggedIn","pkgEditor","fn.innerHTML","variables.style.display","vLink.innerHTML","vDesc.parentNode.style.display","sParams.innerHTML","parameters.style.display","pLink.innerHTML","pOpt.style.display","pType.parentNode.style.display","pType.innerHTML","pDesc.parentNode.style.display","pDesc.innerHTML","sPTypeSave.innerHTML","sPNameSave.innerHTML","sType.innerHTML","sName.innerHTML","_pkgPath","pkg.innerHTML","rH3.style.display","rH3.innerHTML","rLink.innerHTML","rLink.href","mLink.innerHTML","mLink.href","mDesc.parentNode.style.display","mDesc.innerHTML","pkgDescription.innerHTML","_pkgPath","pkg.innerHTML","rH3.style.display","rH3.innerHTML","rLink.innerHTML","rLink.href","mLink.innerHTML","mLink.href","mDesc.parentNode.style.display","mDesc.innerHTML","pkgDescription.innerHTML","count.innerHTML","fnLink.innerHTML","fnLink.href","summary.parentNode.style.display","summary.innerHTML"]}}},"dojo.widget.DocPane._logIn":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.docs.setUserName(this.userName.value);\n\t\t\tdojo.docs.setPassword(this.password.value);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane._loggedIn":{"_":{"meta":{"summary":"","src":"\t\t\tthis._isLoggedIn = true;\n\t\t\tthis.dialog.hide();\n\t\t\tthis.pkgEditor = dojo.widget.createWidget(\"editor2\", {\n\t\t\t\ttoolbarAlwaysVisible: true\n\t\t\t}, this.pkgDescription);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane.toolbarAlwaysVisible":{"_":{"meta":{"summary":"","src":"\t\t\tthis._isLoggedIn = true;\n\t\t\tthis.dialog.hide();\n\t\t\tthis.pkgEditor = dojo.widget.createWidget(\"editor2\", {\n\t\t\t\ttoolbarAlwaysVisible: true\n\t\t\t}, this.pkgDescription);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane._save":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.pkgEditor){\n\t\t\t\tdojo.docs.savePackage(this._pkgPath, {\n\t\t\t\t\tdescription: this.pkgEditor.getEditorContent()\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane.onDocSelectFunction":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\t\tdojo.debug(\"onDocSelectFunction()\");\n\t\t\tfor(var key in message){\n\t\t\t\tdojo.debug(key + \": \" + dojo.json.serialize(message[key]));\n\t\t\t}\n\t\t\tvar meta = message.meta;\n\t\t\tif(meta){\n\t\t\t\tvar variables = meta.variables;\n\t\t\t\tvar this_variables = meta.this_variables;\n\t\t\t\tvar child_variables = meta.child_variables;\n\t\t\t\tvar parameters = meta.parameters;\n\t\t\t}\n\t\t\tvar doc = message.doc;\n\t\t\tdojo.debug(dojo.json.serialize(doc));\n\n\t\t\tvar appends = this._appends;\n\t\t\tdojo.html.removeChildren(this.domNode);\n\t\t\tthis.fn.innerHTML = message.name;\n\n\t\t\tthis.variables.style.display = \"block\";\n\t\t\tvar all = [];\n\t\t\tif(variables){\n\t\t\t\tall = variables;\n\t\t\t}\n\t\t\tif(this_variables){\n\t\t\t\tall = all.concat(this_variables);\n\t\t\t}\n\t\t\tif(child_variables){\n\t\t\t\tall = all.concat(child_variables);\n\t\t\t}\n\t\t\tif(!all.length){\n\t\t\t\tthis.variables.style.display = \"none\";\n\t\t\t}else{\n\t\t\t\tfor(var i = 0, one; one = all[i]; i++){\n\t\t\t\t\tthis.vLink.innerHTML = one;\n\t\t\t\t\tthis.vDesc.parentNode.style.display = \"none\";\n\t\t\t\t\tappends.push(this.vParent.appendChild(this.vSave.cloneNode(true)));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.sParams.innerHTML = \"\";\n\t\t\tvar first = true;\n\t\t\tfor(var param in parameters){\n\t\t\t\tvar paramType = parameters[param].type;\n\t\t\t\tvar paramSummary = parameters[param].summary;\n\t\t\t\tvar paramName = param;\n\t\t\t\tthis.parameters.style.display = \"block\";\t\t\n\t\t\t\tthis.pLink.innerHTML = paramName;\n\t\t\t\tthis.pOpt.style.display = \"none\";\n\t\t\t\tif(parameters[param].opt){\n\t\t\t\t\tthis.pOpt.style.display = \"inline\";\t\t\t\t\n\t\t\t\t}\n\t\t\t\tthis.pType.parentNode.style.display = \"none\";\n\t\t\t\tif(parameters[param][0]){\n\t\t\t\t\tthis.pType.parentNode.style.display = \"inline\";\n\t\t\t\t\tthis.pType.innerHTML = paramType;\n\t\t\t\t}\n\t\t\t\tthis.pDesc.parentNode.style.display = \"none\";\n\t\t\t\tif(paramSummary){\n\t\t\t\t\tthis.pDesc.parentNode.style.display = \"inline\";\n\t\t\t\t\tthis.pDesc.innerHTML = paramSummary;\n\t\t\t\t}\n\t\t\t\tappends.push(this.pParent.appendChild(this.pSave.cloneNode(true)));\n\n\t\t\t\tif(!first) {\n\t\t\t\t\tthis.sParams.appendChild(document.createTextNode(\", \"));\n\t\t\t\t}\n\t\t\t\tfirst = false;\n\t\t\t\tif(paramType){\n\t\t\t\t\tdojo.debug(this.sPTypeSave);\n\t\t\t\t\tthis.sPTypeSave.innerHTML = paramType;\n\t\t\t\t\tthis.sParams.appendChild(this.sPTypeSave.cloneNode(true));\n\t\t\t\t\tthis.sParams.appendChild(document.createTextNode(\" \"));\n\t\t\t\t}\n\t\t\t\tdojo.debug(this.sPNameSave);\n\t\t\t\tthis.sPNameSave.innerHTML = paramName;\n\t\t\t\tthis.sParams.appendChild(this.sPNameSave.cloneNode(true))\n\t\t\t}\n\n\t\t\tif(message.returns){\n\t\t\t\tthis.sType.innerHTML = message.returns;\n\t\t\t}else{\n\t\t\t\tthis.sType.innerHTML = \"void\";\n\t\t\t}\n\n\t\t\tthis.sName.innerHTML = message.name;\n\n\t\t\tthis.domNode.appendChild(this.navSave);\n\t\t\tthis.domNode.appendChild(this.detailSave.cloneNode(true));\n\n\t\t\tfor(var i = 0, append; append = appends[i]; i++){\n\t\t\t\tdojo.html.removeNode(append);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane.onPkgResult":{"_":{"meta":{"summary":"","parameters":{"results":{"type":"Object"}},"src":"\t\t\tif(this.pkgEditor){\n\t\t\t\tthis.pkgEditor.close(true);\n\t\t\t\tdojo.debug(this.pkgDescription);\n\t\t\t}\n\t\t\tvar methods = results.methods;\n\t\t\tvar requires = results.requires;\n\t\t\tvar description = results.description;\n\t\t\tthis._pkgPath = results.path;\n\t\t\tvar requireLinks = [];\n\t\t\tvar appends = this._appends;\n\t\t\twhile(appends.length){\n\t\t\t\tdojo.html.removeNode(appends.shift());\n\t\t\t}\n\n\t\t\tdojo.html.removeChildren(this.domNode);\n\t\t\t\n\t\t\tthis.pkg.innerHTML = results.pkg;\n\t\t\t\n\t\t\tvar hasRequires = false;\n\t\t\tfor(var env in requires){\n\t\t\t\thasRequires = true;\n\n\t\t\t\tthis.rH3.style.display = \"none\";\n\t\t\t\tif(env != \"common\"){\n\t\t\t\t\tthis.rH3.style.display = \"\";\n\t\t\t\t\tthis.rH3.innerHTML = env;\n\t\t\t\t}\n\n\t\t\t\tfor(var i = 0, require; require = requires[env][i]; i++){\n\t\t\t\t\trequireLinks.push({\n\t\t\t\t\t\tname: require\n\t\t\t\t\t});\n\t\t\t\t\tthis.rLink.innerHTML = require;\n\t\t\t\t\tthis.rLink.href = \"#\" + require;\n\t\t\t\t\tvar rRow2 = this.rRow2.parentNode.insertBefore(this.rRow2.cloneNode(true), this.rRow2);\n\t\t\t\t\trRow2.style.display = \"\";\n\t\t\t\t\tappends.push(rRow2);\n\t\t\t\t}\n\t\t\t\tvar rRow = this.rRow.parentNode.insertBefore(this.rRow.cloneNode(true), this.rRow);\n\t\t\t\trRow.style.display = \"\";\n\t\t\t\tappends.push(rRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(hasRequires){\n\t\t\t\tappends.push(this.packageSave.appendChild(this.requires.cloneNode(true)));\n\t\t\t}\n\n\t\t\tif(results.size){\n\t\t\t\tfor(var i = 0, method; method = methods[i]; i++){\n\t\t\t\t\tthis.mLink.innerHTML = method.name;\n\t\t\t\t\tthis.mLink.href = \"#\" + method.name;\n\t\t\t\t\tthis.mDesc.parentNode.style.display = \"none\";\n\t\t\t\t\tif(method.summary){\n\t\t\t\t\t\tthis.mDesc.parentNode.style.display = \"inline\";\t\t\t\t\n\t\t\t\t\t\tthis.mDesc.innerHTML = method.summary;\n\t\t\t\t\t}\n\t\t\t\t\tvar mRow = this.mRow.parentNode.insertBefore(this.mRow.cloneNode(true), this.mRow);\n\t\t\t\t\tmRow.style.display = \"\";\n\t\t\t\t\tappends.push(mRow);\n\t\t\t\t}\n\t\t\t\tappends.push(this.packageSave.appendChild(this.methods.cloneNode(true)));\n\t\t\t}\n\n\t\t\tthis.domNode.appendChild(this.packageSave);\n\t\t\t\n\t\t\t\/*\n\t\t\tdojo.debug(description);\n\t\t\tfunction fillContent(){\n\t\t\t\tthis.pkgDescription.replaceEditorContent(description);\n\t\t\t\tthis.pkgDescription._updateHeight();\n\t\t\t}\n\t\t\tif(this.pkgDescription.isLoaded){\n\t\t\t\tfillContent();\n\t\t\t}else{\n\t\t\t\tdojo.event.connect(this.pkgDescription, \"onLoad\", dojo.lang.hitch(this, fillContent));\n\t\t\t}\n\t\t\t*\/\n\t\t\tthis.pkgDescription.innerHTML = description;\n\t\t\t\n\t\t\tfunction makeSelect(fOrP, x){\n\t\t\t\treturn function(e) {\n\t\t\t\t\tdojo.event.topic.publish(\"\/docs\/\" + fOrP + \"\/select\", x);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar as = this.domNode.getElementsByTagName(\"a\");\n\t\t\tfor(var i = 0, a; a = as[i]; i++){\n\t\t\t\tif(a.className == \"docMLink\"){\n\t\t\t\t\tdojo.event.connect(a, \"onclick\", makeSelect(\"function\", methods[i]));\n\t\t\t\t}else if(a.className == \"docRLink\"){\n\t\t\t\t\tdojo.event.connect(a, \"onclick\", makeSelect(\"package\", requireLinks[i]));\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane.name":{"_":{"meta":{"summary":"","parameters":{"results":{"type":"Object"}},"src":"\t\t\tif(this.pkgEditor){\n\t\t\t\tthis.pkgEditor.close(true);\n\t\t\t\tdojo.debug(this.pkgDescription);\n\t\t\t}\n\t\t\tvar methods = results.methods;\n\t\t\tvar requires = results.requires;\n\t\t\tvar description = results.description;\n\t\t\tthis._pkgPath = results.path;\n\t\t\tvar requireLinks = [];\n\t\t\tvar appends = this._appends;\n\t\t\twhile(appends.length){\n\t\t\t\tdojo.html.removeNode(appends.shift());\n\t\t\t}\n\n\t\t\tdojo.html.removeChildren(this.domNode);\n\t\t\t\n\t\t\tthis.pkg.innerHTML = results.pkg;\n\t\t\t\n\t\t\tvar hasRequires = false;\n\t\t\tfor(var env in requires){\n\t\t\t\thasRequires = true;\n\n\t\t\t\tthis.rH3.style.display = \"none\";\n\t\t\t\tif(env != \"common\"){\n\t\t\t\t\tthis.rH3.style.display = \"\";\n\t\t\t\t\tthis.rH3.innerHTML = env;\n\t\t\t\t}\n\n\t\t\t\tfor(var i = 0, require; require = requires[env][i]; i++){\n\t\t\t\t\trequireLinks.push({\n\t\t\t\t\t\tname: require\n\t\t\t\t\t});\n\t\t\t\t\tthis.rLink.innerHTML = require;\n\t\t\t\t\tthis.rLink.href = \"#\" + require;\n\t\t\t\t\tvar rRow2 = this.rRow2.parentNode.insertBefore(this.rRow2.cloneNode(true), this.rRow2);\n\t\t\t\t\trRow2.style.display = \"\";\n\t\t\t\t\tappends.push(rRow2);\n\t\t\t\t}\n\t\t\t\tvar rRow = this.rRow.parentNode.insertBefore(this.rRow.cloneNode(true), this.rRow);\n\t\t\t\trRow.style.display = \"\";\n\t\t\t\tappends.push(rRow);\n\t\t\t}\n\t\t\t\n\t\t\tif(hasRequires){\n\t\t\t\tappends.push(this.packageSave.appendChild(this.requires.cloneNode(true)));\n\t\t\t}\n\n\t\t\tif(results.size){\n\t\t\t\tfor(var i = 0, method; method = methods[i]; i++){\n\t\t\t\t\tthis.mLink.innerHTML = method.name;\n\t\t\t\t\tthis.mLink.href = \"#\" + method.name;\n\t\t\t\t\tthis.mDesc.parentNode.style.display = \"none\";\n\t\t\t\t\tif(method.summary){\n\t\t\t\t\t\tthis.mDesc.parentNode.style.display = \"inline\";\t\t\t\t\n\t\t\t\t\t\tthis.mDesc.innerHTML = method.summary;\n\t\t\t\t\t}\n\t\t\t\t\tvar mRow = this.mRow.parentNode.insertBefore(this.mRow.cloneNode(true), this.mRow);\n\t\t\t\t\tmRow.style.display = \"\";\n\t\t\t\t\tappends.push(mRow);\n\t\t\t\t}\n\t\t\t\tappends.push(this.packageSave.appendChild(this.methods.cloneNode(true)));\n\t\t\t}\n\n\t\t\tthis.domNode.appendChild(this.packageSave);\n\t\t\t\n\t\t\t\/*\n\t\t\tdojo.debug(description);\n\t\t\tfunction fillContent(){\n\t\t\t\tthis.pkgDescription.replaceEditorContent(description);\n\t\t\t\tthis.pkgDescription._updateHeight();\n\t\t\t}\n\t\t\tif(this.pkgDescription.isLoaded){\n\t\t\t\tfillContent();\n\t\t\t}else{\n\t\t\t\tdojo.event.connect(this.pkgDescription, \"onLoad\", dojo.lang.hitch(this, fillContent));\n\t\t\t}\n\t\t\t*\/\n\t\t\tthis.pkgDescription.innerHTML = description;\n\t\t\t\n\t\t\tfunction makeSelect(fOrP, x){\n\t\t\t\treturn function(e) {\n\t\t\t\t\tdojo.event.topic.publish(\"\/docs\/\" + fOrP + \"\/select\", x);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar as = this.domNode.getElementsByTagName(\"a\");\n\t\t\tfor(var i = 0, a; a = as[i]; i++){\n\t\t\t\tif(a.className == \"docMLink\"){\n\t\t\t\t\tdojo.event.connect(a, \"onclick\", makeSelect(\"function\", methods[i]));\n\t\t\t\t}else if(a.className == \"docRLink\"){\n\t\t\t\t\tdojo.event.connect(a, \"onclick\", makeSelect(\"package\", requireLinks[i]));\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DocPane.onDocResults":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\t\tvar results = message.methods;\n\n\t\t\tif(results.length == 1){\n\t\t\t\tdojo.event.topic.publish(\"\/docs\/function\/select\", results[0]);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdojo.html.removeChildren(this.domNode);\n\n\t\t\tthis.count.innerHTML = results.length;\n\t\t\tvar appends = [];\n\t\t\tfor(var i = 0, row; row = results[i]; i++){\n\t\t\t\tthis.fnLink.innerHTML = row.name;\n\t\t\t\tthis.fnLink.href = \"#\" + row.name;\n\t\t\t\tif(row.id){\n\t\t\t\t\tthis.fnLink.href = this.fnLink.href + \",\" + row.id;\t\n\t\t\t\t}\n\t\t\t\tthis.summary.parentNode.style.display = \"none\";\n\t\t\t\tif(row.summary){\n\t\t\t\t\tthis.summary.parentNode.style.display = \"inline\";\t\t\t\t\n\t\t\t\t\tthis.summary.innerHTML = row.summary;\n\t\t\t\t}\n\t\t\t\tappends.push(this.rowParent.appendChild(this.rowSave.cloneNode(true)));\n\t\t\t}\n\n\t\t\tfunction makeSelect(x){\n\t\t\t\treturn function(e) {\n\t\t\t\t\tdojo.event.topic.publish(\"\/docs\/function\/select\", x);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.domNode.appendChild(this.resultSave.cloneNode(true));\n\t\t\tvar as = this.domNode.getElementsByTagName(\"a\");\n\t\t\tfor(var i = 0, a; a = as[i]; i++){\n\t\t\t\tdojo.event.connect(a, \"onclick\", makeSelect(results[i]));\n\t\t\t}\n\n\t\t\tfor(var i = 0, append; append = appends[i]; i++){\n\t\t\t\tthis.rowParent.removeChild(append);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.DomWidget":{"meta":{"requires":{"common":["dojo.event.*","dojo.widget.Widget","dojo.dom","dojo.html.style","dojo.xml.Parse","dojo.uri.*","dojo.lang.func","dojo.lang.extras"]},"methods":{"dojo.widget.DomWidget":{"_":{"meta":{"summary":"","inherits":["dojo.widget.Widget"],"this_inherits":["dojo.widget.Widget"],"protovariables":{"templateNode":"","templateString":"","templateCssString":"","preventClobber":"","domNode":"","containerNode":""}}}},"dojo.widget.DomWidget.addChild":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""},"overrideContainerNode":{"type":""},"pos":{"type":""},"ref":{"type":""},"insertIndex":{"type":""}},"src":"\t\tif(!this.isContainer){                                                        \n\t\t\tdojo.debug(\"dojo.widget.DomWidget.addChild() attempted on non-container widget\");\n\t\t\treturn null;\n\t\t}else{\n\t\t\tif(insertIndex == undefined){\n\t\t\t\tinsertIndex = this.children.length;\n\t\t\t}\n\t\t\tthis.addWidgetAsDirectChild(widget, overrideContainerNode, pos, ref, insertIndex);\n\t\t\tthis.registerChild(widget, insertIndex);\n\t\t}\n\t\treturn widget;","this":"dojo.widget.Widget"}}},"dojo.widget.DomWidget.addWidgetAsDirectChild":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""},"overrideContainerNode":{"type":""},"pos":{"type":""},"ref":{"type":""},"insertIndex":{"type":""}},"src":"\t\tif((!this.containerNode)&&(!overrideContainerNode)){\n\t\t\tthis.containerNode = this.domNode;\n\t\t}\n\t\tvar cn = (overrideContainerNode) ? overrideContainerNode : this.containerNode;\n\t\tif(!pos){ pos = \"after\"; }\n\t\tif(!ref){ \n\t\t\tif(!cn){ cn = dojo.body(); }\n\t\t\tref = cn.lastChild; \n\t\t}\n\t\tif(!insertIndex) { insertIndex = 0; }\n\t\twidget.domNode.setAttribute(\"dojoinsertionindex\", insertIndex);\n\n\t\t\/\/ insert the child widget domNode directly underneath my domNode, in the\n\t\t\/\/ specified position (by default, append to end)\n\t\tif(!ref){\n\t\t\tcn.appendChild(widget.domNode);\n\t\t}else{\n\t\t\t\/\/ FIXME: was this meant to be the (ugly hack) way to support insert @ index?\n\t\t\t\/\/dojo.dom[pos](widget.domNode, ref, insertIndex);\n\n\t\t\t\/\/ CAL: this appears to be the intended way to insert a node at a given position...\n\t\t\tif (pos == 'insertAtIndex'){\n\t\t\t\t\/\/ dojo.debug(\"idx:\", insertIndex, \"isLast:\", ref === cn.lastChild);\n\t\t\t\tdojo.dom.insertAtIndex(widget.domNode, ref.parentNode, insertIndex);\n\t\t\t}else{\n\t\t\t\t\/\/ dojo.debug(\"pos:\", pos, \"isLast:\", ref === cn.lastChild);\n\t\t\t\tif((pos == \"after\")&&(ref === cn.lastChild)){\n\t\t\t\t\tcn.appendChild(widget.domNode);\n\t\t\t\t}else{\n\t\t\t\t\tdojo.dom.insertAtPosition(widget.domNode, cn, pos);\n\t\t\t\t}\n\t\t\t}\n\t\t}","this":"dojo.widget.Widget"}}},"dojo.widget.Widget":{"_":{"meta":{"this_variables":["containerNode","templateCssString","templateCssPath","templateCssString.loaded","domNode","templateString","templateNode","domNode"]}}},"dojo.widget.DomWidget.registerChild":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""},"insertionIndex":{"type":""}},"src":"\t\tvar idx = -1;\n\t\tfor(var i=0; i<this.children.length; i++){\n\t\t\tif (this.children[i].dojoInsertionIndex < insertionIndex){\n\t\t\t\tidx = i;\n\t\t\t}\n\t\t}\n\n\t\tthis.children.splice(idx+1, 0, widget);\n\n\t\twidget.parent = this;\n\t\twidget.addedTo(this, idx+1);\n\t\t\n\t\t\/\/ If this widget was created programatically, then it was erroneously added\n\t\t\/\/ to dojo.widget.manager.topWidgets.  Fix that here.\n\t\tdelete dojo.widget.manager.topWidgets[widget.widgetId];","this":"dojo.widget.Widget"}}},"dojo.widget.DomWidget.removeChild":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""}},"src":"\t\t\/\/ remove child widget from parent widget\n\t\treturn dojo.widget.DomWidget.superclass.removeChild.call(this, widget);","this_inherits":["dojo.widget.DomWidget.superclass.removeChild"],"this":"dojo.widget.Widget"}}},"dojo.widget.DomWidget.getFragNodeRef":{"_":{"meta":{"summary":"","parameters":{"frag":{"type":""}},"src":"\t\tif(!frag || !frag[this.namespace+\":\"+this.widgetType.toLowerCase()]){\n\t\t\tdojo.raise(\"Error: no frag for widget type \" + this.widgetType\n\t\t\t\t+ \" with namespace \"+this.namespace + \", id \" + this.widgetId\n\t\t\t\t+ \" (maybe a widget has set it's type incorrectly)\");\n\t\t}\n\t\treturn frag ? frag[this.namespace+\":\"+this.widgetType.toLowerCase()][\"nodeRef\"] : null;","this":"dojo.widget.Widget"}}},"dojo.widget.DomWidget.postInitialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""},"parentComp":{"type":""}},"src":"\t\t\/\/ Stick my generated dom into the output tree\n\t\t\/\/alert(this.widgetId + \": replacing \" + sourceNodeRef + \" with \" + this.domNode.innerHTML);\n\t\tif (parentComp && (parentComp.snarfChildDomOutput || !sourceNodeRef)){\n\t\t\t\/\/ Add my generated dom as a direct child of my parent widget\n\t\t\t\/\/ This is important for generated widgets, and also cases where I am generating an\n\t\t\t\/\/ <li> node that can't be inserted back into the original DOM tree\n\t\t\tparentComp.addWidgetAsDirectChild(this, \"\", \"insertAtIndex\", \"\",  args[\"dojoinsertionindex\"], sourceNodeRef);\n\t\t} else if (sourceNodeRef){\n\t\t\t\/\/ Do in-place replacement of the my source node with my generated dom\n\t\t\tif(this.domNode && (this.domNode !== sourceNodeRef)){\n\t\t\t\tvar oldNode = sourceNodeRef.parentNode.replaceChild(this.domNode, sourceNodeRef);\n\t\t\t}\n\t\t}\n\n\t\t\/\/ Register myself with my parent, or with the widget manager if\n\t\t\/\/ I have no parent\n\t\t\/\/ TODO: the code below erroneously adds all programatically generated widgets\n\t\t\/\/ to topWidgets (since we don't know who the parent is until after creation finishes)\n\t\tif ( parentComp ) {\n\t\t\tparentComp.registerChild(this, args.dojoinsertionindex);\n\t\t} else {\n\t\t\tdojo.widget.manager.topWidgets[this.widgetId]=this;\n\t\t}\n\n\n\t\t\/\/dojo.profile.end(this.widgetType + \" postInitialize\");\n\t\t\n\t\t\/\/ Expand my children widgets\n\t\t\/* dojoDontFollow is important for a very special case\n\t\t * basically if you have a widget that you instantiate from script\n\t\t * and that widget is a container, and it contains a reference to a parent\n\t\t * instance, the parser will start recursively parsing until the browser\n\t\t * complains.  So the solution is to set an initialization property of \n\t\t * dojoDontFollow: true and then it won't recurse where it shouldn't\n\t\t *\/\n\t\tif(this.isContainer && !frag[\"dojoDontFollow\"]){\n\t\t\t\/\/alert(\"recurse from \" + this.widgetId);\n\t\t\t\/\/ build any sub-components with us as the parent\n\t\t\tvar fragParser = dojo.widget.getParser();\n\t\t\tfragParser.createSubComponents(frag, this);\n\t\t}","this":"dojo.widget.Widget"}}},"dojo.widget.DomWidget.buildRendering":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\/\/ Handle style for this widget here, as even if templatePath\n\t\t\/\/ is not set, style specified by templateCssString or templateCssPath\n\t\t\/\/ should be applied. templateCssString has higher priority\n\t\t\/\/ than templateCssPath\n\t\tif(args[\"templatecsspath\"]){\n\t\t\targs[\"templateCssPath\"] = args[\"templatecsspath\"];\n\t\t}\n\t\tvar cpath = args[\"templateCssPath\"] || this.templateCssPath;\n\t\t\/\/ DEPRECATED: use Uri objects, not strings\n\t\tif (cpath && !(cpath instanceof dojo.uri.Uri)) {\n\t\t\tcpath = dojo.uri.dojoUri(cpath);\n\t\t\tdojo.deprecated(\"templateCssPath should be of type dojo.uri.Uri\", null, \"0.4\");\n\t\t}\n\t\tif(cpath && !dojo.widget._cssFiles[cpath.toString()]){\n\t\t\tif((!this.templateCssString)&&(cpath)){\n\t\t\t\tthis.templateCssString = dojo.hostenv.getText(cpath);\n\t\t\t\tthis.templateCssPath = null;\n\t\t\t}\n\t\t\tdojo.widget._cssFiles[cpath.toString()] = true;\n\t\t}\n\t\n\t\tif((this[\"templateCssString\"])&&(!this.templateCssString[\"loaded\"])){\n\t\t\tdojo.html.insertCssText(this.templateCssString, null, cpath);\n\t\t\tif(!this.templateCssString){ this.templateCssString = \"\"; }\n\t\t\tthis.templateCssString.loaded = true;\n\t\t}\n\t\tif(\t\n\t\t\t(!this.preventClobber)&&(\n\t\t\t\t(this.templatePath)||\n\t\t\t\t(this.templateNode)||\n\t\t\t\t(\n\t\t\t\t\t(this[\"templateString\"])&&(this.templateString.length) \n\t\t\t\t)||\n\t\t\t\t(\n\t\t\t\t\t(typeof ts != \"undefined\")&&( (ts[\"string\"])||(ts[\"node\"]) )\n\t\t\t\t)\n\t\t\t)\n\t\t){\n\t\t\t\/\/ if it looks like we can build the thing from a template, do it!\n\t\t\tthis.buildFromTemplate(args, frag);\n\t\t}else{\n\t\t\t\/\/ otherwise, assign the DOM node that was the source of the widget\n\t\t\t\/\/ parsing to be the root node\n\t\t\tthis.domNode = this.getFragNodeRef(frag);\n\t\t}\n\t\tthis.fillInTemplate(args, frag); \t\/\/ this is where individual widgets\n\t\t\t\t\t\t\t\t\t\t\t\/\/ will handle population of data\n\t\t\t\t\t\t\t\t\t\t\t\/\/ from properties, remote data\n\t\t\t\t\t\t\t\t\t\t\t\/\/ sets, etc.","this":"dojo.widget.Widget"}}},"dojo.widget.DomWidget.buildFromTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tif(args[\"templatepath\"]){\n\t\t\tavoidCache = true;\n\t\t\targs[\"templatePath\"] = args[\"templatepath\"];\n\t\t}\n\t\tdojo.widget.fillFromTemplateCache(\tthis, \n\t\t\t\t\t\t\t\t\t\t\targs[\"templatePath\"], \n\t\t\t\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\t\t\t\tavoidCache);\n\t\tvar ts = dojo.widget._templateCache[this.widgetType];\n\t\tif((ts)&&(!avoidCache)){\n\t\t\tif(!this.templateString.length){\n\t\t\t\tthis.templateString = ts[\"string\"];\n\t\t\t}\n\t\t\tif(!this.templateNode){\n\t\t\t\tthis.templateNode = ts[\"node\"];\n\t\t\t}\n\t\t}\n\t\tvar matches = false;\n\t\tvar node = null;\n\t\t\/\/ var tstr = new String(this.templateString); \n\t\tvar tstr = this.templateString; \n\t\t\/\/ attempt to clone a template node, if there is one\n\t\tif((!this.templateNode)&&(this.templateString)){\n\t\t\tmatches = this.templateString.match(\/\\$\\{([^\\}]+)\\}\/g);\n\t\t\tif(matches) {\n\t\t\t\t\/\/ if we do property replacement, don't create a templateNode\n\t\t\t\t\/\/ to clone from.\n\t\t\t\tvar hash = this.strings || {};\n\t\t\t\t\/\/ FIXME: should this hash of default replacements be cached in\n\t\t\t\t\/\/ templateString?\n\t\t\t\tfor(var key in dojo.widget.defaultStrings) {\n\t\t\t\t\tif(dojo.lang.isUndefined(hash[key])) {\n\t\t\t\t\t\thash[key] = dojo.widget.defaultStrings[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t\/\/ FIXME: this is a lot of string munging. Can we make it faster?\n\t\t\t\tfor(var i = 0; i < matches.length; i++) {\n\t\t\t\t\tvar key = matches[i];\n\t\t\t\t\tkey = key.substring(2, key.length-1);\n\t\t\t\t\tvar kval = (key.substring(0, 5) == \"this.\") ? dojo.lang.getObjPathValue(key.substring(5), this) : hash[key];\n\t\t\t\t\tvar value;\n\t\t\t\t\tif((kval)||(dojo.lang.isString(kval))){\n\t\t\t\t\t\tvalue = (dojo.lang.isFunction(kval)) ? kval.call(this, key, this.templateString) : kval;\n\t\t\t\t\t\ttstr = tstr.replace(matches[i], value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t\/\/ otherwise, we are required to instantiate a copy of the template\n\t\t\t\t\/\/ string if one is provided.\n\t\t\t\t\n\t\t\t\t\/\/ FIXME: need to be able to distinguish here what should be done\n\t\t\t\t\/\/ or provide a generic interface across all DOM implementations\n\t\t\t\t\/\/ FIMXE: this breaks if the template has whitespace as its first \n\t\t\t\t\/\/ characters\n\t\t\t\t\/\/ node = this.createNodesFromText(this.templateString, true);\n\t\t\t\t\/\/ this.templateNode = node[0].cloneNode(true); \/\/ we're optimistic here\n\t\t\t\tthis.templateNode = this.createNodesFromText(this.templateString, true)[0];\n\t\t\t\tif(!avoidCache){\n\t\t\t\t\tts.node = this.templateNode;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif((!this.templateNode)&&(!matches)){ \n\t\t\tdojo.debug(\"DomWidget.buildFromTemplate: could not create template\");\n\t\t\treturn false;\n\t\t}else if(!matches){\n\t\t\tnode = this.templateNode.cloneNode(true);\n\t\t\tif(!node){ return false; }\n\t\t}else{\n\t\t\tnode = this.createNodesFromText(tstr, true)[0];\n\t\t}\n\n\t\t\/\/ recurse through the node, looking for, and attaching to, our\n\t\t\/\/ attachment points which should be defined on the template node.\n\n\t\tthis.domNode = node;\n\t\t\/\/ dojo.profile.start(\"attachTemplateNodes\");\n\t\tthis.attachTemplateNodes(this.domNode, this);\n\t\t\/\/ dojo.profile.end(\"attachTemplateNodes\");\n\t\t\n\t\t\/\/ relocate source contents to templated container node\n\t\t\/\/ this.containerNode must be able to receive children, or exceptions will be thrown\n\t\tif (this.isContainer && this.containerNode){\n\t\t\tvar src = this.getFragNodeRef(frag);\n\t\t\tif (src){\n\t\t\t\tdojo.dom.moveChildren(src, this.containerNode);\n\t\t\t}","this_inherits":["kval"],"this":"dojo.widget.Widget"}}},"dojo.widget.buildFromTemplate":{"_":{"meta":{"summary":"","src":"\tdojo.lang.forward(\"fillFromTemplateCache\");"}}},"dojo.widget.fillFromTemplateCache":{"_":{"meta":{"summary":"","parameters":{"obj":{"type":""},"templatePath":{"type":""},"templateString":{"type":""},"avoidCache":{"type":""}},"src":"\t\/\/ DEPRECATED: use Uri objects, not strings\n\tif (tpath && !(tpath instanceof dojo.uri.Uri)) {\n\t\ttpath = dojo.uri.dojoUri(tpath);\n\t\tdojo.deprecated(\"templatePath should be of type dojo.uri.Uri\", null, \"0.4\");\n\t}\n\n\tvar tmplts = dojo.widget._templateCache;\n\tif(!obj[\"widgetType\"]) { \/\/ don't have a real template here\n\t\tdo {\n\t\t\tvar dummyName = \"__dummyTemplate__\" + dojo.widget._templateCache.dummyCount++;\n\t\t} while(tmplts[dummyName]);\n\t\tobj.widgetType = dummyName;\n\t}\n\tvar wt = obj.widgetType;\n\n\tvar ts = tmplts[wt];\n\tif(!ts){\n\t\ttmplts[wt] = { \"string\": null, \"node\": null };\n\t\tif(avoidCache){\n\t\t\tts = {};\n\t\t}else{\n\t\t\tts = tmplts[wt];\n\t\t}\n\t}\n\tif((!obj.templateString)&&(!avoidCache)){\n\t\tobj.templateString = templateString || ts[\"string\"];\n\t}\n\tif((!obj.templateNode)&&(!avoidCache)){\n\t\tobj.templateNode = ts[\"node\"];\n\t}\n\tif((!obj.templateNode)&&(!obj.templateString)&&(tpath)){\n\t\t\/\/ fetch a text fragment and assign it to templateString\n\t\t\/\/ NOTE: we rely on blocking IO here!\n\t\tvar tstring = dojo.hostenv.getText(tpath);\n\t\tif(tstring){\n\t\t\t\/\/ strip <?xml ...?> declarations so that external SVG and XML\n\t\t\t\/\/ documents can be added to a document without worry\n\t\t\ttstring = tstring.replace(\/^\\s*<\\?xml(\\s)+version=[\\'\\\"](\\d)*.(\\d)*[\\'\\\"](\\s)*\\?>\/im, \"\");\n\t\t\tvar matches = tstring.match(\/<body[^>]*>\\s*([\\s\\S]+)\\s*<\\\/body>\/im);\n\t\t\tif(matches){\n\t\t\t\ttstring = matches[1];\n\t\t\t}\n\t\t}else{\n\t\t\ttstring = \"\";\n\t\t}\n\t\tobj.templateString = tstring;\n\t\tif(!avoidCache){\n\t\t\ttmplts[wt][\"string\"] = tstring;\n\t\t}\n\t}\n\tif((!ts[\"string\"])&&(!avoidCache)){\n\t\tts.string = obj.templateString;\n\t}"}}},"dojo.widget.attachTemplateNodes":{"_":{"meta":{"summary":"","parameters":{"rootNode":{"type":""},"targetObj":{"type":""},"events":{"type":""}},"src":"\tfunction trim(str){\n\t\treturn str.replace(\/^\\s+|\\s+$\/g, \"\");\n\t}\n\n\tif(!rootNode){ \n\t\trootNode = targetObj.domNode;\n\t}\n\n\tif(rootNode.nodeType != elementNodeType){\n\t\treturn;\n\t}\n\t\/\/ alert(events.length);\n\n\tvar nodes = rootNode.all || rootNode.getElementsByTagName(\"*\");\n\tvar _this = targetObj;\n\tfor(var x=-1; x<nodes.length; x++){\n\t\tvar baseNode = (x == -1) ? rootNode : nodes[x];\n\t\t\/\/ FIXME: is this going to have capitalization problems?  Could use getAttribute(name, 0); to get attributes case-insensitve\n\t\tvar attachPoint = [];\n\t\tfor(var y=0; y<this.attachProperties.length; y++){\n\t\t\tvar tmpAttachPoint = baseNode.getAttribute(this.attachProperties[y]);\n\t\t\tif(tmpAttachPoint){\n\t\t\t\tattachPoint = tmpAttachPoint.split(\";\");\n\t\t\t\tfor(var z=0; z<attachPoint.length; z++){\n\t\t\t\t\tif(dojo.lang.isArray(targetObj[attachPoint[z]])){\n\t\t\t\t\t\ttargetObj[attachPoint[z]].push(baseNode);\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttargetObj[attachPoint[z]]=baseNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t\/\/ continue;\n\n\t\t\/\/ FIXME: we need to put this into some kind of lookup structure\n\t\t\/\/ instead of direct assignment\n\t\tvar tmpltPoint = baseNode.getAttribute(this.templateProperty);\n\t\tif(tmpltPoint){\n\t\t\ttargetObj[tmpltPoint]=baseNode;\n\t\t}\n\n\t\tdojo.lang.forEach(dojo.widget.waiNames, function(name){\n\t\t\tvar wai = dojo.widget.wai[name];\n\t\t\tvar val = baseNode.getAttribute(wai.name);\n\t\t\tif(val){\n\t\t\t\tif(val.indexOf('-') == -1){ \n\t\t\t\t\tdojo.widget.wai.setAttr(baseNode, wai.name, \"role\", val);\n\t\t\t\t}else{\n\t\t\t\t\t\/\/ this is a state-value pair\n\t\t\t\t\tvar statePair = val.split('-');\n\t\t\t\t\tdojo.widget.wai.setAttr(baseNode, wai.name, statePair[0], statePair[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}, this);\n\n\t\tvar attachEvent = baseNode.getAttribute(this.eventAttachProperty);\n\t\tif(attachEvent){\n\t\t\t\/\/ NOTE: we want to support attributes that have the form\n\t\t\t\/\/ \"domEvent: nativeEvent; ...\"\n\t\t\tvar evts = attachEvent.split(\";\");\n\t\t\tfor(var y=0; y<evts.length; y++){\n\t\t\t\tif((!evts[y])||(!evts[y].length)){ continue; }\n\t\t\t\tvar thisFunc = null;\n\t\t\t\tvar tevt = trim(evts[y]);\n\t\t\t\tif(evts[y].indexOf(\":\") >= 0){\n\t\t\t\t\t\/\/ oh, if only JS had tuple assignment\n\t\t\t\t\tvar funcNameArr = tevt.split(\":\");\n\t\t\t\t\ttevt = trim(funcNameArr[0]);\n\t\t\t\t\tthisFunc = trim(funcNameArr[1]);\n\t\t\t\t}\n\t\t\t\tif(!thisFunc){\n\t\t\t\t\tthisFunc = tevt;\n\t\t\t\t}\n\n\t\t\t\tvar tf = function(){ \n\t\t\t\t\tvar ntf = new String(thisFunc);\n\t\t\t\t\treturn function(evt){\n\t\t\t\t\t\tif(_this[ntf]){\n\t\t\t\t\t\t\t_this[ntf](dojo.event.browser.fixEvent(evt, this));\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}();\n\t\t\t\tdojo.event.browser.addListener(baseNode, tevt, tf, false, true);\n\t\t\t\t\/\/ dojo.event.browser.addListener(baseNode, tevt, dojo.lang.hitch(_this, thisFunc));\n\t\t\t}\n\t\t}\n\n\t\tfor(var y=0; y<events.length; y++){\n\t\t\t\/\/alert(events[x]);\n\t\t\tvar evtVal = baseNode.getAttribute(events[y]);\n\t\t\tif((evtVal)&&(evtVal.length)){\n\t\t\t\tvar thisFunc = null;\n\t\t\t\tvar domEvt = events[y].substr(4); \/\/ clober the \"dojo\" prefix\n\t\t\t\tthisFunc = trim(evtVal);\n\t\t\t\tvar funcs = [thisFunc];\n\t\t\t\tif(thisFunc.indexOf(\";\")>=0){\n\t\t\t\t\tfuncs = dojo.lang.map(thisFunc.split(\";\"), trim);\n\t\t\t\t}\n\t\t\t\tfor(var z=0; z<funcs.length; z++){\n\t\t\t\t\tif(!funcs[z].length){ continue; }\n\t\t\t\t\tvar tf = function(){ \n\t\t\t\t\t\tvar ntf = new String(funcs[z]);\n\t\t\t\t\t\treturn function(evt){\n\t\t\t\t\t\t\tif(_this[ntf]){\n\t\t\t\t\t\t\t\t_this[ntf](dojo.event.browser.fixEvent(evt, this));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}();\n\t\t\t\t\tdojo.event.browser.addListener(baseNode, domEvt, tf, false, true);\n\t\t\t\t\t\/\/ dojo.event.browser.addListener(baseNode, domEvt, dojo.lang.hitch(_this, funcs[z]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar onBuild = baseNode.getAttribute(this.onBuildProperty);\n\t\tif(onBuild){\n\t\t\teval(\"var node = baseNode; var widget = targetObj; \"+onBuild);\n\t\t}\n\t}"}}},"dojo.widget.getDojoEventsFromStr":{"_":{"meta":{"summary":"","parameters":{"str":{"type":""}},"src":"\tvar evts = str ? str.match(re)||[] : [];\n\tvar ret = [];\n\tvar lem = {};\n\tfor(var x=0; x<evts.length; x++){\n\t\tif(evts[x].legth < 1){ continue; }\n\t\tvar cm = evts[x].replace(\/\\s\/, \"\");\n\t\tcm = (cm.slice(0, cm.length-1));\n\t\tif(!lem[cm]){\n\t\t\tlem[cm] = true;\n\t\t\tret.push(cm);\n\t\t}\n\t}\n\treturn ret;"}}}}}},"dojo.widget.DropdownContainer":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.widget.Menu2","dojo.event.*","dojo.html.layout","dojo.html.display","dojo.html.iframe","dojo.html.util"]},"methods":{"dojo.widget.DropdownContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"inputWidth":"","inputId":"","inputName":"","iconURL":"","iconAlt":"","inputNode":"","buttonNode":"","containerNode":"","containerToggle":"","containerToggleDuration":"","containerAnimInProgress":"","templateString":"","templateCssPath":""}}}},"dojo.widget.DropdownContainer.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tvar source = this.getFragNodeRef(frag);\n\n\t\t\tthis.popup = dojo.widget.createWidget(\"PopupContainer\", {toggle: this.containerToggle});\n\n\t\t\tthis.containerNode = this.popup.domNode;\n\n\t\t\tthis.domNode.appendChild(this.popup.domNode);\n\n\t\t\tif(this.inputId){ this.inputNode.id = this.inputId; }\n\t\t\tif(this.inputName){ this.inputNode.name = this.inputName; }\n\t\t\tthis.inputNode.style.width = this.inputWidth;\n\n\t\t\tdojo.event.connect(this.inputNode, \"onchange\", this, \"onInputChange\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["popup","containerNode","inputNode.id","inputNode.name","inputNode.style.width","popup","containerNode","inputNode.id","inputNode.name","inputNode.style.width"]}}},"dojo.widget.DropdownContainer.toggle":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tvar source = this.getFragNodeRef(frag);\n\n\t\t\tthis.popup = dojo.widget.createWidget(\"PopupContainer\", {toggle: this.containerToggle});\n\n\t\t\tthis.containerNode = this.popup.domNode;\n\n\t\t\tthis.domNode.appendChild(this.popup.domNode);\n\n\t\t\tif(this.inputId){ this.inputNode.id = this.inputId; }\n\t\t\tif(this.inputName){ this.inputNode.name = this.inputName; }\n\t\t\tthis.inputNode.style.width = this.inputWidth;\n\n\t\t\tdojo.event.connect(this.inputNode, \"onchange\", this, \"onInputChange\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DropdownContainer.onIconClick":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(!this.popup.isShowingNow){\n\t\t\t\tthis.popup.open(this.inputNode, this, this.buttonNode);\n\t\t\t}else{\n\t\t\t\tthis.popup.close();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DropdownContainer.hideContainer":{"_":{"meta":{"summary":"","src":"\t\t\tthis.popup.close();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.DropdownContainer.onInputChange":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.DropdownDatePicker":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.DropdownContainer","dojo.widget.DatePicker","dojo.event.*","dojo.html.*"]},"methods":{"dojo.widget.DropdownDatePicker":{"_":{"meta":{"summary":"","inherits":["dojo.widget.DropdownContainer"],"this_inherits":["dojo.widget.DropdownContainer"],"protovariables":{"iconURL":"","iconAlt":"","zIndex":"","datePicker":"","dateFormat":"","date":""}}}},"dojo.widget.DropdownDatePicker.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.widget.DropdownDatePicker.superclass.fillInTemplate.call(this, args, frag);\n\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\t\n\t\t\tif(args.date){ this.date = new Date(args.date); }\n\t\t\t\n\t\t\tvar dpNode = document.createElement(\"div\");\n\t\t\tthis.containerNode.appendChild(dpNode);\n\t\t\t\n\t\t\tvar dateProps = { widgetContainerId: this.widgetId };\n\t\t\tif(this.date){\n\t\t\t\tdateProps[\"date\"] = this.date;\n\t\t\t\tdateProps[\"storedDate\"] = dojo.widget.DatePicker.util.toRfcDate(this.date);\n\t\t\t\tthis.inputNode.value = dojo.date.format(this.date, this.dateFormat);\n\t\t\t}\n\t\t\tthis.datePicker = dojo.widget.createWidget(\"DatePicker\", dateProps, dpNode);\n\t\t\tdojo.event.connect(this.datePicker, \"onSetDate\", this, \"onSetDate\");\n\t\t\tthis.containerNode.style.zIndex = this.zIndex;\n\t\t\tthis.containerNode.style.backgroundColor = \"transparent\";","this_inherits":["dojo.widget.DropdownDatePicker.superclass.fillInTemplate"],"this":"dojo.widget.DropdownContainer"}}},"dojo.widget.DropdownContainer":{"_":{"meta":{"this_variables":["date","inputNode.value","datePicker","containerNode.style.zIndex","containerNode.style.backgroundColor","date","inputNode.value","datePicker","containerNode.style.zIndex","containerNode.style.backgroundColor","inputNode.value","datePicker.date"]}}},"dojo.widget.DropdownDatePicker.widgetContainerId":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.widget.DropdownDatePicker.superclass.fillInTemplate.call(this, args, frag);\n\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\t\n\t\t\tif(args.date){ this.date = new Date(args.date); }\n\t\t\t\n\t\t\tvar dpNode = document.createElement(\"div\");\n\t\t\tthis.containerNode.appendChild(dpNode);\n\t\t\t\n\t\t\tvar dateProps = { widgetContainerId: this.widgetId };\n\t\t\tif(this.date){\n\t\t\t\tdateProps[\"date\"] = this.date;\n\t\t\t\tdateProps[\"storedDate\"] = dojo.widget.DatePicker.util.toRfcDate(this.date);\n\t\t\t\tthis.inputNode.value = dojo.date.format(this.date, this.dateFormat);\n\t\t\t}\n\t\t\tthis.datePicker = dojo.widget.createWidget(\"DatePicker\", dateProps, dpNode);\n\t\t\tdojo.event.connect(this.datePicker, \"onSetDate\", this, \"onSetDate\");\n\t\t\tthis.containerNode.style.zIndex = this.zIndex;\n\t\t\tthis.containerNode.style.backgroundColor = \"transparent\";","this_inherits":["dojo.widget.DropdownDatePicker.superclass.fillInTemplate"],"this":"dojo.widget.DropdownContainer"}}},"dojo.widget.DropdownDatePicker.onSetDate":{"_":{"meta":{"summary":"","src":"\t\t\tthis.inputNode.value = dojo.date.format(this.datePicker.date, this.dateFormat);\n\t\t\tthis.hideContainer();","this":"dojo.widget.DropdownContainer"}}},"dojo.widget.DropdownDatePicker.onInputChange":{"_":{"meta":{"summary":"","src":"\t\t\tvar tmp = new Date(this.inputNode.value);\n\t\t\tthis.datePicker.date = tmp;\n\t\t\tthis.datePicker.setDate(dojo.widget.DatePicker.util.toRfcDate(tmp));\n\t\t\tthis.datePicker.initData();\n\t\t\tthis.datePicker.initUI();","this":"dojo.widget.DropdownContainer"}}}}}},"dojo.widget.Editor":{"meta":{"requires":{"common":["dojo.io.*","dojo.widget.*","dojo.widget.Toolbar","dojo.widget.RichText","dojo.widget.ColorPalette","dojo.string.extras"]},"methods":{"dojo.widget.Editor":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\tthis.contentFilters = [];\n\tthis._toolbars = [];","this_variables":["contentFilters","_toolbars","_richText","_toolbarContainer","_toolbarContainer.domNode.style.display","_toolbarContainer.domNode.style.display","_updateToolbarTimer","_updateToolbarLastRan","_richText.contentFilters"],"inherits":["dojo.widget.HtmlWidget"],"protovariables":{"widgetType":"","saveUrl":"","saveMethod":"","saveArgName":"","closeOnSave":"","items":"","formatBlockItems":"","fontNameItems":"","fontSizeItems":"","validateItems":"","_richText":"","_richTextType":"","_toolbarContainer":"","_toolbarContainerType":"","_toolbars":"","_toolbarType":"","_toolbarItemType":"","_updateToolbarLastRan":"","_updateToolbarTimer":"","_updateToolbarFrequency":"","supportedCommands":""}}}},"dojo.widget.Editor.getItemProperties":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""}},"src":"\t\tvar props = {};\n\t\tswitch(name.toLowerCase()) {\n\t\t\tcase \"bold\":\n\t\t\tcase \"italic\":\n\t\t\tcase \"underline\":\n\t\t\tcase \"strikethrough\":\n\t\t\t\tprops.toggleItem = true;\n\t\t\t\tbreak;\n\n\t\t\tcase \"justifygroup\":\n\t\t\t\tprops.defaultButton = \"justifyleft\";\n\t\t\t\tprops.preventDeselect = true;\n\t\t\t\tprops.buttonGroup = true;\n\t\t\t\tbreak;\n\n\t\t\tcase \"listgroup\":\n\t\t\t\tprops.buttonGroup = true;\n\t\t\t\tbreak;\n\n\t\t\tcase \"save\":\n\t\t\tcase \"cancel\":\n\t\t\t\tprops.label = dojo.string.capitalize(name);\n\t\t\t\tbreak;\n\n\t\t\tcase \"forecolor\":\n\t\t\tcase \"hilitecolor\":\n\t\t\t\tprops.name = name;\n\t\t\t\tprops.toggleItem = true; \/\/ FIXME: they aren't exactly toggle items\n\t\t\t\tprops.icon = this.getCommandImage(name);\n\t\t\t\tbreak;\n\n\t\t\tcase \"formatblock\":\n\t\t\t\tprops.name = \"formatBlock\";\n\t\t\t\tprops.values = this.formatBlockItems;\n\t\t\t\tbreak;\n\n\t\t\tcase \"fontname\":\n\t\t\t\tprops.name = \"fontName\";\n\t\t\t\tprops.values = this.fontNameItems;\n\n\t\t\tcase \"fontsize\":\n\t\t\t\tprops.name = \"fontSize\";\n\t\t\t\tprops.values = this.fontSizeItems;\n\t\t}\n\t\treturn props;","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.focusOnLoad":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tvar trt = dojo.widget.createWidget(this._richTextType, {\n\t\t\tfocusOnLoad: this.focusOnLoad,\n\t\t\tminHeight: this.minHeight\n\t\t}, node)\n\t\tvar _this = this;\n\t\t\/\/ this appears to fix a weird timing bug on Safari\n\t\tsetTimeout(function(){\n\t\t\t_this.setRichText(trt);\n\n\t\t\t_this.initToolbar();\n\n\t\t\t_this.fillInTemplate(args, frag);\n\t\t}, 0);","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.minHeight":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tvar trt = dojo.widget.createWidget(this._richTextType, {\n\t\t\tfocusOnLoad: this.focusOnLoad,\n\t\t\tminHeight: this.minHeight\n\t\t}, node)\n\t\tvar _this = this;\n\t\t\/\/ this appears to fix a weird timing bug on Safari\n\t\tsetTimeout(function(){\n\t\t\t_this.setRichText(trt);\n\n\t\t\t_this.initToolbar();\n\n\t\t\t_this.fillInTemplate(args, frag);\n\t\t}, 0);","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.buildRendering":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tvar trt = dojo.widget.createWidget(this._richTextType, {\n\t\t\tfocusOnLoad: this.focusOnLoad,\n\t\t\tminHeight: this.minHeight\n\t\t}, node)\n\t\tvar _this = this;\n\t\t\/\/ this appears to fix a weird timing bug on Safari\n\t\tsetTimeout(function(){\n\t\t\t_this.setRichText(trt);\n\n\t\t\t_this.initToolbar();\n\n\t\t\t_this.fillInTemplate(args, frag);\n\t\t}, 0);","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.setRichText":{"_":{"meta":{"summary":"","parameters":{"richText":{"type":""}},"src":"\t\tif(this._richText && this._richText == richText) {\n\t\t\tdojo.debug(\"Already set the richText to this richText!\");\n\t\t\treturn;\n\t\t}\n\n\t\tif(this._richText && !this._richText.isClosed) {\n\t\t\tdojo.debug(\"You are switching richTexts yet you haven't closed the current one. Losing reference!\");\n\t\t}\n\t\tthis._richText = richText;\n\t\tdojo.event.connect(this._richText, \"close\", this, \"onClose\");\n\t\tdojo.event.connect(this._richText, \"onLoad\", this, \"onLoad\");\n\t\tdojo.event.connect(this._richText, \"onDisplayChanged\", this, \"updateToolbar\");\n\t\tif(this._toolbarContainer) {\n\t\t\tthis._toolbarContainer.enable();\n\t\t\tthis.updateToolbar(true);\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.initToolbar":{"_":{"meta":{"summary":"","src":"\t\tthis._toolbarContainer = dojo.widget.createWidget(this._toolbarContainerType);\n\t\tvar tb = this.addToolbar();\n\t\tvar last = true;\n\t\tfor(var i = 0; i < this.items.length; i++) {\n\t\t\tif(this.items[i] == \"\\n\") { \/\/ new row\n\t\t\t\ttb = this.addToolbar();\n\t\t\t} else {\n\t\t\t\tif((this.items[i] == \"|\")&&(!last)){\n\t\t\t\t\tlast = true;\n\t\t\t\t}else{\n\t\t\t\t\tlast = this.addItem(this.items[i], tb);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.insertToolbar(this._toolbarContainer.domNode, this._richText.domNode);\n\t\t\/\/ alert(new Date - tic);","returns":"only create it once","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.insertToolbar":{"_":{"meta":{"summary":"","parameters":{"tbNode":{"type":""},"richTextNode":{"type":""}},"src":"\t\tdojo.html.insertBefore(tbNode, richTextNode);\n\t\t\/\/dojo.html.insertBefore(this._toolbarContainer.domNode, this._richText.domNode);","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.addToolbar":{"_":{"meta":{"summary":"","parameters":{"toolbar":{"type":""}},"src":"\t\tthis.initToolbar();\n\t\tif(!(toolbar instanceof dojo.widget.Toolbar)) {\n\t\t\ttoolbar = dojo.widget.createWidget(this._toolbarType);\n\t\t}\n\t\tthis._toolbarContainer.addChild(toolbar);\n\t\tthis._toolbars.push(toolbar);\n\t\treturn toolbar;","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.addItem":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"tb":{"type":""},"dontValidate":{"type":""}},"src":"\t\tif(!tb) { tb = this._toolbars[0]; }\n\t\tvar cmd = ((item)&&(!dojo.lang.isUndefined(item[\"getValue\"]))) ?  cmd = item[\"getValue\"](): item;\n\n\t\tvar groups = dojo.widget.Editor.itemGroups;\n\t\tif(item instanceof dojo.widget.ToolbarItem) {\n\t\t\ttb.addChild(item);\n\t\t} else if(groups[cmd]) {\n\t\t\tvar group = groups[cmd];\n\t\t\tvar worked = true;\n\t\t\tif(cmd == \"justifyGroup\" || cmd == \"listGroup\") {\n\t\t\t\tvar btnGroup = [cmd];\n\t\t\t\tfor(var i = 0 ; i < group.length; i++) {\n\t\t\t\t\tif(dontValidate || this.isSupportedCommand(group[i])) {\n\t\t\t\t\t\tbtnGroup.push(this.getCommandImage(group[i]));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tworked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(btnGroup.length){\n\t\t\t\t\t\/*\n\t\t\t\t\t\/\/ the addChild interface is assinine. Work around it.\n\t\t\t\t\tvar tprops = this.getItemProperties(cmd);\n\t\t\t\t\tvar tmpGroup = dojo.widget.createWidget(\"ToolbarButtonGroup\", tprops);\n\t\t\t\t\tdojo.debug(btnGroup);\n\t\t\t\t\tdojo.event.connect(tmpGroup, \"onClick\", this, \"_action\");\n\t\t\t\t\tdojo.event.connect(tmpGroup, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t\t*\/\n\t\t\t\t\tvar btn = tb.addChild(btnGroup, null, this.getItemProperties(cmd));\n\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_action\");\n\t\t\t\t\tdojo.event.connect(btn, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t}\n\t\t\t\treturn worked;\n\t\t\t} else {\n\t\t\t\tfor(var i = 0; i < group.length; i++) {\n\t\t\t\t\tif(!this.addItem(group[i], tb)){\n\t\t\t\t\t\tworked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn worked;\n\t\t\t}\n\t\t} else {\n\t\t\tif((!dontValidate)&&(!this.isSupportedCommand(cmd))){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(dontValidate || this.isSupportedCommand(cmd)) {\n\t\t\t\tcmd = cmd.toLowerCase();\n\t\t\t\tif(cmd == \"formatblock\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"formatBlock\",\n\t\t\t\t\t\tvalues: this.formatBlockItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tvar _this = this;\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", function(item, value) {\n\t\t\t\t\t\t_this.onAction(\"formatBlock\", value);\n\t\t\t\t\t});\n\t\t\t\t} else if(cmd == \"fontname\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"fontName\",\n\t\t\t\t\t\tvalues: this.fontNameItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", dojo.lang.hitch(this, function(item, value) {\n\t\t\t\t\t\tthis.onAction(\"fontName\", value);\n\t\t\t\t\t}));\n\t\t\t\t} else if(cmd == \"fontsize\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"fontSize\",\n\t\t\t\t\t\tvalues: this.fontSizeItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", dojo.lang.hitch(this, function(item, value) {\n\t\t\t\t\t\tthis.onAction(\"fontSize\", value);\n\t\t\t\t\t}));\n\t\t\t\t} else if(dojo.lang.inArray(cmd, [\"forecolor\", \"hilitecolor\"])) {\n\t\t\t\t\tvar btn = tb.addChild(dojo.widget.createWidget(\"ToolbarColorDialog\", this.getItemProperties(cmd)));\n\t\t\t\t\tdojo.event.connect(btn, \"onSetValue\", this, \"_setValue\");\n\t\t\t\t} else {\n\t\t\t\t\tvar btn = tb.addChild(this.getCommandImage(cmd), null, this.getItemProperties(cmd));\n\t\t\t\t\tif(cmd == \"save\"){\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_save\");\n\t\t\t\t\t}else if(cmd == \"cancel\"){\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_close\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_action\");\n\t\t\t\t\t\tdojo.event.connect(btn, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.name":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"tb":{"type":""},"dontValidate":{"type":""}},"src":"\t\tif(!tb) { tb = this._toolbars[0]; }\n\t\tvar cmd = ((item)&&(!dojo.lang.isUndefined(item[\"getValue\"]))) ?  cmd = item[\"getValue\"](): item;\n\n\t\tvar groups = dojo.widget.Editor.itemGroups;\n\t\tif(item instanceof dojo.widget.ToolbarItem) {\n\t\t\ttb.addChild(item);\n\t\t} else if(groups[cmd]) {\n\t\t\tvar group = groups[cmd];\n\t\t\tvar worked = true;\n\t\t\tif(cmd == \"justifyGroup\" || cmd == \"listGroup\") {\n\t\t\t\tvar btnGroup = [cmd];\n\t\t\t\tfor(var i = 0 ; i < group.length; i++) {\n\t\t\t\t\tif(dontValidate || this.isSupportedCommand(group[i])) {\n\t\t\t\t\t\tbtnGroup.push(this.getCommandImage(group[i]));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tworked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(btnGroup.length){\n\t\t\t\t\t\/*\n\t\t\t\t\t\/\/ the addChild interface is assinine. Work around it.\n\t\t\t\t\tvar tprops = this.getItemProperties(cmd);\n\t\t\t\t\tvar tmpGroup = dojo.widget.createWidget(\"ToolbarButtonGroup\", tprops);\n\t\t\t\t\tdojo.debug(btnGroup);\n\t\t\t\t\tdojo.event.connect(tmpGroup, \"onClick\", this, \"_action\");\n\t\t\t\t\tdojo.event.connect(tmpGroup, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t\t*\/\n\t\t\t\t\tvar btn = tb.addChild(btnGroup, null, this.getItemProperties(cmd));\n\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_action\");\n\t\t\t\t\tdojo.event.connect(btn, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t}\n\t\t\t\treturn worked;\n\t\t\t} else {\n\t\t\t\tfor(var i = 0; i < group.length; i++) {\n\t\t\t\t\tif(!this.addItem(group[i], tb)){\n\t\t\t\t\t\tworked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn worked;\n\t\t\t}\n\t\t} else {\n\t\t\tif((!dontValidate)&&(!this.isSupportedCommand(cmd))){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(dontValidate || this.isSupportedCommand(cmd)) {\n\t\t\t\tcmd = cmd.toLowerCase();\n\t\t\t\tif(cmd == \"formatblock\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"formatBlock\",\n\t\t\t\t\t\tvalues: this.formatBlockItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tvar _this = this;\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", function(item, value) {\n\t\t\t\t\t\t_this.onAction(\"formatBlock\", value);\n\t\t\t\t\t});\n\t\t\t\t} else if(cmd == \"fontname\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"fontName\",\n\t\t\t\t\t\tvalues: this.fontNameItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", dojo.lang.hitch(this, function(item, value) {\n\t\t\t\t\t\tthis.onAction(\"fontName\", value);\n\t\t\t\t\t}));\n\t\t\t\t} else if(cmd == \"fontsize\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"fontSize\",\n\t\t\t\t\t\tvalues: this.fontSizeItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", dojo.lang.hitch(this, function(item, value) {\n\t\t\t\t\t\tthis.onAction(\"fontSize\", value);\n\t\t\t\t\t}));\n\t\t\t\t} else if(dojo.lang.inArray(cmd, [\"forecolor\", \"hilitecolor\"])) {\n\t\t\t\t\tvar btn = tb.addChild(dojo.widget.createWidget(\"ToolbarColorDialog\", this.getItemProperties(cmd)));\n\t\t\t\t\tdojo.event.connect(btn, \"onSetValue\", this, \"_setValue\");\n\t\t\t\t} else {\n\t\t\t\t\tvar btn = tb.addChild(this.getCommandImage(cmd), null, this.getItemProperties(cmd));\n\t\t\t\t\tif(cmd == \"save\"){\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_save\");\n\t\t\t\t\t}else if(cmd == \"cancel\"){\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_close\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_action\");\n\t\t\t\t\t\tdojo.event.connect(btn, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.values":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""},"tb":{"type":""},"dontValidate":{"type":""}},"src":"\t\tif(!tb) { tb = this._toolbars[0]; }\n\t\tvar cmd = ((item)&&(!dojo.lang.isUndefined(item[\"getValue\"]))) ?  cmd = item[\"getValue\"](): item;\n\n\t\tvar groups = dojo.widget.Editor.itemGroups;\n\t\tif(item instanceof dojo.widget.ToolbarItem) {\n\t\t\ttb.addChild(item);\n\t\t} else if(groups[cmd]) {\n\t\t\tvar group = groups[cmd];\n\t\t\tvar worked = true;\n\t\t\tif(cmd == \"justifyGroup\" || cmd == \"listGroup\") {\n\t\t\t\tvar btnGroup = [cmd];\n\t\t\t\tfor(var i = 0 ; i < group.length; i++) {\n\t\t\t\t\tif(dontValidate || this.isSupportedCommand(group[i])) {\n\t\t\t\t\t\tbtnGroup.push(this.getCommandImage(group[i]));\n\t\t\t\t\t}else{\n\t\t\t\t\t\tworked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(btnGroup.length){\n\t\t\t\t\t\/*\n\t\t\t\t\t\/\/ the addChild interface is assinine. Work around it.\n\t\t\t\t\tvar tprops = this.getItemProperties(cmd);\n\t\t\t\t\tvar tmpGroup = dojo.widget.createWidget(\"ToolbarButtonGroup\", tprops);\n\t\t\t\t\tdojo.debug(btnGroup);\n\t\t\t\t\tdojo.event.connect(tmpGroup, \"onClick\", this, \"_action\");\n\t\t\t\t\tdojo.event.connect(tmpGroup, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t\t*\/\n\t\t\t\t\tvar btn = tb.addChild(btnGroup, null, this.getItemProperties(cmd));\n\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_action\");\n\t\t\t\t\tdojo.event.connect(btn, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t}\n\t\t\t\treturn worked;\n\t\t\t} else {\n\t\t\t\tfor(var i = 0; i < group.length; i++) {\n\t\t\t\t\tif(!this.addItem(group[i], tb)){\n\t\t\t\t\t\tworked = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn worked;\n\t\t\t}\n\t\t} else {\n\t\t\tif((!dontValidate)&&(!this.isSupportedCommand(cmd))){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(dontValidate || this.isSupportedCommand(cmd)) {\n\t\t\t\tcmd = cmd.toLowerCase();\n\t\t\t\tif(cmd == \"formatblock\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"formatBlock\",\n\t\t\t\t\t\tvalues: this.formatBlockItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tvar _this = this;\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", function(item, value) {\n\t\t\t\t\t\t_this.onAction(\"formatBlock\", value);\n\t\t\t\t\t});\n\t\t\t\t} else if(cmd == \"fontname\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"fontName\",\n\t\t\t\t\t\tvalues: this.fontNameItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", dojo.lang.hitch(this, function(item, value) {\n\t\t\t\t\t\tthis.onAction(\"fontName\", value);\n\t\t\t\t\t}));\n\t\t\t\t} else if(cmd == \"fontsize\") {\n\t\t\t\t\tvar select = dojo.widget.createWidget(\"ToolbarSelect\", {\n\t\t\t\t\t\tname: \"fontSize\",\n\t\t\t\t\t\tvalues: this.fontSizeItems\n\t\t\t\t\t});\n\t\t\t\t\ttb.addChild(select);\n\t\t\t\t\tdojo.event.connect(select, \"onSetValue\", dojo.lang.hitch(this, function(item, value) {\n\t\t\t\t\t\tthis.onAction(\"fontSize\", value);\n\t\t\t\t\t}));\n\t\t\t\t} else if(dojo.lang.inArray(cmd, [\"forecolor\", \"hilitecolor\"])) {\n\t\t\t\t\tvar btn = tb.addChild(dojo.widget.createWidget(\"ToolbarColorDialog\", this.getItemProperties(cmd)));\n\t\t\t\t\tdojo.event.connect(btn, \"onSetValue\", this, \"_setValue\");\n\t\t\t\t} else {\n\t\t\t\t\tvar btn = tb.addChild(this.getCommandImage(cmd), null, this.getItemProperties(cmd));\n\t\t\t\t\tif(cmd == \"save\"){\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_save\");\n\t\t\t\t\t}else if(cmd == \"cancel\"){\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_close\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdojo.event.connect(btn, \"onClick\", this, \"_action\");\n\t\t\t\t\t\tdojo.event.connect(btn, \"onChangeSelect\", this, \"_action\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.enableToolbar":{"_":{"meta":{"summary":"","src":"\t\tif(this._toolbarContainer) {\n\t\t\tthis._toolbarContainer.domNode.style.display = \"\";\n\t\t\tthis._toolbarContainer.enable();\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.disableToolbar":{"_":{"meta":{"summary":"","parameters":{"hide":{"type":""}},"src":"\t\tif(hide){\n\t\t\tif(this._toolbarContainer){\n\t\t\t\tthis._toolbarContainer.domNode.style.display = \"none\";\n\t\t\t}\n\t\t}else{\n\t\t\tif(this._toolbarContainer){\n\t\t\t\tthis._toolbarContainer.disable();\n\t\t\t}\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.updateToolbar":{"_":{"meta":{"summary":"","parameters":{"force":{"type":""}},"src":"\t\tif(!this._toolbarContainer) { return; }\n\n\t\t\/\/ keeps the toolbar from updating too frequently\n\t\t\/\/ TODO: generalize this functionality?\n\t\tvar diff = new Date() - this._updateToolbarLastRan;\n\t\tif(!force && this._updateToolbarLastRan && (diff < this._updateToolbarFrequency)) {\n\t\t\tclearTimeout(this._updateToolbarTimer);\n\t\t\tvar _this = this;\n\t\t\tthis._updateToolbarTimer = setTimeout(function() {\n\t\t\t\t_this.updateToolbar();\n\t\t\t}, this._updateToolbarFrequency\/2);\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis._updateToolbarLastRan = new Date();\n\t\t}\n\t\t\/\/ end frequency checker\n\n\t\tvar items = this._toolbarContainer.getItems();\n\t\tfor(var i = 0; i < items.length; i++) {\n\t\t\tvar item = items[i];\n\t\t\tif(item instanceof dojo.widget.ToolbarSeparator) { continue; }\n\t\t\tvar cmd = item._name;\n\t\t\tif (cmd == \"save\" || cmd == \"cancel\") { continue; }\n\t\t\telse if(cmd == \"justifyGroup\") {\n\t\t\t\ttry {\n\t\t\t\t\tif(!this._richText.queryCommandEnabled(\"justifyleft\")) {\n\t\t\t\t\t\titem.disable(false, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.enable(false, true);\n\t\t\t\t\t\tvar jitems = item.getItems();\n\t\t\t\t\t\tfor(var j = 0; j < jitems.length; j++) {\n\t\t\t\t\t\t\tvar name = jitems[j]._name;\n\t\t\t\t\t\t\tvar value = this._richText.queryCommandValue(name);\n\t\t\t\t\t\t\tif(typeof value == \"boolean\" && value) {\n\t\t\t\t\t\t\t\tvalue = name;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else if(typeof value == \"string\") {\n\t\t\t\t\t\t\t\tvalue = \"justify\"+value;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvalue = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!value) { value = \"justifyleft\"; } \/\/ TODO: query actual style\n\t\t\t\t\t\titem.setValue(value, false, true);\n\t\t\t\t\t}\n\t\t\t\t} catch(err) {}\n\t\t\t} else if(cmd == \"listGroup\") {\n\t\t\t\tvar litems = item.getItems();\n\t\t\t\tfor(var j = 0; j < litems.length; j++) {\n\t\t\t\t\tthis.updateItem(litems[j]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.updateItem(item);\n\t\t\t}\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.updateItem":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"\t\ttry {\n\t\t\tvar cmd = item._name;\n\t\t\tvar enabled = this._richText.queryCommandEnabled(cmd);\n\t\t\titem.setEnabled(enabled, false, true);\n\n\t\t\tvar active = this._richText.queryCommandState(cmd);\n\t\t\tif(active && cmd == \"underline\") {\n\t\t\t\t\/\/ don't activate underlining if we are on a link\n\t\t\t\tactive = !this._richText.queryCommandEnabled(\"unlink\");\n\t\t\t}\n\t\t\titem.setSelected(active, false, true);\n\t\t\treturn true;\n\t\t} catch(err) {\n\t\t\treturn false;\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.isSupportedCommand":{"_":{"meta":{"summary":"","parameters":{"cmd":{"type":""}},"src":"\t\tif(!yes) {\n\t\t\ttry {\n\t\t\t\tvar richText = this._richText || dojo.widget.HtmlRichText.prototype;\n\t\t\t\tyes = richText.queryCommandAvailable(cmd);\n\t\t\t} catch(E) {}\n\t\t}\n\t\treturn yes;","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.getCommandImage":{"_":{"meta":{"summary":"","parameters":{"cmd":{"type":""}},"src":"\t\tif(cmd == \"|\") {\n\t\t\treturn cmd;\n\t\t} else {\n\t\t\treturn dojo.uri.dojoUri(\"src\/widget\/templates\/buttons\/\" + cmd + \".gif\");\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor._action":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tthis._fire(\"onAction\", e.getValue());","this":"dojo.widget.Editor"}}},"dojo.widget.Editor._setValue":{"_":{"meta":{"summary":"","parameters":{"a":{"type":""},"b":{"type":""}},"src":"\t\tthis._fire(\"onAction\", a.getValue(), b);","this":"dojo.widget.Editor"}}},"dojo.widget.Editor._save":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif(this.saveUrl.length){\n\t\t\t\tvar content = {};\n\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\tcontent: content\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t}\n\t\t\tif(this.closeOnSave){\n\t\t\t\tthis._richText.close(e.getName().toLowerCase() == \"save\");\n\t\t\t}\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.method":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif(this.saveUrl.length){\n\t\t\t\tvar content = {};\n\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\tcontent: content\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t}\n\t\t\tif(this.closeOnSave){\n\t\t\t\tthis._richText.close(e.getName().toLowerCase() == \"save\");\n\t\t\t}\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.url":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif(this.saveUrl.length){\n\t\t\t\tvar content = {};\n\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\tcontent: content\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t}\n\t\t\tif(this.closeOnSave){\n\t\t\t\tthis._richText.close(e.getName().toLowerCase() == \"save\");\n\t\t\t}\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.content":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif(this.saveUrl.length){\n\t\t\t\tvar content = {};\n\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\tcontent: content\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t}\n\t\t\tif(this.closeOnSave){\n\t\t\t\tthis._richText.close(e.getName().toLowerCase() == \"save\");\n\t\t\t}\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor._close":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tif(!this._richText.isClosed) {\n\t\t\tthis._richText.close(e.getName().toLowerCase() == \"save\");\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.onAction":{"_":{"meta":{"summary":"","parameters":{"cmd":{"type":""},"value":{"type":""}},"src":"\t\tswitch(cmd) {\n\t\t\tcase \"createlink\":\n\t\t\t\tif(!(value = prompt(\"Please enter the URL of the link:\", \"http:\/\/\"))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"insertimage\":\n\t\t\t\tif(!(value = prompt(\"Please enter the URL of the image:\", \"http:\/\/\"))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\tthis._richText.execCommand(cmd, value);","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\/\/ dojo.event.connect(this, \"onResized\", this._richText, \"onResized\");","this":"dojo.widget.Editor"}}},"dojo.widget.Editor._fire":{"_":{"meta":{"summary":"","parameters":{"eventName":{"type":""}},"src":"\t\tif(dojo.lang.isFunction(this[eventName])) {\n\t\t\tvar args = [];\n\t\t\tif(arguments.length == 1) {\n\t\t\t\targs.push(this);\n\t\t\t} else {\n\t\t\t\tfor(var i = 1; i < arguments.length; i++) {\n\t\t\t\t\targs.push(arguments[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis[eventName].apply(this, args);\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.getHtml":{"_":{"meta":{"summary":"","src":"\t\tthis._richText.contentFilters = this._richText.contentFilters.concat(this.contentFilters);\n\t\treturn this._richText.getEditorContent();","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.getEditorContent":{"_":{"meta":{"summary":"","src":"\t\treturn this.getHtml();","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.onClose":{"_":{"meta":{"summary":"","parameters":{"save":{"type":""},"hide":{"type":""}},"src":"\t\tthis.disableToolbar(hide);\n\t\tif(save) {\n\t\t\tthis._fire(\"onSave\");\n\t\t} else {\n\t\t\tthis._fire(\"onCancel\");\n\t\t}","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.onLoad":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.onSave":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Editor"}}},"dojo.widget.Editor.onCancel":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Editor"}}}}}},"dojo.widget.Editor2":{"meta":{"requires":{"common":["dojo.io.*","dojo.html.*","dojo.html.layout","dojo.html.iframe","dojo.widget.*","dojo.widget.RichText","dojo.widget.Editor2Toolbar"]},"methods":{"dojo.widget.Editor2":{"_":{"meta":{"summary":"","inherits":["dojo.widget.RichText"],"this_inherits":["dojo.widget.RichText"],"protovariables":{"saveUrl":"","saveMethod":"","saveArgName":"","closeOnSave":"","shareToolbar":"","toolbarAlwaysVisible":"","htmlEditing":"","_inHtmlMode":"","_htmlEditNode":"","commandList":"","toolbarWidget":"","scrollInterval":"","toolbarTemplatePath":"","_scrollSetUp":"","_fixEnabled":"","_scrollThreshold":"","_handleScroll":"","_updateToolbarLastRan":"","_updateToolbarTimer":"","_updateToolbarFrequency":""}}}},"dojo.widget.Editor2.editorOnLoad":{"_":{"meta":{"summary":"","src":"\t\t\tvar toolbars = dojo.widget.byType(\"Editor2Toolbar\");\n\t\t\tif((!toolbars.length)||(!this.shareToolbar)){\n\t\t\t\tvar tbOpts = {};\n\t\t\t\tthis.toolbarTemplatePath = this.toolbarTemplatePath || \"src\/widget\/templates\/HtmlEditorToolbarOneline.html\";\n\t\t\t\ttbOpts.templatePath = dojo.uri.dojoUri(this.toolbarTemplatePath);\n\t\t\t\tif(this.toolbarWidget){\n\t\t\t\t\tthis.toolbarWidget.show();\n\t\t\t\t}else{\n\t\t\t\t\tthis.toolbarWidget = dojo.widget.createWidget(\"Editor2Toolbar\", \n\t\t\t\t\t\t\t\t\t\t\ttbOpts, this.domNode, \"before\");\n\t\t\t\t\tdojo.event.connect(this, \"close\", this.toolbarWidget, \"hide\");\n\t\t\t\t\tdojo.event.connect(this, \"destroy\", this.toolbarWidget, \"destroy\");\n\t\t\t\t\tthis.toolbarWidget.hideUnusableButtons(this);\n\t\t\t\t}\n\n\t\t\t\tif(this.object){\n\t\t\t\t\tthis.tbBgIframe = new dojo.html.BackgroundIframe(this.toolbarWidget.domNode);\n\t\t\t\t\tthis.tbBgIframe.iframe.style.height = \"30px\";\n\t\t\t\t}\n\n\t\t\t\t\/\/ need to set position fixed to wherever this thing has landed\n\t\t\t\tif(this.toolbarAlwaysVisible){\n\t\t\t\t\tvar src = document.documentElement||window;\n\t\t\t\t\tthis.scrollInterval = setInterval(dojo.lang.hitch(this, \"globalOnScrollHandler\"), 100);\n\t\t\t\t\t\/\/ dojo.event.connect(src, \"onscroll\", this, \"globalOnScrollHandler\");\n\t\t\t\t\tdojo.event.connect(\"before\", this, \"destroyRendering\", this, \"unhookScroller\");\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t\/\/ FIXME: \tshould we try harder to explicitly manage focus in\n\t\t\t\t\/\/ \t\t\torder to prevent too many editors from all querying\n\t\t\t\t\/\/ \t\t\tfor button status concurrently?\n\t\t\t\t\/\/ FIXME: \tselecting in one shared toolbar doesn't clobber\n\t\t\t\t\/\/ \t\t\tselection in the others. This is problematic.\n\t\t\t\tthis.toolbarWidget = toolbars[0];\n\t\t\t}\n\t\t\tdojo.event.topic.registerPublisher(\"Editor2.clobberFocus\", this, \"clobberFocus\");\n\t\t\tdojo.event.topic.subscribe(\"Editor2.clobberFocus\", this, \"setBlur\");\n\t\t\tdojo.event.connect(this.toolbarWidget.linkButton, \"onclick\", \n\t\t\t\tdojo.lang.hitch(this, function(){\n\t\t\t\t\tvar range;\n\t\t\t\t\tif(this.document.selection){\n\t\t\t\t\t\trange = this.document.selection.createRange().text;\n\t\t\t\t\t}else if(dojo.render.html.mozilla){\n\t\t\t\t\t\trange = this.window.getSelection().toString();\n\t\t\t\t\t}\n\t\t\t\t\tif(range.length){\n\t\t\t\t\t\tthis.toolbarWidget.exec(\"createlink\", \n\t\t\t\t\t\t\tprompt(\"Please enter the URL of the link:\", \"http:\/\/\"));\n\t\t\t\t\t}else{\n\t\t\t\t\t\talert(\"Please select text to link\");\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\n\t\t\tdojo.event.connect(this.toolbarWidget, \"formatSelectClick\", this, \"focus\");\n\t\t\tdojo.event.connect(this.toolbarWidget, \"saveClick\", this, \"save\");\t\t\t\n\t\t\tdojo.event.connect(this, \"execCommand\", this, \"focus\");\n\n\t\t\tif(this.htmlEditing){\n\t\t\t\tvar tb = this.toolbarWidget.htmltoggleButton;\n\t\t\t\tif(tb){\n\t\t\t\t\ttb.style.display = \"\";\n\t\t\t\t\tdojo.event.connect(this.toolbarWidget, \"htmltoggleClick\",\n\t\t\t\t\t\t\t\t\t\tthis, \"toggleHtmlEditing\");\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.RichText":{"_":{"meta":{"this_variables":["toolbarTemplatePath","toolbarWidget","tbBgIframe","tbBgIframe.iframe.style.height","scrollInterval","_inHtmlMode","_htmlEditNode","_htmlEditNode.style.display","_htmlEditNode.style.width","_htmlEditNode.style.height","_htmlEditNode.value","domNode.style.display","_scrollSetUp","_scrollThreshold","domNode.style.marginTop","_fixEnabled","_handleScroll","_updateToolbarTimer","_updateToolbarLastRan"]}}},"dojo.widget.Editor2.clobberFocus":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.save":{"_":{"meta":{"summary":"","src":"                    dojo.debug(\"Editor2.save\");    ","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.toggleHtmlEditing":{"_":{"meta":{"summary":"","src":"\t\t\tif(this===dojo.widget.Editor2._CurrentInstance){\n\t\t\t\tif(!this._inHtmlMode){\n\t\t\t\t\tthis._inHtmlMode = true;\n\t\t\t\t\tthis.toolbarWidget.highlightButton(\"htmltoggle\");\n\t\t\t\t\tif(!this._htmlEditNode){\n\t\t\t\t\t\tthis._htmlEditNode = document.createElement(\"textarea\");\n\t\t\t\t\t\tdojo.html.insertBefore(this._htmlEditNode, this.domNode);\n\t\t\t\t\t}\n\t\t\t\t\tthis._htmlEditNode.style.display = \"\";\n\t\t\t\t\tthis._htmlEditNode.style.width = \"100%\";\n\t\t\t\t\tthis._htmlEditNode.style.height = dojo.html.getBorderBox(this.editNode).height+\"px\";\n\t\t\t\t\tthis._htmlEditNode.value = this.editNode.innerHTML;\n\t\t\t\t\tthis.domNode.style.display = \"none\";\n\t\t\t\t}else{\n\t\t\t\t\tthis._inHtmlMode = false;\n\t\t\t\t\tthis.domNode.style.display = \"\";\n\t\t\t\t\tthis.toolbarWidget.unhighlightButton(\"htmltoggle\");\n\t\t\t\t\tdojo.lang.setTimeout(this, \"replaceEditorContent\", 1, this._htmlEditNode.value);\n\t\t\t\t\tthis._htmlEditNode.style.display = \"none\";\n\t\t\t\t\tthis.editNode.focus();\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.setFocus":{"_":{"meta":{"summary":"","src":"\t\t\tif(dojo.widget.Editor2._CurrentInstance == this){ return; }\n\n\t\t\tif(this.toolbarWidget){\n\t\t\t\tthis.clobberFocus();\n\t\t\t\t\/\/ dojo.debug(\"setFocus:\", this);\n\t\t\t\tdojo.widget.Editor2._CurrentInstance = this;\n\t\t\t\tdojo.event.connect(this.toolbarWidget, \"exec\", this, \"execCommand\");\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.setBlur":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.globalOnScrollHandler":{"_":{"meta":{"summary":"","src":"\t\t\tvar isIE = dojo.render.html.ie;\n\t\t\tif(!this._handleScroll){ return; }\n\t\t\tvar dh = dojo.html;\n\t\t\tvar tdn = this.toolbarWidget.domNode;\n\t\t\tvar db = dojo.body();\n\t\t\tvar totalHeight = dh.getMarginBox(tdn).height;\n\t\t\tif(!this._scrollSetUp){\n\t\t\t\tthis._scrollSetUp = true;\n\t\t\t\tvar editorWidth =  dh.getMarginBox(this.domNode).width; \n\t\t\t\tthis._scrollThreshold = dh.abs(tdn, false).y;\n\t\t\t\t\/\/ dojo.debug(\"threshold:\", this._scrollThreshold);\n\t\t\t\tif((isIE)&&(db)&&(dh.getStyle(db, \"background-image\")==\"none\")){\n\t\t\t\t\twith(db.style){\n\t\t\t\t\t\tbackgroundImage = \"url(\" + dojo.uri.dojoUri(\"src\/widget\/templates\/images\/blank.gif\") + \")\";\n\t\t\t\t\t\tbackgroundAttachment = \"fixed\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar scrollPos = (window[\"pageYOffset\"]) ? window[\"pageYOffset\"] : (document[\"documentElement\"]||document[\"body\"]).scrollTop;\n\n\t\t\t\/\/ FIXME: need to have top and bottom thresholds so toolbar doesn't keep scrolling past the bottom\n\t\t\tif(scrollPos > this._scrollThreshold){\n\t\t\t\t\/\/ dojo.debug(scrollPos);\n\t\t\t\tif(!this._fixEnabled){\n\t\t\t\t\tthis.domNode.style.marginTop = totalHeight+\"px\";\n\t\t\t\t\tif(isIE){\n\t\t\t\t\t\t\/\/ FIXME: should we just use setBehvior() here instead?\n\t\t\t\t\t\tvar cl = dojo.html.abs(tdn).x;\n\t\t\t\t\t\tdocument.body.appendChild(tdn);\n\t\t\t\t\t\ttdn.style.left = cl+dojo.html.getPixelValue(document.body, \"margin-left\")+\"px\";\n\t\t\t\t\t\tdojo.html.addClass(tdn, \"IEFixedToolbar\");\n\t\t\t\t\t\tif(this.object){\n\t\t\t\t\t\t\tdojo.html.addClass(this.tbBgIframe, \"IEFixedToolbar\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}else{\n\t\t\t\t\t\twith(tdn.style){\n\t\t\t\t\t\t\tposition = \"fixed\";\n\t\t\t\t\t\t\ttop = \"0px\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttdn.style.zIndex = 1000;\n\t\t\t\t\tthis._fixEnabled = true;\n\t\t\t\t}\n\t\t\t\t\/\/ if we're showing the floating toolbar, make sure that if\n\t\t\t\t\/\/ we've scrolled past the bottom of the editor that we hide\n\t\t\t\t\/\/ the toolbar for this instance of the editor.\n\n\t\t\t\t\/\/ TODO: when we get multiple editor toolbar support working\n\t\t\t\t\/\/ correctly, ensure that we check this against the scroll\n\t\t\t\t\/\/ position of the bottom-most editor instance.\n\t\t\t\tif(!dojo.render.html.safari){\n\t\t\t\t\t\/\/ safari reports a bunch of things incorrectly here\n\t\t\t\t\tvar eHeight = (this.height) ? parseInt(this.height) : ((this.object) ? dojo.html.getBorderBox(this.editNode).height : this._lastHeight);\n\t\t\t\t\tif(scrollPos > (this._scrollThreshold+eHeight)){\n\t\t\t\t\t\ttdn.style.display = \"none\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\ttdn.style.display = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}else if(this._fixEnabled){\n\t\t\t\tthis.domNode.style.marginTop = null;\n\t\t\t\twith(tdn.style){\n\t\t\t\t\tposition = \"\";\n\t\t\t\t\ttop = \"\";\n\t\t\t\t\tzIndex = \"\";\n\t\t\t\t\tif(isIE){\n\t\t\t\t\t\tmarginTop = \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(isIE){\n\t\t\t\t\tdojo.html.removeClass(tdn, \"IEFixedToolbar\");\n\t\t\t\t\tdojo.html.insertBefore(tdn, this._htmlEditNode||this.domNode);\n\t\t\t\t}\n\t\t\t\tthis._fixEnabled = false;\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.unhookScroller":{"_":{"meta":{"summary":"","src":"\t\t\tthis._handleScroll = false;\n\t\t\tclearInterval(this.scrollInterval);\n\t\t\t\/\/ var src = document[\"documentElement\"]||window;\n\t\t\t\/\/ dojo.event.disconnect(src, \"onscroll\", this, \"globalOnScrollHandler\");\n\t\t\tif(dojo.render.html.ie){\n\t\t\t\tdojo.html.removeClass(this.toolbarWidget.domNode, \"IEFixedToolbar\");\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.updateToolbar":{"_":{"meta":{"summary":"","parameters":{"force":{"type":""}},"src":"\t\t\tif((!this.isLoaded)||(!this.toolbarWidget)){ return; }\n\n\t\t\t\/\/ keeps the toolbar from updating too frequently\n\t\t\t\/\/ TODO: generalize this functionality?\n\t\t\tvar diff = new Date() - this._updateToolbarLastRan;\n\t\t\tif( (!force)&&(this._updateToolbarLastRan)&&\n\t\t\t\t((diff < this._updateToolbarFrequency)) ){\n\n\t\t\t\tclearTimeout(this._updateToolbarTimer);\n\t\t\t\tvar _this = this;\n\t\t\t\tthis._updateToolbarTimer = setTimeout(function() {\n\t\t\t\t\t_this.updateToolbar();\n\t\t\t\t}, this._updateToolbarFrequency\/2);\n\t\t\t\treturn;\n\n\t\t\t}else{\n\t\t\t\tthis._updateToolbarLastRan = new Date();\n\t\t\t}\n\t\t\t\/\/ end frequency checker\n\n\t\t\t\/\/ FIXME: SEVERE: This forEach block breaks undo on IE\n\t\t\tdojo.lang.forEach(this.commandList, \n\t\t\t\tfunction(cmd){\n\t\t\t\t\tif((cmd == \"inserthtml\") || (cmd == \"save\")){ return; }\n\t\t\t\t\ttry{\n\t\t\t\t\t\tif(this.queryCommandEnabled(cmd)){\n\t\t\t\t\t\t\tif(this.queryCommandState(cmd)){\n\t\t\t\t\t\t\t\tthis.toolbarWidget.highlightButton(cmd);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tthis.toolbarWidget.unhighlightButton(cmd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\/\/ alert(cmd+\":\"+e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis\n\t\t\t);\n\n\t\t\tvar h = dojo.render.html;\n\t\t\t\n\t\t\t\/\/ safari f's us for selection primitives\n\t\t\tif(h.safari){ return; }\n\n\t\t\tvar selectedNode = (h.ie) ? this.document.selection.createRange().parentElement() : this.window.getSelection().anchorNode;\n\t\t\t\/\/ make sure we actuall have an element\n\t\t\twhile((selectedNode)&&(selectedNode.nodeType != 1)){\n\t\t\t\tselectedNode = selectedNode.parentNode;\n\t\t\t}\n\t\t\tif(!selectedNode){ return; }\n\n\t\t\tvar formats = [\"p\", \"pre\", \"h1\", \"h2\", \"h3\", \"h4\"];\n\t\t\t\/\/ gotta run some specialized updates for the various\n\t\t\t\/\/ formatting options\n\t\t\tvar type = formats[dojo.lang.find(formats, selectedNode.nodeName.toLowerCase())];\n\t\t\twhile((selectedNode)&&(selectedNode!=this.editNode)&&(!type)){\n\t\t\t\tselectedNode = selectedNode.parentNode;\n\t\t\t\ttype = formats[dojo.lang.find(formats, selectedNode.nodeName.toLowerCase())];\n\t\t\t}\n\t\t\tif(!type){\n\t\t\t\ttype = \"\";\n\t\t\t}else{\n\t\t\t\tif(type.charAt(0)==\"h\"){\n\t\t\t\t\tthis.toolbarWidget.unhighlightButton(\"bold\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.toolbarWidget.selectFormat(type);","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.updateItem":{"_":{"meta":{"summary":"","parameters":{"item":{"type":""}},"src":"\t\t\ttry {\n\t\t\t\tvar cmd = item._name;\n\t\t\t\tvar enabled = this._richText.queryCommandEnabled(cmd);\n\t\t\t\titem.setEnabled(enabled, false, true);\n\n\t\t\t\tvar active = this._richText.queryCommandState(cmd);\n\t\t\t\tif(active && cmd == \"underline\") {\n\t\t\t\t\t\/\/ don't activate underlining if we are on a link\n\t\t\t\t\tactive = !this._richText.queryCommandEnabled(\"unlink\");\n\t\t\t\t}\n\t\t\t\titem.setSelected(active, false, true);\n\t\t\t\treturn true;\n\t\t\t} catch(err) {\n\t\t\t\treturn false;\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2._save":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\t\tdojo.debug(\"save attempt\");\n\t\t\t\tif(this.saveUrl.length){\n\t\t\t\t\tvar content = {};\n\t\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\t\tdojo.io.bind({\n\t\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\t\tcontent: content\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t\t}\n\t\t\t\tif(this.closeOnSave){\n\t\t\t\t\tthis.close(e.getName().toLowerCase() == \"save\");\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.method":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\t\tdojo.debug(\"save attempt\");\n\t\t\t\tif(this.saveUrl.length){\n\t\t\t\t\tvar content = {};\n\t\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\t\tdojo.io.bind({\n\t\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\t\tcontent: content\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t\t}\n\t\t\t\tif(this.closeOnSave){\n\t\t\t\t\tthis.close(e.getName().toLowerCase() == \"save\");\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.url":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\t\tdojo.debug(\"save attempt\");\n\t\t\t\tif(this.saveUrl.length){\n\t\t\t\t\tvar content = {};\n\t\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\t\tdojo.io.bind({\n\t\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\t\tcontent: content\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t\t}\n\t\t\t\tif(this.closeOnSave){\n\t\t\t\t\tthis.close(e.getName().toLowerCase() == \"save\");\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.RichText"}}},"dojo.widget.Editor2.content":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\t\tdojo.debug(\"save attempt\");\n\t\t\t\tif(this.saveUrl.length){\n\t\t\t\t\tvar content = {};\n\t\t\t\t\tcontent[this.saveArgName] = this.getHtml();\n\t\t\t\t\tdojo.io.bind({\n\t\t\t\t\t\tmethod: this.saveMethod,\n\t\t\t\t\t\turl: this.saveUrl,\n\t\t\t\t\t\tcontent: content\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tdojo.debug(\"please set a saveUrl for the editor\");\n\t\t\t\t}\n\t\t\t\tif(this.closeOnSave){\n\t\t\t\t\tthis.close(e.getName().toLowerCase() == \"save\");\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.RichText"}}}}}},"dojo.widget.Editor2Toolbar":{"meta":{"requires":{"common":["dojo.lang.*","dojo.widget.*","dojo.event.*","dojo.html.layout","dojo.html.display","dojo.widget.RichText","dojo.widget.ColorPalette"]},"methods":{"dojo.widget.Editor2Toolbar":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"commandList":"","templatePath":"","templateCssPath":"","forecolorPalette":"","hilitecolorPalette":"","wikiwordButton":"","htmltoggleButton":"","insertimageButton":"","styleDropdownButton":"","styleDropdownContainer":"","copyButton":"","boldButton":"","italicButton":"","underlineButton":"","justifycenterButton":"","justifyleftButton":"","justifyfullButton":"","justifyrightButton":"","pasteButton":"","undoButton":"","redoButton":"","linkButton":"","insertunorderedlistButton":"","insertorderedlistButton":"","forecolorButton":"","forecolorDropDown":"","hilitecolorButton":"","hilitecolorDropDown":"","formatSelectBox":"","inserthorizontalruleButton":"","strikethroughButton":"","clickInterceptDiv":"","oneLineTr":"","saveButton":""}}}},"dojo.widget.Editor2Toolbar.buttonMouseOver":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.buttonMouseOut":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.preventSelect":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"                              if(dojo.render.html.safari){ e.preventDefault(); }    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.wikiwordClick":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.insertimageClick":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.htmltoggleClick":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.saveClick":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.styleDropdownClick":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.debug(\"styleDropdownClick:\", this.styleDropdownContainer);\n\t\t\tdojo.html.toggleShowing(this.styleDropdownContainer);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.Click":{"_":{"meta":{"summary":"","src":"                            this.exec(\"outdent\");    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.linkClick":{"_":{"meta":{"summary":"","src":"\t\t\t\/\/ FIXME: we need to alert the user if they haven't selected any text\n\t\t\t\/\/ this.exec(\t\"createlink\", \n\t\t\t\/\/ \t\t\tprompt(\"Please enter the URL of the link:\", \"http:\/\/\"));","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.formatSelectClick":{"_":{"meta":{"summary":"","src":"\t\t\tvar sv = this.formatSelectBox.value.toLowerCase();\n\t\t\tthis.exec(\"formatblock\", sv);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.normalTextClick":{"_":{"meta":{"summary":"","src":"                               this.exec(\"formatblock\", \"p\");    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.TextClick":{"_":{"meta":{"summary":"","src":"                           this.exec(\"formatblock\", \"h4\");    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.hideAllDropDowns":{"_":{"meta":{"summary":"","src":"\t\t\tthis.domNode.style.height = \"\";\n\t\t\tdojo.lang.forEach(dojo.widget.byType(\"Editor2Toolbar\"), function(tb){\n\t\t\t\ttry{\n\t\t\t\t\tdojo.html.hide(tb.forecolorDropDown);\n\t\t\t\t\tdojo.html.hide(tb.hilitecolorDropDown);\n\t\t\t\t\tdojo.html.hide(tb.styleDropdownContainer);\n\t\t\t\t\tif(tb.clickInterceptDiv){\n\t\t\t\t\t\tdojo.html.hide(tb.clickInterceptDiv);\n\t\t\t\t\t}\n\t\t\t\t}catch(e){}\n\t\t\t\tif(dojo.render.html.ie){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tdojo.html.hide(tb.forecolorPalette.bgIframe);\n\t\t\t\t\t}catch(e){}\n\t\t\t\t\ttry{\n\t\t\t\t\t\tdojo.html.hide(tb.hilitecolorPalette.bgIframe);\n\t\t\t\t\t}catch(e){}\n\t\t\t\t}\n\t\t\t});","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["domNode.style.height","clickInterceptDiv"]}}},"dojo.widget.Editor2Toolbar.selectFormat":{"_":{"meta":{"summary":"","parameters":{"format":{"type":""}},"src":"\t\t\tif(this.formatSelectBox) {\n\t\t\t\tdojo.lang.forEach(this.formatSelectBox.options, function(item){\n\t\t\t\t\tif(item.value.toLowerCase() == format.toLowerCase()){\n\t\t\t\t\t\t\/\/ FIXME: SEVERE: setting selected on this item breaks the undo stack on IE\n\t\t\t\t\t\titem.selected = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.forecolorClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis.colorClick(e, \"forecolor\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.hilitecolorClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis.colorClick(e, \"hilitecolor\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.colorClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""},"type":{"type":""}},"src":"\t\t\tvar h = dojo.render.html;\n\t\t\tthis.hideAllDropDowns();\n\t\t\t\/\/ FIXME: if we've been \"popped out\", we need to set the height of the toolbar.\n\t\t\te.stopPropagation();\n\t\t\tvar dd = this[type+\"DropDown\"];\n\t\t\tvar pal = this[type+\"Palette\"];\n\t\t\tdojo.html.toggleShowing(dd);\n\t\t\tif(!pal){\n\t\t\t\tpal = this[type+\"Palette\"] = dojo.widget.createWidget(\"ColorPalette\", {}, dd, \"first\");\n\t\t\t\tvar fcp = pal.domNode;\n\t\t\t\tvar mb = dojo.html.getMarginBox(fcp);\n\t\t\t\twith(dd.style){\n\t\t\t\t\twidth = mb.width + \"px\";\n\t\t\t\t\theight = mb.height + \"px\";\n\t\t\t\t\tzIndex = 1002;\n\t\t\t\t\tposition = \"absolute\";\n\t\t\t\t}\n\n\t\t\t\tdojo.event.connect(\t\"after\",\n\t\t\t\t\t\t\t\t\tpal, \"onColorSelect\",\n\t\t\t\t\t\t\t\t\tthis, \"exec\",\n\t\t\t\t\t\t\t\t\tfunction(mi){ mi.args.unshift(type); return mi.proceed(); }\n\t\t\t\t);\n\n\t\t\t\tdojo.event.connect(\t\"after\",\n\t\t\t\t\t\t\t\t\tpal, \"onColorSelect\",\n\t\t\t\t\t\t\t\t\tdojo.html, \"toggleShowing\",\n\t\t\t\t\t\t\t\t\tthis, function(mi){ mi.args.unshift(dd); return mi.proceed(); }\n\t\t\t\t);\n\n\t\t\t\tvar cid = this.clickInterceptDiv;\n\t\t\t\tif(!cid){\n\t\t\t\t\tcid = this.clickInterceptDiv = document.createElement(\"div\");\n\t\t\t\t\tdocument.body.appendChild(cid);\n\t\t\t\t\twith(cid.style){\n\t\t\t\t\t\tbackgroundColor = \"transparent\";\n\t\t\t\t\t\ttop = left = \"0px\";\n\t\t\t\t\t\theight = width = \"100%\";\n\t\t\t\t\t\tposition = \"absolute\";\n\t\t\t\t\t\tborder = \"none\";\n\t\t\t\t\t\tdisplay = \"none\";\n\t\t\t\t\t\tzIndex = 1001;\n\t\t\t\t\t}\n\t\t\t\t\tdojo.event.connect(cid, \"onclick\", function(){ cid.style.display = \"none\"; });\n\t\t\t\t}\n\t\t\t\tdojo.event.connect(pal, \"onColorSelect\", function(){ cid.style.display = \"none\"; });\n\n\t\t\t\tdojo.event.kwConnect({\n\t\t\t\t\tsrcObj:\t\tdocument.body, \n\t\t\t\t\tsrcFunc:\t\"onclick\", \n\t\t\t\t\ttargetObj:\tthis,\n\t\t\t\t\ttargetFunc:\t\"hideAllDropDowns\",\n\t\t\t\t\tonce:\t\ttrue\n\t\t\t\t});\n\t\t\t\tdocument.body.appendChild(dd);\n\t\t\t}\n\t\t\tdojo.html.toggleShowing(this.clickInterceptDiv);\n\t\t\tvar pos = dojo.html.abs(this[type+\"Button\"]);\n\t\t\tdojo.html.placeOnScreenPoint(dd, pos.x, pos.y, 0, false);\n\t\t\tif(pal.bgIframe){\n\t\t\t\tvar mb = dojo.html.getMarginBox(dd);\n\t\t\t\twith(pal.bgIframe.style){\n\t\t\t\t\tdisplay = \"block\";\n\t\t\t\t\tleft = dd.style.left;\n\t\t\t\t\ttop = dd.style.top;\n\t\t\t\t\twidth = mb.width+\"px\";\n\t\t\t\t\theight = mb.height+\"px\";\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.srcObj":{"_":{"meta":{"summary":"","src":"\t\t\tif(!dojo.render.html.ie){\n\t\t\t\t\/\/ apparently this causes leakage on IE!\n\t\t\t\tdojo.event.kwDisconnect({\n\t\t\t\t\tsrcObj:\t\tdocument.body, \n\t\t\t\t\tsrcFunc:\t\"onclick\", \n\t\t\t\t\ttargetObj:\tthis,\n\t\t\t\t\ttargetFunc:\t\"hideAllDropDowns\",\n\t\t\t\t\tonce:\t\ttrue\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.srcFunc":{"_":{"meta":{"summary":"","src":"\t\t\tif(!dojo.render.html.ie){\n\t\t\t\t\/\/ apparently this causes leakage on IE!\n\t\t\t\tdojo.event.kwDisconnect({\n\t\t\t\t\tsrcObj:\t\tdocument.body, \n\t\t\t\t\tsrcFunc:\t\"onclick\", \n\t\t\t\t\ttargetObj:\tthis,\n\t\t\t\t\ttargetFunc:\t\"hideAllDropDowns\",\n\t\t\t\t\tonce:\t\ttrue\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.targetObj":{"_":{"meta":{"summary":"","src":"\t\t\tif(!dojo.render.html.ie){\n\t\t\t\t\/\/ apparently this causes leakage on IE!\n\t\t\t\tdojo.event.kwDisconnect({\n\t\t\t\t\tsrcObj:\t\tdocument.body, \n\t\t\t\t\tsrcFunc:\t\"onclick\", \n\t\t\t\t\ttargetObj:\tthis,\n\t\t\t\t\ttargetFunc:\t\"hideAllDropDowns\",\n\t\t\t\t\tonce:\t\ttrue\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.targetFunc":{"_":{"meta":{"summary":"","src":"\t\t\tif(!dojo.render.html.ie){\n\t\t\t\t\/\/ apparently this causes leakage on IE!\n\t\t\t\tdojo.event.kwDisconnect({\n\t\t\t\t\tsrcObj:\t\tdocument.body, \n\t\t\t\t\tsrcFunc:\t\"onclick\", \n\t\t\t\t\ttargetObj:\tthis,\n\t\t\t\t\ttargetFunc:\t\"hideAllDropDowns\",\n\t\t\t\t\tonce:\t\ttrue\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.once":{"_":{"meta":{"summary":"","src":"\t\t\tif(!dojo.render.html.ie){\n\t\t\t\t\/\/ apparently this causes leakage on IE!\n\t\t\t\tdojo.event.kwDisconnect({\n\t\t\t\t\tsrcObj:\t\tdocument.body, \n\t\t\t\t\tsrcFunc:\t\"onclick\", \n\t\t\t\t\ttargetObj:\tthis,\n\t\t\t\t\ttargetFunc:\t\"hideAllDropDowns\",\n\t\t\t\t\tonce:\t\ttrue\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.uninitialize":{"_":{"meta":{"summary":"","src":"\t\t\tif(!dojo.render.html.ie){\n\t\t\t\t\/\/ apparently this causes leakage on IE!\n\t\t\t\tdojo.event.kwDisconnect({\n\t\t\t\t\tsrcObj:\t\tdocument.body, \n\t\t\t\t\tsrcFunc:\t\"onclick\", \n\t\t\t\t\ttargetObj:\tthis,\n\t\t\t\t\ttargetFunc:\t\"hideAllDropDowns\",\n\t\t\t\t\tonce:\t\ttrue\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.exec":{"_":{"meta":{"summary":"","parameters":{"what":{"type":""},"arg":{"type":""}},"src":"                             \/* dojo.debug(what, new Date()); *\/    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.hideUnusableButtons":{"_":{"meta":{"summary":"","parameters":{"obj":{"type":""}},"src":"\t\t\tvar op = obj||dojo.widget.RichText.prototype;\n\t\t\tdojo.lang.forEach(this.commandList,\n\t\t\t\tfunction(cmd){\n\t\t\t\t\tif(this[cmd+\"Button\"]){\n\t\t\t\t\t\tvar cb = this[cmd+\"Button\"];\n\t\t\t\t\t\tif(!op.queryCommandAvailable(cmd)){\n\t\t\t\t\t\t\tcb.style.display = \"none\";\n\t\t\t\t\t\t\tcb.parentNode.style.display = \"none\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tthis);\n\t\t\t\tif(this.oneLineTr){\n\t\t\t\t\tvar lastVisibleIsSpacer = false;\n\t\t\t\t\tvar lastVisible = false;\n\t\t\t\t\tvar tds = this.oneLineTr.getElementsByTagName(\"td\");\n\t\t\t\t\tdojo.lang.forEach(tds, function(td){\n\t\t\t\t\t\tif(td.getAttribute(\"isSpacer\")){\n\t\t\t\t\t\t\tif(td.style.display != \"none\"){\n\t\t\t\t\t\t\t\tif(lastVisibleIsSpacer){\n\t\t\t\t\t\t\t\t\ttd.style.display = \"none\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlastVisibleIsSpacer = true;\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tlastVisible = td;\n\t\t\t\t\t\t\t\tlastVisibleIsSpacer = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tif(td.style.display != \"none\"){\n\t\t\t\t\t\t\t\tlastVisible = td;\n\t\t\t\t\t\t\t\tlastVisibleIsSpacer = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.highlightButton":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""}},"src":"\t\t\tvar bn = name+\"Button\";\n\t\t\tif(this[bn]){\n\t\t\t\twith(this[bn].style){\n\t\t\t\t\tbackgroundColor = \"White\";\n\t\t\t\t\tborder = \"1px solid #aeaeab\";\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Editor2Toolbar.unhighlightButton":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""}},"src":"\t\t\tvar bn = name+\"Button\";\n\t\t\tif(this[bn]){\n\t\t\t\t\/\/ dojo.debug(\"unhighlighting:\", name);\n\t\t\t\twith(this[bn].style){\n\t\t\t\t\tbackgroundColor = \"\";\n\t\t\t\t\tborder = \"\";\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.FilteringTable":{"meta":{"requires":{"common":["dojo.date","dojo.json","dojo.data.SimpleStore","dojo.html.*","dojo.html.util","dojo.html.style","dojo.html.selection","dojo.event.*","dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.FilteringTable":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.FilteringTable.index":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField","store","valueField","multiple","maxSelect","maxSortable","minRows","defaultDateFormat","isInitialized","columns","sortInformation","headClass","tbodyClass","headerClass","headerUpClass","headerDownClass","rowClass","rowAlternateClass","rowSelectedClass","columnSelected","sortInformation.length","columns.length","store.keyField"]}}},"dojo.widget.FilteringTable.direction":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.isContainer":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.templatePath":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.templateCssPath":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.getTypeFromString":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.getByRow":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.getDataByRow":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.getSelectedData":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.isSelected":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.isValueSelected":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.isIndexSelected":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.isRowSelected":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.reset":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.resetSelections":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.onReset":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.select":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.selectByValue":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.selectByIndex":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.selectByRow":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.onDataSelect":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.toggleSelection":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.toggleSelectionByValue":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.toggleSelectionByIndex":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.toggleSelectionByRow":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.onDataToggle":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable._meta":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.field":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.format":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.filterer":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.noSort":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.sortType":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.dataType":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.sortFunction":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.filterFunction":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.label":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.align":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.valign":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.getField":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.getType":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.createMetaData":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.parseMetadata":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.parseData":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.onSelect":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.onSort":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.this.headerDownClass":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.onFilter":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable._defaultFilter":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.setFilter":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.setFilterByIndex":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.clearFilter":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.clearFilterByIndex":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.clearFilters":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.applyFilters":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.createSorter":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.createRow":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.prefill":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.init":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.render":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.renderSelections":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.renderFilter":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.initialize":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.FilteringTable.postCreate":{"_":{"meta":{"summary":"","src":"\t\tthis.store=new dojo.data.SimpleStore();\n\n\t\t\/\/declare per instance changeable widget properties\n\t\tthis.valueField=\"Id\";\n\t\tthis.multiple=false;\n\t\tthis.maxSelect=0;\n\t\tthis.maxSortable=1;  \/\/ how many columns can be sorted at once.\n\t\tthis.minRows=0;\n\t\tthis.defaultDateFormat = \"%D\";\n\t\tthis.isInitialized=false;\n\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[{\n\t\t\tindex:0,\n\t\t\tdirection:0\n\t\t}];\n\n\t\t\/\/ CSS definitions\n\t\tthis.headClass=\"\";\n\t\tthis.tbodyClass=\"\";\n\t\tthis.headerClass=\"\";\n\t\tthis.headerUpClass=\"selectedUp\";\n\t\tthis.headerDownClass=\"selectedDown\";\n\t\tthis.rowClass=\"\";\n\t\tthis.rowAlternateClass=\"alt\";\n\t\tthis.rowSelectedClass=\"selected\";\n\t\tthis.columnSelected=\"sorted-column\";\n\t},\n\n\t\/\/\tdojo widget properties\n\tisContainer: false,\n\ttemplatePath: null,\n\ttemplateCssPath: null,\n\n\t\/\/\tmethods.\n\tgetTypeFromString: function(s){\n\t\tvar parts = s.split(\".\"), i = 0, obj = dj_global; \n\t\tdo{ \n\t\t\tobj = obj[parts[i++]]; \n\t\t} while (i < parts.length && obj); \n\t\treturn (obj != dj_global) ? obj : null;\n\t},\n\n\t\/\/\tcustom data access.\n\tgetByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getByKey(dojo.html.getAttribute(row, \"value\")); \n\t},\n\tgetDataByRow: function(\/*HTMLTableRow*\/row){\n\t\treturn this.store.getDataByKey(dojo.html.getAttribute(row, \"value\"));\n\t},\n\n\tgetSelectedData: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\treturns all objects that are selected.\n\t\tvar data=this.store.get();\n\t\tvar a=[];\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].isSelected){\n\t\t\t\ta.push(data[i].src);\n\t\t\t}\n\t\t}\n\t\tif(this.multiple){\n\t\t\treturn a;\t\t\/\/\tarray\n\t\t} else {\n\t\t\treturn a[0];\t\/\/\tobject\n\t\t}\n\t},\n\t\n\tisSelected: function(\/* object *\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\treturn true;\t\/\/\tboolean\n\t\t\t}\n\t\t}\n\t\treturn false;\t\/\/\tboolean\n\t},\n\tisValueSelected: function(\/* string *\/val){\n\t\tvar v = this.store.getByKey(val);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisIndexSelected: function(\/* number *\/idx){\n\t\tvar v = this.store.getByIndex(idx);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\tisRowSelected: function(\/* HTMLTableRow *\/row){\n\t\tvar v = this.getByRow(row);\n\t\tif(v){\n\t\t\treturn v.isSelected;\n\t\t}\n\t\treturn false;\n\t},\n\n\treset: function(){\n\t\tthis.store.clearData();\n\t\tthis.columns = [];\n\t\tthis.sortInformation = [ {index:0, direction:0} ];\n\t\tthis.resetSelections();\n\t\tthis.isInitialized = false;\n\t\tthis.onReset();\n\t},\n\tresetSelections: function(){\n\t\tthis.store.forEach(function(element){\n\t\t\telement.isSelected = false;\n\t\t});\n\t},\n\tonReset:function(){ },\n\n\t\/\/\tselection and toggle functions\n\tselect: function(\/*object*\/ obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataSelect(obj);\n\t},\n\tselectByValue: function(\/*string*\/ val){\n\t\tthis.select(this.getDataByKey(val));\n\t},\n\tselectByIndex: function(\/*number*\/ idx){\n\t\tthis.select(this.getDataByIndex(idx));\n\t},\n\tselectByRow: function(\/*HTMLTableRow*\/ row){\n\t\tthis.select(this.getDataByRow(row));\n\t},\n\tonDataSelect: function(\/* object *\/obj){ },\n\n\ttoggleSelection: function(\/*object*\/obj){\n\t\tvar data = this.store.get();\n\t\tfor(var i=0; i<data.length; i++){\n\t\t\tif(data[i].src == obj){\n\t\t\t\tdata[i].isSelected = !data[i].isSelected;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.onDataToggle(obj);\n\t},\n\ttoggleSelectionByValue: function(\/*string*\/val){\n\t\tthis.toggleSelection(this.getDataByKey(val));\n\t},\n\ttoggleSelectionByIndex: function(\/*number*\/idx){\n\t\tthis.toggleSelection(this.getDataByIndex(idx));\n\t},\n\ttoggleSelectionByRow: function(\/*HTMLTableRow*\/row){\n\t\tthis.toggleSelection(this.getDataByRow(row));\n\t},\n\tonDataToggle: function(\/* object *\/obj){ },\n\n\t\/\/\tparsing functions, from HTML to metadata\/SimpleStore\n\t_meta:{\n\t\tfield:null,\n\t\tformat:null,\n\t\tfilterer:null,\n\t\tnoSort:false,\n\t\tsortType:\"String\",\n\t\tdataType:String,\n\t\tsortFunction:null,\n\t\tfilterFunction:null,\n\t\tlabel:null,\n\t\talign:\"left\",\n\t\tvalign:\"middle\",\n\t\tgetField:function(){ \n\t\t\treturn this.field || this.label; \n\t\t},\n\t\tgetType:function(){ \n\t\t\treturn this.dataType; \n\t\t}\n\t},\n\tcreateMetaData: function(\/* object *\/obj){\n\t\t\/\/\tsummary\n\t\t\/\/\tTake a JSON-type structure and make it into a ducktyped metadata object.\n\t\tfor(var p in this._meta){\n\t\t\t\/\/\trudimentary mixin\n\t\t\tif(!obj[p]){\n\t\t\t\tobj[p] = this._meta[p];\n\t\t\t}\n\t\t}\n\t\tif(!obj.label){\n\t\t\tobj.label=obj.field;\n\t\t}\n\t\tif(!obj.filterFunction){\n\t\t\tobj.filterFunction=this._defaultFilter;\n\t\t}\n\t\treturn obj;\t\/\/\tobject\n\t},\n\tparseMetadata: function(\/* HTMLTableHead *\/head){\n\t\tthis.columns=[];\n\t\tthis.sortInformation=[];\n\t\tvar row = head.getElementsByTagName(\"tr\")[0];\n\t\tvar cells = row.getElementsByTagName(\"td\");\n\t\tif (cells.length == 0){\n\t\t\tcells = row.getElementsByTagName(\"th\");\n\t\t}\n\t\tfor(var i=0; i<cells.length; i++){\n\t\t\tvar o = this.createMetaData({ });\n\t\t\t\n\t\t\t\/\/\tpresentation attributes\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"align\")){\n\t\t\t\to.align = dojo.html.getAttribute(cells[i],\"align\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"valign\")){\n\t\t\t\to.valign = dojo.html.getAttribute(cells[i],\"valign\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"nosort\")){\n\t\t\t\to.noSort = (dojo.html.getAttribute(cells[i],\"nosort\")==\"true\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sortusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"sortusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.sortFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"field\")){\n\t\t\t\to.field=dojo.html.getAttribute(cells[i],\"field\");\n\t\t\t} else {\n\t\t\t\to.field=\"field\"+i;\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"format\")){\n\t\t\t\to.format=dojo.html.getAttribute(cells[i],\"format\");\n\t\t\t}\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"dataType\")){\n\t\t\t\tvar sortType = dojo.html.getAttribute(cells[i],\"dataType\");\n\t\t\t\t\/\/\tFIXME: switch this to let sorting happen based on dojo.html.renderedTextContent\n\t\t\t\tif(sortType.toLowerCase()==\"html\" || sortType.toLowerCase()==\"markup\"){\n\t\t\t\t\to.sortType = \"__markup__\";\t\/\/\talways convert to \"__markup__\"\n\t\t\t\t\to.noSort = true;\n\t\t\t\t}else{\n\t\t\t\t\tvar type = this.getTypeFromString(sortType);\n\t\t\t\t\tif(type){\n\t\t\t\t\t\to.sortType = sortType;\n\t\t\t\t\t\to.dataType = type;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\to.label = dojo.html.renderedTextContent(cells[i]);\n\n\t\t\t\/\/\tTODO: set up filtering mechanisms here.\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"filterusing\")){\n\t\t\t\tvar trans = dojo.html.getAttribute(cells[i],\"filterusing\");\n\t\t\t\tvar f = this.getTypeFromString(trans);\n\t\t\t\tif (f != null && f != window && typeof(f)==\"function\"){\n\t\t\t\t\to.filterFunction=f;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tthis.columns.push(o);\n\n\t\t\t\/\/\tcheck to see if there's a default sort, and set the properties necessary\n\t\t\tif(dojo.html.hasAttribute(cells[i], \"sort\")){\n\t\t\t\tvar info = {\n\t\t\t\t\tindex:i,\n\t\t\t\t\tdirection:0\n\t\t\t\t};\n\t\t\t\tvar dir = dojo.html.getAttribute(cells[i], \"sort\");\n\t\t\t\tif(!isNaN(parseInt(dir))){\n\t\t\t\t\tdir = parseInt(dir);\n\t\t\t\t\tinfo.direction = (dir != 0) ? 1 : 0;\n\t\t\t\t}else{\n\t\t\t\t\tinfo.direction = (dir.toLowerCase() == \"desc\") ? 1 : 0;\n\t\t\t\t}\n\t\t\t\tthis.sortInformation.push(info);\n\t\t\t}\n\t\t}\n\t\tif(this.sortInformation.length == 0){\n\t\t\tthis.sortInformation.push({\n\t\t\t\tindex:0,\n\t\t\t\tdirection:0\n\t\t\t});\n\t\t} else if (this.sortInformation.length > this.maxSortable){\n\t\t\tthis.sortInformation.length = this.maxSortable;\n\t\t}\n\t},\n\tparseData: function(\/* HTMLTableBody *\/body){\n\t\t\/\/\tsummary\n\t\t\/\/\tParse HTML data into native JSON structure for the store.\n\t\tvar rows = body.rows;\n\t\tif(rows.length == 0 && this.columns.length == 0) return;\t\/\/\tthere's no data, ignore me.\n\n\t\t\/\/\tcreate a data constructor based on what we've got for the fields.\n\t\tvar self=this;\n\t\tvar ctor=function(row){\n\t\t\tvar obj = {};\n\t\t\tfor(var i=0; i<self.columns.length; i++){\n\t\t\t\tvar o = obj;\n\t\t\t\tvar data = row.cells[i].innerHTML;\n\t\t\t\tvar p = self.columns[i].getField();\n\t\t\t\tif(p.indexOf(\".\") > -1){\n\t\t\t\t\tp = p.split(\".\");\n\t\t\t\t\twhile(p.length>1){\n\t\t\t\t\t\tvar pr = p.shift();\n\t\t\t\t\t\to[pr] = {};\n\t\t\t\t\t\to = o[pr];\n\t\t\t\t\t}\n\t\t\t\t\tp = p[0];\n\t\t\t\t}\n\n\t\t\t\tif(self.columns[i].sortType==\"__markup__\") o[p] = String(data);\n\t\t\t\telse{\n\t\t\t\t\tvar type = self.columns[i].getType();\n\t\t\t\t\tif(data){\n\t\t\t\t\t\to[p] = new type(data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\to[p] = new type();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t};\n\n\t\t\/\/\twe have initialization data, let's parse it.\n\t\tvar arr=[];\n\t\tvar selected=[];\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row = rows[i];\n\t\t\tvar o = ctor(row);\t\/\/ yay.  magic.  love.  sigh.\n\t\t\to[this.valueField] = dojo.html.getAttribute(row,\"value\");\n\t\t\tif(dojo.html.getAttribute(row,\"selected\")==\"true\"){\n\t\t\t\tselected.push(o);\n\t\t\t}\n\t\t\tarr.push(o);\n\t\t}\n\t\tthis.store.setData(arr);\n\t\t\n\t\tfor(var i=0; i<selected.length; i++){\n\t\t\tthis.select(selected[i]);\n\t\t}\n\t\tthis.renderSelections();\n\n\t\t\/\/\tsay that we are already initialized so that we don't kill anything\n\t\tthis.isInitialized=true;\n\t},\n\n\t\/\/\tstandard events\n\tonSelect: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tHandles the onclick event of any element.\n\t\tvar row = dojo.html.getParentByType(e.target,\"tr\");\n\t\tvar body = dojo.html.getParentByType(row,\"tbody\");\n\t\tif(this.multiple){\n\t\t\tif(e.shiftKey){\n\t\t\t\tvar startRow;\n\t\t\t\tvar rows=body.rows;\n\t\t\t\tfor(var i=0;i<rows.length;i++){\n\t\t\t\t\tif(rows[i]==row){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\tstartRow=rows[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!startRow){\n\t\t\t\t\tstartRow = row;\n\t\t\t\t\tfor(; i<rows.length; i++){\n\t\t\t\t\t\tif(this.isRowSelected(rows[i])){\n\t\t\t\t\t\t\trow = rows[i];\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.resetSelections();\n\t\t\t\tif(startRow == row){\n\t\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t\t} else {\n\t\t\t\t\tvar doSelect = false;\n\t\t\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\t\t\tif(rows[i] == startRow){\n\t\t\t\t\t\t\tdoSelect=true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(doSelect){\n\t\t\t\t\t\t\tthis.selectByRow(rows[i]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(rows[i] == row){\n\t\t\t\t\t\t\tdoSelect = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toggleSelectionByRow(row);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.resetSelections();\n\t\t\tthis.toggleSelectionByRow(row);\n\t\t}\n\t\tthis.renderSelections();\n\t\te.stopPropagation();\n\t\te.preventDefault();\n\t},\n\tonSort: function(\/* HTMLEvent *\/e){\n\t\t\/\/\tsummary\n\t\t\/\/\tSort the table based on the column selected.\n\t\tvar oldIndex=this.sortIndex;\n\t\tvar oldDirection=this.sortDirection;\n\t\t\n\t\tvar source=e.target;\n\t\tvar row=dojo.html.getParentByType(source,\"tr\");\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0){\n\t\t\tcellTag=\"th\";\n\t\t}\n\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tvar header=dojo.html.getParentByType(source,cellTag);\n\t\t\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t\tif(headers[i]==header){\n\t\t\t\tif(this.sortInformation[0].index != i){\n\t\t\t\t\tthis.sortInformation.unshift({ \n\t\t\t\t\t\tindex:i, \n\t\t\t\t\t\tdirection:0\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.sortInformation[0] = {\n\t\t\t\t\t\tindex:i,\n\t\t\t\t\t\tdirection:(~this.sortInformation[0].direction)&1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.sortInformation.length = Math.min(this.sortInformation.length, this.maxSortable);\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\t\tthis.render();\n\t},\n\tonFilter: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tshow or hide rows based on the parameters of the passed filter.\n\t},\n\n\t\/\/\tFiltering methods\n\t_defaultFilter: function(\/* HTMLTableRow *\/row){\n\t\t\/\/\tsummary\n\t\t\/\/\tAlways return true as the result of the default filter.\n\t\treturn true;\n\t},\n\tsetFilter: function(\/* string *\/field, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=fn;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t},\n\tsetFilterByIndex: function(\/* number *\/idx, \/* function *\/fn){\n\t\t\/\/\tsummary\n\t\t\/\/\tset a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=fn;\n\t\tthis.applyFilters();\n\t},\n\tclearFilter: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed field.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tif(this.columns[i].getField() == field){\n\t\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.applyFilters();\n\t}, \n\tclearFilterByIndex: function(\/* string *\/field){\n\t\t\/\/\tsummary\n\t\t\/\/\tclear a filtering function on the passed column index.\n\t\tthis.columns[idx].filterFunction=this._defaultFilter;\n\t\tthis.applyFilters();\n\t}, \n\tclearFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tclears all filters.\n\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\tthis.columns[i].filterFunction=this._defaultFilter;\n\t\t}\n\t\t\/\/\twe'll do the clear manually, it will be faster.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\trows[i].style.display=\"\";\n\t\t}\n\t\tthis.onFilter();\n\t},\n\tapplyFilters: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tapply all filters to the table.\n\t\tvar rows=this.domNode.tBodies[0].rows;\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar b=true;\n\t\t\tvar row=rows[i];\n\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\tif(!this.columns[j].filterFunction(this.store.getField(this.getDataByRow(row), this.columns[j].getField()))){\n\t\t\t\t\tb=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.style.display=(b?\"\":\"none\");\n\t\t}\n\t\tthis.onFilter();\n\t},\n\n\t\/\/\tsorting functionality\n\tcreateSorter: function(\/* array *\/info){\n\t\t\/\/\tsummary\n\t\t\/\/\tcreates a custom function to be used for sorting.\n\t\tvar self=this;\n\t\tvar sortFunctions=[];\t\/\/\tour function stack.\n\t\n\t\tfunction createSortFunction(field, dir){\n\t\t\treturn function(rowA, rowB){\n\t\t\t\tvar a = self.store.getField(self.getDataByRow(rowA), field);\n\t\t\t\tvar b = self.store.getField(self.getDataByRow(rowB), field);\n\t\t\t\tvar ret = 0;\n\t\t\t\tif(a > b) ret = 1;\n\t\t\t\tif(a < b) ret = -1;\n\t\t\t\treturn dir * ret;\n\t\t\t}\n\t\t}\n\n\t\tvar current=0;\n\t\tvar max = Math.min(info.length, this.maxSortable, this.columns.length);\n\t\twhile(current < max){\n\t\t\tvar field = this.columns[info[current].index].getField();\n\t\t\tvar direction = (info[current].direction == 0) ? 1 : -1;\n\t\t\tsortFunctions.push(createSortFunction(field, direction));\n\t\t\tcurrent++;\n\t\t}\n\n\t\treturn function(rowA, rowB){\n\t\t\tvar idx=0;\n\t\t\twhile(idx < sortFunctions.length){\n\t\t\t\tvar ret = sortFunctions[idx++](rowA, rowB);\n\t\t\t\tif(ret != 0) return ret;\n\t\t\t}\n\t\t\t\/\/\tif we got here then we must be equal.\n\t\t\treturn 0; \t\n\t\t};\t\/\/\tfunction\n\t},\n\n\t\/\/\trendering\n\tcreateRow: function(\/* object *\/obj){\n\t\tvar row=document.createElement(\"tr\");\n\t\tdojo.html.disableSelection(row);\n\t\tif(obj.key != null){\n\t\t\trow.setAttribute(\"value\", obj.key);\n\t\t}\n\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\tvar cell=document.createElement(\"td\");\n\t\t\tcell.setAttribute(\"align\", this.columns[j].align);\n\t\t\tcell.setAttribute(\"valign\", this.columns[j].valign);\n\t\t\tdojo.html.disableSelection(cell);\n\t\t\tvar val = this.store.getField(obj.src, this.columns[j].getField());\n\t\t\tif(typeof(val)==\"undefined\"){\n\t\t\t\tval=\"\";\n\t\t\t}\n\t\t\tif (this.columns[j].sortType==\"__markup__\"){\n\t\t\t\tcell.innerHTML=val;\n\t\t\t} else {\n\t\t\t\tif(this.columns[j].getType()==Date) {\n\t\t\t\t\tval=new Date(val);\n\t\t\t\t\tif(!isNaN(val)){\n\t\t\t\t\t\tvar format = this.defaultDateFormat;\n\t\t\t\t\t\tif(this.columns[j].format){\n\t\t\t\t\t\t\tformat = this.columns[j].format;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(dojo.date.format(val, format)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t\t}\n\t\t\t\t} else if (\"Number number int Integer float Float\".indexOf(this.columns[j].getType())>-1){\n\t\t\t\t\t\/\/\tTODO: number formatting\n\t\t\t\t\tif(val.length == 0){\n\t\t\t\t\t\tval=\"0\";\n\t\t\t\t\t}\n\t\t\t\t\tvar n = parseFloat(val, 10) + \"\";\n\t\t\t\t\t\/\/\tTODO: numeric formatting + rounding :)\n\t\t\t\t\tif(n.indexOf(\".\")>-1){\n\t\t\t\t\t\tn = dojo.math.round(parseFloat(val,10),2);\n\t\t\t\t\t}\n\t\t\t\t\tcell.appendChild(document.createTextNode(n));\n\t\t\t\t}else{\n\t\t\t\t\tcell.appendChild(document.createTextNode(val));\n\t\t\t\t}\n\t\t\t}\n\t\t\trow.appendChild(cell);\n\t\t}\n\t\treturn row;\n\t},\n\tprefill: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tif there's no data in the table, then prefill it with this.minRows.\n\t\tthis.isInitialized = false;\n\t\tvar body = this.domNode.tBodies[0];\n\t\twhile (body.childNodes.length > 0){\n\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t}\n\t\t\n\t\tif(this.minRows>0){\n\t\t\tfor(var i=0; i < this.minRows; i++){\n\t\t\t\tvar row = document.createElement(\"tr\");\n\t\t\t\tif(this.alternateRows){\n\t\t\t\t\tdojo.html[((i % 2 == 1)?\"addClass\":\"removeClass\")](row, this.rowAlternateClass);\n\t\t\t\t}\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tvar cell = document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML = \"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\t},\n\tinit: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tinitializes the table of data\n\t\tthis.isInitialized=false;\n\n\t\t\/\/\tif there is no thead, create it now.\n\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\tif(head.getElementsByTagName(\"tr\").length == 0){\n\t\t\t\/\/\trender the column code.\n\t\t\tvar row=document.createElement(\"tr\");\n\t\t\tfor(var i=0; i<this.columns.length; i++){\n\t\t\t\tvar cell=document.createElement(\"td\");\n\t\t\t\tcell.setAttribute(\"align\", this.columns[i].align);\n\t\t\t\tcell.setAttribute(\"valign\", this.columns[i].valign);\n\t\t\t\tdojo.html.disableSelection(cell);\n\t\t\t\tcell.innerHTML=this.columns[i].label;\n\t\t\t\trow.appendChild(cell);\n\n\t\t\t\t\/\/\tattach the events.\n\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\tdojo.event.connect(cell, \"onclick\", this, \"onSort\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tdojo.html.prependChild(row, head);\n\t\t}\n\t\t\n\t\tif(this.store.get().length == 0){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar idx=this.domNode.tBodies[0].rows.length;\n\t\tif(!idx || idx==0 || this.domNode.tBodies[0].rows[0].getAttribute(\"emptyrow\")==\"true\"){\n\t\t\tidx = 0;\n\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\twhile(body.childNodes.length>0){\n\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t}\n\n\t\t\tvar data = this.store.get();\n\t\t\tfor(var i=0; i<data.length; i++){\n\t\t\t\tvar row = this.createRow(data[i]);\n\t\t\t\tbody.appendChild(row);\n\t\t\t\tdojo.event.connect(row, \"onclick\", this, \"onSelect\");\n\t\t\t\tidx++;\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tadd empty rows\n\t\tif(this.minRows > 0 && idx < this.minRows){\n\t\t\tidx = this.minRows - idx;\n\t\t\tfor(var i=0; i<idx; i++){\n\t\t\t\trow=document.createElement(\"tr\");\n\t\t\t\trow.setAttribute(\"emptyRow\",\"true\");\n\t\t\t\tfor(var j=0; j<this.columns.length; j++){\n\t\t\t\t\tcell=document.createElement(\"td\");\n\t\t\t\t\tcell.innerHTML=\"&nbsp;\";\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t\tbody.appendChild(row);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tlast but not least, show any columns that have sorting already on them.\n\t\tvar row=this.domNode.getElementsByTagName(\"thead\")[0].rows[0];\n\t\tvar cellTag=\"td\";\n\t\tif(row.getElementsByTagName(cellTag).length==0) cellTag=\"th\";\n\t\tvar headers=row.getElementsByTagName(cellTag);\n\t\tfor(var i=0; i<headers.length; i++){\n\t\t\tdojo.html.setClass(headers[i], this.headerClass);\n\t\t}\n\t\tfor(var i=0; i<this.sortInformation.length; i++){\n\t\t\tvar idx=this.sortInformation[i].index;\n\t\t\tvar dir=(~this.sortInformation[i].direction)&1;\n\t\t\tdojo.html.setClass(headers[idx], dir==0?this.headerDownClass:this.headerUpClass);\n\t\t}\n\n\t\tthis.isInitialized=true;\n\t\treturn this.isInitialized;\n\t},\n\trender: function(){\n\t\/*\tThe method that should be called once underlying changes\n\t *\tare made, including sorting, filtering, data changes.\n\t *\tRendering the selections themselves are a different method,\n\t *\twhich render() will call as the last step.\n\t ****************************************************************\/\n\t\tif(!this.isInitialized){\n\t\t\tvar b = this.init();\n\t\t\tif(!b){\n\t\t\t\tthis.prefill();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/\tdo the sort\n\t\tvar rows=[];\n\t\tvar body=this.domNode.tBodies[0];\n\t\tvar emptyRowIdx=-1;\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tif(body.rows[i].getAttribute(\"emptyRow\")){\n\t\t\t\temptyRowIdx=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\trows.push(body.rows[i]);\n\t\t}\n\n\t\t\/\/\tbuild the sorting function, and do the sorting.\n\t\tvar sortFunction = this.createSorter(this.sortInformation);\n\t\tif(sortFunction){\n\t\t\trows.sort(sortFunction);\n\t\t}\n\t\tif(emptyRowIdx>-1){\n\t\t\tfor(var i=emptyRowIdx; i<body.rows.length; i++){\n\t\t\t\trows.push(body.rows[i]);\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tappend the rows without killing them, this should help with the HTML problems.\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tif(this.alternateRows){\n\t\t\t\tdojo.html[((i%2==1)?\"addClass\":\"removeClass\")](rows[i], this.rowAlternateClass);\n\t\t\t}\n\t\t\tbody.appendChild(rows[i]);\n\t\t}\n\n\t\t\/\/\tnow re-render any selections.\n\t\tthis.renderSelections();\n\t},\n\trenderSelections: function(){\n\t\tvar body=this.domNode.tBodies[0];\n\t\tfor(var i=0; i<body.rows.length; i++){\n\t\t\tdojo.html[(this.isRowSelected(body.rows[i])?\"addClass\":\"removeClass\")](body.rows[i], this.rowSelectedClass);\n\t\t}\n\t},\n\trenderFilter: function(){\n\t},\n\n\t\/\/\twidget lifetime handlers\n\tinitialize: function(){ \n\t\tvar self=this;\n\t\t\/\/\tconnect up binding listeners here.\n\t\tdojo.event.connect(this.store, \"onSetData\", function(){\n\t\t\tself.store.forEach(function(element){\n\t\t\t\telement.isSelected = false;\n\t\t\t});\n\t\t\tself.isInitialized=false;\n\t\t\tvar body = self.domNode.tBodies[0];\n\t\t\tif(body){\n\t\t\t\twhile(body.childNodes.length>0){\n\t\t\t\t\tbody.removeChild(body.childNodes[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onClearData\", function(){\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddData\", function(addedObject){\n\t\t\tvar row=self.createRow(addedObject);\n\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onAddDataRange\", function(arr){\n\t\t\tfor(var i=0; i<arr.length; i++){\n\t\t\t\tarr[i].isSelected=false;\n\t\t\t\tvar row=self.createRow(arr[i]);\n\t\t\t\tself.domNode.tBodies[0].appendChild(row);\n\t\t\t};\n\t\t\tself.render();\n\t\t});\n\t\tdojo.event.connect(this.store, \"onRemoveData\", function(removedObject){\n\t\t\tvar rows = self.domNode.tBodies[0].rows;\n\t\t\tfor(var i=0; i<rows.length; i++){\n\t\t\t\tif(self.getDataByRow(rows[i]) == removedObject.src){\n\t\t\t\t\trows[i].parentNode.removeChild(rows[i]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.render();\n\t\t});\n\t},\n\/\/\tfillInTemplate: function(args, frag){ },\n\tpostCreate: function(){\n\t\t\/\/\tsummary\n\t\t\/\/\tfinish widget initialization.\n\n\t\tthis.store.keyField = this.valueField;\n\n\t\tif(this.domNode){\n\t\t\t\/\/\tstart by making sure domNode is a table element;\n\t\t\tif(this.domNode.nodeName.toLowerCase() != \"table\"){\n\t\t\t}\n\n\t\t\t\/\/\tsee if there is columns set up already\n\t\t\tif(this.domNode.getElementsByTagName(\"thead\")[0]){\n\t\t\t\tvar head=this.domNode.getElementsByTagName(\"thead\")[0];\n\t\t\t\tif(this.headClass.length > 0){\n\t\t\t\t\thead.className = this.headClass;\n\t\t\t\t}\n\t\t\t\tdojo.html.disableSelection(this.domNode);\n\t\t\t\tthis.parseMetadata(head);\n\n\t\t\t\tvar header=\"td\";\n\t\t\t\tif(head.getElementsByTagName(header).length==0){\n\t\t\t\t\theader=\"th\";\n\t\t\t\t}\n\t\t\t\tvar headers = head.getElementsByTagName(header);\n\t\t\t\tfor(var i=0; i<headers.length; i++){\n\t\t\t\t\tif(!this.columns[i].noSort){\n\t\t\t\t\t\tdojo.event.connect(headers[i], \"onclick\", this, \"onSort\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.domNode.appendChild(document.createElement(\"thead\"));\n\t\t\t}\n\n\t\t\t\/\/ if the table doesn't have a tbody already, add one and grab a reference to it\n\t\t\tif (this.domNode.tBodies.length < 1) {\n\t\t\t\tvar body = document.createElement(\"tbody\");\n\t\t\t\tthis.domNode.appendChild(body);\n\t\t\t} else {\n\t\t\t\tvar body = this.domNode.tBodies[0];\n\t\t\t}\n\n\t\t\tif (this.tbodyClass.length > 0){\n\t\t\t\tbody.className = this.tbodyClass;\n\t\t\t}\n\t\t\tthis.parseData(body);\n\t\t}","returns":"mixed","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.FisheyeList":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.html.style","dojo.html.selection","dojo.html.util","dojo.event"]},"methods":{"dojo.widget.FisheyeList":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.FisheyeListItem":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.FloatingPane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.Manager","dojo.html.*","dojo.html.layout","dojo.html.shadow","dojo.html.iframe","dojo.html.selection","dojo.widget.html.layout","dojo.widget.ContentPane","dojo.dnd.HtmlDragMove","dojo.dnd.HtmlDragMoveSource","dojo.dnd.HtmlDragMoveObject","dojo.widget.ResizeHandle"]},"methods":{"dojo.widget.FloatingPane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ContentPane"],"this_inherits":["dojo.widget.ContentPane"],"protovariables":{"title":"","iconSrc":"","hasShadow":"","constrainToContainer":"","taskBarId":"","resizable":"","titleBarDisplay":"","windowState":"","displayCloseAction":"","displayMinimizeAction":"","displayMaximizeAction":"","maxTaskBarConnectAttempts":"","taskBarConnectAttempts":"","templatePath":"","templateCssPath":"","drag":""}}}},"dojo.widget.FloatingPane.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.html.copyStyle(this.domNode, source);\n\t\n\t\t\t\/\/ necessary for safari, khtml (for computing width\/height)\n\t\t\tdojo.body().appendChild(this.domNode);\n\t\n\t\t\t\/\/ if display:none then state=minimized, otherwise state=normal\n\t\t\tif(!this.isShowing()){\n\t\t\t\tthis.windowState=\"minimized\";\n\t\t\t}\n\t\n\t\t\t\/\/ <img src=\"\"> can hang IE!  better get rid of it\n\t\t\tif(this.iconSrc==\"\"){\n\t\t\t\tdojo.html.removeNode(this.titleBarIcon);\n\t\t\t}else{\n\t\t\t\tthis.titleBarIcon.src = this.iconSrc.toString();\/\/ dojo.uri.Uri obj req. toString()\n\t\t\t}\n\t\n\t\t\tif(this.titleBarDisplay!=\"none\"){\t\n\t\t\t\tthis.titleBar.style.display=\"\";\n\t\t\t\tdojo.html.disableSelection(this.titleBar);\n\t\n\t\t\t\tthis.titleBarIcon.style.display = (this.iconSrc==\"\" ? \"none\" : \"\");\n\t\n\t\t\t\tthis.minimizeAction.style.display = (this.displayMinimizeAction ? \"\" : \"none\");\n\t\t\t\tthis.maximizeAction.style.display= \n\t\t\t\t\t(this.displayMaximizeAction && this.windowState!=\"maximized\" ? \"\" : \"none\");\n\t\t\t\tthis.restoreAction.style.display= \n\t\t\t\t\t(this.displayMaximizeAction && this.windowState==\"maximized\" ? \"\" : \"none\");\n\t\t\t\tthis.closeAction.style.display= (this.displayCloseAction ? \"\" : \"none\");\n\t\n\t\t\t\tthis.drag = new dojo.dnd.HtmlDragMoveSource(this.domNode);\t\n\t\t\t\tif (this.constrainToContainer) {\n\t\t\t\t\tthis.drag.constrainTo();\n\t\t\t\t}\n\t\t\t\tthis.drag.setDragHandle(this.titleBar);\n\t\n\t\t\t\tvar self = this;\n\t\n\t\t\t\tdojo.event.topic.subscribe(\"dragMove\",\n\t\t\t\t\tfunction (info){\n\t\t\t\t\t\tif (info.source.domNode == self.domNode){\n\t\t\t\t\t\t\tdojo.event.topic.publish('floatingPaneMove', { source: self } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\n\t\t\t}\n\t\n\t\t\tif(this.resizable){\n\t\t\t\tthis.resizeBar.style.display=\"\";\n\t\t\t\tvar rh = dojo.widget.createWidget(\"ResizeHandle\", {targetElmId: this.widgetId, id:this.widgetId+\"_resize\"});\n\t\t\t\tthis.resizeBar.appendChild(rh.domNode);\n\t\t\t}\n\t\n\t\t\t\/\/ add a drop shadow\n\t\t\tif(this.hasShadow){\n\t\t\t\tthis.shadow=new dojo.html.shadow(this.domNode);\n\t\t\t}\n\t\n\t\t\t\/\/ Prevent IE bleed-through problem\n\t\t\tthis.bgIframe = new dojo.html.BackgroundIframe(this.domNode);\n\t\n\t\t\tif( this.taskBarId ){\n\t\t\t\tthis.taskBarSetup();\n\t\t\t}\n\t\n\t\t\tif (dojo.hostenv.post_load_) {\n\t\t\t\tthis.setInitialWindowState();\n\t\t\t} else {\n\t\t\t\tdojo.addOnLoad(this, \"setInitialWindowState\");\n\t\t\t}\n\t\n\t\t\t\/\/ counteract body.appendChild above\n\t\t\tdojo.body().removeChild(this.domNode);\n\t\n\t\t\tdojo.widget.FloatingPane.superclass.fillInTemplate.call(this, args, frag);","this_inherits":["dojo.widget.FloatingPane.superclass.fillInTemplate"],"this":"dojo.widget.ContentPane"}}},"dojo.widget.ContentPane":{"_":{"meta":{"this_variables":["windowState","titleBarIcon.src","titleBar.style.display","titleBarIcon.style.display","minimizeAction.style.display","maximizeAction.style.display","restoreAction.style.display","closeAction.style.display","drag","resizeBar.style.display","shadow","bgIframe","windowState","titleBarIcon.src","titleBar.style.display","titleBarIcon.style.display","minimizeAction.style.display","maximizeAction.style.display","restoreAction.style.display","closeAction.style.display","drag","resizeBar.style.display","shadow","bgIframe","windowState","titleBarIcon.src","titleBar.style.display","titleBarIcon.style.display","minimizeAction.style.display","maximizeAction.style.display","restoreAction.style.display","closeAction.style.display","drag","resizeBar.style.display","shadow","bgIframe","width","previous","domNode.style.top","maximizeAction.style.display","restoreAction.style.display","windowState","previous","domNode.style.top","maximizeAction.style.display","restoreAction.style.display","windowState","previous","domNode.style.top","maximizeAction.style.display","restoreAction.style.display","windowState","previous","domNode.style.top","maximizeAction.style.display","restoreAction.style.display","windowState","previous","domNode.style.top","maximizeAction.style.display","restoreAction.style.display","windowState","previous","domNode.style.top","maximizeAction.style.display","restoreAction.style.display","windowState","windowState","previous","restoreAction.style.display","maximizeAction.style.display","windowState","windowState"]}}},"dojo.widget.FloatingPane.source":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.html.copyStyle(this.domNode, source);\n\t\n\t\t\t\/\/ necessary for safari, khtml (for computing width\/height)\n\t\t\tdojo.body().appendChild(this.domNode);\n\t\n\t\t\t\/\/ if display:none then state=minimized, otherwise state=normal\n\t\t\tif(!this.isShowing()){\n\t\t\t\tthis.windowState=\"minimized\";\n\t\t\t}\n\t\n\t\t\t\/\/ <img src=\"\"> can hang IE!  better get rid of it\n\t\t\tif(this.iconSrc==\"\"){\n\t\t\t\tdojo.html.removeNode(this.titleBarIcon);\n\t\t\t}else{\n\t\t\t\tthis.titleBarIcon.src = this.iconSrc.toString();\/\/ dojo.uri.Uri obj req. toString()\n\t\t\t}\n\t\n\t\t\tif(this.titleBarDisplay!=\"none\"){\t\n\t\t\t\tthis.titleBar.style.display=\"\";\n\t\t\t\tdojo.html.disableSelection(this.titleBar);\n\t\n\t\t\t\tthis.titleBarIcon.style.display = (this.iconSrc==\"\" ? \"none\" : \"\");\n\t\n\t\t\t\tthis.minimizeAction.style.display = (this.displayMinimizeAction ? \"\" : \"none\");\n\t\t\t\tthis.maximizeAction.style.display= \n\t\t\t\t\t(this.displayMaximizeAction && this.windowState!=\"maximized\" ? \"\" : \"none\");\n\t\t\t\tthis.restoreAction.style.display= \n\t\t\t\t\t(this.displayMaximizeAction && this.windowState==\"maximized\" ? \"\" : \"none\");\n\t\t\t\tthis.closeAction.style.display= (this.displayCloseAction ? \"\" : \"none\");\n\t\n\t\t\t\tthis.drag = new dojo.dnd.HtmlDragMoveSource(this.domNode);\t\n\t\t\t\tif (this.constrainToContainer) {\n\t\t\t\t\tthis.drag.constrainTo();\n\t\t\t\t}\n\t\t\t\tthis.drag.setDragHandle(this.titleBar);\n\t\n\t\t\t\tvar self = this;\n\t\n\t\t\t\tdojo.event.topic.subscribe(\"dragMove\",\n\t\t\t\t\tfunction (info){\n\t\t\t\t\t\tif (info.source.domNode == self.domNode){\n\t\t\t\t\t\t\tdojo.event.topic.publish('floatingPaneMove', { source: self } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\n\t\t\t}\n\t\n\t\t\tif(this.resizable){\n\t\t\t\tthis.resizeBar.style.display=\"\";\n\t\t\t\tvar rh = dojo.widget.createWidget(\"ResizeHandle\", {targetElmId: this.widgetId, id:this.widgetId+\"_resize\"});\n\t\t\t\tthis.resizeBar.appendChild(rh.domNode);\n\t\t\t}\n\t\n\t\t\t\/\/ add a drop shadow\n\t\t\tif(this.hasShadow){\n\t\t\t\tthis.shadow=new dojo.html.shadow(this.domNode);\n\t\t\t}\n\t\n\t\t\t\/\/ Prevent IE bleed-through problem\n\t\t\tthis.bgIframe = new dojo.html.BackgroundIframe(this.domNode);\n\t\n\t\t\tif( this.taskBarId ){\n\t\t\t\tthis.taskBarSetup();\n\t\t\t}\n\t\n\t\t\tif (dojo.hostenv.post_load_) {\n\t\t\t\tthis.setInitialWindowState();\n\t\t\t} else {\n\t\t\t\tdojo.addOnLoad(this, \"setInitialWindowState\");\n\t\t\t}\n\t\n\t\t\t\/\/ counteract body.appendChild above\n\t\t\tdojo.body().removeChild(this.domNode);\n\t\n\t\t\tdojo.widget.FloatingPane.superclass.fillInTemplate.call(this, args, frag);","this_inherits":["dojo.widget.FloatingPane.superclass.fillInTemplate"],"this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.targetElmId":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.html.copyStyle(this.domNode, source);\n\t\n\t\t\t\/\/ necessary for safari, khtml (for computing width\/height)\n\t\t\tdojo.body().appendChild(this.domNode);\n\t\n\t\t\t\/\/ if display:none then state=minimized, otherwise state=normal\n\t\t\tif(!this.isShowing()){\n\t\t\t\tthis.windowState=\"minimized\";\n\t\t\t}\n\t\n\t\t\t\/\/ <img src=\"\"> can hang IE!  better get rid of it\n\t\t\tif(this.iconSrc==\"\"){\n\t\t\t\tdojo.html.removeNode(this.titleBarIcon);\n\t\t\t}else{\n\t\t\t\tthis.titleBarIcon.src = this.iconSrc.toString();\/\/ dojo.uri.Uri obj req. toString()\n\t\t\t}\n\t\n\t\t\tif(this.titleBarDisplay!=\"none\"){\t\n\t\t\t\tthis.titleBar.style.display=\"\";\n\t\t\t\tdojo.html.disableSelection(this.titleBar);\n\t\n\t\t\t\tthis.titleBarIcon.style.display = (this.iconSrc==\"\" ? \"none\" : \"\");\n\t\n\t\t\t\tthis.minimizeAction.style.display = (this.displayMinimizeAction ? \"\" : \"none\");\n\t\t\t\tthis.maximizeAction.style.display= \n\t\t\t\t\t(this.displayMaximizeAction && this.windowState!=\"maximized\" ? \"\" : \"none\");\n\t\t\t\tthis.restoreAction.style.display= \n\t\t\t\t\t(this.displayMaximizeAction && this.windowState==\"maximized\" ? \"\" : \"none\");\n\t\t\t\tthis.closeAction.style.display= (this.displayCloseAction ? \"\" : \"none\");\n\t\n\t\t\t\tthis.drag = new dojo.dnd.HtmlDragMoveSource(this.domNode);\t\n\t\t\t\tif (this.constrainToContainer) {\n\t\t\t\t\tthis.drag.constrainTo();\n\t\t\t\t}\n\t\t\t\tthis.drag.setDragHandle(this.titleBar);\n\t\n\t\t\t\tvar self = this;\n\t\n\t\t\t\tdojo.event.topic.subscribe(\"dragMove\",\n\t\t\t\t\tfunction (info){\n\t\t\t\t\t\tif (info.source.domNode == self.domNode){\n\t\t\t\t\t\t\tdojo.event.topic.publish('floatingPaneMove', { source: self } );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\n\t\t\t}\n\t\n\t\t\tif(this.resizable){\n\t\t\t\tthis.resizeBar.style.display=\"\";\n\t\t\t\tvar rh = dojo.widget.createWidget(\"ResizeHandle\", {targetElmId: this.widgetId, id:this.widgetId+\"_resize\"});\n\t\t\t\tthis.resizeBar.appendChild(rh.domNode);\n\t\t\t}\n\t\n\t\t\t\/\/ add a drop shadow\n\t\t\tif(this.hasShadow){\n\t\t\t\tthis.shadow=new dojo.html.shadow(this.domNode);\n\t\t\t}\n\t\n\t\t\t\/\/ Prevent IE bleed-through problem\n\t\t\tthis.bgIframe = new dojo.html.BackgroundIframe(this.domNode);\n\t\n\t\t\tif( this.taskBarId ){\n\t\t\t\tthis.taskBarSetup();\n\t\t\t}\n\t\n\t\t\tif (dojo.hostenv.post_load_) {\n\t\t\t\tthis.setInitialWindowState();\n\t\t\t} else {\n\t\t\t\tdojo.addOnLoad(this, \"setInitialWindowState\");\n\t\t\t}\n\t\n\t\t\t\/\/ counteract body.appendChild above\n\t\t\tdojo.body().removeChild(this.domNode);\n\t\n\t\t\tdojo.widget.FloatingPane.superclass.fillInTemplate.call(this, args, frag);","this_inherits":["dojo.widget.FloatingPane.superclass.fillInTemplate"],"this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.isShowing()){\n\t\t\t\tthis.width=-1;\t\/\/ force resize\n\t\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\t\tthis.resizeTo(mb.width, mb.height);\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.maximizeWindow":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\tthis.previous={\n\t\t\t\twidth: mb.width || this.width,\n\t\t\t\theight: mb.height || this.height,\n\t\t\t\tleft: this.domNode.style.left,\n\t\t\t\ttop: this.domNode.style.top,\n\t\t\t\tbottom: this.domNode.style.bottom,\n\t\t\t\tright: this.domNode.style.right\n\t\t\t};\n\t\t\tthis.domNode.style.left =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-left\", true) + \"px\";\n\t\t\tthis.domNode.style.top =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-top\", true) + \"px\";\n\t\n\t\t\tif ((this.domNode.parentNode.nodeName.toLowerCase() == 'body')) {\n\t\t\t\tvar viewport = dojo.html.getViewport();\n\t\t\t\tvar padding = dojo.html.getPadding(dojo.body());\n\t\t\t\tthis.resizeTo(viewport.width-padding.width, viewport.height-padding.height);\n\t\t\t} else {\n\t\t\t\tvar content = dojo.html.getContentBox(this.domNode.parentNode);\n\t\t\t\tthis.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t\tthis.maximizeAction.style.display=\"none\";\n\t\t\tthis.restoreAction.style.display=\"\";\n\t\t\tthis.windowState=\"maximized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.width":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\t\tdojo.html.setMarginBox(this.domNode, { width: w, height: h });\n\t\n\t\t\tdojo.widget.html.layout(this.domNode,\n\t\t\t\t[\n\t\t\t\t  {domNode: this.titleBar, layoutAlign: \"top\"},\n\t\t\t\t  {domNode: this.resizeBar, layoutAlign: \"bottom\"},\n\t\t\t\t  {domNode: this.containerNode, layoutAlign: \"client\"}\n\t\t\t\t] );\n\t\n\t\t\t\/\/ If any of the children have layoutAlign specified, obey it\n\t\t\tdojo.widget.html.layout(this.containerNode, this.children, \"top-bottom\");\n\t\t\t\n\t\t\tthis.bgIframe.onResized();\n\t\t\tif(this.shadow){ this.shadow.size(w, h); }\n\t\t\tthis.onResized();","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.height":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\tthis.previous={\n\t\t\t\twidth: mb.width || this.width,\n\t\t\t\theight: mb.height || this.height,\n\t\t\t\tleft: this.domNode.style.left,\n\t\t\t\ttop: this.domNode.style.top,\n\t\t\t\tbottom: this.domNode.style.bottom,\n\t\t\t\tright: this.domNode.style.right\n\t\t\t};\n\t\t\tthis.domNode.style.left =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-left\", true) + \"px\";\n\t\t\tthis.domNode.style.top =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-top\", true) + \"px\";\n\t\n\t\t\tif ((this.domNode.parentNode.nodeName.toLowerCase() == 'body')) {\n\t\t\t\tvar viewport = dojo.html.getViewport();\n\t\t\t\tvar padding = dojo.html.getPadding(dojo.body());\n\t\t\t\tthis.resizeTo(viewport.width-padding.width, viewport.height-padding.height);\n\t\t\t} else {\n\t\t\t\tvar content = dojo.html.getContentBox(this.domNode.parentNode);\n\t\t\t\tthis.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t\tthis.maximizeAction.style.display=\"none\";\n\t\t\tthis.restoreAction.style.display=\"\";\n\t\t\tthis.windowState=\"maximized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.left":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\tthis.previous={\n\t\t\t\twidth: mb.width || this.width,\n\t\t\t\theight: mb.height || this.height,\n\t\t\t\tleft: this.domNode.style.left,\n\t\t\t\ttop: this.domNode.style.top,\n\t\t\t\tbottom: this.domNode.style.bottom,\n\t\t\t\tright: this.domNode.style.right\n\t\t\t};\n\t\t\tthis.domNode.style.left =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-left\", true) + \"px\";\n\t\t\tthis.domNode.style.top =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-top\", true) + \"px\";\n\t\n\t\t\tif ((this.domNode.parentNode.nodeName.toLowerCase() == 'body')) {\n\t\t\t\tvar viewport = dojo.html.getViewport();\n\t\t\t\tvar padding = dojo.html.getPadding(dojo.body());\n\t\t\t\tthis.resizeTo(viewport.width-padding.width, viewport.height-padding.height);\n\t\t\t} else {\n\t\t\t\tvar content = dojo.html.getContentBox(this.domNode.parentNode);\n\t\t\t\tthis.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t\tthis.maximizeAction.style.display=\"none\";\n\t\t\tthis.restoreAction.style.display=\"\";\n\t\t\tthis.windowState=\"maximized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.top":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\tthis.previous={\n\t\t\t\twidth: mb.width || this.width,\n\t\t\t\theight: mb.height || this.height,\n\t\t\t\tleft: this.domNode.style.left,\n\t\t\t\ttop: this.domNode.style.top,\n\t\t\t\tbottom: this.domNode.style.bottom,\n\t\t\t\tright: this.domNode.style.right\n\t\t\t};\n\t\t\tthis.domNode.style.left =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-left\", true) + \"px\";\n\t\t\tthis.domNode.style.top =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-top\", true) + \"px\";\n\t\n\t\t\tif ((this.domNode.parentNode.nodeName.toLowerCase() == 'body')) {\n\t\t\t\tvar viewport = dojo.html.getViewport();\n\t\t\t\tvar padding = dojo.html.getPadding(dojo.body());\n\t\t\t\tthis.resizeTo(viewport.width-padding.width, viewport.height-padding.height);\n\t\t\t} else {\n\t\t\t\tvar content = dojo.html.getContentBox(this.domNode.parentNode);\n\t\t\t\tthis.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t\tthis.maximizeAction.style.display=\"none\";\n\t\t\tthis.restoreAction.style.display=\"\";\n\t\t\tthis.windowState=\"maximized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.bottom":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\tthis.previous={\n\t\t\t\twidth: mb.width || this.width,\n\t\t\t\theight: mb.height || this.height,\n\t\t\t\tleft: this.domNode.style.left,\n\t\t\t\ttop: this.domNode.style.top,\n\t\t\t\tbottom: this.domNode.style.bottom,\n\t\t\t\tright: this.domNode.style.right\n\t\t\t};\n\t\t\tthis.domNode.style.left =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-left\", true) + \"px\";\n\t\t\tthis.domNode.style.top =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-top\", true) + \"px\";\n\t\n\t\t\tif ((this.domNode.parentNode.nodeName.toLowerCase() == 'body')) {\n\t\t\t\tvar viewport = dojo.html.getViewport();\n\t\t\t\tvar padding = dojo.html.getPadding(dojo.body());\n\t\t\t\tthis.resizeTo(viewport.width-padding.width, viewport.height-padding.height);\n\t\t\t} else {\n\t\t\t\tvar content = dojo.html.getContentBox(this.domNode.parentNode);\n\t\t\t\tthis.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t\tthis.maximizeAction.style.display=\"none\";\n\t\t\tthis.restoreAction.style.display=\"\";\n\t\t\tthis.windowState=\"maximized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.right":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\tthis.previous={\n\t\t\t\twidth: mb.width || this.width,\n\t\t\t\theight: mb.height || this.height,\n\t\t\t\tleft: this.domNode.style.left,\n\t\t\t\ttop: this.domNode.style.top,\n\t\t\t\tbottom: this.domNode.style.bottom,\n\t\t\t\tright: this.domNode.style.right\n\t\t\t};\n\t\t\tthis.domNode.style.left =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-left\", true) + \"px\";\n\t\t\tthis.domNode.style.top =\n\t\t\t\tdojo.html.getPixelValue(this.domNode.parentNode, \"padding-top\", true) + \"px\";\n\t\n\t\t\tif ((this.domNode.parentNode.nodeName.toLowerCase() == 'body')) {\n\t\t\t\tvar viewport = dojo.html.getViewport();\n\t\t\t\tvar padding = dojo.html.getPadding(dojo.body());\n\t\t\t\tthis.resizeTo(viewport.width-padding.width, viewport.height-padding.height);\n\t\t\t} else {\n\t\t\t\tvar content = dojo.html.getContentBox(this.domNode.parentNode);\n\t\t\t\tthis.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t\tthis.maximizeAction.style.display=\"none\";\n\t\t\tthis.restoreAction.style.display=\"\";\n\t\t\tthis.windowState=\"maximized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.minimizeWindow":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis.hide();\n\t\t\tthis.windowState = \"minimized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.restoreWindow":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif (this.windowState==\"minimized\") {\n\t\t\t\tthis.show() \n\t\t\t} else {\n\t\t\t\tfor(var attr in this.previous){\n\t\t\t\t\tthis.domNode.style[attr] = this.previous[attr];\n\t\t\t\t}\n\t\t\t\tthis.resizeTo(this.previous.width, this.previous.height);\n\t\t\t\tthis.previous=null;\n\t\n\t\t\t\tthis.restoreAction.style.display=\"none\";\n\t\t\t\tthis.maximizeAction.style.display=this.displayMaximizeAction ? \"\" : \"none\";\n\t\t\t}\n\t\n\t\t\tthis.windowState=\"normal\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.closeWindow":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tdojo.html.removeNode(this.domNode);\n\t\t\tthis.destroy();","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.onMouseDown":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis.bringToTop();","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.bringToTop":{"_":{"meta":{"summary":"","src":"\t\t\tvar floatingPanes= dojo.widget.manager.getWidgetsByType(this.widgetType);\n\t\t\tvar windows = [];\n\t\t\tfor (var x=0; x<floatingPanes.length; x++) {\n\t\t\t\tif (this.widgetId != floatingPanes[x].widgetId) {\n\t\t\t\t\t\twindows.push(floatingPanes[x]);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\twindows.sort(function(a,b) {\n\t\t\t\treturn a.domNode.style.zIndex - b.domNode.style.zIndex;\n\t\t\t});\n\t\t\t\n\t\t\twindows.push(this);\n\t\n\t\t\tvar floatingPaneStartingZ = 100;\n\t\t\tfor (x=0; x<windows.length;x++) {\n\t\t\t\twindows[x].domNode.style.zIndex = floatingPaneStartingZ + x;\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.setInitialWindowState":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.windowState == \"maximized\") {\n\t\t\t\tthis.maximizeWindow();\n\t\t\t\tthis.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (this.windowState==\"normal\") {\n\t\t\t\tthis.show();\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tif (this.windowState==\"minimized\") {\n\t\t\t\tthis.hide();\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tthis.windowState=\"minimized\";","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.taskBarSetup":{"_":{"meta":{"summary":"","src":"\t\t\tvar taskbar = dojo.widget.getWidgetById(this.taskBarId);\n\t\t\tif (!taskbar){\n\t\t\t\tif (this.taskBarConnectAttempts <  this.maxTaskBarConnectAttempts) {\n\t\t\t\t\tdojo.lang.setTimeout(this, this.taskBarSetup, 50);\n\t\t\t\t\tthis.taskBarConnectAttempts++;\n\t\t\t\t} else {\n\t\t\t\t\tdojo.debug(\"Unable to connect to the taskBar\");\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttaskbar.addChild(this);","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.show":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.FloatingPane.superclass.show.apply(this, arguments);\n\t\t\tthis.bringToTop();","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.onShow":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.FloatingPane.superclass.onShow.call(this);\n\t\t\tvar mb = dojo.html.getMarginBox(this.domNode);\n\t\t\tthis.resizeTo(mb.width, mb.height);","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.resizeTo":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\t\tdojo.html.setMarginBox(this.domNode, { width: w, height: h });\n\t\n\t\t\tdojo.widget.html.layout(this.domNode,\n\t\t\t\t[\n\t\t\t\t  {domNode: this.titleBar, layoutAlign: \"top\"},\n\t\t\t\t  {domNode: this.resizeBar, layoutAlign: \"bottom\"},\n\t\t\t\t  {domNode: this.containerNode, layoutAlign: \"client\"}\n\t\t\t\t] );\n\t\n\t\t\t\/\/ If any of the children have layoutAlign specified, obey it\n\t\t\tdojo.widget.html.layout(this.containerNode, this.children, \"top-bottom\");\n\t\t\t\n\t\t\tthis.bgIframe.onResized();\n\t\t\tif(this.shadow){ this.shadow.size(w, h); }\n\t\t\tthis.onResized();","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.domNode":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\t\tdojo.html.setMarginBox(this.domNode, { width: w, height: h });\n\t\n\t\t\tdojo.widget.html.layout(this.domNode,\n\t\t\t\t[\n\t\t\t\t  {domNode: this.titleBar, layoutAlign: \"top\"},\n\t\t\t\t  {domNode: this.resizeBar, layoutAlign: \"bottom\"},\n\t\t\t\t  {domNode: this.containerNode, layoutAlign: \"client\"}\n\t\t\t\t] );\n\t\n\t\t\t\/\/ If any of the children have layoutAlign specified, obey it\n\t\t\tdojo.widget.html.layout(this.containerNode, this.children, \"top-bottom\");\n\t\t\t\n\t\t\tthis.bgIframe.onResized();\n\t\t\tif(this.shadow){ this.shadow.size(w, h); }\n\t\t\tthis.onResized();","this":"dojo.widget.ContentPane"}}},"dojo.widget.FloatingPane.checkSize":{"_":{"meta":{"summary":"","src":"\t\t\t\/\/ checkSize() is called when the user has resized the browser window,\n\t\t\t\/\/ but that doesn't affect this widget (or this widget's children)\n\t\t\t\/\/ so it can be safely ignored...\n\t\t\t\/\/ TODO: unless we are maximized.  then we should resize ourself.","this":"dojo.widget.ContentPane"}}}}}},"dojo.widget.GoogleMap":{"meta":{"requires":{"common":["dojo.event.*","dojo.math","dojo.widget.*","dojo.uri.Uri","dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.GoogleMap":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.HslColorPicker":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.widget.HslColorPicker","dojo.math","dojo.svg","dojo.graphics.color","dojo.graphics.color.hsl"]},"methods":{"dojo.widget.svg.HslColorPicker":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.HtmlWidget":{"meta":{"requires":{"common":["dojo.widget.DomWidget","dojo.html.util","dojo.html.display","dojo.html.layout","dojo.lang.extras","dojo.lang.func","dojo.lfx.toggle"]},"methods":{"dojo.widget.HtmlWidget":{"_":{"meta":{"summary":"","inherits":["dojo.widget.DomWidget"],"this_inherits":["dojo.widget.DomWidget"],"protovariables":{"widgetType":"","templateCssPath":"","templatePath":"","toggle":"","toggleDuration":"","animationInProgress":""}}}},"dojo.widget.HtmlWidget.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.postMixInProperties":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.lfx.toggle[this.toggle.toLowerCase()] || dojo.lfx.toggle.plain;","this":"dojo.widget.DomWidget"}}},"dojo.widget.DomWidget":{"_":{"meta":{"this_variables":["toggleObj","animationInProgress","isHidden","animationInProgress","animationInProgress","isHidden","animationInProgress","width","height"]}}},"dojo.widget.HtmlWidget.getContainerHeight":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.getContainerWidth":{"_":{"meta":{"summary":"","src":"\t\treturn this.parent.domNode.offsetWidth;","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.setNativeHeight":{"_":{"meta":{"summary":"","parameters":{"height":{"type":""}},"src":"\t\tvar ch = this.getContainerHeight();","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.createNodesFromText":{"_":{"meta":{"summary":"","parameters":{"txt":{"type":""},"wrap":{"type":""}},"src":"\t\treturn dojo.html.createNodesFromText(txt, wrap);","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.destroyRendering":{"_":{"meta":{"summary":"","parameters":{"finalize":{"type":""}},"src":"\t\ttry{\n\t\t\tif(!finalize && this.domNode){\n\t\t\t\tdojo.event.browser.clean(this.domNode);\n\t\t\t}\n\t\t\tthis.domNode.parentNode.removeChild(this.domNode);\n\t\t\tdelete this.domNode;\n\t\t}catch(e){ \/* squelch! *\/ }","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.isShowing":{"_":{"meta":{"summary":"","src":"\t\treturn dojo.html.isShowing(this.domNode);","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.toggleShowing":{"_":{"meta":{"summary":"","src":"\t\t\tthis.show();\n\t\t}else{\n\t\t\tthis.hide();\n\t\t}","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.show":{"_":{"meta":{"summary":"","src":"\t\tthis.animationInProgress=true;\n\t\tthis.isHidden = false;\n\t\tthis.toggleObj.show(this.domNode, this.toggleDuration, null,\n\t\t\tdojo.lang.hitch(this, this.onShow), this.explodeSrc);","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.onShow":{"_":{"meta":{"summary":"","src":"\t\tthis.animationInProgress=false;\n\t\tthis.checkSize();","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.hide":{"_":{"meta":{"summary":"","src":"\t\tthis.animationInProgress = true;\n\t\tthis.isHidden = true;\n\t\tthis.toggleObj.hide(this.domNode, this.toggleDuration, null,\n\t\t\tdojo.lang.hitch(this, this.onHide), this.explodeSrc);","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.onHide":{"_":{"meta":{"summary":"","src":"\t\tthis.animationInProgress=false;","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget._isResized":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\t\/\/ If my parent has been resized and I have style=\"height: 100%\"\n\t\t\/\/ or something similar then my size has changed too.\n\t\tvar wh = dojo.html.getMarginBox(this.domNode);\n\t\tvar width=w||wh.width;\n\t\tvar height=h||wh.height;\n\t\tif(this.width == width && this.height == height){ return false; }\n\n\t\tthis.width=width;\n\t\tthis.height=height;\n\t\treturn true;","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.checkSize":{"_":{"meta":{"summary":"","src":"\t\tif(!this._isResized()){ return; }\n\t\tthis.onResized();","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.resizeTo":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\tif(!this._isResized(w,h)){ return; }\n\t\tdojo.html.setMarginBox(this.domNode, { width: w, height: h });\n\t\tthis.onResized();","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.width":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\tif(!this._isResized(w,h)){ return; }\n\t\tdojo.html.setMarginBox(this.domNode, { width: w, height: h });\n\t\tthis.onResized();","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.resizeSoon":{"_":{"meta":{"summary":"","src":"\t\tif(this.isShowing()){\n\t\t\tdojo.lang.setTimeout(this, this.onResized, 0);\n\t\t}","this":"dojo.widget.DomWidget"}}},"dojo.widget.HtmlWidget.onResized":{"_":{"meta":{"summary":"","src":"\t\tdojo.lang.forEach(this.children, function(child){ if (child[\"checkSize\"]) child.checkSize(); });","this":"dojo.widget.DomWidget"}}}}}},"dojo.widget.IButton":{"meta":{"requires":{"common":["dojo.widget.Widget"]},"methods":{"dojo.widget.IButton":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\n\tthis.widgetType = \"IButton\";\n  this.color = \"\";","this_variables":["widgetType","color"],"inherits":["dojo.widget.Widget"]}}}}}},"dojo.widget.InlineEditBox":{"meta":{"requires":{"common":["dojo.widget.*","dojo.lfx.*","dojo.graphics.color","dojo.string","dojo.html.*","dojo.html.layout"]},"methods":{"dojo.widget.InlineEditBox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.LayoutContainer":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.html.layout"]},"methods":{"dojo.widget.LayoutContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.Widget":{"_":{"meta":{"protovariables":{"layoutAlign":""}}}}}}},"dojo.widget.LinkPane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.ContentPane","dojo.html.style"]},"methods":{"dojo.widget.LinkPane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ContentPane"],"this_inherits":["dojo.widget.ContentPane"]}}}}}},"dojo.widget.Manager":{"meta":{"requires":{"common":["dojo.lang.array","dojo.lang.func","dojo.event.*"]},"methods":{"dojo.widget.manager.getUniqueId":{"_":{"meta":{"summary":"","parameters":{"widgetType":{"type":""}},"src":"\t\treturn widgetType + \"_\" + (widgetTypeCtr[widgetType] != undefined ?\n\t\t\t++widgetTypeCtr[widgetType] : widgetTypeCtr[widgetType] = 0);"}}},"dojo.widget.manager.add":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""}},"src":"\t\t\/\/ Opera9 uses ID (caps)\n\t\tif(!widget.extraArgs[\"id\"]){\n\t\t\twidget.extraArgs[\"id\"] = widget.extraArgs[\"ID\"];\n\t\t}\n\t\t\/\/ FIXME: the rest of this method is very slow!\n\t\tif(widget.widgetId == \"\"){\n\t\t\tif(widget[\"id\"]){\n\t\t\t\twidget.widgetId = widget[\"id\"];\n\t\t\t}else if(widget.extraArgs[\"id\"]){\n\t\t\t\twidget.widgetId = widget.extraArgs[\"id\"];\n\t\t\t}else{\n\t\t\t\twidget.widgetId = this.getUniqueId(widget.widgetType);\n\t\t\t}\n\t\t}\n\t\tif(this.widgetIds[widget.widgetId]){\n\t\t\tdojo.debug(\"widget ID collision on ID: \"+widget.widgetId);\n\t\t}\n\t\tthis.widgetIds[widget.widgetId] = widget;\n\t\t\/\/ Widget.destroy already calls removeById(), so we don't need to\n\t\t\/\/ connect() it here\n\t\t\/\/dojo.profile.end(\"dojo.widget.manager.add\");"}}},"dojo.widget.manager.destroyAll":{"_":{"meta":{"summary":"","src":"\t\tfor(var x=this.widgets.length-1; x>=0; x--){\n\t\t\ttry{\n\t\t\t\t\/\/ this.widgets[x].destroyChildren();\n\t\t\t\tthis.widgets[x].destroy(true);\n\t\t\t\tdelete this.widgets[x];\n\t\t\t}catch(e){ }\n\t\t}"}}},"dojo.widget.manager.remove":{"_":{"meta":{"summary":"","parameters":{"widgetIndex":{"type":""}},"src":"\t\tif(dojo.lang.isNumber(widgetIndex)){\n\t\t\tvar tw = this.widgets[widgetIndex].widgetId;\n\t\t\tdelete this.widgetIds[tw];\n\t\t\tthis.widgets.splice(widgetIndex, 1);\n\t\t}else{\n\t\t\tthis.removeById(widgetIndex);\n\t\t}"}}},"dojo.widget.manager.removeById":{"_":{"meta":{"summary":"","parameters":{"id":{"type":""}},"src":"\t\tif(!dojo.lang.isString(id)){\n\t\t\tid = id[\"widgetId\"];\n\t\t\tif(!id){ dojo.debug(\"invalid widget or id passed to removeById\"); return; }\n\t\t}\n\t\tfor (var i=0; i<this.widgets.length; i++){\n\t\t\tif(this.widgets[i].widgetId == id){\n\t\t\t\tthis.remove(i);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}"}}},"dojo.widget.manager.getWidgetById":{"_":{"meta":{"summary":"","parameters":{"id":{"type":""}},"src":"\t\tif(dojo.lang.isString(id)){\n\t\t\treturn this.widgetIds[id];\n\t\t}\n\t\treturn id;"}}},"dojo.widget.manager.getWidgetsByType":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""}},"src":"\t\tvar lt = type.toLowerCase();\n\t\tvar ret = [];\n\t\tdojo.lang.forEach(this.widgets, function(x){\n\t\t\tif(x.widgetType.toLowerCase() == lt){\n\t\t\t\tret.push(x);\n\t\t\t}\n\t\t});\n\t\treturn ret;"}}},"dojo.widget.manager.getWidgetsByFilter":{"_":{"meta":{"summary":"","parameters":{"unaryFunc":{"type":""},"onlyOne":{"type":""}},"src":"\t\tvar ret = [];\n\t\tdojo.lang.every(this.widgets, function(x){\n\t\t\tif(unaryFunc(x)){\n\t\t\t\tret.push(x);\n\t\t\t\tif(onlyOne){return false;}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\treturn (onlyOne ? ret[0] : ret);"}}},"dojo.widget.manager.getAllWidgets":{"_":{"meta":{"summary":"","src":"\t\treturn this.widgets.concat();"}}},"dojo.widget.manager.getWidgetByNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":"DOMNode"}},"src":"\t\tvar w=this.getAllWidgets();\n\t\tnode = dojo.byId(node);\n\t\tfor(var i=0; i<w.length; i++){\n\t\t\tif(w[i].domNode==node){\n\t\t\t\treturn w[i];\n\t\t\t}\n\t\t}\n\t\treturn null;"}}},"dojo.widget.manager.registerWidgetPackage":{"_":{"meta":{"summary":"","parameters":{"pname":{"type":""}},"src":"\t\tif(!widgetPackages[pname]){\n\t\t\twidgetPackages[pname] = true;\n\t\t\twidgetPackages.push(pname);\n\t\t}"}}},"dojo.widget.manager.getWidgetPackageList":{"_":{"meta":{"summary":"","src":"\t\treturn dojo.lang.map(widgetPackages, function(elt) { return(elt!==true ? elt : undefined); });"}}},"dojo.widget.manager.getImplementation":{"_":{"meta":{"summary":"","parameters":{"widgetName":{"type":""},"ctorObject":{"type":""},"mixins":{"type":""},"namespace":{"type":""}},"src":"\t\tif(impl){ \n\t\t\t\/\/ var tic = new Date();\n\t\t\tvar ret;\n\t\t\tif(ctorObject){ret = new impl(ctor);}\n\t\t\telse{ret = new impl();}\n\t\t\t\/\/ dojo.debug(new Date() - tic);\n\t\t\treturn ret;\n\t\t}"}}},"dojo.widget.manager.getImplementationName":{"_":{"meta":{"summary":"","parameters":{"widgetName":{"type":""},"namespace":{"type":""}},"src":"\t\tvar lowerCaseWidgetName = widgetName.toLowerCase();\n\n\t\tif(!knownWidgetImplementations[namespace]){knownWidgetImplementations[namespace]={};}\n\t\t\n\t\tvar impl = knownWidgetImplementations[namespace][lowerCaseWidgetName];\n\t\tif(impl){\n\t\t\treturn impl;\n\t\t}\n\t\tvar ns = dojo.getNamespace(namespace);\n\t\tif(ns){ns.load(widgetName);}\n\n\t\t\/\/ first store a list of the render prefixes we are capable of rendering\n\t\tif(!renderPrefixCache.length){\n\t\t\tfor(var renderer in dojo.render){\n\t\t\t\tif(dojo.render[renderer][\"capable\"] === true){\n\t\t\t\t\tvar prefixes = dojo.render[renderer].prefixes;\n\t\t\t\t\tfor(var i = 0; i < prefixes.length; i++){\n\t\t\t\t\t\trenderPrefixCache.push(prefixes[i].toLowerCase());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/ make sure we don't HAVE to prefix widget implementation names\n\t\t\t\/\/ with anything to get them to render\n\t\t\trenderPrefixCache.push(\"\");\n\t\t}\n\n\t\tvar nsSearchArr = null;\n\t\t\n\t\tvar deprWarningLogged=false;\n\t\tfor(var counter = 0; counter < 2; counter++){\t\n\t\t\t\/\/ look for a rendering-context specific version of our widget name\n\t\t\tfor(var i = 0; i < widgetPackages.length; i++){\n\t\t\t\tvar widgetPackage = dojo.evalObjPath(widgetPackages[i]);\n\t\t\t\tif(!widgetPackage) { continue; }\n\t\t\t\tvar pos = widgetPackages[i].indexOf(\".\");\n\t\t\t\tif(pos > -1){\n\t\t\t\t\tvar n = widgetPackages[i].substring(0,pos);\n\t\t\t\t\tif(n != namespace){\n\t\t\t\t\t\tif(counter==0){continue;}\n\t\t\t\t\t\tif(!deprWarningLogged){\n\t\t\t\t\t\t\tdeprWarningLogged = true;\n\t\t\t\t\t\t\tdojo.deprecated('dojo.widget.Manager.getImplementationName', 'Wrong namespace ('+namespace+\n\t\t\t\t\t\t\t\t') specified. Developers should specify correct namespaces for all non-Dojo widgets', \"0.5\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (var j = 0; j < renderPrefixCache.length; j++) {\n\t\t\t\t\tif (!widgetPackage[renderPrefixCache[j]]) { continue; }\n\t\t\t\t\tfor (var widgetClass in widgetPackage[renderPrefixCache[j]]) {\n\t\t\t\t\t\tif (widgetClass.toLowerCase() != lowerCaseWidgetName) { continue; }\n\t\t\t\t\t\tknownWidgetImplementations[namespace][lowerCaseWidgetName] =\n\t\t\t\t\t\t\twidgetPackage[renderPrefixCache[j]][widgetClass];\n\t\t\t\t\t\treturn knownWidgetImplementations[namespace][lowerCaseWidgetName];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tfor (var j = 0; j < renderPrefixCache.length; j++) {\n\t\t\t\t\tfor (var widgetClass in widgetPackage) {\n\t\t\t\t\t\tif (widgetClass.toLowerCase() != (renderPrefixCache[j] + lowerCaseWidgetName) &&\n\t\t\t\t\t\t\twidgetClass.toLowerCase() != lowerCaseWidgetName) { continue; }\n\t\t\n\t\t\t\t\t\tknownWidgetImplementations[namespace][lowerCaseWidgetName] =\n\t\t\t\t\t\t\twidgetPackage[widgetClass];\n\t\t\t\t\t\treturn knownWidgetImplementations[namespace][lowerCaseWidgetName];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar newNs = dojo.findNamespaceForWidget(lowerCaseWidgetName);\n\t\t\tif(newNs){\n\t\t\t\tnamespace = newNs.nsPrefix;\t\n\t\t\t}\n\t\t}\n\t\t\n\t\tthrow new Error('Could not locate \"' + widgetName + '\" class');"}}},"dojo.widget.manager.onWindowResized":{"_":{"meta":{"summary":"","src":"\t\tif(this.resizing){\n\t\t\treturn;\t\/\/ duplicate event\n\t\t}\n\t\ttry{\n\t\t\tthis.resizing=true;\n\t\t\tfor(var id in this.topWidgets){\n\t\t\t\tvar child = this.topWidgets[id];\n\t\t\t\tif(child.checkSize ){\n\t\t\t\t\tchild.checkSize();\n\t\t\t\t}\n\t\t\t}\n\t\t}catch(e){\n\t\t}finally{\n\t\t\tthis.resizing=false;\n\t\t}","this_variables":["resizing"],"returns":"duplicate event"}}}}}},"dojo.widget.Menu2":{"meta":{"requires":{"common":["dojo.html.style","dojo.html.layout","dojo.html.selection","dojo.html.iframe","dojo.event.*","dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.PopupContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.PopupMenu2":{"_":{"meta":{"summary":"","inherits":["dojo.widget.PopupContainer"],"this_inherits":["dojo.widget.PopupContainer"]}}},"dojo.widget.MenuItem2":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.MenuSeparator2":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.MenuBar2":{"_":{"meta":{"summary":"","inherits":["dojo.widget.PopupMenu2"],"this_inherits":["dojo.widget.PopupMenu2"]}}},"dojo.widget.MenuBarItem2":{"_":{"meta":{"summary":"","inherits":["dojo.widget.MenuItem2"],"this_inherits":["dojo.widget.MenuItem2"]}}},"dojo.widget.PopupManager.registerWin":{"_":{"meta":{"summary":"","parameters":{"win":{"type":""}},"src":"\t\tif(!win.__PopupManagerRegistered)\n\t\t{\n\t\t\tdojo.event.connect(win.document, 'onmousedown', this, 'onClick');\n\t\t\tdojo.event.connect(win, \"onscroll\", this, \"onClick\");\n\t\t\tdojo.event.connect(win.document, this._keyEventName, this, 'onKeyPress');\n\t\t\twin.__PopupManagerRegistered = true;\n\t\t\tthis.registeredWindows.push(win);\n\t\t}"}}},"dojo.widget.PopupManager.registerAllWindows":{"_":{"meta":{"summary":"","parameters":{"targetWindow":{"type":""}},"src":"\t\tthis.registerWin(targetWindow);\n\n\t\tfor (var i = 0; i < targetWindow.frames.length; i++){\n\t\t\t\/\/do not remove  dojo.html.getDocumentWindow, see comment in it\n\t\t\tvar win = dojo.html.getDocumentWindow(targetWindow.frames[i].document);\n\t\t\tif(win){\n\t\t\t\tthis.registerAllWindows(win);\n\t\t\t}\n\t\t}"}}},"dojo.widget.PopupManager.closed":{"_":{"meta":{"summary":"","parameters":{"menu":{"type":""}},"src":"\t\tif (this.currentMenu == menu){\n\t\t\tthis.currentMenu = null;\n\t\t\tthis.currentButton = null;\n\t\t\tthis.currentFocusMenu = null;\n\t\t}","this_variables":["currentMenu","currentButton","currentFocusMenu"]}}},"dojo.widget.PopupManager.opened":{"_":{"meta":{"summary":"","parameters":{"menu":{"type":""},"button":{"type":""}},"src":"\t\tif (menu == this.currentMenu){ return; }\n\n\t\tif (this.currentMenu){\n\t\t\tthis.currentMenu.close();\n\t\t}\n\n\t\tthis.currentMenu = menu;\n\t\tthis.currentFocusMenu = menu;\n\t\tthis.currentButton = button;","this_variables":["currentMenu","currentFocusMenu","currentButton"]}}},"dojo.widget.PopupManager.setFocusedMenu":{"_":{"meta":{"summary":"","parameters":{"menu":{"type":""}},"src":"\t\tthis.currentFocusMenu = menu;","this_variables":["currentFocusMenu"]}}},"dojo.widget.PopupManager.onKeyPress":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tif(!this.currentMenu || !this.currentMenu.isShowingNow){ return; }\n\n\t\tvar m = this.currentFocusMenu;\n\t\twhile (m){\n\t\t\tif(m.processKey(e)){\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tm = m.parentPopup;\n\t\t}"}}},"dojo.widget.PopupManager.onClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tif (!this.currentMenu){ return; }\n\n\t\tvar scrolloffset = dojo.html.getScroll().offset;\n\n\t\t\/\/ starting from the base menu, perform a hit test\n\t\t\/\/ and exit when one succeeds\n\n\t\tvar m = this.currentMenu;\n\n\t\twhile (m){\n\t\t\tif(dojo.html.overElement(m.domNode, e) || dojo.html.isDescendantOf(e.target, m.domNode)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tm = m.currentSubpopup;\n\t\t}\n\n\t\t\/\/ Also, if user clicked the button that opened this menu, then\n\t\t\/\/ that button will send the menu a close() command, so this code\n\t\t\/\/ shouldn't try to close the menu.  Closing twice messes up animation.\n\t\tif (this.currentButton && dojo.html.overElement(this.currentButton, e)){\n\t\t\treturn;\n\t\t}\n\n\t\t\/\/ the click didn't fall within the open menu tree\n\t\t\/\/ so close it\n\n\t\tthis.currentMenu.close();"}}},"dojo.widget.Menu2.OperaAndKonqFixer.fixNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":" \t\tif (implement){\n \t\t\t\/\/ attach stub oncontextmenu function\n \t\t\tif (!dojo.lang.isFunction(node.oncontextmenu)){\n \t\t\t\tnode.oncontextmenu = function(e){\/*stub*\/}\n \t\t\t}\n\n \t\t\t\/\/ attach control function for oncontextmenu\n \t\t\tif (dojo.render.html.opera){\n \t\t\t\t\/\/ opera\n \t\t\t\t\/\/ listen to ctrl-click events\n \t\t\t\tnode._menufixer_opera = function(e){\n \t\t\t\t\tif (e.ctrlKey){\n \t\t\t\t\t\tthis.oncontextmenu(e);\n \t\t\t\t\t}\n \t\t\t\t};\n\n \t\t\t\tdojo.event.connect(node, \"onclick\", node, \"_menufixer_opera\");\n\n \t\t\t} else {\n \t\t\t\t\/\/ konqueror\n \t\t\t\t\/\/ rightclick, listen to mousedown events\n \t\t\t\tnode._menufixer_konq = function(e){\n \t\t\t\t\tif (e.button==2 ){\n \t\t\t\t\t\te.preventDefault(); \/\/ need to prevent browsers menu\n \t\t\t\t\t\tthis.oncontextmenu(e);\n \t\t\t\t\t}\n \t\t\t\t};\n\n \t\t\t\tdojo.event.connect(node, \"onmousedown\", node, \"_menufixer_konq\");\n \t\t\t}\n \t\t}"}}},"dojo.widget.Menu2.OperaAndKonqFixer.cleanNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":" \t\tif (implement){\n \t\t\t\/\/ checks needed if we gets a non fixed node\n \t\t\tif (node._menufixer_opera){\n \t\t\t\tdojo.event.disconnect(node, \"onclick\", node, \"_menufixer_opera\");\n \t\t\t\tdelete node._menufixer_opera;\n \t\t\t} else if(node._menufixer_konq){\n \t\t\t\tdojo.event.disconnect(node, \"onmousedown\", node, \"_menufixer_konq\");\n \t\t\t\tdelete node._menufixer_konq;\n \t\t\t}\n \t\t\tif (node.oncontextmenu){\n \t\t\t\tdelete node.oncontextmenu;\n \t\t\t}\n \t\t}"}}}}}},"dojo.widget.MonthlyCalendar":{"meta":{"requires":{"common":["dojo.date","dojo.widget.*","dojo.widget.DatePicker","dojo.event.*","dojo.html.*"]},"methods":{"dojo.widget.MonthlyCalendar":{"_":{"meta":{"summary":"","inherits":["dojo.widget.DatePicker"],"this_inherits":["dojo.widget.DatePicker"]}}},"dojo.widget.MonthlyCalendar.util.toRfcDate":{"_":{"meta":{"summary":"","parameters":{"jsDate":{"type":""}},"src":"\t\tif(!jsDate) {\n\t\t\tjsDate = this.today;\n\t\t}\n\t\tvar year = jsDate.getFullYear();\n\t\tvar month = jsDate.getMonth() + 1;\n\t\tif (month < 10) {\n\t\t\tmonth = \"0\" + month.toString();\n\t\t}\n\t\tvar date = jsDate.getDate();\n\t\tif (date < 10) {\n\t\t\tdate = \"0\" + date.toString();\n\t\t}\n\t\t\/\/ because this is a date picker and not a time picker, we treat time \n\t\t\/\/ as zero\n\t\treturn year + \"-\" + month + \"-\" + date + \"T00:00:00+00:00\";"}}},"dojo.widget.MonthlyCalendar.util.fromRfcDate":{"_":{"meta":{"summary":"","parameters":{"rfcDate":{"type":""}},"src":"\t\tvar tempDate = rfcDate.split(\"-\");\n\t\tif(tempDate.length < 3) {\n\t\t\treturn new Date();\n\t\t}\n\t\t\/\/ fullYear, month, date\n\t\treturn new Date(parseInt(tempDate[0]), (parseInt(tempDate[1], 10) - 1), parseInt(tempDate[2].substr(0,2), 10));"}}},"dojo.widget.MonthlyCalendar.util.initFirstSaturday":{"_":{"meta":{"summary":"","parameters":{"month":{"type":""},"year":{"type":""}},"src":"\t\tif(!month) {\n\t\t\tmonth = this.date.getMonth();\n\t\t}\n\t\tif(!year) {\n\t\t\tyear = this.date.getFullYear();\n\t\t}\n\t\tvar firstOfMonth = new Date(year, month, 1);\n\t\treturn {year: year, month: month, date: 7 - firstOfMonth.getDay()};"}}}}}},"dojo.widget.Parse":{"meta":{"requires":{"common":["dojo.widget.Manager","dojo.dom","dojo.namespace"]},"methods":{"dojo.widget.Parse":{"_":{"meta":{"summary":"","parameters":{"fragment":{"type":""}},"src":"\tthis.propertySetsList = [];\n\tthis.fragment = fragment;\n\t\n\tthis.createComponents = function(frag, parentComp){\n\t\tvar comps = [];\n\t\tvar built = false;\n\t\t\/\/ if we have items to parse\/create at this level, do it!\n\t\ttry{\n\t\t\tif((frag)&&(frag[\"tagName\"])&&(frag!=frag[\"nodeRef\"])){\n\t\t\t\tvar djTags = dojo.widget.tags;\n\t\t\t\t\/\/ we split so that you can declare multiple\n\t\t\t\t\/\/ non-destructive widgets from the same ctor node\n\t\t\t\tvar tna = String(frag[\"tagName\"]).split(\";\");\n\t\t\t\tfor(var x=0; x<tna.length; x++){\n\t\t\t\t\tvar ltn = (tna[x].replace(\/^\\s+|\\s+$\/g, \"\")).toLowerCase();\n\t\t\t\t\tvar pos = ltn.indexOf(\":\");\n\t\t\t\t\tvar nsName = (pos > 0) ? ltn.substring(0,pos) : null;\n\t\t\t\t\t\/\/if we don't already have a tag registered for this widget, try to load it's\n\t\t\t\t\t\/\/namespace, if it has one\n\t\t\t\t\tif(!djTags[ltn] && dojo.getNamespace && dojo.lang.isString(ltn) && pos>0){\t\t\t\t    \t\t\t\t\t\n\t\t\t\t\t\tvar ns = dojo.getNamespace(nsName);\n\t\t\t\t\t\tvar tagName = ltn.substring(pos+1,ltn.length);\n\t\t\t\t\t\tvar domain = null;\n\t\t\t\t\t\tvar dojoDomain = frag[ltn][\"dojoDomain\"] || frag[ltn][\"dojodomain\"]; \n\t\t\t\t\t\tif(dojoDomain){\n\t\t\t\t\t\t\tdomain = dojoDomain[0].value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ns){\n\t\t\t\t\t\t    ns.load(tagName, domain);\n\t\t\t\t\t\t}\n\t\t\t\t\t    \n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(!djTags[ltn]){\n\t\t\t\t\t\tdojo.deprecated('dojo.widget.Parse.createComponents', 'Widget not defined for  namespace'+nsName+\n\t\t\t\t\t\t\t', so searching all namespaces. Developers should specify namespaces for all non-Dojo widgets', \"0.5\");\t\t\t\t\t\t\n\t\n\t\t\t\t\t\tvar newNs = dojo.findNamespaceForWidget(tagName);\n\t\t\t\t\t\tif(newNs){\n\t\t\t\t\t\t\tltn = newNs.nsPrefix + \":\" + (ltn.indexOf(\":\")> 0 ? ltn.substring(ltn.indexOf(\":\")+1) : ltn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(djTags[ltn]){\n\t\t\t\t\t\tbuilt = true;\n\t\t\t\t\t\tfrag.tagName = ltn;\n\t\t\t\t\t\tvar ret = djTags[ltn](frag, this, parentComp, frag[\"index\"]);\n\t\t\t\t\t\tcomps.push(ret);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(dojo.lang.isString(ltn) && nsName && dojo._namespaces[nsName]){\n\t\t\t\t\t\t\tdojo.debug(\"no tag handler registered for type: \", ltn);\n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}catch(e){\n\t\t\tdojo.debug(\"dojo.widget.Parse: error:\", e);\n\t\t\t\/\/ throw e;\n\t\t\t\/\/ IE is such a bitch sometimes\n\t\t}\n\t\t\/\/ if there's a sub-frag, build widgets from that too\n\t\tif(!built){\n\t\t\tcomps = comps.concat(this.createSubComponents(frag, parentComp));\n\t\t}\n\t\treturn comps;\n\t}\n\n\t\/*\tcreateSubComponents recurses over a raw JavaScript object structure,\n\t\t\tand calls the corresponding handler for its normalized tagName if it exists\n\t*\/\n\tthis.createSubComponents = function(fragment, parentComp){\n\t\tvar frag, comps = [];\n\t\tfor(var item in fragment){\n\t\t\tfrag = fragment[item];\n\t\t\tif ((frag)&&(typeof frag == \"object\")&&(frag!=fragment.nodeRef)&&(frag!=fragment[\"tagName\"])){\n\t\t\t\tcomps = comps.concat(this.createComponents(frag, parentComp));\n\t\t\t}\n\t\t}\n\t\treturn comps;\n\t}\n\n\t\/*  parsePropertySets checks the top level of a raw JavaScript object\n\t\t\tstructure for any propertySets.  It stores an array of references to \n\t\t\tpropertySets that it finds.\n\t*\/\n\tthis.parsePropertySets = function(fragment){\n\t\treturn [];\n\t\tvar propertySets = [];\n\t\tfor(var item in fragment){\n\t\t\tif((fragment[item][\"tagName\"] == \"dojo:propertyset\")){\n\t\t\t\tpropertySets.push(fragment[item]);\n\t\t\t}\n\t\t}\n\t\t\/\/ FIXME: should we store these propertySets somewhere for later retrieval\n\t\tthis.propertySetsList.push(propertySets);\n\t\treturn propertySets;\n\t}\n\t\n\t\/*  parseProperties checks a raw JavaScript object structure for\n\t\t\tproperties, and returns an array of properties that it finds.\n\t*\/\n\tthis.parseProperties = function(fragment){\n\t\tvar properties = {};\n\t\tfor(var item in fragment){\n\t\t\t\/\/ FIXME: need to check for undefined?\n\t\t\t\/\/ case: its a tagName or nodeRef\n\t\t\tif((fragment[item] == fragment[\"tagName\"])||\n\t\t\t\t(fragment[item] == fragment.nodeRef)){\n\t\t\t\t\/\/ do nothing\n\t\t\t}else{\n\t\t\t\tif((fragment[item][\"tagName\"])&&\n\t\t\t\t\t(dojo.widget.tags[fragment[item].tagName.toLowerCase()])){\n\t\t\t\t\t\/\/ TODO: it isn't a property or property set, it's a fragment, \n\t\t\t\t\t\/\/ so do something else\n\t\t\t\t\t\/\/ FIXME: needs to be a better\/stricter check\n\t\t\t\t\t\/\/ TODO: handle xlink:href for external property sets\n\t\t\t\t}else if((fragment[item][0])&&(fragment[item][0].value!=\"\")&&(fragment[item][0].value!=null)){\n\t\t\t\t\ttry{\n\t\t\t\t\t\t\/\/ FIXME: need to allow more than one provider\n\t\t\t\t\t\tif(item.toLowerCase() == \"dataprovider\") {\n\t\t\t\t\t\t\tvar _this = this;\n\t\t\t\t\t\t\tthis.getDataProvider(_this, fragment[item][0].value);\n\t\t\t\t\t\t\tproperties.dataProvider = this.dataProvider;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tproperties[item] = fragment[item][0].value;\n\t\t\t\t\t\tvar nestedProperties = this.parseProperties(fragment[item]);\n\t\t\t\t\t\t\/\/ FIXME: this kind of copying is expensive and inefficient!\n\t\t\t\t\t\tfor(var property in nestedProperties){\n\t\t\t\t\t\t\tproperties[property] = nestedProperties[property];\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){ dojo.debug(e); }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn properties;\n\t}\n\n\t\/* getPropertySetById returns the propertySet that matches the provided id\n\t*\/\n\t\n\tthis.getDataProvider = function(objRef, dataUrl){\n\t\t\/\/ FIXME: this is currently sync.  To make this async, we made need to move \n\t\t\/\/this step into the widget ctor, so that it is loaded when it is needed \n\t\t\/\/ to populate the widget\n\t\tdojo.io.bind({\n\t\t\turl: dataUrl,\n\t\t\tload: function(type, evaldObj){\n\t\t\t\tif(type==\"load\"){\n\t\t\t\t\tobjRef.dataProvider = evaldObj;\n\t\t\t\t}\n\t\t\t},\n\t\t\tmimetype: \"text\/javascript\",\n\t\t\tsync: true\n\t\t});\n\t}\n\n\t\n\tthis.getPropertySetById = function(propertySetId){\n\t\tfor(var x = 0; x < this.propertySetsList.length; x++){\n\t\t\tif(propertySetId == this.propertySetsList[x][\"id\"][0].value){\n\t\t\t\treturn this.propertySetsList[x];\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\t\n\t\/* getPropertySetsByType returns the propertySet(s) that match(es) the\n\t * provided componentClass\n\t *\/\n\tthis.getPropertySetsByType = function(componentType){\n\t\tvar propertySets = [];\n\t\tfor(var x=0; x < this.propertySetsList.length; x++){\n\t\t\tvar cpl = this.propertySetsList[x];\n\t\t\tvar cpcc = cpl[\"componentClass\"]||cpl[\"componentType\"]||null;\n\t\t\tvar propertySetId = this.propertySetsList[x][\"id\"][0].value;\n\t\t\tif((cpcc)&&(propertySetId == cpcc[0].value)){\n\t\t\t\tpropertySets.push(cpl);\n\t\t\t}\n\t\t}\n\t\treturn propertySets;\n\t}\n\t\n\t\/* getPropertySets returns the propertySet for a given component fragment\n\t*\/\n\tthis.getPropertySets = function(fragment){\n\t\tvar ppl = \"dojo:propertyproviderlist\";\n\t\tvar propertySets = [];\n\t\tvar tagname = fragment[\"tagName\"];\n\t\tif(fragment[ppl]){ \n\t\t\tvar propertyProviderIds = fragment[ppl].value.split(\" \");\n\t\t\t\/\/ FIXME: should the propertyProviderList attribute contain #\n\t\t\t\/\/ \t\t  syntax for reference to ids or not?\n\t\t\t\/\/ FIXME: need a better test to see if this is local or external\n\t\t\t\/\/ FIXME: doesn't handle nested propertySets, or propertySets that\n\t\t\t\/\/ \t\t  just contain information about css documents, etc.\n\t\t\tfor(var propertySetId in propertyProviderIds){\n\t\t\t\tif((propertySetId.indexOf(\"..\")==-1)&&(propertySetId.indexOf(\":\/\/\")==-1)){\n\t\t\t\t\t\/\/ get a reference to a propertySet within the current parsed structure\n\t\t\t\t\tvar propertySet = this.getPropertySetById(propertySetId);\n\t\t\t\t\tif(propertySet != \"\"){\n\t\t\t\t\t\tpropertySets.push(propertySet);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t\/\/ FIXME: add code to parse and return a propertySet from\n\t\t\t\t\t\/\/ another document\n\t\t\t\t\t\/\/ alex: is this even necessaray? Do we care? If so, why?\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\/\/ we put the typed ones first so that the parsed ones override when\n\t\t\/\/ iteration happens.\n\t\treturn (this.getPropertySetsByType(tagname)).concat(propertySets);\n\t}\n\t\n\t\/* \n\t\tnodeRef is the node to be replaced... in the future, we might want to add \n\t\tan alternative way to specify an insertion point\n\n\t\tcomponentName is the expected dojo widget name, i.e. Button of ContextMenu\n\n\t\tproperties is an object of name value pairs\n\t\tnamespace is the namespace of the widget.  Defaults to \"dojo\"\n\t*\/\n\tthis.createComponentFromScript = function(nodeRef, componentName, properties, namespace){\n\t\tif(!namespace){ namespace = \"dojo\"; }\n\t\tvar ltn = namespace + \":\" + componentName.toLowerCase();\n\t\t\n\t\tvar djTags = dojo.widget.tags;\n\t\t\/\/if we don't already have a tag registered for this widget, try to load it's\n\t\t\/\/namespace, if it has one\n\t\tif(!djTags[ltn] && dojo.getNamespace && dojo.lang.isString(ltn)){\t\t    \n\t\t\tvar ns = dojo.getNamespace(namespace);\n\t\t\tif(ns){ns.load(componentName);}\n\t\t}\n\t\t\n\t\tif(!djTags[ltn]){\n\t\t\tdojo.deprecated('dojo.widget.Parse.createComponentFromScript', 'Widget not defined for namespace'+\n\t\t\t\tnamespace +\n\t\t\t\t', so searching all namespaces. Developers should specify namespaces for all non-Dojo widgets', \"0.5\");\t\t\t\t\t\t\n\n\t\t\tvar newNs = dojo.findNamespaceForWidget(componentName.toLowerCase());\n\t\t\tif(newNs){\n\t\t\t\tvar newLtn = newNs.nsPrefix + \":\"+(ltn.indexOf(\":\")> 0 ? ltn.substring(ltn.indexOf(\":\")+1) : ltn);\n\t\t\t\tproperties[newLtn]=properties[ltn];\n\t\t\t\tproperties.namespace = newNs.nsPrefix;\n\t\t\t\tltn = newLtn;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(djTags[ltn]){\n\t\t\tproperties.fastMixIn = true;\t\t\t\n\t\t\t\/\/dojo.profile.start(\"dojo.widget.tags - \"+ltn);\n\t\t\t\/\/var ret = [dojo.widget.tags[ltn](properties, this, null, null, properties)];\n\t\t\tvar ret = [dojo.widget.buildWidgetFromParseTree(ltn, properties, this, null, null, properties)];\n\t\t\t\/\/dojo.profile.end(\"dojo.widget.tags - \"+ltn);\n\t\t\treturn ret;\n\t\t}else{\n\t\t\tdojo.debug(\"no tag handler registered for type: \", ltn);\n\t\t}\n\n\t}","this_variables":["propertySetsList","fragment","createComponents","createSubComponents","parsePropertySets","parseProperties","getDataProvider","getPropertySetById","getPropertySetsByType","getPropertySets","createComponentFromScript"]}}},"dojo.widget.Parse.createComponents":{"_":{"meta":{"summary":"","parameters":{"frag":{"type":""},"parentComp":{"type":""}},"src":"\t\tvar comps = [];\n\t\tvar built = false;\n\t\t\/\/ if we have items to parse\/create at this level, do it!\n\t\ttry{\n\t\t\tif((frag)&&(frag[\"tagName\"])&&(frag!=frag[\"nodeRef\"])){\n\t\t\t\tvar djTags = dojo.widget.tags;\n\t\t\t\t\/\/ we split so that you can declare multiple\n\t\t\t\t\/\/ non-destructive widgets from the same ctor node\n\t\t\t\tvar tna = String(frag[\"tagName\"]).split(\";\");\n\t\t\t\tfor(var x=0; x<tna.length; x++){\n\t\t\t\t\tvar ltn = (tna[x].replace(\/^\\s+|\\s+$\/g, \"\")).toLowerCase();\n\t\t\t\t\tvar pos = ltn.indexOf(\":\");\n\t\t\t\t\tvar nsName = (pos > 0) ? ltn.substring(0,pos) : null;\n\t\t\t\t\t\/\/if we don't already have a tag registered for this widget, try to load it's\n\t\t\t\t\t\/\/namespace, if it has one\n\t\t\t\t\tif(!djTags[ltn] && dojo.getNamespace && dojo.lang.isString(ltn) && pos>0){\t\t\t\t    \t\t\t\t\t\n\t\t\t\t\t\tvar ns = dojo.getNamespace(nsName);\n\t\t\t\t\t\tvar tagName = ltn.substring(pos+1,ltn.length);\n\t\t\t\t\t\tvar domain = null;\n\t\t\t\t\t\tvar dojoDomain = frag[ltn][\"dojoDomain\"] || frag[ltn][\"dojodomain\"]; \n\t\t\t\t\t\tif(dojoDomain){\n\t\t\t\t\t\t\tdomain = dojoDomain[0].value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ns){\n\t\t\t\t\t\t    ns.load(tagName, domain);\n\t\t\t\t\t\t}\n\t\t\t\t\t    \n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif(!djTags[ltn]){\n\t\t\t\t\t\tdojo.deprecated('dojo.widget.Parse.createComponents', 'Widget not defined for  namespace'+nsName+\n\t\t\t\t\t\t\t', so searching all namespaces. Developers should specify namespaces for all non-Dojo widgets', \"0.5\");\t\t\t\t\t\t\n\t\n\t\t\t\t\t\tvar newNs = dojo.findNamespaceForWidget(tagName);\n\t\t\t\t\t\tif(newNs){\n\t\t\t\t\t\t\tltn = newNs.nsPrefix + \":\" + (ltn.indexOf(\":\")> 0 ? ltn.substring(ltn.indexOf(\":\")+1) : ltn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif(djTags[ltn]){\n\t\t\t\t\t\tbuilt = true;\n\t\t\t\t\t\tfrag.tagName = ltn;\n\t\t\t\t\t\tvar ret = djTags[ltn](frag, this, parentComp, frag[\"index\"]);\n\t\t\t\t\t\tcomps.push(ret);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(dojo.lang.isString(ltn) && nsName && dojo._namespaces[nsName]){\n\t\t\t\t\t\t\tdojo.debug(\"no tag handler registered for type: \", ltn);\n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}catch(e){\n\t\t\tdojo.debug(\"dojo.widget.Parse: error:\", e);\n\t\t\t\/\/ throw e;\n\t\t\t\/\/ IE is such a bitch sometimes\n\t\t}\n\t\t\/\/ if there's a sub-frag, build widgets from that too\n\t\tif(!built){\n\t\t\tcomps = comps.concat(this.createSubComponents(frag, parentComp));\n\t\t}\n\t\treturn comps;"}}},"dojo.widget.Parse.createSubComponents":{"_":{"meta":{"summary":"","parameters":{"fragment":{"type":""},"parentComp":{"type":""}},"src":"\t\tvar frag, comps = [];\n\t\tfor(var item in fragment){\n\t\t\tfrag = fragment[item];\n\t\t\tif ((frag)&&(typeof frag == \"object\")&&(frag!=fragment.nodeRef)&&(frag!=fragment[\"tagName\"])){\n\t\t\t\tcomps = comps.concat(this.createComponents(frag, parentComp));\n\t\t\t}\n\t\t}\n\t\treturn comps;"}}},"dojo.widget.Parse.parsePropertySets":{"_":{"meta":{"summary":"","parameters":{"fragment":{"type":""}},"src":"\t\treturn [];\n\t\tvar propertySets = [];\n\t\tfor(var item in fragment){\n\t\t\tif((fragment[item][\"tagName\"] == \"dojo:propertyset\")){\n\t\t\t\tpropertySets.push(fragment[item]);\n\t\t\t}\n\t\t}\n\t\t\/\/ FIXME: should we store these propertySets somewhere for later retrieval\n\t\tthis.propertySetsList.push(propertySets);\n\t\treturn propertySets;"}}},"dojo.widget.Parse.parseProperties":{"_":{"meta":{"summary":"","parameters":{"fragment":{"type":""}},"src":"\t\tvar properties = {};\n\t\tfor(var item in fragment){\n\t\t\t\/\/ FIXME: need to check for undefined?\n\t\t\t\/\/ case: its a tagName or nodeRef\n\t\t\tif((fragment[item] == fragment[\"tagName\"])||\n\t\t\t\t(fragment[item] == fragment.nodeRef)){\n\t\t\t\t\/\/ do nothing\n\t\t\t}else{\n\t\t\t\tif((fragment[item][\"tagName\"])&&\n\t\t\t\t\t(dojo.widget.tags[fragment[item].tagName.toLowerCase()])){\n\t\t\t\t\t\/\/ TODO: it isn't a property or property set, it's a fragment, \n\t\t\t\t\t\/\/ so do something else\n\t\t\t\t\t\/\/ FIXME: needs to be a better\/stricter check\n\t\t\t\t\t\/\/ TODO: handle xlink:href for external property sets\n\t\t\t\t}else if((fragment[item][0])&&(fragment[item][0].value!=\"\")&&(fragment[item][0].value!=null)){\n\t\t\t\t\ttry{\n\t\t\t\t\t\t\/\/ FIXME: need to allow more than one provider\n\t\t\t\t\t\tif(item.toLowerCase() == \"dataprovider\") {\n\t\t\t\t\t\t\tvar _this = this;\n\t\t\t\t\t\t\tthis.getDataProvider(_this, fragment[item][0].value);\n\t\t\t\t\t\t\tproperties.dataProvider = this.dataProvider;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tproperties[item] = fragment[item][0].value;\n\t\t\t\t\t\tvar nestedProperties = this.parseProperties(fragment[item]);\n\t\t\t\t\t\t\/\/ FIXME: this kind of copying is expensive and inefficient!\n\t\t\t\t\t\tfor(var property in nestedProperties){\n\t\t\t\t\t\t\tproperties[property] = nestedProperties[property];\n\t\t\t\t\t\t}\n\t\t\t\t\t}catch(e){ dojo.debug(e); }\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn properties;"}}},"dojo.widget.Parse.getDataProvider":{"_":{"meta":{"summary":"","parameters":{"objRef":{"type":""},"dataUrl":{"type":""}},"src":"\t\t\turl: dataUrl,\n\t\t\tload: function(type, evaldObj){\n\t\t\t\tif(type==\"load\"){\n\t\t\t\t\tobjRef.dataProvider = evaldObj;\n\t\t\t\t}\n\t\t\t},\n\t\t\tmimetype: \"text\/javascript\",\n\t\t\tsync: true\n\t\t});"}}},"dojo.widget.Parse.getPropertySetById":{"_":{"meta":{"summary":"","parameters":{"propertySetId":{"type":""}},"src":"\t\tfor(var x = 0; x < this.propertySetsList.length; x++){\n\t\t\tif(propertySetId == this.propertySetsList[x][\"id\"][0].value){\n\t\t\t\treturn this.propertySetsList[x];\n\t\t\t}\n\t\t}\n\t\treturn \"\";"}}},"dojo.widget.Parse.getPropertySetsByType":{"_":{"meta":{"summary":"","parameters":{"componentType":{"type":""}},"src":"\t\tvar propertySets = [];\n\t\tfor(var x=0; x < this.propertySetsList.length; x++){\n\t\t\tvar cpl = this.propertySetsList[x];\n\t\t\tvar cpcc = cpl[\"componentClass\"]||cpl[\"componentType\"]||null;\n\t\t\tvar propertySetId = this.propertySetsList[x][\"id\"][0].value;\n\t\t\tif((cpcc)&&(propertySetId == cpcc[0].value)){\n\t\t\t\tpropertySets.push(cpl);\n\t\t\t}\n\t\t}\n\t\treturn propertySets;"}}},"dojo.widget.Parse.getPropertySets":{"_":{"meta":{"summary":"","parameters":{"fragment":{"type":""}},"src":"\t\tvar ppl = \"dojo:propertyproviderlist\";\n\t\tvar propertySets = [];\n\t\tvar tagname = fragment[\"tagName\"];\n\t\tif(fragment[ppl]){ \n\t\t\tvar propertyProviderIds = fragment[ppl].value.split(\" \");\n\t\t\t\/\/ FIXME: should the propertyProviderList attribute contain #\n\t\t\t\/\/ \t\t  syntax for reference to ids or not?\n\t\t\t\/\/ FIXME: need a better test to see if this is local or external\n\t\t\t\/\/ FIXME: doesn't handle nested propertySets, or propertySets that\n\t\t\t\/\/ \t\t  just contain information about css documents, etc.\n\t\t\tfor(var propertySetId in propertyProviderIds){\n\t\t\t\tif((propertySetId.indexOf(\"..\")==-1)&&(propertySetId.indexOf(\":\/\/\")==-1)){\n\t\t\t\t\t\/\/ get a reference to a propertySet within the current parsed structure\n\t\t\t\t\tvar propertySet = this.getPropertySetById(propertySetId);\n\t\t\t\t\tif(propertySet != \"\"){\n\t\t\t\t\t\tpropertySets.push(propertySet);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\t\/\/ FIXME: add code to parse and return a propertySet from\n\t\t\t\t\t\/\/ another document\n\t\t\t\t\t\/\/ alex: is this even necessaray? Do we care? If so, why?\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\/\/ we put the typed ones first so that the parsed ones override when\n\t\t\/\/ iteration happens.\n\t\treturn (this.getPropertySetsByType(tagname)).concat(propertySets);"}}},"dojo.widget.Parse.createComponentFromScript":{"_":{"meta":{"summary":"","parameters":{"nodeRef":{"type":""},"componentName":{"type":""},"properties":{"type":""},"namespace":{"type":""}},"src":"\t\tif(!namespace){ namespace = \"dojo\"; }\n\t\tvar ltn = namespace + \":\" + componentName.toLowerCase();\n\t\t\n\t\tvar djTags = dojo.widget.tags;\n\t\t\/\/if we don't already have a tag registered for this widget, try to load it's\n\t\t\/\/namespace, if it has one\n\t\tif(!djTags[ltn] && dojo.getNamespace && dojo.lang.isString(ltn)){\t\t    \n\t\t\tvar ns = dojo.getNamespace(namespace);\n\t\t\tif(ns){ns.load(componentName);}\n\t\t}\n\t\t\n\t\tif(!djTags[ltn]){\n\t\t\tdojo.deprecated('dojo.widget.Parse.createComponentFromScript', 'Widget not defined for namespace'+\n\t\t\t\tnamespace +\n\t\t\t\t', so searching all namespaces. Developers should specify namespaces for all non-Dojo widgets', \"0.5\");\t\t\t\t\t\t\n\n\t\t\tvar newNs = dojo.findNamespaceForWidget(componentName.toLowerCase());\n\t\t\tif(newNs){\n\t\t\t\tvar newLtn = newNs.nsPrefix + \":\"+(ltn.indexOf(\":\")> 0 ? ltn.substring(ltn.indexOf(\":\")+1) : ltn);\n\t\t\t\tproperties[newLtn]=properties[ltn];\n\t\t\t\tproperties.namespace = newNs.nsPrefix;\n\t\t\t\tltn = newLtn;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(djTags[ltn]){\n\t\t\tproperties.fastMixIn = true;\t\t\t\n\t\t\t\/\/dojo.profile.start(\"dojo.widget.tags - \"+ltn);\n\t\t\t\/\/var ret = [dojo.widget.tags[ltn](properties, this, null, null, properties)];\n\t\t\tvar ret = [dojo.widget.buildWidgetFromParseTree(ltn, properties, this, null, null, properties)];\n\t\t\t\/\/dojo.profile.end(\"dojo.widget.tags - \"+ltn);\n\t\t\treturn ret;\n\t\t}else{\n\t\t\tdojo.debug(\"no tag handler registered for type: \", ltn);\n\t\t}"}}},"dojo.widget.getParser":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""}},"src":"\tif(!name){ name = \"dojo\"; }\n\tif(!this._parser_collection[name]){\n\t\tthis._parser_collection[name] = new dojo.widget.Parse();\n\t}\n\treturn this._parser_collection[name];"}}},"dojo.widget.createWidget":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""},"props":{"type":""},"refNode":{"type":""},"position":{"type":""}},"src":"\tvar isNode = false;\n\tvar isNameStr = (typeof name == \"string\");\n\tif(isNameStr){\n\t\tvar pos = name.indexOf(\":\");\n\t\tvar namespace = (pos > -1) ? name.substring(0,pos) : \"dojo\";\n\t\tif(pos > -1){ name = name.substring(pos+1); }\n\t\tvar lowerCaseName = name.toLowerCase();\n\t\tvar namespacedName = namespace+\":\" + lowerCaseName;\n\t\tisNode = ( dojo.byId(name) && (!dojo.widget.tags[namespacedName]) ); \n\t}\n\n\tif( (arguments.length == 1) && ((isNode)||(!isNameStr)) ){\n\t\t\/\/ we got a DOM node \n\t\tvar xp = new dojo.xml.Parse(); \n\t\t\/\/ FIXME: we should try to find the parent! \n\t\tvar tn = (isNode) ? dojo.byId(name) : name; \n\t\treturn dojo.widget.getParser().createComponents(xp.parseElement(tn, null, true))[0]; \n\t}\n\n\tfunction fromScript(placeKeeperNode, name, props, namespace){\n\t\tprops[namespacedName] = { \n\t\t\tdojotype: [{value: lowerCaseName}],\n\t\t\tnodeRef: placeKeeperNode,\n\t\t\tfastMixIn: true\n\t\t};\n\t\tprops.namespace = namespace;\n\t\treturn dojo.widget.getParser().createComponentFromScript(\n\t\t\tplaceKeeperNode, name, props, namespace);\n\t}\n\n\tprops = props||{};\n\tvar notRef = false;\n\tvar tn = null;\n\tvar h = dojo.render.html.capable;\n\tif(h){\n\t\ttn = document.createElement(\"span\");\n\t}\n\tif(!refNode){\n\t\tnotRef = true;\n\t\trefNode = tn;\n\t\tif(h){\n\t\t\tdojo.body().appendChild(refNode);\n\t\t}\n\t}else if(position){\n\t\tdojo.dom.insertAtPosition(tn, refNode, position);\n\t}else{ \/\/ otherwise don't replace, but build in-place\n\t\ttn = refNode;\n\t}\n\tvar widgetArray = fromScript(tn, name.toLowerCase(), props, namespace);\n\tif (!widgetArray || !widgetArray[0] || typeof widgetArray[0].widgetType == \"undefined\") {\n\t\tthrow new Error(\"createWidget: Creation of \\\"\" + name + \"\\\" widget failed.\");\n\t}\n\tif (notRef) {\n\t\tif (widgetArray[0].domNode.parentNode) {\n\t\t\twidgetArray[0].domNode.parentNode.removeChild(widgetArray[0].domNode);\n\t\t}\n\t}\n\treturn widgetArray[0]; \/\/ just return the widget","returns":"just return the widget"}}}}}},"dojo.widget.RemoteTabController":{"meta":{"requires":{"common":["dojo.widget.*"]},"methods":{"dojo.widget.RemoteTabController":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templateCssPath":""}}}},"dojo.widget.RemoteTabController.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.addClass(this.domNode, this[\"class\"]);                                     \n\n\t\t\tif (this.tabContainer) {\n\t\t\t\tdojo.addOnLoad(dojo.lang.hitch(this, function() {\n\t\t\t\t\tthis.setTabContainer(dojo.widget.byId(this.tabContainer));\n\t\t\t\t}));\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.RemoteTabController.setTabContainer":{"_":{"meta":{"summary":" Connect this Remote Tab Controller to an existing TabContainer","parameters":{"tabContainer":{"type":"dojo.widget.TabContainer"}},"src":"\t\t\tthis.setupTabs();\n\n\t\t\tdojo.event.connect(this._tabContainer, \"addChild\", this, \"setupTabs\");\n\t\t\tdojo.event.connect(this._tabContainer, \"selectTab\", this, \"onTabSelected\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["_tabContainer","selectedTab","selectedTab"]}}},"dojo.widget.RemoteTabController.setupTabs":{"_":{"meta":{"summary":" Setup tab buttons for each of the TabContainers tabs","src":"\t\t\tdojo.lang.forEach(this._tabContainer.children, this.addTab, this);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.RemoteTabController.onTabSelected":{"_":{"meta":{"summary":" Do this when a tab gets selected","parameters":{"tab":{"type":"dojo.widget.TabPane"}},"src":"\t\t\t\tdojo.html.removeClass(this.selectedTab.button, \"current\");\n\t\t\t}\n\n\t\t\tthis.selectedTab = this.tabs[tab.widgetId];\n\t\t\tdojo.html.addClass(this.selectedTab.button,\"current\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.RemoteTabController.addTab":{"_":{"meta":{"summary":" Add a new button Create label","parameters":{"tab":{"type":"dojo.widget.TabPane"}},"src":"\t\t\tdojo.html.addClass(div, this.labelClass);\n\t\t\tvar innerDiv = document.createElement(\"div\");\n\n\t\t\t\/\/ need inner span so focus rectangle is drawn properly\n\t\t\tvar titleSpan = document.createElement(\"span\");\n\t\t\ttitleSpan.innerHTML = tab.label;\n\t\t\ttitleSpan.tabIndex=\"-1\";\n\n\t\t\t\/\/ set role on tab title\n\t\t\tdojo.widget.wai.setAttr(titleSpan, \"waiRole\", \"role\", \"tab\");\n\t\t\tinnerDiv.appendChild(titleSpan);\n\t\t\tdojo.html.disableSelection(titleSpan);\n\n\t\t\tdiv.appendChild(innerDiv);\n\t\t\tdiv.tabTitle=titleSpan;\n\t\t\tthis.domNode.appendChild(div);\n\n\t\t\tvar tabObj = {\"tab\": tab, \"button\": div};\n\n\n\t\t\tif (this._tabContainer.selectedTab == tab.widgetId || tab.selected) {\n\t\t\t\tthis.selectedTab = tabObj;\n\t\t\t\tdojo.html.addClass(div, \"current\");\n\t\t\t}\n\n\t\t\tthis.tabs[tab.widgetId] = tabObj;\n\n\t\t\tdojo.event.connect(div, \"onclick\", dojo.lang.hitch(this._tabContainer, function() {\n\t\t\t\tthis.selectTab(tab); \n\t\t\t}));\n\n\t\t\tdojo.event.connect(div, \"onkeydown\", dojo.lang.hitch(this._tabContainer, function(evt) {\n\t\t\t\tthis.tabNavigation(evt, tab); \n\t\t\t}));","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.ResizableTextarea":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.LayoutContainer","dojo.widget.ResizeHandle"]},"methods":{"dojo.widget.ResizableTextarea":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.ResizeHandle":{"meta":{"requires":{"common":["dojo.widget.*","dojo.html.layout","dojo.event"]},"methods":{"dojo.widget.ResizeHandle":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.RichText":{"meta":{"requires":{"common":["dojo.widget.*","dojo.html.*","dojo.html.layout","dojo.event.*","dojo.string.extras"]},"methods":{"dojo.widget.RichText":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"inheritWidth":"","focusOnLoad":"","saveName":"","_content":"","height":"","minHeight":"","isClosed":"","isLoaded":"","useActiveX":"","relativeImageUrls":"","_SEPARATOR":""}}}},"dojo.widget.RichText.fillInTemplate":{"_":{"meta":{"summary":"","src":"\t\t\tthis.open();\n\n\t\t\t\/\/ add the formatting functions\n\t\t\tvar funcs = [\"queryCommandEnabled\", \"queryCommandState\",\n\t\t\t\t\"queryCommandValue\", \"execCommand\"];\n\t\t\tfor(var i = 0; i < funcs.length; i++){\n\t\t\t\tdojo.event.connect(\"around\", this, funcs[i], this, \"_normalizeCommand\");\n\t\t\t}\n\t\t\t\n\t\t\t\/\/ backwards compatibility, needs to be removed\n\t\t\tdojo.event.connect(this, \"onKeyPressed\", this, \"afterKeyPress\");\n\t\t\tdojo.event.connect(this, \"onKeyPress\", this, \"keyPress\");\n\t\t\tdojo.event.connect(this, \"onKeyDown\", this, \"keyDown\");\n\t\t\tdojo.event.connect(this, \"onKeyUp\", this, \"keyUp\");\n\n\t\t\t\/\/ add default some key handlers\t\t\n\t\t\tvar ctrl = this.KEY_CTRL;\n\t\t\tvar exec = function (cmd, arg) {\n\t\t\t\treturn arguments.length == 1 ? function () { this.execCommand(cmd); } :\n\t\t\t\t\tfunction () { this.execCommand(cmd, arg); }","this":"dojo.widget.HtmlWidget"}}},"isSignificantNode":{"_":{"meta":{"summary":"","parameters":{"element":{"type":""}},"src":"\t\t\t\t\t&& dojo.html.getStyle(element, \"display\") != \"none\" \n\t\t\t\t\t&& !dojo.html.isPositionAbsolute(element);"}}},"this.iframe.onload":{"_":{"meta":{"summary":"","src":"\t\t\t\t\tsetTimeout(ifrFunc, 250);"}}},"isSupportedBy":{"_":{"meta":{"summary":"","parameters":{"browsers":{"type":""}},"src":"\t\t\t\treturn {\n\t\t\t\t\tie: Boolean(browsers & ie),\n\t\t\t\t\tmozilla: Boolean(browsers & mozilla),\n\t\t\t\t\tsafari: Boolean(browsers & safari),\n\t\t\t\t\topera: Boolean(browsers & opera)\n\t\t\t\t}"}}}}}},"dojo.widget.Rounded":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.ContentPane","dojo.html.style","dojo.html.display"]},"methods":{"dojo.widget.Rounded":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ContentPane"],"this_inherits":["dojo.widget.ContentPane"]}}}}}},"dojo.widget.Select":{"meta":{"requires":{"common":["dojo.widget.ComboBox","dojo.widget.*","dojo.widget.html.stabile"]},"methods":{"dojo.widget.Select":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ComboBox"],"this_inherits":["dojo.widget.ComboBox"],"protovariables":{"forceValidOption":""}}}},"dojo.widget.Select.setValue":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tthis.comboBoxValue.value = value;\n\t\t\tdojo.widget.html.stabile.setState(this.widgetId, this.getState(), true);\n\t\t\tthis.onValueChanged(value);","this":"dojo.widget.ComboBox"}}},"dojo.widget.ComboBox":{"_":{"meta":{"this_variables":["comboBoxValue.value","comboBoxSelectionValue.value","textInputNode.value"]}}},"dojo.widget.Select.setLabel":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tif (this.textInputNode.value != value) { \/\/ prevent mucking up of selection\n\t\t\t\tthis.textInputNode.value = value;\n\t\t\t}","this":"dojo.widget.ComboBox"}}},"dojo.widget.Select.getLabel":{"_":{"meta":{"summary":"","src":"\t\t\treturn this.comboBoxSelectionValue.value;","this":"dojo.widget.ComboBox"}}},"dojo.widget.Select.getState":{"_":{"meta":{"summary":"","src":"\t\t\treturn {\n\t\t\t\tvalue: this.getValue(),\n\t\t\t\tlabel: this.getLabel()\n\t\t\t};","this":"dojo.widget.ComboBox"}}},"dojo.widget.Select.value":{"_":{"meta":{"summary":"","src":"\t\t\treturn {\n\t\t\t\tvalue: this.getValue(),\n\t\t\t\tlabel: this.getLabel()\n\t\t\t};","this":"dojo.widget.ComboBox"}}},"dojo.widget.Select.label":{"_":{"meta":{"summary":"","src":"\t\t\treturn {\n\t\t\t\tvalue: this.getValue(),\n\t\t\t\tlabel: this.getLabel()\n\t\t\t};","this":"dojo.widget.ComboBox"}}},"dojo.widget.Select.onKeyUp":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis.setLabel(this.textInputNode.value);","this":"dojo.widget.ComboBox"}}},"dojo.widget.Select.setState":{"_":{"meta":{"summary":"","parameters":{"state":{"type":""}},"src":"\t\t\tthis.setValue(state.value);\n\t\t\tthis.setLabel(state.label);","this":"dojo.widget.ComboBox"}}},"dojo.widget.Select.setAllValues":{"_":{"meta":{"summary":"","parameters":{"value1":{"type":""},"value2":{"type":""}},"src":"\t\t\tthis.setValue(value2);\n\t\t\tthis.setLabel(value1);","this":"dojo.widget.ComboBox"}}}}}},"dojo.widget.Show":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.uri.Uri","dojo.event","dojo.animation.Animation","dojo.math.curves","dojo.lang.common","dojo.lang.func"]},"methods":{"dojo.widget.Show":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.ShowAction":{"meta":{"requires":{"common":["dojo.widget.*"]},"methods":{"dojo.widget.ShowAction":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.ShowSlide":{"meta":{"requires":{"common":["dojo.widget.*","dojo.lang.common","dojo.widget.HtmlWidget","dojo.lfx.html","dojo.html.display","dojo.html.layout","dojo.animation.Animation","dojo.graphics.color"]},"methods":{"dojo.widget.ShowSlide":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.SlideShow":{"meta":{"requires":{"common":["dojo.event","dojo.widget.*","dojo.lfx.*","dojo.html.display"]},"methods":{"dojo.widget.SlideShow":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":"","imgUrls":"","imgUrlBase":"","urlsIdx":"","transitionInterval":"","imgWidth":"","imgHeight":"","background":"","foreground":"","stopped":"","fadeAnim":"","imagesContainer":"","startStopButton":"","controlsContainer":"","img1":"","img2":"","preventCache":""}}}},"dojo.widget.SlideShow.delay":{"_":{"meta":{"summary":"","src":"\t\t\t\tsrcObj: this[this.background],\n\t\t\t\tsrcFunc: \"onload\",\n\t\t\t\tadviceObj: this,\n\t\t\t\tadviceFunc: \"backgroundImageLoaded\",\n\t\t\t\tonce: true, \/\/ make sure we only ever hear about it once\n\t\t\t\tdelay: this.delay\n\t\t\t});\n\t\t\tdojo.html.setOpacity(this[this.background], 1.0);\n\t\t\tthis[this.background].src = this.imgUrlBase+this.imgUrls[this.urlsIdx++];\n\t\t\tif(this.urlsIdx>(this.imgUrls.length-1)){\n\t\t\t\tthis.urlsIdx = 0;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["urlsIdx","preventCache","img2.src","img1.src","stopped","startStopButton.value","fadeAnim","foreground","background","urlsIdx","urlsIdx","urlsIdx","urlsIdx","urlsIdx","urlsIdx"]}}},"dojo.widget.SlideShow.fillInTemplate":{"_":{"meta":{"summary":"","src":"\t\t\t\tthis.preventCache = true;\n\t\t\t}\n\t\t\tdojo.html.setOpacity(this.img1, 0.9999);\n\t\t\tdojo.html.setOpacity(this.img2, 0.9999);\n\t\t\twith(this.imagesContainer.style){\n\t\t\t\twidth = this.imgWidth+\"px\";\n\t\t\t\theight = this.imgHeight+\"px\";\n\t\t\t}\n\t\t\twith(this.img1.style){\n\t\t\t\twidth = this.imgWidth+\"px\";\n\t\t\t\theight = this.imgHeight+\"px\";\n\t\t\t}\n\t\t\twith(this.img2.style){\n\t\t\t\twidth = this.imgWidth+\"px\";\n\t\t\t\theight = this.imgHeight+\"px\";\n\t\t\t}\n\t\t\tif(this.imgUrls.length>1){\n\t\t\t\tthis.img2.src = this.imgUrlBase+this.imgUrls[this.urlsIdx++] + this.getUrlSuffix();\n\t\t\t\tthis.endTransition();\n\t\t\t}else{\n\t\t\t\tthis.img1.src = this.imgUrlBase+this.imgUrls[this.urlsIdx++] + this.getUrlSuffix();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.getUrlSuffix":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.preventCache) {\n\t\t\t\treturn \"?ts=\" + (new Date()).getTime();\n\t\t\t} else {\n\t\t\t\treturn \"\";\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.togglePaused":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.debug(\"pause\");\n\t\t\tif(this.stopped){\n\t\t\t\tthis.stopped = false;\n\t\t\t\tthis.backgroundImageLoaded();\n\t\t\t\tthis.startStopButton.value= \"pause\";\n\t\t\t}else{\n\t\t\t\tthis.stopped = true;\n\t\t\t\tthis.startStopButton.value= \"play\";\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.backgroundImageLoaded":{"_":{"meta":{"summary":"","src":"\t\t\t\/\/ actually start the fadeOut effect\n\t\t\t\/\/ NOTE: if we wanted to use other transition types, we'd set them up\n\t\t\t\/\/ \t\t here as well\n\t\t\tif(this.fadeAnim) {\n\t\t\t\tthis.fadeAnim.stop();\n\t\t\t}\n\t\t\tthis.fadeAnim = dojo.lfx.fadeOut(this[this.foreground], \n\t\t\t\tthis.transitionInterval, null);\n\t\t\tdojo.event.connect(this.fadeAnim,\"onEnd\",this,\"endTransition\");\n\t\t\tthis.fadeAnim.play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.endTransition":{"_":{"meta":{"summary":"","src":"\t\t\twith(this[this.foreground].style){ zIndex = parseInt(zIndex)-1; }\n\n\t\t\t\/\/ fg\/bg book-keeping\n\t\t\tvar tmp = this.foreground;\n\t\t\tthis.foreground = this.background;\n\t\t\tthis.background = tmp;\n\t\t\t\/\/ keep on truckin\n\t\t\tthis.loadNextImage();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.loadNextImage":{"_":{"meta":{"summary":"","src":"\t\t\t\tsrcObj: this[this.background],\n\t\t\t\tsrcFunc: \"onload\",\n\t\t\t\tadviceObj: this,\n\t\t\t\tadviceFunc: \"backgroundImageLoaded\",\n\t\t\t\tonce: true, \/\/ make sure we only ever hear about it once\n\t\t\t\tdelay: this.delay\n\t\t\t});\n\t\t\tdojo.html.setOpacity(this[this.background], 1.0);\n\t\t\tthis[this.background].src = this.imgUrlBase+this.imgUrls[this.urlsIdx++];\n\t\t\tif(this.urlsIdx>(this.imgUrls.length-1)){\n\t\t\t\tthis.urlsIdx = 0;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.srcObj":{"_":{"meta":{"summary":"","src":"\t\t\t\tsrcObj: this[this.background],\n\t\t\t\tsrcFunc: \"onload\",\n\t\t\t\tadviceObj: this,\n\t\t\t\tadviceFunc: \"backgroundImageLoaded\",\n\t\t\t\tonce: true, \/\/ make sure we only ever hear about it once\n\t\t\t\tdelay: this.delay\n\t\t\t});\n\t\t\tdojo.html.setOpacity(this[this.background], 1.0);\n\t\t\tthis[this.background].src = this.imgUrlBase+this.imgUrls[this.urlsIdx++];\n\t\t\tif(this.urlsIdx>(this.imgUrls.length-1)){\n\t\t\t\tthis.urlsIdx = 0;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.srcFunc":{"_":{"meta":{"summary":"","src":"\t\t\t\tsrcObj: this[this.background],\n\t\t\t\tsrcFunc: \"onload\",\n\t\t\t\tadviceObj: this,\n\t\t\t\tadviceFunc: \"backgroundImageLoaded\",\n\t\t\t\tonce: true, \/\/ make sure we only ever hear about it once\n\t\t\t\tdelay: this.delay\n\t\t\t});\n\t\t\tdojo.html.setOpacity(this[this.background], 1.0);\n\t\t\tthis[this.background].src = this.imgUrlBase+this.imgUrls[this.urlsIdx++];\n\t\t\tif(this.urlsIdx>(this.imgUrls.length-1)){\n\t\t\t\tthis.urlsIdx = 0;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.adviceObj":{"_":{"meta":{"summary":"","src":"\t\t\t\tsrcObj: this[this.background],\n\t\t\t\tsrcFunc: \"onload\",\n\t\t\t\tadviceObj: this,\n\t\t\t\tadviceFunc: \"backgroundImageLoaded\",\n\t\t\t\tonce: true, \/\/ make sure we only ever hear about it once\n\t\t\t\tdelay: this.delay\n\t\t\t});\n\t\t\tdojo.html.setOpacity(this[this.background], 1.0);\n\t\t\tthis[this.background].src = this.imgUrlBase+this.imgUrls[this.urlsIdx++];\n\t\t\tif(this.urlsIdx>(this.imgUrls.length-1)){\n\t\t\t\tthis.urlsIdx = 0;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.adviceFunc":{"_":{"meta":{"summary":"","src":"\t\t\t\tsrcObj: this[this.background],\n\t\t\t\tsrcFunc: \"onload\",\n\t\t\t\tadviceObj: this,\n\t\t\t\tadviceFunc: \"backgroundImageLoaded\",\n\t\t\t\tonce: true, \/\/ make sure we only ever hear about it once\n\t\t\t\tdelay: this.delay\n\t\t\t});\n\t\t\tdojo.html.setOpacity(this[this.background], 1.0);\n\t\t\tthis[this.background].src = this.imgUrlBase+this.imgUrls[this.urlsIdx++];\n\t\t\tif(this.urlsIdx>(this.imgUrls.length-1)){\n\t\t\t\tthis.urlsIdx = 0;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SlideShow.once":{"_":{"meta":{"summary":"","src":"\t\t\t\tsrcObj: this[this.background],\n\t\t\t\tsrcFunc: \"onload\",\n\t\t\t\tadviceObj: this,\n\t\t\t\tadviceFunc: \"backgroundImageLoaded\",\n\t\t\t\tonce: true, \/\/ make sure we only ever hear about it once\n\t\t\t\tdelay: this.delay\n\t\t\t});\n\t\t\tdojo.html.setOpacity(this[this.background], 1.0);\n\t\t\tthis[this.background].src = this.imgUrlBase+this.imgUrls[this.urlsIdx++];\n\t\t\tif(this.urlsIdx>(this.imgUrls.length-1)){\n\t\t\t\tthis.urlsIdx = 0;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.Slider":{"meta":{"requires":{"common":["dojo.event.*","dojo.dnd.*","dojo.dnd.HtmlDragMove","dojo.widget.*","dojo.html.layout"]},"methods":{"dojo.widget._SliderDragMoveSource":{"_":{"meta":{"summary":"","inherits":["dojo.dnd.HtmlDragMoveSource"],"this_inherits":["dojo.dnd.HtmlDragMoveSource"]}}},"dojo.widget._SliderDragMoveObject":{"_":{"meta":{"summary":"","inherits":["dojo.dnd.HtmlDragMoveObject"],"this_inherits":["dojo.dnd.HtmlDragMoveObject"]}}},"dojo.widget.Slider":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"minimumX":"","minimumY":"","maximumX":"","maximumY":"","snapValuesX":"","snapValuesY":"","_snapToGrid":"","isEnableX":"","isEnableY":"","_valueSizeX":"","_valueSizeY":"","_minX":"","_minY":"","_constraintWidth":"","_constraintHeight":"","_clipLeft":"","_clipRight":"","_clipTop":"","_clipBottom":"","_clipXdelta":"","_clipYdelta":"","initialValueX":"","initialValueY":"","flipX":"","flipY":"","clickSelect":"","activeDrag":"","templateCssPath":"","templatePath":"","sliderHandleNode":"","constrainingContainerNode":"","sliderBackgroundNode":"","progressBackgroundNode":"","topButtonNode":"","leftButtonNode":"","rightButtonNode":"","bottomButtonNode":"","focusNode":"","isDragInProgress":"","widgetStyle":"","buttonStyleX":"","buttonStyleY":"","bottomButtonSrc":"","topButtonSrc":"","leftButtonSrc":"","rightButtonSrc":"","backgroundSrc":"","progressBackgroundSrc":"","backgroundSize":"","backgroundStyle":"","handleStyle":"","handleSrc":"","showButtons":"","_eventCount":"","_typamaticTimer":"","_typamaticFunction":"","defaultTimeout":"","timeoutChangeRate":"","_currentTimeout":""},"this_variables":["initialValueX","minimumX","maximumX","snapValuesX","buttonStyleX","flipX","initialValueY","minimumY","maximumY","snapValuesY","buttonStyleY","flipY"]}}},"dojo.widget.Slider._handleKeyEvents":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar keyCode = evt.keyCode;\n\n\t\t\tswitch(keyCode){\n\t\t\t\tcase k.KEY_LEFT_ARROW:\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\tthis._leftButtonPressed(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_RIGHT_ARROW:\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\tthis._rightButtonPressed(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\tthis._bottomButtonPressed(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\tthis._topButtonPressed(evt);\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._eventCount++;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.k.KEY_LEFT_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(typeof evt == \"object\" && evt != null && typeof evt.keyCode != \"undefined\" && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_LEFT_ARROW:\n\t\t\t\t\tcase k.KEY_RIGHT_ARROW:\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.topButtonNode);\n\t\t\tthis._releaseButton(this.bottomButtonNode);\n\t\t\tthis._releaseButton(this.leftButtonNode);\n\t\t\tthis._releaseButton(this.rightButtonNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tclearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["_typamaticTimer","_currentTimeout","_typamaticTimer","_currentTimeout","_typamaticTimer","_currentTimeout","_typamaticTimer","_currentTimeout","_typamaticTimer","_currentTimeout","_typamaticNode","_typamaticTimer","_currentTimeout","topBorderNode.style.padding","bottomBorderNode.style.padding","topBorderNode.style.paddingBottom","bottomBorderNode.style.paddingTop","rightBorderNode.style.paddingRight","leftBorderNode.style.paddingLeft","domNode.style.padding","topBorderNode.style.borderStyle","rightBorderNode.style.borderStyle","bottomBorderNode.style.borderStyle","leftBorderNode.style.borderStyle","topBorderNode.style.borderColor","rightBorderNode.style.borderColor","bottomBorderNode.style.borderColor","leftBorderNode.style.borderColor","topBorderNode.style.borderWidth","bottomBorderNode.style.borderWidth","topBorderNode.style.borderBottomWidth","bottomBorderNode.style.borderTopWidth","rightBorderNode.style.borderRightWidth","leftBorderNode.style.borderLeftWidth","domNode.style.borderWidth","_handleMove","rightButtonNode.style.width","rightButtonNode.style.visibility","leftButtonNode.style.width","leftButtonNode.style.visibility","bottomButtonNode.style.width","bottomButtonNode.style.visibility","topButtonNode.style.width","topButtonNode.style.visibility","sliderHandleNode.style.left","_clipLeft","_clipRight","progressBackgroundNode.style.clip","_constraintWidth","_clipLeft","_clipXdelta","_clipTop","_clipBottom","snapValuesX","_valueSizeX","sliderHandleNode.style.top","_clipTop","_clipBottom","progressBackgroundNode.style.clip","_constraintHeight","_clipTop","_clipYdelta","_clipLeft","_clipRight","snapValuesY","_valueSizeY"]}}},"dojo.widget.Slider.k.KEY_RIGHT_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(typeof evt == \"object\" && evt != null && typeof evt.keyCode != \"undefined\" && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_LEFT_ARROW:\n\t\t\t\t\tcase k.KEY_RIGHT_ARROW:\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.topButtonNode);\n\t\t\tthis._releaseButton(this.bottomButtonNode);\n\t\t\tthis._releaseButton(this.leftButtonNode);\n\t\t\tthis._releaseButton(this.rightButtonNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tclearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.k.KEY_DOWN_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(typeof evt == \"object\" && evt != null && typeof evt.keyCode != \"undefined\" && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_LEFT_ARROW:\n\t\t\t\t\tcase k.KEY_RIGHT_ARROW:\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.topButtonNode);\n\t\t\tthis._releaseButton(this.bottomButtonNode);\n\t\t\tthis._releaseButton(this.leftButtonNode);\n\t\t\tthis._releaseButton(this.rightButtonNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tclearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.k.KEY_UP_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(typeof evt == \"object\" && evt != null && typeof evt.keyCode != \"undefined\" && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_LEFT_ARROW:\n\t\t\t\t\tcase k.KEY_RIGHT_ARROW:\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.topButtonNode);\n\t\t\tthis._releaseButton(this.bottomButtonNode);\n\t\t\tthis._releaseButton(this.leftButtonNode);\n\t\t\tthis._releaseButton(this.rightButtonNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tclearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._onKeyDown":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\t\tthis._handleKeyEvents(evt);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._onKeyPress":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(document.createEvent){            \n\t\t\t\tthis._handleKeyEvents(evt);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._pressButton":{"_":{"meta":{"summary":"","parameters":{"buttonNode":{"type":""}},"src":"\t\t\tbuttonNode.className = buttonNode.className.replace(\"Outset\",\"Inset\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._releaseButton":{"_":{"meta":{"summary":"","parameters":{"buttonNode":{"type":""}},"src":"\t\t\tbuttonNode.className = buttonNode.className.replace(\"Inset\",\"Outset\");","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._buttonPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""},"buttonNode":{"type":""}},"src":"\t\t\tthis._setFocus();\n\t\t\tif(typeof evt == \"object\"){\n\t\t\t\tif(this._typamaticTimer != null){\n\t\t\t\t\tif(this._typamaticNode == buttonNode){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tclearTimeout(this._typamaticTimer);\n\t\t\t\t}\n\t\t\t\tthis._buttonReleased(null);\n\t\t\t\tthis._eventCount++;\n\t\t\t\tthis._typamaticTimer = null;\n\t\t\t\tthis._currentTimeout = this.defaultTimeout;\n\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t}else if (evt != this._eventCount){\n\t\t\t\tthis._buttonReleased(null);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (buttonNode == this.leftButtonNode && this.isEnableX) {\n\t\t\t\tthis._snapX(dojo.html.getPixelValue (this.sliderHandleNode,\"left\") - this._valueSizeX, this._handleMove );\n\t\t\t}\n\t\t\telse if (buttonNode == this.rightButtonNode && this.isEnableX) {\n\t\t\t\tthis._snapX(dojo.html.getPixelValue (this.sliderHandleNode,\"left\") + this._valueSizeX, this._handleMove );\n\t\t\t}\n\t\t\telse if (buttonNode == this.topButtonNode && this.isEnableY) {\n\t\t\t\tthis._snapY(dojo.html.getPixelValue (this.sliderHandleNode,\"top\") - this._valueSizeY, this._handleMove );\n\t\t\t}\n\t\t\telse if (buttonNode == this.bottomButtonNode && this.isEnableY) {\n\t\t\t\tthis._snapY(dojo.html.getPixelValue (this.sliderHandleNode,\"top\") + this._valueSizeY, this._handleMove );\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis._pressButton(buttonNode);\n\t\t\tthis.notifyListeners();\n\t\t\tthis._typamaticNode = buttonNode;\n\t\t\tthis._typamaticTimer = dojo.lang.setTimeout(this, \"_buttonPressed\", this._currentTimeout, this._eventCount, buttonNode);\n\t\t\tthis._currentTimeout = Math.round(this._currentTimeout * this.timeoutChangeRate);\n\t\t\treturn false;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._bottomButtonPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\treturn this._buttonPressed(evt,this.bottomButtonNode);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._bottomButtonDoubleClicked":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar rc = this._bottomButtonPressed(evt);\n\t\t\tdojo.lang.setTimeout( this, \"_buttonReleased\", 50, null);\n\t\t\treturn rc;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._topButtonPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\treturn this._buttonPressed(evt,this.topButtonNode);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._topButtonDoubleClicked":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar rc = this._topButtonPressed(evt);\n\t\t\tdojo.lang.setTimeout( this, \"_buttonReleased\", 50, null);\n\t\t\treturn rc;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._leftButtonPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\treturn this._buttonPressed(evt,this.leftButtonNode);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._leftButtonDoubleClicked":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar rc = this._leftButtonPressed(evt);\n\t\t\tdojo.lang.setTimeout( this, \"_buttonReleased\", 50, null);\n\t\t\treturn rc;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._rightButtonPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\treturn this._buttonPressed(evt,this.rightButtonNode);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._rightButtonDoubleClicked":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar rc = this._rightButtonPressed(evt);\n\t\t\tdojo.lang.setTimeout( this, \"_buttonReleased\", 50, null);\n\t\t\treturn rc;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._buttonReleased":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(typeof evt == \"object\" && evt != null && typeof evt.keyCode != \"undefined\" && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_LEFT_ARROW:\n\t\t\t\t\tcase k.KEY_RIGHT_ARROW:\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.topButtonNode);\n\t\t\tthis._releaseButton(this.bottomButtonNode);\n\t\t\tthis._releaseButton(this.leftButtonNode);\n\t\t\tthis._releaseButton(this.rightButtonNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tclearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._mouseWheeled":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar scrollAmount = 0;\n\t\t\tif(typeof evt.wheelDelta == 'number'){ \/\/ IE\n\t\t\t\tscrollAmount = evt.wheelDelta;\n\t\t\t}else if (typeof evt.detail == 'number'){ \/\/ Mozilla+Firefox\n\t\t\t\tscrollAmount = -evt.detail;\n\t\t\t}\n\t\t\tif (this.isEnableY) {\n\t\t\t\tif(scrollAmount > 0){\n\t\t\t\t\tthis._topButtonPressed(evt);\n\t\t\t\t\tthis._buttonReleased(evt);\n\t\t\t\t}else if (scrollAmount < 0){\n\t\t\t\t\tthis._bottomButtonPressed(evt);\n\t\t\t\t\tthis._buttonReleased(evt);\n\t\t\t\t}\n\t\t\t} else if (this.isEnableX) {\n\t\t\t\tif(scrollAmount > 0){\n\t\t\t\t\tthis._rightButtonPressed(evt);\n\t\t\t\t\tthis._buttonReleased(evt);\n\t\t\t\t}else if (scrollAmount < 0){\n\t\t\t\t\tthis._leftButtonPressed(evt);\n\t\t\t\t\tthis._buttonReleased(evt);\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._discardEvent":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tdojo.event.browser.stopEvent(evt);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._setFocus":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.focusNode.focus) {\n\t\t\t\tthis.focusNode.focus();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._removeComments":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""}},"src":"\t\t\tvar children = parent.childNodes;\n\t\t\tfor (var i = children.length-1; i >= 0; i--) {\n\t\t\t\tvar aChild = children.item(i);\n\t\t\t\tif (aChild  != null) {\n\t\t\t\t\tswitch(aChild.nodeType){\n\t\t\t\t\t\tcase 1: \/\/ recurse\n\t\t\t\t\t\t\tthis._removeComments(aChild);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 8: \/\/ comment\n\t\t\t\t\t\t\tparent.removeChild(aChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.1":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""}},"src":"\t\t\tvar children = parent.childNodes;\n\t\t\tfor (var i = children.length-1; i >= 0; i--) {\n\t\t\t\tvar aChild = children.item(i);\n\t\t\t\tif (aChild  != null) {\n\t\t\t\t\tswitch(aChild.nodeType){\n\t\t\t\t\t\tcase 1: \/\/ recurse\n\t\t\t\t\t\t\tthis._removeComments(aChild);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 8: \/\/ comment\n\t\t\t\t\t\t\tparent.removeChild(aChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.8":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""}},"src":"\t\t\tvar children = parent.childNodes;\n\t\t\tfor (var i = children.length-1; i >= 0; i--) {\n\t\t\t\tvar aChild = children.item(i);\n\t\t\t\tif (aChild  != null) {\n\t\t\t\t\tswitch(aChild.nodeType){\n\t\t\t\t\t\tcase 1: \/\/ recurse\n\t\t\t\t\t\t\tthis._removeComments(aChild);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 8: \/\/ comment\n\t\t\t\t\t\t\tparent.removeChild(aChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tthis._removeComments(this.domNode);\n\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\tdojo.html.copyStyle(this.domNode, source);\n\t\t\t\/\/ the user's style for the widget might include border and padding\n\t\t\t\/\/ unfortunately, border isn't supported for inline elements\n\t\t\t\/\/ so I get to fake everyone out by setting the border and padding\n\t\t\t\/\/ of the outer table cells\n\t\t\tvar padding = this.domNode.style.padding;\n\t\t\tif (dojo.lang.isString(padding) && padding != \"\" && padding != \"0px\" && padding != \"0px 0px 0px 0px\") {\n\t\t\t\tthis.topBorderNode.style.padding = \n\t\t\t\t\tthis.bottomBorderNode.style.padding = padding;\n\t\t\t\tthis.topBorderNode.style.paddingBottom = \"0px\";\n\t\t\t\tthis.bottomBorderNode.style.paddingTop = \"0px\";\n\t\t\t\tthis.rightBorderNode.style.paddingRight = this.domNode.style.paddingRight;\n\t\t\t\tthis.leftBorderNode.style.paddingLeft= this.domNode.style.paddingLeft;\n\t\t\t\tthis.domNode.style.padding = \"0px 0px 0px 0px\";\n\t\t\t}\n\t\t\tvar borderWidth = this.domNode.style.borderWidth;\n\t\t\tif (dojo.lang.isString(borderWidth) && borderWidth != \"\" && borderWidth != \"0px\" && borderWidth != \"0px 0px 0px 0px\") {\n\t\t\t\tthis.topBorderNode.style.borderStyle = \n\t\t\t\t\tthis.rightBorderNode.style.borderStyle = \n\t\t\t\t\tthis.bottomBorderNode.style.borderStyle = \n\t\t\t\t\tthis.leftBorderNode.style.borderStyle = \n\t\t\t\t\t\tthis.domNode.style.borderStyle;\n\t\t\t\tthis.topBorderNode.style.borderColor = \n\t\t\t\t\tthis.rightBorderNode.style.borderColor = \n\t\t\t\t\tthis.bottomBorderNode.style.borderColor = \n\t\t\t\t\tthis.leftBorderNode.style.borderColor = \n\t\t\t\t\t\tthis.domNode.style.borderColor;\n\t\t\t\tthis.topBorderNode.style.borderWidth = \n\t\t\t\t\tthis.bottomBorderNode.style.borderWidth = borderWidth;\n\t\t\t\tthis.topBorderNode.style.borderBottomWidth = \"0px\";\n\t\t\t\tthis.bottomBorderNode.style.borderTopWidth = \"0px\";\n\t\t\t\tthis.rightBorderNode.style.borderRightWidth = this.domNode.style.borderRightWidth;\n\t\t\t\tthis.leftBorderNode.style.borderLeftWidth = this.domNode.style.borderLeftWidth;\n\t\t\t\tthis.domNode.style.borderWidth = \"0px 0px 0px 0px\";\n\t\t\t}\n\n\t\t\t\/\/ dojo.debug (\"fillInTemplate - className = \" + this.domNode.className);\n\n\t\t\t\/\/ setup drag-n-drop for the sliderHandle\n\t\t\tthis._handleMove = new dojo.widget._SliderDragMoveSource (this.sliderHandleNode);\n\t\t\tthis._handleMove.setParent (this);\n\n\t\t\tif (this.clickSelect) {\n\t\t\t\tdojo.event.connect (this.constrainingContainerNode, \"onmousedown\", this, \"onClick\");\n\t\t\t} \n\n\t\t\tif (this.isEnableX) {\n\t\t\t\tthis.setValueX (!isNaN(this.initialValueX) ? this.initialValueX : (!isNaN(this.minimumX) ? this.minimumX : 0));\n\t\t\t}\n\t\t\tif (!this.isEnableX || !this.showButtons) {\n\t\t\t\tthis.rightButtonNode.style.width = \"1px\"; \/\/ allow the border to show\n\t\t\t\tthis.rightButtonNode.style.visibility = \"hidden\";\n\t\t\t\tthis.leftButtonNode.style.width = \"1px\"; \/\/ allow the border to show\n\t\t\t\tthis.leftButtonNode.style.visibility = \"hidden\";\n\t\t\t}\n\t\t\tif (this.isEnableY) {\n\t\t\t\tthis.setValueY (!isNaN(this.initialValueY) ? this.initialValueY : (!isNaN(this.minimumY) ? this.minimumY : 0));\n\t\t\t}\n\t\t\tif (!this.isEnableY || !this.showButtons) {\n\t\t\t\tthis.bottomButtonNode.style.width = \"1px\"; \/\/ allow the border to show\n\t\t\t\tthis.bottomButtonNode.style.visibility = \"hidden\";\n\t\t\t\tthis.topButtonNode.style.width = \"1px\"; \/\/ allow the border to show\n\t\t\t\tthis.topButtonNode.style.visibility = \"hidden\";\n\t\t\t}\n\t\t\tif(this.focusNode.addEventListener){\n\t\t\t\t\/\/ dojo.event.connect() doesn't seem to work with DOMMouseScroll\n\t\t\t\tthis.focusNode.addEventListener('DOMMouseScroll', dojo.lang.hitch(this, \"_mouseWheeled\"), false); \/\/ Mozilla + Firefox + Netscape\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._snapX":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"handleMove":{"type":""}},"src":"\t\t\tif (x < 0) { x = 0; }\n\t\t\telse if (x > this._constraintWidth) { x = this._constraintWidth; }\n\t\t\telse {\n\t\t\t\tvar selectedValue = Math.round (x \/ this._valueSizeX);\n\t\t\t\tx = Math.round (selectedValue * this._valueSizeX);\n\t\t\t}\n\t\t\tthis.sliderHandleNode.style.left = x + \"px\";\n\t\t\tif (this.flipX) {\n\t\t\t\tthis._clipLeft = x + this._clipXdelta;\n\t\t\t} else {\n\t\t\t\tthis._clipRight = x + this._clipXdelta;\n\t\t\t}\n\t\t\tthis.progressBackgroundNode.style.clip = \"rect(\"+this._clipTop+\"px,\"+this._clipRight+\"px,\"+this._clipBottom+\"px,\"+this._clipLeft+\"px)\";","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._calc_valueSizeX":{"_":{"meta":{"summary":"","src":"\t\t\tvar constrainingCtrBox = dojo.html.getContentBox(this.constrainingContainerNode);\n\t\t\tvar sliderHandleBox = dojo.html.getContentBox(this.sliderHandleNode);\n\t\t\tif (constrainingCtrBox.width <= 0 || sliderHandleBox.width <= 0) { \n\t\t\t\treturn false; \n\t\t\t}\n\n\t\t\tthis._constraintWidth = constrainingCtrBox.width \n\t\t\t\t+ dojo.html.getPadding(this.constrainingContainerNode).width\n\t\t\t\t- sliderHandleBox.width;\n\n\t\t\tif (this.flipX) {\n\t\t\t\tthis._clipLeft = this._clipRight = constrainingCtrBox.width;\n\t\t\t} else {\n\t\t\t\tthis._clipLeft = this._clipRight = 0;\n\t\t\t}\n\t\t\tthis._clipXdelta = sliderHandleBox.width >> 1;\n\t\t\tif (!this.isEnableY) {\n\t\t\t\tthis._clipTop = 0;\n\t\t\t\tthis._clipBottom = constrainingCtrBox.height;\n\t\t\t}\n\n\t\t\tif (this._constraintWidth <= 0) { return false; }\n\t\t\tif (this.snapValuesX == 0) {\n\t\t\t\tthis.snapValuesX = this._constraintWidth + 1;\n\t\t\t}\n\n\t\t\tthis._valueSizeX = this._constraintWidth \/ (this.snapValuesX - 1);\n\t\t\treturn true;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.setValueX":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tif (0.0 == this._valueSizeX) {\n\t\t\t\tif (this._calc_valueSizeX () == false) {\n\t\t\t\t\tdojo.lang.setTimeout(this, \"setValueX\", 100, value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isNaN(value)) {\n\t\t\t\tvalue = 0;\n\t\t\t}\n\t\t\tif (value > this.maximumX) {\n\t\t\t\tvalue = this.maximumX;\n\t\t\t}\n\t\t\telse if (value < this.minimumX) {\n\t\t\t\tvalue = this.minimumX;\n\t\t\t}\n\t\t\tvar pixelPercent = (value-this.minimumX) \/ (this.maximumX-this.minimumX);\n\t\t\tif (this.flipX) {\n\t\t\t\tpixelPercent = 1.0 - pixelPercent;\n\t\t\t}\n\t\t\tthis._snapX (pixelPercent * this._constraintWidth, this._handleMove);\n\t\t\tthis.notifyListeners();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.getValueX":{"_":{"meta":{"summary":"","src":"\t\t\tvar pixelPercent = dojo.html.getPixelValue (this.sliderHandleNode,\"left\") \/ this._constraintWidth;\n\t\t\tif (this.flipX) {\n\t\t\t\tpixelPercent = 1.0 - pixelPercent;\n\t\t\t}\n\t\t\treturn Math.round (pixelPercent * (this.snapValuesX-1)) * ((this.maximumX-this.minimumX) \/ (this.snapValuesX-1)) + this.minimumX;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._snapY":{"_":{"meta":{"summary":"","parameters":{"y":{"type":""},"handleMove":{"type":""}},"src":"\t\t\tif (y < 0) { y = 0; }\n\t\t\telse if (y > this._constraintHeight) { y = this._constraintHeight; }\n\t\t\telse {\n\t\t\t\tvar selectedValue = Math.round (y \/ this._valueSizeY);\n\t\t\t\ty = Math.round (selectedValue * this._valueSizeY);\n\t\t\t}\n\t\t\tthis.sliderHandleNode.style.top = y + \"px\";\n\t\t\tif (this.flipY) {\n\t\t\t\tthis._clipTop = y + this._clipYdelta;\n\t\t\t} else {\n\t\t\t\tthis._clipBottom = y + this._clipYdelta;\n\t\t\t}\n\t\t\tthis.progressBackgroundNode.style.clip = \"rect(\"+this._clipTop+\"px,\"+this._clipRight+\"px,\"+this._clipBottom+\"px,\"+this._clipLeft+\"px)\";","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider._calc_valueSizeY":{"_":{"meta":{"summary":"","src":"\t\t\tvar constrainingCtrBox = dojo.html.getContentBox(this.constrainingContainerNode);\n\t\t\tvar sliderHandleBox = dojo.html.getContentBox(this.sliderHandleNode);\n\t\t\tif (constrainingCtrBox.height <= 0 || sliderHandleBox.height <= 0) { \n\t\t\t\treturn false; \n\t\t\t}\n\n\t\t\tthis._constraintHeight = constrainingCtrBox.height\n\t\t\t\t+ dojo.html.getPadding(this.constrainingContainerNode).height\n\t\t\t\t- sliderHandleBox.height;\n\n\t\t\tif (this.flipY) {\n\t\t\t\tthis._clipTop = this._clipBottom = constrainingCtrBox.height;\n\t\t\t} else {\n\t\t\t\tthis._clipTop = this._clipBottom = 0;\n\t\t\t}\n\t\t\tthis._clipYdelta = sliderHandleBox.height >> 1;\n\t\t\tif (!this.isEnableX) {\n\t\t\t\tthis._clipLeft = 0;\n\t\t\t\tthis._clipRight = constrainingCtrBox.width;\n\t\t\t}\n\n\t\t\tif (this._constraintHeight <= 0) { return false; }\n\t\t\tif (this.snapValuesY == 0) {\n\t\t\t\tthis.snapValuesY = this._constraintHeight + 1;\n\t\t\t}\n\n\t\t\tthis._valueSizeY = this._constraintHeight \/ (this.snapValuesY - 1);\n\t\t\treturn true;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.setValueY":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tif (0.0 == this._valueSizeY) {\n\t\t\t\tif (this._calc_valueSizeY () == false) {\n\t\t\t\t\tdojo.lang.setTimeout(this, \"setValueY\", 100, value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (isNaN(value)) {\n\t\t\t\tvalue = 0;\n\t\t\t}\n\t\t\tif (value > this.maximumY) {\n\t\t\t\tvalue = this.maximumY;\n\t\t\t}\n\t\t\telse if (value < this.minimumY) {\n\t\t\t\tvalue = this.minimumY;\n\t\t\t}\n\t\t\tvar pixelPercent = (value-this.minimumY) \/ (this.maximumY-this.minimumY);\n\t\t\tif (this.flipY) {\n\t\t\t\tpixelPercent = 1.0 - pixelPercent;\n\t\t\t}\n\t\t\tthis._snapY (pixelPercent * this._constraintHeight, this._handleMove);\n\t\t\tthis.notifyListeners();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.getValueY":{"_":{"meta":{"summary":"","src":"\t\t\tvar pixelPercent = dojo.html.getPixelValue (this.sliderHandleNode,\"top\") \/ this._constraintHeight;\n\t\t\tif (this.flipY) {\n\t\t\t\tpixelPercent = 1.0 - pixelPercent;\n\t\t\t}\n\t\t\treturn Math.round (pixelPercent * (this.snapValuesY-1)) * ((this.maximumY-this.minimumY) \/ (this.snapValuesY-1)) + this.minimumY;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.onClick":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif (this.isDragInProgress) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar offset = dojo.html.getScroll().offset;\n\t\t\tvar parent = dojo.html.getAbsolutePosition(this.constrainingContainerNode, true);\n\t\t\tvar content = dojo.html.getContentBox(this._handleMove.domNode);\t\t\t\n\t\t\tif (this.isEnableX) {\n\t\t\t\tvar x = offset.x + evt.clientX - parent.x - (content.width >> 1);\n\t\t\t\tthis._snapX(x, this._handleMove);\n\t\t\t}\n\t\t\tif (this.isEnableY) {\n\t\t\t\tvar y = offset.y + evt.clientY - parent.y - (content.height >> 1);\n\t\t\t\tthis._snapY(y, this._handleMove);\n\t\t\t}\n\t\t\tthis.notifyListeners();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.notifyListeners":{"_":{"meta":{"summary":"","src":"\t\t\tthis.onValueChanged(this.getValueX(), this.getValueY());","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Slider.onValueChanged":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SliderHorizontal":{"_":{"meta":{"summary":"","inherits":["dojo.widget.Slider"],"this_inherits":["dojo.widget.Slider"],"protovariables":{"widgetType":"","isEnableX":"","isEnableY":"","initialValue":"","snapValues":"","minimum":"","maximum":"","buttonStyle":"","backgroundSize":"","backgroundSrc":"","flip":""}}}},"dojo.widget.SliderHorizontal.postMixInProperties":{"_":{"meta":{"summary":"","src":"\t\t\tif (!isNaN(parseFloat(this.initialValue))) {\n\t\t\t\tthis.initialValueX = parseFloat(this.initialValue);\n\t\t\t}\n\t\t\tif (!isNaN(parseFloat(this.minimum))) {\n\t\t\t\tthis.minimumX = parseFloat(this.minimum);\n\t\t\t}\n\t\t\tif (!isNaN(parseFloat(this.maximum))) {\n\t\t\t\tthis.maximumX = parseFloat(this.maximum);\n\t\t\t}\n\t\t\tif (!isNaN(parseInt(this.snapValues))) {\n\t\t\t\tthis.snapValuesX = parseInt(this.snapValues);\n\t\t\t}\n\t\t\tif (dojo.lang.isString(this.buttonStyle) && this.buttonStyle != \"\") {\n\t\t\t\tthis.buttonStyleX = this.buttonStyle;\n\t\t\t}\n\t\t\tif (dojo.lang.isBoolean(this.flip)) {\n\t\t\t\tthis.flipX = this.flip;\n\t\t\t}","this":"dojo.widget.Slider"}}},"dojo.widget.SliderHorizontal.notifyListeners":{"_":{"meta":{"summary":"","src":"\t\t\tthis.onValueChanged(this.getValueX());","this":"dojo.widget.Slider"}}},"dojo.widget.SliderHorizontal.getValue":{"_":{"meta":{"summary":"","src":"\t\t\treturn this.getValueX ();","this":"dojo.widget.Slider"}}},"dojo.widget.SliderHorizontal.setValue":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tthis.setValueX (value);","this":"dojo.widget.Slider"}}},"dojo.widget.SliderHorizontal.onValueChanged":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"","this":"dojo.widget.Slider"}}},"dojo.widget.SliderVertical":{"_":{"meta":{"summary":"","inherits":["dojo.widget.Slider"],"this_inherits":["dojo.widget.Slider"],"protovariables":{"widgetType":"","isEnableX":"","isEnableY":"","initialValue":"","snapValues":"","minimum":"","maximum":"","buttonStyle":"","backgroundSize":"","backgroundSrc":"","flip":""}}}},"dojo.widget.SliderVertical.postMixInProperties":{"_":{"meta":{"summary":"","src":"\t\t\tif (!isNaN(parseFloat(this.initialValue))) {\n\t\t\t\tthis.initialValueY = parseFloat(this.initialValue);\n\t\t\t}\n\t\t\tif (!isNaN(parseFloat(this.minimum))) {\n\t\t\t\tthis.minimumY = parseFloat(this.minimum);\n\t\t\t}\n\t\t\tif (!isNaN(parseFloat(this.maximum))) {\n\t\t\t\tthis.maximumY = parseFloat(this.maximum);\n\t\t\t}\n\t\t\tif (!isNaN(parseInt(this.snapValues))) {\n\t\t\t\tthis.snapValuesY = parseInt(this.snapValues);\n\t\t\t}\n\t\t\tif (dojo.lang.isString(this.buttonStyle) && this.buttonStyle != \"\") {\n\t\t\t\tthis.buttonStyleY = this.buttonStyle;\n\t\t\t}\n\t\t\tif (dojo.lang.isBoolean(this.flip)) {\n\t\t\t\tthis.flipY = this.flip;\n\t\t\t}","this":"dojo.widget.Slider"}}},"dojo.widget.SliderVertical.notifyListeners":{"_":{"meta":{"summary":"","src":"\t\t\tthis.onValueChanged(this.getValueY());","this":"dojo.widget.Slider"}}},"dojo.widget.SliderVertical.getValue":{"_":{"meta":{"summary":"","src":"\t\t\treturn this.getValueY ();","this":"dojo.widget.Slider"}}},"dojo.widget.SliderVertical.setValue":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tthis.setValueY (value);","this":"dojo.widget.Slider"}}},"dojo.widget.SliderVertical.onValueChanged":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"","this":"dojo.widget.Slider"}}}}}},"dojo.widget.SortableTable":{"meta":{"requires":{"common":["dojo.lang","dojo.date","dojo.html.*","dojo.html.selection","dojo.html.util","dojo.html.style","dojo.event.*","dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.SortableTable":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.Spinner":{"meta":{"requires":{"common":["dojo.widget.Manager.*","dojo.widget.validate","dojo.widget.*","dojo.io.*","dojo.lfx.*","dojo.html.*","dojo.html.layout","dojo.string"]},"methods":{"dojo.widget.Spinner":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"inputNode":"","upArrowNode":"","downArrowNode":"","relNode":"","spacerNode":"","inputWidgetId":"","_inputWidget":"","_typamaticTimer":"","_typamaticFunction":"","defaultTimeout":"","timeoutChangeRate":"","_currentTimeout":"","_eventCount":"","incrementSrc":"","decrementSrc":"","templatePath":"","templateCssPath":""}}}},"dojo.widget.Spinner.setValue":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tthis._inputWidget.setValue(value);\n\t\t\tthis._inputWidget.adjustValue(0);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.getValue":{"_":{"meta":{"summary":"","src":"\t\t\treturn this._inputWidget.getValue();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._handleKeyEvents":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar k = dojo.event.browser.keys;\n\t\t\tvar keyCode = evt.keyCode;\n\n\t\t\tswitch(keyCode){\n \t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\tthis._downArrowPressed(evt);\n\t\t\t\t\treturn;\n\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\tthis._upArrowPressed(evt);\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._eventCount++;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.k.KEY_DOWN_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis.inputNode.focus();\n\t\t\tif(evt != null && typeof evt == \"object\" && evt.keyCode && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.upArrowNode);\n\t\t\tthis._releaseButton(this.downArrowNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tdojo.lang.clearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["_typamaticTimer","_currentTimeout","_typamaticTimer","_currentTimeout","spacerNode.style.width","upArrowNode.width","upArrowNode.style.width","upArrowNode.height","upArrowNode.style.height","downArrowNode.width","downArrowNode.style.width","downArrowNode.height","downArrowNode.style.height","relNode.style.","_typamaticTimer","_currentTimeout","_typamaticNode","_typamaticTimer","_currentTimeout","inputNode.selectionEnd","inputNode.selectionEnd","domNode.style.display","_inputWidget","inputNode","domNode"]}}},"dojo.widget.Spinner.k.KEY_UP_ARROW":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis.inputNode.focus();\n\t\t\tif(evt != null && typeof evt == \"object\" && evt.keyCode && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.upArrowNode);\n\t\t\tthis._releaseButton(this.downArrowNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tdojo.lang.clearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.onKeyDown":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\t\tthis._handleKeyEvents(evt);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.onKeyPress":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tif(document.createEvent){            \n\t\t\t\tthis._handleKeyEvents(evt);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\tdojo.html.copyStyle(this.domNode, source);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.resize":{"_":{"meta":{"summary":"","src":"\t\t\tvar inputHeight = dojo.html.getBorderBox(this.inputNode).height;\n\t\t\tvar oldw = dojo.html.getPixelValue(this.upArrowNode,\"width\");\n\t\t\tif (oldw <= 0) {\n\t\t\t\toldw = dojo.html.getContentBox(this.upArrowNode).width;\n\t\t\t}\n\t\t\tvar oldh = dojo.html.getPixelValue(this.upArrowNode,\"height\");\n\t\t\tif (oldh <= 0) {\n\t\t\t\toldh = dojo.html.getContentBox(this.upArrowNode).height;\n\t\t\t}\n\t\t\tif(inputHeight <= 0 || oldh <= 0 || oldw <= 0){\n\t\t\t\t\/\/ need more time to calculate size\n\t\t\t\tdojo.lang.setTimeout(this, \"resize\", 100);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\/\/ note that the border is not resized\n\t\t\tvar border = dojo.html.getBorder(this.upArrowNode);\n\t\t\tvar newh = (inputHeight >> 1) - border.height;\n\t\t\tvar ratio = newh \/ oldh;\n\t\t\tvar neww = Math.floor(oldw * ratio);\n\t\t\tthis.spacerNode.style.width = (neww + border.width) + \"px\";\n\t\t\tif (ratio != 1) {\n\t\t\t\tthis.upArrowNode.width = neww;\n\t\t\t\tthis.upArrowNode.style.width = neww;\n\t\t\t\tthis.upArrowNode.height = newh;\n\t\t\t\tthis.upArrowNode.style.height = newh;\n\t\t\t\tthis.downArrowNode.width = neww;\n\t\t\t\tthis.downArrowNode.style.width = neww;\n\t\t\t\tthis.downArrowNode.height = newh;\n\t\t\t\tthis.downArrowNode.style.height = newh;\n\t\t\t}\n\t\t\tvar inputTop = dojo.html.getAbsolutePosition(this.inputNode,true).y;\n\t\t\tvar spinnerTop = dojo.html.getAbsolutePosition(this.upArrowNode,true).y;\n\t\t\t\/\/ FIXME: dojo bug: getAbsolutePosition includes the border only for gecko browsers\n\t\t\tif (dojo.render.html.mozilla || dojo.render.html.moz) {\n\t\t\t\tinputTop -= dojo.html.getBorderExtent(this.inputNode,\"top\");\n\t\t\t\tspinnerTop -= dojo.html.getBorderExtent(this.upArrowNode,\"top\");\n\t\t\t}\n\t\t\tif (inputTop != spinnerTop) {\n\t\t\t\tthis.relNode.style.top = (dojo.html.getPixelValue(this.relNode,\"top\") + inputTop - spinnerTop) + \"px\";\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._pressButton":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\twith(node.style){\n\t\t\t\tborderWidth = \"1px 0px 0px 1px\";\n\t\t\t\tborderStyle = \"inset\";\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._releaseButton":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\twith(node.style){\n\t\t\t\tborderWidth = \"0px 1px 1px 0px\";\n\t\t\t\tborderStyle = \"outset\";\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._arrowPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""},"direction":{"type":""}},"src":"\t\t\tvar nodePressed = (direction == -1) ? this.downArrowNode : this.upArrowNode;\n\t\t\tvar nodeReleased = (direction == +1) ? this.downArrowNode : this.upArrowNode;\n\t\t\tif(typeof evt != \"number\"){\n\t\t\t\tif(this._typamaticTimer != null){\n\t\t\t\t\tif(this._typamaticNode == nodePressed){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tdojo.lang.clearTimeout(this._typamaticTimer);\n\t\t\t\t}\n\t\t\t\tthis._releaseButton(nodeReleased);\n\t\t\t\tthis._eventCount++;\n\t\t\t\tthis._typamaticTimer = null;\n\t\t\t\tthis._currentTimeout = this.defaultTimeout;\n\n\t\t\t}else if (evt != this._eventCount){\n\t\t\t\tthis._releaseButton(nodePressed);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._pressButton(nodePressed);\n\t\t\tthis.setCursorX(this._inputWidget.adjustValue(direction,this.getCursorX()));\n\t\t\tthis._typamaticNode = nodePressed;\n\t\t\tthis._typamaticTimer = dojo.lang.setTimeout(this, \"_arrowPressed\", this._currentTimeout, this._eventCount, direction);\n\t\t\tthis._currentTimeout = Math.round(this._currentTimeout * this.timeoutChangeRate);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._downArrowPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\treturn this._arrowPressed(evt,-1);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._downArrowDoubleClicked":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar rc = this._downArrowPressed(evt);\n\t\t\tdojo.lang.setTimeout(this, \"_arrowReleased\", 50, null);\n\t\t\treturn rc;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._upArrowPressed":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\treturn this._arrowPressed(evt,+1);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._upArrowDoubleClicked":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar rc = this._upArrowPressed(evt);\n\t\t\tdojo.lang.setTimeout(this, \"_arrowReleased\", 50, null);\n\t\t\treturn rc;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._arrowReleased":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tthis.inputNode.focus();\n\t\t\tif(evt != null && typeof evt == \"object\" && evt.keyCode && evt.keyCode != null){\n\t\t\t\tvar keyCode = evt.keyCode;\n\t\t\t\tvar k = dojo.event.browser.keys;\n\n\t\t\t\tswitch(keyCode){\n\t\t\t\t\tcase k.KEY_DOWN_ARROW:\n\t\t\t\t\tcase k.KEY_UP_ARROW:\n\t\t\t\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._releaseButton(this.upArrowNode);\n\t\t\tthis._releaseButton(this.downArrowNode);\n\t\t\tthis._eventCount++;\n\t\t\tif(this._typamaticTimer != null){\n\t\t\t\tdojo.lang.clearTimeout(this._typamaticTimer);\n\t\t\t}\n\t\t\tthis._typamaticTimer = null;\n\t\t\tthis._currentTimeout = this.defaultTimeout;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._mouseWheeled":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tvar scrollAmount = 0;\n\t\t\tif(typeof evt.wheelDelta == 'number'){ \/\/ IE\n\t\t\t\tscrollAmount = evt.wheelDelta;\n\t\t\t}else if (typeof evt.detail == 'number'){ \/\/ Mozilla+Firefox\n\t\t\t\tscrollAmount = -evt.detail;\n\t\t\t}\n\t\t\tif(scrollAmount > 0){\n\t\t\t\tthis._upArrowPressed(evt);\n\t\t\t\tthis._arrowReleased(evt);\n\t\t\t}else if (scrollAmount < 0){\n\t\t\t\tthis._downArrowPressed(evt);\n\t\t\t\tthis._arrowReleased(evt);\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner._discardEvent":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""}},"src":"\t\t\tdojo.event.browser.stopEvent(evt);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.getCursorX":{"_":{"meta":{"summary":"","src":"\t\t\tvar x = -1;\n\t\t\ttry{\n\t\t\t\tthis.inputNode.focus();\n\t\t\t\tif (typeof this.inputNode.selectionEnd == \"number\"){\n\t\t\t\t\tx = this.inputNode.selectionEnd;\n\t\t\t\t}else if (document.selection && document.selection.createRange) {\n\t\t\t\t\tvar range = document.selection.createRange().duplicate();\n\t\t\t\t\tif(range.parentElement() == this.inputNode){\n\t\t\t\t\t\trange.moveStart('textedit', -1);\n\t\t\t\t\t\tx = range.text.length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}catch(e){ \/* squelch! *\/ }\n\t\t\treturn x;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.setCursorX":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""}},"src":"\t\t\ttry{\n\t\t\t\tthis.inputNode.focus();\n\t\t\t\tif(!x){ x = 0 }\n\t\t\t\tif(typeof this.inputNode.selectionEnd == \"number\"){\n\t\t\t\tthis.inputNode.selectionEnd = x;\n\t\t\t\t}else if(this.inputNode.createTextRange){\n\t\t\t\tvar range = this.inputNode.createTextRange();\n\t\t\t\trange.collapse(true);\n\t\t\t\trange.moveEnd('character', x);\n\t\t\t\trange.moveStart('character', x);\n\t\t\t\trange.select();\n\t\t\t\t}\n\t\t\t}catch(e){ \/* squelch! *\/ }","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Spinner.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tthis.domNode.style.display=\"none\";\n\n\t\t\tthis._inputWidget = dojo.widget.byId(this.inputWidgetId);\n\n\t\t\tif(typeof this._inputWidget != 'object'){\n\t\t\t\tdojo.lang.setTimeout(this, \"postCreate\", 100); \n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar widgetNode = this._inputWidget.domNode;\n\t\t\tvar inputNodes = widgetNode.getElementsByTagName('INPUT');\n\t\t\tthis.inputNode = inputNodes[0];\n\n\t\t\tif(this.inputNode.addEventListener){\n\t\t\t\t\/\/ dojo.event.connect() doesn't seem to work with DOMMouseScroll\n\t\t\t\tthis.inputNode.addEventListener('DOMMouseScroll', dojo.lang.hitch(this, \"_mouseWheeled\"), false); \/\/ Mozilla + Firefox + Netscape\n\t\t\t}else{\n\t\t\t\tdojo.event.connect(this.inputNode, \"onmousewheel\", this, \"_mouseWheeled\"); \/\/ IE + Safari\n\t\t\t}\n\n\t\t\t\/\/ make sure the disconnected node will fit right next to the INPUT tag w\/o any interference\n\t\t\tdojo.html.copyStyle(this.spacerNode, this.inputNode);\n\t\t\twith(this.spacerNode.style){\n\t\t\t\tdisplay = \"inline-block\";\n\t\t\t\tbackgroundColor = \"\";\n\t\t\t\tmarginLeft = \"0px\";\n\t\t\t\tborder = \"0px\";\n\t\t\t\tpaddingLeft = \"0px\";\n\t\t\t}\n\t\t\twith(this.inputNode.style){\n\t\t\t\tmarginRight = \"0px\";\n\t\t\t\tpaddingRight = \"0px\";\n\t\t\t}\n\n\t\t\t\/\/ add the disconnected node right after the INPUT tag\n\t\t\tdojo.html.insertAfter(this.spacerNode, this.inputNode, false);\n\t\t\tthis.domNode = dojo.html.removeNode(this.domNode);\n\n\t\t\tthis.resize();\n\n\t\t\tdojo.event.connect(this.inputNode, \"onkeypress\", this, \"onKeyPress\");\n\t\t\tdojo.event.connect(this.inputNode, \"onkeydown\", this, \"onKeyDown\");\n\t\t\tdojo.event.connect(this.inputNode, \"onkeyup\", this, \"_arrowReleased\");\n\t\t\tdojo.event.connect(this.inputNode, \"onresize\", this, \"resize\");\n\t\t\tdojo.event.connect(this.inputNode, \"onchange\", this, \"resize\");\n\t\t\tdojo.event.connect(window, \"onchange\", this, \"resize\");\n\n\t\t\tthis.setValue(this.getValue());","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.SpinnerIntegerTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.IntegerTextbox"],"this_inherits":["dojo.widget.validate.IntegerTextbox"]}}},"dojo.widget.SpinnerRealNumberTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.RealNumberTextbox"],"this_inherits":["dojo.widget.validate.RealNumberTextbox"]}}},"dojo.widget.SpinnerTimeTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.TimeTextbox"],"this_inherits":["dojo.widget.validate.TimeTextbox"]}}}}}},"dojo.widget.SplitContainer":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.ContentPane","dojo.widget.HtmlWidget","dojo.html.style","dojo.html.layout","dojo.html.selection","dojo.io","dojo.io.cookie"]},"methods":{"dojo.widget.SplitContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.SplitContainerPanel":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ContentPane"],"this_inherits":["dojo.widget.ContentPane"]}}},"dojo.widget.Widget":{"_":{"meta":{"protovariables":{"sizeMin":"","sizeShare":""}}}}}}},"dojo.widget.SvgButton":{"meta":{"requires":{"common":["dojo.widget.Button"]},"methods":{"dojo.widget.SvgButton":{"_":{"meta":{"summary":"","src":"\tdojo.widget.SvgWidget.call(this);\n\n\t\/\/ FIXME: freaking implement this already!\n\tthis.onFoo = function(){ alert(\"bar\"); }\n\n\tthis.label = \"huzzah!\";\n\n\tthis.setLabel = function(x, y, textSize, label, shape){\n\t\t\/\/var labelNode = this.domNode.ownerDocument.createTextNode(this.label);\n\t\t\/\/var textNode = this.domNode.ownerDocument.createElement(\"text\");\n\t\tvar coords = dojo.widget.SvgButton.prototype.coordinates(x, y, textSize, label, shape);\n\t\tvar textString = \"\";\n\t\tswitch(shape) {\n\t\t\tcase \"ellipse\":\n\t\t\t\ttextString = \"<text x='\"+ coords[6] + \"' y='\"+ coords[7] + \"'>\"+ label + \"<\/text>\";\n\t\t\t\t\/\/textNode.setAttribute(\"x\", coords[6]);\n\t\t\t\t\/\/textNode.setAttribute(\"y\", coords[7]);\n\t\t\t\tbreak;\n\t\t\tcase \"rectangle\":\n\t\t\t\t\/\/FIXME: implement\n\t\t\t\ttextString = \"\";\n\t\t\t\t\/\/textNode.setAttribute(\"x\", coords[6]);\n\t\t\t\t\/\/textNode.setAttribute(\"y\", coords[7]);\n\t\t\t\tbreak;\n\t\t\tcase \"circle\":\n\t\t\t\t\/\/FIXME: implement\n\t\t\t\ttextString = \"\";\n\t\t\t\t\/\/textNode.setAttribute(\"x\", coords[6]);\n\t\t\t\t\/\/textNode.setAttribute(\"y\", coords[7]);\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/textNode.appendChild(labelNode);\n\t\t\/\/this.domNode.appendChild(textNode);\n\t\treturn textString;\n\t\t\/\/alert(textNode.getComputedTextLength());\n\t}\n\n\tthis.fillInTemplate = function(x, y, textSize, label, shape){\n\t\t\/\/ the idea is to set the text to the appropriate place given its length\n\t\t\/\/ and the template shape\n\t\t\n\t\t\/\/ FIXME: For now, assuming text sizes are integers in SVG units\n\t\tthis.textSize = textSize || 12;\n\t\tthis.label = label;\n\t\t\/\/ FIXEME: for now, I'm going to fake this... need to come up with a real way to \n\t\t\/\/ determine the actual width of the text, such as computedStyle\n\t\tvar textWidth = this.label.length*this.textSize ;\n\t\t\/\/this.setLabel();\n\t}","this_variables":["onFoo","label","setLabel","fillInTemplate","textSize"],"inherits":["dojo.widget.DomButton"]}}},"dojo.widget.SvgButton.onFoo":{"_":{"meta":{"summary":"","src":"                          alert(\"bar\");   "}}},"dojo.widget.SvgButton.setLabel":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"textSize":{"type":""},"label":{"type":""},"shape":{"type":""}},"src":"\t\tvar textString = \"\";\n\t\tswitch(shape) {\n\t\t\tcase \"ellipse\":\n\t\t\t\ttextString = \"<text x='\"+ coords[6] + \"' y='\"+ coords[7] + \"'>\"+ label + \"<\/text>\";\n\t\t\t\t\/\/textNode.setAttribute(\"x\", coords[6]);\n\t\t\t\t\/\/textNode.setAttribute(\"y\", coords[7]);\n\t\t\t\tbreak;\n\t\t\tcase \"rectangle\":\n\t\t\t\t\/\/FIXME: implement\n\t\t\t\ttextString = \"\";\n\t\t\t\t\/\/textNode.setAttribute(\"x\", coords[6]);\n\t\t\t\t\/\/textNode.setAttribute(\"y\", coords[7]);\n\t\t\t\tbreak;\n\t\t\tcase \"circle\":\n\t\t\t\t\/\/FIXME: implement\n\t\t\t\ttextString = \"\";\n\t\t\t\t\/\/textNode.setAttribute(\"x\", coords[6]);\n\t\t\t\t\/\/textNode.setAttribute(\"y\", coords[7]);\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/textNode.appendChild(labelNode);\n\t\t\/\/this.domNode.appendChild(textNode);\n\t\treturn textString;\n\t\t\/\/alert(textNode.getComputedTextLength());"}}},"dojo.widget.SvgButton.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"textSize":{"type":""},"label":{"type":""},"shape":{"type":""}},"src":"\t\tthis.label = label;\n\t\t\/\/ FIXEME: for now, I'm going to fake this... need to come up with a real way to \n\t\t\/\/ determine the actual width of the text, such as computedStyle\n\t\tvar textWidth = this.label.length*this.textSize ;\n\t\t\/\/this.setLabel();","this_variables":["textSize","label"]}}},"dojo.widget.SvgButton.shapeString":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"textSize":{"type":""},"label":{"type":""},"shape":{"type":""}},"src":"\tswitch(shape) {\n\t\tcase \"ellipse\":\n\t\t\tvar coords = dojo.widget.SvgButton.prototype.coordinates(x, y, textSize, label, shape)\n\t\t\treturn \"<ellipse cx='\"+ coords[4]+\"' cy='\"+ coords[5]+\"' rx='\"+ coords[2]+\"' ry='\"+ coords[3]+\"'\/>\";\n\t\t\tbreak;\n\t\tcase \"rect\":\n\t\t\t\/\/FIXME: implement\n\t\t\treturn \"\";\n\t\t\t\/\/return \"<rect x='110' y='45' width='70' height='30'\/>\";\n\t\t\tbreak;\n\t\tcase \"circle\":\n\t\t\t\/\/FIXME: implement\n\t\t\treturn \"\";\n\t\t\t\/\/return \"<circle cx='210' cy='60' r='23'\/>\";\n\t\t\tbreak;\n\t}","this":"dojo.widget.SvgButton"}}},"dojo.widget.SvgButton.coordinates":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"textSize":{"type":""},"label":{"type":""},"shape":{"type":""}},"src":"\tswitch(shape) {\n\t\tcase \"ellipse\":\n\t\t\tvar buttonWidth = label.length*textSize;\n\t\t\tvar buttonHeight = textSize*2.5\n\t\t\tvar rx = buttonWidth\/2;\n\t\t\tvar ry = buttonHeight\/2;\n\t\t\tvar cx = rx + x;\n\t\t\tvar cy = ry + y;\n\t\t\tvar textX = cx - rx*textSize\/25;\n\t\t\tvar textY = cy*1.1;\n\t\t\treturn [buttonWidth, buttonHeight, rx, ry, cx, cy, textX, textY];\n\t\t\tbreak;\n\t\tcase \"rectangle\":\n\t\t\t\/\/FIXME: implement\n\t\t\treturn \"\";\n\t\t\tbreak;\n\t\tcase \"circle\":\n\t\t\t\/\/FIXME: implement\n\t\t\treturn \"\";\n\t\t\tbreak;\n\t}","this":"dojo.widget.SvgButton"}}},"dojo.widget.SvgButton.labelString":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"textSize":{"type":""},"label":{"type":""},"shape":{"type":""}},"src":"\tvar textString = \"\";\n\tvar coords = dojo.widget.SvgButton.prototype.coordinates(x, y, textSize, label, shape);\n\tswitch(shape) {\n\t\tcase \"ellipse\":\n\t\t\ttextString = \"<text x='\"+ coords[6] + \"' y='\"+ coords[7] + \"'>\"+ label + \"<\/text>\";\n\t\t\tbreak;\n\t\tcase \"rectangle\":\n\t\t\t\/\/FIXME: implement\n\t\t\ttextString = \"\";\n\t\t\tbreak;\n\t\tcase \"circle\":\n\t\t\t\/\/FIXME: implement\n\t\t\ttextString = \"\";\n\t\t\tbreak;\n\t}\n\treturn textString;","this":"dojo.widget.SvgButton"}}},"dojo.widget.SvgButton.templateString":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"textSize":{"type":""},"label":{"type":""},"shape":{"type":""}},"src":"\treturn \"<g class='dojoButton' dojoAttachEvent='onClick; onMouseMove: onFoo;' dojoAttachPoint='labelNode'>\"+ dojo.widgets.SVGButton.prototype.shapeString(x, y, textSize, label, shape) + dojo.widget.SVGButton.prototype.labelString(x, y, textSize, label, shape) + \"<\/g>\";","this":"dojo.widget.SvgButton"}}}}}},"dojo.widget.SvgWidget":{"meta":{"requires":{"common":["dojo.widget.DomWidget","dojo.dom"]},"methods":{"dojo.widget.SvgWidget":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""}},"src":"\t\/\/ mix in the parent type\n\t\/\/ dojo.widget.DomWidget.call(this);","inherits":["dojo.widget.DomWidget"]}}},"tf":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.SvgWidget.call(this);\n\t\t\tthis.buildRendering = function(){ return; }\n\t\t\tthis.destroyRendering = function(){ return; }\n\t\t\tthis.postInitialize = function(){ return; }\n\t\t\tthis.cleanUp = function(){ return; }\n\t\t\tthis.widgetType = \"SVGRootWidget\";\n\t\t\tthis.domNode = document.documentElement;\n\t\t}\n\t\tvar wm = dojo.widget.manager;\n\t\twm.root = rw;\n\t\twm.add(rw);\n\n\t\t\/\/ extend the widgetManager with a getWidgetFromNode method\n\t\twm.getWidgetFromNode = function(node){\n\t\t\tvar filter = function(x){\n\t\t\t\tif(x.domNode == node){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar widgets = [];\n\t\t\twhile((node)&&(widgets.length < 1)){\n\t\t\t\twidgets = this.getWidgetsByFilter(filter);\n\t\t\t\tnode = node.parentNode;\n\t\t\t}\n\t\t\tif(widgets.length > 0){\n\t\t\t\treturn widgets[0];\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\twm.getWidgetFromEvent = function(domEvt){\n\t\t\treturn this.getWidgetFromNode(domEvt.target);\n\t\t}\n\n\t\twm.getWidgetFromPrimitive = wm.getWidgetFromNode;","this_variables":["buildRendering","destroyRendering","postInitialize","cleanUp","widgetType","domNode"]}}},"tf.buildRendering":{"_":{"meta":{"summary":"","src":"                                     return;   "}}},"tf.destroyRendering":{"_":{"meta":{"summary":"","src":"                                       return;   "}}},"tf.postInitialize":{"_":{"meta":{"summary":"","src":"                                     return;   "}}},"tf.cleanUp":{"_":{"meta":{"summary":"","src":"                              return;   "}}},"dojo.widget.SvgWidget.getContainerHeight":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.SvgWidget"}}},"dojo.widget.SvgWidget.getContainerWidth":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.SvgWidget"}}},"dojo.widget.SvgWidget.setNativeHeight":{"_":{"meta":{"summary":"","parameters":{"height":{"type":""}},"src":"","this":"dojo.widget.SvgWidget"}}},"dojo.widget.SvgWidget.createNodesFromText":{"_":{"meta":{"summary":"","parameters":{"txt":{"type":""},"wrap":{"type":""}},"src":"\t\treturn dojo.dom.createNodesFromText(txt, wrap);","this":"dojo.widget.SvgWidget"}}}}}},"dojo.widget.SwtWidget":{"meta":{"requires":{"common":["dojo.event.*","dojo.widget.Widget","dojo.uri.*","dojo.lang.func","dojo.lang.extras"]},"methods":{"dojo.widget.SwtWidget":{"_":{"meta":{"summary":"","inherits":["dojo.widget.Widget"],"this_inherits":["dojo.widget.Widget"],"protovariables":{"display":"","shell":""}}}},"dojo.widget.SwtWidget.show":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.hide":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.addChild":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.registerChild":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.addWidgetAsDirectChild":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.removeChild":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.cleanUp":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.destroyRendering":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.SwtWidget.postInitialize":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.Widget"}}},"dojo.widget.manager.startShell":{"_":{"meta":{"summary":"","src":"\t\tvar sh = dojo.widget.SwtWidget.prototype.shell;\n\t\tvar d = dojo.widget.SwtWidget.prototype.display;\n\t\tsh.open();\n\t\twhile(!sh.isDisposed()){\n\t\t\tdojo.widget.manager.doNext();\n\t\t\tif(!d.readAndDispatch()){\n\t\t\t\td.sleep();\n\t\t\t}\n\t\t}\n\t\td.dispose();"}}}}}},"dojo.widget.TabContainer":{"meta":{"requires":{"common":["dojo.lang.func","dojo.widget.*","dojo.widget.HtmlWidget","dojo.event.*","dojo.html.selection","dojo.widget.html.layout"]},"methods":{"dojo.widget.TabContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"isContainer":"","labelPosition":"","closeButton":"","useVisibility":"","doLayout":"","templatePath":"","templateCssPath":"","selectedTab":""}}}},"dojo.widget.TabContainer.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tdojo.html.copyStyle(this.domNode, source);\n\n\t\tdojo.widget.TabContainer.superclass.fillInTemplate.call(this, args, frag);","this_inherits":["dojo.widget.TabContainer.superclass.fillInTemplate"],"this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer.postCreate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tthis._setupTab(this.children[i]);\n\t\t}\n\n\t\tif (this.closeButton==\"pane\") {\n\t\t\tvar div = document.createElement(\"div\");\n\t\t\tdojo.html.addClass(div, \"dojoTabPanePaneClose\");\n\t\t\tdojo.event.connect(div, \"onclick\", dojo.lang.hitch(this, \n\t\t\t\t\tfunction(){ this._runOnCloseTab(this.selectedTabWidget); }\n\t\t\t\t)\n\t\t\t);\n\t\t\tdojo.event.connect(div, \"onmouseover\", function(){ dojo.html.addClass(div, \"dojoTabPanePaneCloseHover\"); });\n\t\t\tdojo.event.connect(div, \"onmouseout\", function(){ dojo.html.removeClass(div, \"dojoTabPanePaneCloseHover\"); });\n\t\t\tthis.dojoTabLabels.appendChild(div);\n\t\t}\n\n\t\tif(!this.doLayout){\n\t\t\tdojo.html.addClass(this.dojoTabLabels, \"dojoTabNoLayout\");\n\t\t\tif (this.labelPosition == 'bottom') {\n\t\t\t\tvar p = this.dojoTabLabels.parentNode;\n\t\t\t\tp.removeChild(this.dojoTabLabels);\n\t\t\t\tp.appendChild(this.dojoTabLabels);\n\t\t\t}\n\t\t}\n\t\tdojo.html.addClass(this.dojoTabLabels, \"dojoTabLabels-\"+this.labelPosition);\n\n\t\tthis._doSizing();\n\n\t\t\/\/ Display the selected tab\n\t\tif(this.selectedTabWidget){\n\t\t\tthis.selectTab(this.selectedTabWidget, true);\n\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["labelPosition","closeButton","selectedTabWidget","selectedTabWidget","selectedTabWidget"]}}},"dojo.widget.TabContainer.addChild":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"overrideContainerNode":{"type":""},"pos":{"type":""},"ref":{"type":""},"insertIndex":{"type":""}},"src":"\t\tdojo.widget.TabContainer.superclass.addChild.call(this,child, overrideContainerNode, pos, ref, insertIndex);\n\n\t\t\/\/ in case the tab labels have overflowed from one line to two lines\n\t\tthis._doSizing();","this_inherits":["dojo.widget.TabContainer.superclass.addChild"],"this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer._setupTab":{"_":{"meta":{"summary":"","parameters":{"tab":{"type":""}},"src":"\t\ttab.domNode.style.display=\"none\";\n\n\t\t\/\/ Create label\n\t\ttab.div = document.createElement(\"div\");\n\t\tdojo.html.addClass(tab.div, \"dojoTabPaneTab\");\n\t\tvar innerDiv = document.createElement(\"div\");\n\t\t\/\/ need inner span so focus rectangle is drawn properly\n\t\tvar titleSpan = document.createElement(\"span\");\n\t\ttitleSpan.innerHTML = tab.label;\n\t\ttitleSpan.tabIndex=\"-1\";\n\t\t\/\/ set role on tab title\n\t\tdojo.widget.wai.setAttr(titleSpan, \"waiRole\", \"role\", \"tab\");\n\t\tinnerDiv.appendChild(titleSpan);\n\t\tdojo.html.disableSelection(titleSpan); \n\t\t\n\t\tif(this.closeButton==\"tab\" || tab.tabCloseButton){\n\t\t\tvar img = document.createElement(\"span\");\n\t\t\tdojo.html.addClass(img, \"dojoTabPaneTabClose\");\n\t\t\tdojo.event.connect(img, \"onclick\", dojo.lang.hitch(this, \n\t\t\t\t\tfunction(evt){ \n\t\t\t\t\t\tthis._runOnCloseTab(tab); dojo.event.browser.stopEvent(evt);\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t\tdojo.event.connect(img, \"onmouseover\", function(){ dojo.html.addClass(img,\"dojoTabPaneTabCloseHover\"); });\n\t\t\tdojo.event.connect(img, \"onmouseout\", function(){ dojo.html.removeClass(img,\"dojoTabPaneTabCloseHover\"); });\n\t\t\tinnerDiv.appendChild(img);\n\t\t}\n\t\ttab.div.appendChild(innerDiv);\n\t\ttab.div.tabTitle=titleSpan;\n\t\tthis.dojoTabLabels.appendChild(tab.div);\n\n\t\tdojo.event.connect(tab.div, \"onclick\", dojo.lang.hitch(this, \n\t\t\t\tfunction(){ this.selectTab(tab); }\n\t\t\t)\n\t\t);\n\t\tdojo.event.connect(tab.div, \"onkeydown\", dojo.lang.hitch(this, \n\t\t\t\tfunction(evt){ this.tabNavigation(evt, tab); } \n\t\t\t)\n\t\t);\n\n\t\tif(!this.selectedTabWidget || this.selectedTab==tab.widgetId || tab.selected || (this.children.length==0)){\n\t\t\t\/\/ Deselect old tab and select new one\n\t\t\t\/\/ We do this instead of calling selectTab in this case, becuase other wise other widgets\n\t\t\t\/\/ listening for addChild and selectTab can run into a race condition\n\t\t\tif(this.selectedTabWidget){\n\t\t\t\tthis._hideTab(this.selectedTabWidget);\n\t\t\t}\n\t\t\tthis.selectedTabWidget = tab;\n\t\t\tthis._showTab(tab);\n\n\t\t} else {\n\t\t\tthis._hideTab(tab);\n\t\t}\n\n\t\tdojo.html.addClass(tab.domNode, \"dojoTabPane\");\n\n\t\tif(this.doLayout){\n\t\t\twith(tab.domNode.style){\n\t\t\t\ttop = dojo.html.getPixelValue(this.containerNode, \"padding-top\", true);\n\t\t\t\tleft = dojo.html.getPixelValue(this.containerNode, \"padding-left\", true);\n\t\t\t}\n\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer._doSizing":{"_":{"meta":{"summary":"","src":"\t\tif(!this.doLayout){ return; }\n\n\t\t\/\/ position the labels and the container node\n\t\tvar labelAlign=this.labelPosition.replace(\/-h\/,\"\");\n\t\tvar children = [\n\t\t\t{domNode: this.dojoTabLabels, layoutAlign: labelAlign},\n\t\t\t{domNode: this.containerNode, layoutAlign: \"client\"}\n\t\t];\n\n\t\tdojo.widget.html.layout(this.domNode, children);\n\n\t\t\/\/ size the current tab\n\t\t\/\/ TODO: should have ptr to current tab rather than searching\n\t\tvar content = dojo.html.getContentBox(this.containerNode);\n\t\tdojo.lang.forEach(this.children, function(child){\n\t\t\tif(child.selected){\n\t\t\t\tchild.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t});","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer.domNode":{"_":{"meta":{"summary":"","src":"\t\tif(!this.doLayout){ return; }\n\n\t\t\/\/ position the labels and the container node\n\t\tvar labelAlign=this.labelPosition.replace(\/-h\/,\"\");\n\t\tvar children = [\n\t\t\t{domNode: this.dojoTabLabels, layoutAlign: labelAlign},\n\t\t\t{domNode: this.containerNode, layoutAlign: \"client\"}\n\t\t];\n\n\t\tdojo.widget.html.layout(this.domNode, children);\n\n\t\t\/\/ size the current tab\n\t\t\/\/ TODO: should have ptr to current tab rather than searching\n\t\tvar content = dojo.html.getContentBox(this.containerNode);\n\t\tdojo.lang.forEach(this.children, function(child){\n\t\t\tif(child.selected){\n\t\t\t\tchild.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t});","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer.removeChild":{"_":{"meta":{"summary":"","parameters":{"tab":{"type":""}},"src":"\t\tif(this.closeButton == \"tab\"){\n\t\t\tvar img = tab.div.lastChild.lastChild;\n\t\t\tif(img){\n\t\t\t\tdojo.html.removeClass(img, \"dojoTabPaneTabClose\");\n\t\t\t}\n\t\t}\n\n\t\tdojo.widget.TabContainer.superclass.removeChild.call(this, tab);\n\n\t\tdojo.html.removeClass(tab.domNode, \"dojoTabPane\");\n\t\tthis.dojoTabLabels.removeChild(tab.div);\n\t\tdelete(tab.div);\n\n\t\tif (this.selectedTabWidget === tab) {\n\t\t\tthis.selectedTabWidget = undefined;\n\t\t\tif (this.children.length > 0) {\n\t\t\t\tthis.selectTab(this.children[0], true);\n\t\t\t}\n\t\t}\n\n\t\t\/\/ in case the tab labels have overflowed from one line to two lines\n\t\tthis._doSizing();","this_inherits":["dojo.widget.TabContainer.superclass.removeChild"],"this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer.selectTab":{"_":{"meta":{"summary":"","parameters":{"tab":{"type":""},"_noRefresh":{"type":""}},"src":"\t\t\tthis._hideTab(this.selectedTabWidget);\n\t\t}\n\t\tthis.selectedTabWidget = tab;\n\t\tthis._showTab(tab, _noRefresh);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer.tabNavigation":{"_":{"meta":{"summary":"","parameters":{"evt":{"type":""},"tab":{"type":""}},"src":"\t\tif( (evt.keyCode == evt.KEY_RIGHT_ARROW)||\n\t\t\t(evt.keyCode == evt.KEY_LEFT_ARROW) ){\n\t\t\tvar current = null;\n\t\t\tvar next = null;\n\t\t\tfor(var i=0; i < this.children.length; i++){\n\t\t\t\tif(this.children[i] == tab){\n\t\t\t\t\tcurrent = i; \n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(evt.keyCode == evt.KEY_RIGHT_ARROW){\n\t\t\t\tnext = this.children[ (current+1) % this.children.length ]; \n\t\t\t}else{ \/\/ is LEFT_ARROW\n\t\t\t\tnext = this.children[ (current+ (this.children.length-1)) % this.children.length ];\n\t\t\t}\n\t\t\tthis.selectTab(next);\n\t\t\tdojo.event.browser.stopEvent(evt);\n\t\t\tnext.div.tabTitle.focus();\n\t\t} ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer.keyDown":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tif(e.keyCode == e.KEY_UP_ARROW && e.ctrlKey){\n\t\t\t\/\/ set focus to current tab\n\t\t\tthis.selectTab(this.selectedTabWidget);\n\t\t\tdojo.event.browser.stopEvent(e);\n\t\t\tthis.selectedTabWidget.div.tabTitle.focus();\n\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer._showTab":{"_":{"meta":{"summary":"","parameters":{"tab":{"type":""},"_noRefresh":{"type":""}},"src":"\t\tdojo.html.addClass(tab.div, \"current\");\n\t\ttab.selected=true;\n\t\ttab.div.tabTitle.setAttribute(\"tabIndex\",\"0\");\n\t\tif ( this.useVisibility && !dojo.render.html.ie){\n\t\t\ttab.domNode.style.visibility=\"visible\";\n\t\t}else{\n\t\t\t\/\/ make sure we dont refresh onClose and on postCreate\n\t\t\t\/\/ speeds up things a bit when using refreshOnShow and fixes #646\n\t\t\tif(_noRefresh && tab.refreshOnShow){\n\t\t\t\tvar tmp = tab.refreshOnShow;\n\t\t\t\ttab.refreshOnShow = false;\n\t\t\t\ttab.show();\n\t\t\t\ttab.refreshOnShow = tmp;\n\t\t\t}else{\n\t\t\t\ttab.show();\n\t\t\t}\n\n\t\t\tif(this.doLayout){\n\t\t\t\tvar content = dojo.html.getContentBox(this.containerNode);\n\t\t\t\ttab.resizeTo(content.width, content.height);\n\t\t\t}\n\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer._hideTab":{"_":{"meta":{"summary":"","parameters":{"tab":{"type":""}},"src":"\t\tdojo.html.removeClass(tab.div, \"current\");\n\t\ttab.div.tabTitle.setAttribute(\"tabIndex\",\"-1\");\n\t\ttab.selected=false;\n\t\tif( this.useVisibility ){\n\t\t\ttab.domNode.style.visibility=\"hidden\";\n\t\t}else{\n\t\t\ttab.hide();\n\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer._runOnCloseTab":{"_":{"meta":{"summary":"","parameters":{"tab":{"type":""}},"src":"\t\tvar onc = tab.extraArgs.onClose || tab.extraArgs.onclose;\n\t\tvar fcn = dojo.lang.isFunction(onc) ? onc : window[onc];\n\t\tvar remove = dojo.lang.isFunction(fcn) ? fcn(this,tab) : true;\n\t\tif(remove) {\n\t\t\tthis.removeChild(tab);\n\t\t\t\/\/ makes sure we can clean up executeScripts in ContentPane onUnLoad\n\t\t\ttab.destroy();\n\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.TabContainer.onResized":{"_":{"meta":{"summary":"","src":"\t\tthis._doSizing();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Widget":{"_":{"meta":{"protovariables":{"label":"","selected":"","tabCloseButton":""}}}}}}},"dojo.widget.TaskBar":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.FloatingPane","dojo.widget.HtmlWidget","dojo.event","dojo.html.selection"]},"methods":{"dojo.widget.TaskBarItem":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.TaskBar":{"_":{"meta":{"summary":"","inherits":["dojo.widget.FloatingPane"],"this_inherits":["dojo.widget.FloatingPane"]}}}}}},"dojo.widget.TimePicker":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.event.*","dojo.date","dojo.dom","dojo.html.style"]},"methods":{"dojo.widget.TimePicker":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.TimePicker.util.toRfcDateTime":{"_":{"meta":{"summary":"","parameters":{"jsDate":{"type":""}},"src":"\t\tif(!jsDate) {\n\t\t\tjsDate = new Date();\n\t\t}\n\t\treturn dojo.date.format(jsDate, \"%Y-%m-%dT%H:%M:00%z\");"}}},"dojo.widget.TimePicker.util.fromRfcDateTime":{"_":{"meta":{"summary":"","parameters":{"rfcDate":{"type":""},"useDefaultMinutes":{"type":""},"isAnyTime":{"type":""}},"src":"\t\tvar tempDate = new Date();\n\t\tif(!rfcDate || rfcDate.indexOf(\"T\")==-1) {\n\t\t\tif(useDefaultMinutes) {\n\t\t\t\ttempDate.setMinutes(Math.floor(tempDate.getMinutes()\/5)*5);\n\t\t\t} else {\n\t\t\t\ttempDate.setMinutes(0);\n\t\t\t}\n\t\t} else {\n\t\t\tvar tempTime = rfcDate.split(\"T\")[1].split(\":\");\n\t\t\t\/\/ fullYear, month, date\n\t\t\tvar tempDate = new Date();\n\t\t\ttempDate.setHours(tempTime[0]);\n\t\t\ttempDate.setMinutes(tempTime[1]);\n\t\t}\n\t\treturn tempDate;"}}},"dojo.widget.TimePicker.util.toAmPmHour":{"_":{"meta":{"summary":"","parameters":{"hour":{"type":""}},"src":"\t\tvar amPmHour = hour;\n\t\tvar isAm = true;\n\t\tif (amPmHour == 0) {\n\t\t\tamPmHour = 12;\n\t\t} else if (amPmHour>12) {\n\t\t\tamPmHour = amPmHour - 12;\n\t\t\tisAm = false;\n\t\t} else if (amPmHour == 12) {\n\t\t\tisAm = false;\n\t\t}\n\t\treturn [amPmHour, isAm];"}}},"dojo.widget.TimePicker.util.fromAmPmHour":{"_":{"meta":{"summary":"","parameters":{"amPmHour":{"type":""},"isAm":{"type":""}},"src":"\t\tvar hour = parseInt(amPmHour, 10);\n\t\tif(isAm && hour == 12) {\n\t\t\thour = 0;\n\t\t} else if (!isAm && hour<12) {\n\t\t\thour = hour + 12;\n\t\t}\n\t\treturn hour;"}}}}}},"dojo.widget.TitlePane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.html.style","dojo.lfx.*"]},"methods":{"dojo.widget.TitlePane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.Toaster":{"meta":{"requires":{"common":["dojo.widget.*","dojo.lfx.*","dojo.html.iframe"]},"methods":{"dojo.widget.Toaster":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templateString":"","templateCssPath":"","clipNode":"","messageTopic":"","contentNode":"","_scrollConnected":"","messageTypes":"","clipCssClass":"","containerCssClass":"","contentCssClass":"","messageCssClass":"","warningCssClass":"","errorCssClass":"","fatalCssClass":"","positionDirection":"","positionDirectionTypes":"","showDelay":"","slideAnim":"","fadeAnim":"","bgIframe":""}}}},"dojo.widget.Toaster.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tthis.hide();\n\t\t\tdojo.html.setClass(this.clipNode, this.clipCssClass);\n\t\t\tdojo.html.addClass(this.containerNode, this.containerCssClass);\n\t\t\tdojo.html.setClass(this.contentNode, this.contentCssClass);\n\t\t\tif(this.messageTopic){\n\t\t\t\tdojo.event.topic.subscribe(this.messageTopic, this, \"setContent\");\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tthis.positionDirection = this.positionDirectionTypes.BRU;\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["positionDirection","contentNode.innerHTML","containerNode.style.left","containerNode.style.top","slideAnim","fadeAnim","contentNode.innerHTML","containerNode.style.left","containerNode.style.top","slideAnim","fadeAnim","contentNode.innerHTML","containerNode.style.left","containerNode.style.top","slideAnim","fadeAnim","contentNode.innerHTML","containerNode.style.left","containerNode.style.top","slideAnim","fadeAnim","contentNode.innerHTML","containerNode.style.left","containerNode.style.top","slideAnim","fadeAnim","contentNode.innerHTML","containerNode.style.left","containerNode.style.top","slideAnim","fadeAnim","contentNode.innerHTML","containerNode.style.left","containerNode.style.top","slideAnim","fadeAnim","clipNode.style.height","clipNode.style.width","clipNode.style.top","clipNode.style.left","clipNode.style.clip","bgIframe","_scrollConnected","_scrollConnected"]}}},"dojo.widget.Toaster.setContent":{"_":{"meta":{"summary":"","parameters":{"msg":{"type":""},"messageType":{"type":""}},"src":"\t\t\t\tdojo.lang.setTimeout(50, dojo.lang.hitch(this, function(){\n\t\t\t\t\tthis.setContent(msg, messageType);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}else if(this.slideAnim){\n\t\t\t\tthis.slideAnim.stop();\n\t\t\t\tif(this.fadeAnim) this.fadeAnim.stop();\n\t\t\t}\n\t\t\tif(!msg){\n\t\t\t\tdojo.debug(this.widgetId + \".setContent() incoming content was null, ignoring.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\t\/\/ determine type of content and apply appropriately\n\t\t\tdojo.html.removeClass(this.containerNode, this.messageCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.warningCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.errorCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.fatalCssClass);\n\n\t\t\tdojo.html.clearOpacity(this.containerNode);\n\t\t\t\n\t\t\tif(msg instanceof String || typeof msg == \"string\"){\n\t\t\t\tthis.contentNode.innerHTML = msg;\n\t\t\t}else if(dojo.html.isNode(msg)){\n\t\t\t\tthis.contentNode.innerHTML = dojo.html.getContentAsString(msg);\n\t\t\t}else{\n\t\t\t\tdojo.raise(\"Toaster.setContent(): msg is of unknown type:\" + msg);\n\t\t\t}\n\n\t\t\tswitch(messageType){\n\t\t\t\tcase this.messageTypes.WARNING:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.warningCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.ERROR:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.errorCssClass);\n\t\t\t\t\tbreak\n\t\t\t\tcase this.messageTypes.FATAL:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.fatalCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.MESSAGE:\n\t\t\t\tdefault:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.messageCssClass);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t\/\/ now do funky animation of widget appearing from\n\t\t\t\/\/ bottom right of page and up\n\t\t\tthis.show();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up initial position of container node and slide-out direction\n\t\t\tif(this.positionDirection.indexOf(\"-up\") >= 0){\n\t\t\t\tthis.containerNode.style.left=0+\"px\";\n\t\t\t\tthis.containerNode.style.top=nodeSize.height + 10 + \"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-left\") >= 0){\n\t\t\t\tthis.containerNode.style.left=nodeSize.width + 10 +\"px\";\n\t\t\t\tthis.containerNode.style.top=0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-right\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0 - nodeSize.width - 10 + \"px\";\n\t\t\t\tthis.containerNode.style.top = 0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-down\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0+\"px\";\n\t\t\t\tthis.containerNode.style.top = 0 - nodeSize.height - 10 + \"px\";\n\t\t\t}else{\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\tthis.slideAnim = dojo.lfx.html.slideTo(\n\t\t\t\tthis.containerNode,\n\t\t\t\t{ top: 0, left: 0 },\n\t\t\t\t450,\n\t\t\t\tnull,\n\t\t\t\tdojo.lang.hitch(this, function(nodes, anim){\n\t\t\t\t\tdojo.lang.setTimeout(dojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\/\/ we must hide the iframe in order to fade\n\t\t\t\t\t\t\/\/ TODO: figure out how to fade with a BackgroundIframe\n\t\t\t\t\t\tif(this.bgIframe){\n\t\t\t\t\t\t\tthis.bgIframe.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\/\/ can't do a fadeHide because we're fading the\n\t\t\t\t\t\t\/\/ inner node rather than the clipping node\n\t\t\t\t\t\tthis.fadeAnim = dojo.lfx.html.fadeOut(\n\t\t\t\t\t\t\tthis.containerNode,\n\t\t\t\t\t\t\t1000,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tdojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t})).play();\n\t\t\t\t\t}), this.showDelay);\n\t\t\t\t})).play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.this.messageTypes.WARNING":{"_":{"meta":{"summary":"","parameters":{"msg":{"type":""},"messageType":{"type":""}},"src":"\t\t\t\tdojo.lang.setTimeout(50, dojo.lang.hitch(this, function(){\n\t\t\t\t\tthis.setContent(msg, messageType);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}else if(this.slideAnim){\n\t\t\t\tthis.slideAnim.stop();\n\t\t\t\tif(this.fadeAnim) this.fadeAnim.stop();\n\t\t\t}\n\t\t\tif(!msg){\n\t\t\t\tdojo.debug(this.widgetId + \".setContent() incoming content was null, ignoring.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\t\/\/ determine type of content and apply appropriately\n\t\t\tdojo.html.removeClass(this.containerNode, this.messageCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.warningCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.errorCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.fatalCssClass);\n\n\t\t\tdojo.html.clearOpacity(this.containerNode);\n\t\t\t\n\t\t\tif(msg instanceof String || typeof msg == \"string\"){\n\t\t\t\tthis.contentNode.innerHTML = msg;\n\t\t\t}else if(dojo.html.isNode(msg)){\n\t\t\t\tthis.contentNode.innerHTML = dojo.html.getContentAsString(msg);\n\t\t\t}else{\n\t\t\t\tdojo.raise(\"Toaster.setContent(): msg is of unknown type:\" + msg);\n\t\t\t}\n\n\t\t\tswitch(messageType){\n\t\t\t\tcase this.messageTypes.WARNING:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.warningCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.ERROR:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.errorCssClass);\n\t\t\t\t\tbreak\n\t\t\t\tcase this.messageTypes.FATAL:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.fatalCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.MESSAGE:\n\t\t\t\tdefault:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.messageCssClass);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t\/\/ now do funky animation of widget appearing from\n\t\t\t\/\/ bottom right of page and up\n\t\t\tthis.show();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up initial position of container node and slide-out direction\n\t\t\tif(this.positionDirection.indexOf(\"-up\") >= 0){\n\t\t\t\tthis.containerNode.style.left=0+\"px\";\n\t\t\t\tthis.containerNode.style.top=nodeSize.height + 10 + \"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-left\") >= 0){\n\t\t\t\tthis.containerNode.style.left=nodeSize.width + 10 +\"px\";\n\t\t\t\tthis.containerNode.style.top=0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-right\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0 - nodeSize.width - 10 + \"px\";\n\t\t\t\tthis.containerNode.style.top = 0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-down\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0+\"px\";\n\t\t\t\tthis.containerNode.style.top = 0 - nodeSize.height - 10 + \"px\";\n\t\t\t}else{\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\tthis.slideAnim = dojo.lfx.html.slideTo(\n\t\t\t\tthis.containerNode,\n\t\t\t\t{ top: 0, left: 0 },\n\t\t\t\t450,\n\t\t\t\tnull,\n\t\t\t\tdojo.lang.hitch(this, function(nodes, anim){\n\t\t\t\t\tdojo.lang.setTimeout(dojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\/\/ we must hide the iframe in order to fade\n\t\t\t\t\t\t\/\/ TODO: figure out how to fade with a BackgroundIframe\n\t\t\t\t\t\tif(this.bgIframe){\n\t\t\t\t\t\t\tthis.bgIframe.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\/\/ can't do a fadeHide because we're fading the\n\t\t\t\t\t\t\/\/ inner node rather than the clipping node\n\t\t\t\t\t\tthis.fadeAnim = dojo.lfx.html.fadeOut(\n\t\t\t\t\t\t\tthis.containerNode,\n\t\t\t\t\t\t\t1000,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tdojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t})).play();\n\t\t\t\t\t}), this.showDelay);\n\t\t\t\t})).play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.this.messageTypes.ERROR":{"_":{"meta":{"summary":"","parameters":{"msg":{"type":""},"messageType":{"type":""}},"src":"\t\t\t\tdojo.lang.setTimeout(50, dojo.lang.hitch(this, function(){\n\t\t\t\t\tthis.setContent(msg, messageType);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}else if(this.slideAnim){\n\t\t\t\tthis.slideAnim.stop();\n\t\t\t\tif(this.fadeAnim) this.fadeAnim.stop();\n\t\t\t}\n\t\t\tif(!msg){\n\t\t\t\tdojo.debug(this.widgetId + \".setContent() incoming content was null, ignoring.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\t\/\/ determine type of content and apply appropriately\n\t\t\tdojo.html.removeClass(this.containerNode, this.messageCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.warningCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.errorCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.fatalCssClass);\n\n\t\t\tdojo.html.clearOpacity(this.containerNode);\n\t\t\t\n\t\t\tif(msg instanceof String || typeof msg == \"string\"){\n\t\t\t\tthis.contentNode.innerHTML = msg;\n\t\t\t}else if(dojo.html.isNode(msg)){\n\t\t\t\tthis.contentNode.innerHTML = dojo.html.getContentAsString(msg);\n\t\t\t}else{\n\t\t\t\tdojo.raise(\"Toaster.setContent(): msg is of unknown type:\" + msg);\n\t\t\t}\n\n\t\t\tswitch(messageType){\n\t\t\t\tcase this.messageTypes.WARNING:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.warningCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.ERROR:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.errorCssClass);\n\t\t\t\t\tbreak\n\t\t\t\tcase this.messageTypes.FATAL:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.fatalCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.MESSAGE:\n\t\t\t\tdefault:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.messageCssClass);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t\/\/ now do funky animation of widget appearing from\n\t\t\t\/\/ bottom right of page and up\n\t\t\tthis.show();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up initial position of container node and slide-out direction\n\t\t\tif(this.positionDirection.indexOf(\"-up\") >= 0){\n\t\t\t\tthis.containerNode.style.left=0+\"px\";\n\t\t\t\tthis.containerNode.style.top=nodeSize.height + 10 + \"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-left\") >= 0){\n\t\t\t\tthis.containerNode.style.left=nodeSize.width + 10 +\"px\";\n\t\t\t\tthis.containerNode.style.top=0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-right\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0 - nodeSize.width - 10 + \"px\";\n\t\t\t\tthis.containerNode.style.top = 0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-down\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0+\"px\";\n\t\t\t\tthis.containerNode.style.top = 0 - nodeSize.height - 10 + \"px\";\n\t\t\t}else{\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\tthis.slideAnim = dojo.lfx.html.slideTo(\n\t\t\t\tthis.containerNode,\n\t\t\t\t{ top: 0, left: 0 },\n\t\t\t\t450,\n\t\t\t\tnull,\n\t\t\t\tdojo.lang.hitch(this, function(nodes, anim){\n\t\t\t\t\tdojo.lang.setTimeout(dojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\/\/ we must hide the iframe in order to fade\n\t\t\t\t\t\t\/\/ TODO: figure out how to fade with a BackgroundIframe\n\t\t\t\t\t\tif(this.bgIframe){\n\t\t\t\t\t\t\tthis.bgIframe.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\/\/ can't do a fadeHide because we're fading the\n\t\t\t\t\t\t\/\/ inner node rather than the clipping node\n\t\t\t\t\t\tthis.fadeAnim = dojo.lfx.html.fadeOut(\n\t\t\t\t\t\t\tthis.containerNode,\n\t\t\t\t\t\t\t1000,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tdojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t})).play();\n\t\t\t\t\t}), this.showDelay);\n\t\t\t\t})).play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.this.messageTypes.FATAL":{"_":{"meta":{"summary":"","parameters":{"msg":{"type":""},"messageType":{"type":""}},"src":"\t\t\t\tdojo.lang.setTimeout(50, dojo.lang.hitch(this, function(){\n\t\t\t\t\tthis.setContent(msg, messageType);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}else if(this.slideAnim){\n\t\t\t\tthis.slideAnim.stop();\n\t\t\t\tif(this.fadeAnim) this.fadeAnim.stop();\n\t\t\t}\n\t\t\tif(!msg){\n\t\t\t\tdojo.debug(this.widgetId + \".setContent() incoming content was null, ignoring.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\t\/\/ determine type of content and apply appropriately\n\t\t\tdojo.html.removeClass(this.containerNode, this.messageCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.warningCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.errorCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.fatalCssClass);\n\n\t\t\tdojo.html.clearOpacity(this.containerNode);\n\t\t\t\n\t\t\tif(msg instanceof String || typeof msg == \"string\"){\n\t\t\t\tthis.contentNode.innerHTML = msg;\n\t\t\t}else if(dojo.html.isNode(msg)){\n\t\t\t\tthis.contentNode.innerHTML = dojo.html.getContentAsString(msg);\n\t\t\t}else{\n\t\t\t\tdojo.raise(\"Toaster.setContent(): msg is of unknown type:\" + msg);\n\t\t\t}\n\n\t\t\tswitch(messageType){\n\t\t\t\tcase this.messageTypes.WARNING:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.warningCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.ERROR:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.errorCssClass);\n\t\t\t\t\tbreak\n\t\t\t\tcase this.messageTypes.FATAL:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.fatalCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.MESSAGE:\n\t\t\t\tdefault:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.messageCssClass);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t\/\/ now do funky animation of widget appearing from\n\t\t\t\/\/ bottom right of page and up\n\t\t\tthis.show();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up initial position of container node and slide-out direction\n\t\t\tif(this.positionDirection.indexOf(\"-up\") >= 0){\n\t\t\t\tthis.containerNode.style.left=0+\"px\";\n\t\t\t\tthis.containerNode.style.top=nodeSize.height + 10 + \"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-left\") >= 0){\n\t\t\t\tthis.containerNode.style.left=nodeSize.width + 10 +\"px\";\n\t\t\t\tthis.containerNode.style.top=0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-right\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0 - nodeSize.width - 10 + \"px\";\n\t\t\t\tthis.containerNode.style.top = 0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-down\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0+\"px\";\n\t\t\t\tthis.containerNode.style.top = 0 - nodeSize.height - 10 + \"px\";\n\t\t\t}else{\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\tthis.slideAnim = dojo.lfx.html.slideTo(\n\t\t\t\tthis.containerNode,\n\t\t\t\t{ top: 0, left: 0 },\n\t\t\t\t450,\n\t\t\t\tnull,\n\t\t\t\tdojo.lang.hitch(this, function(nodes, anim){\n\t\t\t\t\tdojo.lang.setTimeout(dojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\/\/ we must hide the iframe in order to fade\n\t\t\t\t\t\t\/\/ TODO: figure out how to fade with a BackgroundIframe\n\t\t\t\t\t\tif(this.bgIframe){\n\t\t\t\t\t\t\tthis.bgIframe.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\/\/ can't do a fadeHide because we're fading the\n\t\t\t\t\t\t\/\/ inner node rather than the clipping node\n\t\t\t\t\t\tthis.fadeAnim = dojo.lfx.html.fadeOut(\n\t\t\t\t\t\t\tthis.containerNode,\n\t\t\t\t\t\t\t1000,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tdojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t})).play();\n\t\t\t\t\t}), this.showDelay);\n\t\t\t\t})).play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.this.messageTypes.MESSAGE":{"_":{"meta":{"summary":"","parameters":{"msg":{"type":""},"messageType":{"type":""}},"src":"\t\t\t\tdojo.lang.setTimeout(50, dojo.lang.hitch(this, function(){\n\t\t\t\t\tthis.setContent(msg, messageType);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}else if(this.slideAnim){\n\t\t\t\tthis.slideAnim.stop();\n\t\t\t\tif(this.fadeAnim) this.fadeAnim.stop();\n\t\t\t}\n\t\t\tif(!msg){\n\t\t\t\tdojo.debug(this.widgetId + \".setContent() incoming content was null, ignoring.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\t\/\/ determine type of content and apply appropriately\n\t\t\tdojo.html.removeClass(this.containerNode, this.messageCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.warningCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.errorCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.fatalCssClass);\n\n\t\t\tdojo.html.clearOpacity(this.containerNode);\n\t\t\t\n\t\t\tif(msg instanceof String || typeof msg == \"string\"){\n\t\t\t\tthis.contentNode.innerHTML = msg;\n\t\t\t}else if(dojo.html.isNode(msg)){\n\t\t\t\tthis.contentNode.innerHTML = dojo.html.getContentAsString(msg);\n\t\t\t}else{\n\t\t\t\tdojo.raise(\"Toaster.setContent(): msg is of unknown type:\" + msg);\n\t\t\t}\n\n\t\t\tswitch(messageType){\n\t\t\t\tcase this.messageTypes.WARNING:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.warningCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.ERROR:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.errorCssClass);\n\t\t\t\t\tbreak\n\t\t\t\tcase this.messageTypes.FATAL:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.fatalCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.MESSAGE:\n\t\t\t\tdefault:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.messageCssClass);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t\/\/ now do funky animation of widget appearing from\n\t\t\t\/\/ bottom right of page and up\n\t\t\tthis.show();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up initial position of container node and slide-out direction\n\t\t\tif(this.positionDirection.indexOf(\"-up\") >= 0){\n\t\t\t\tthis.containerNode.style.left=0+\"px\";\n\t\t\t\tthis.containerNode.style.top=nodeSize.height + 10 + \"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-left\") >= 0){\n\t\t\t\tthis.containerNode.style.left=nodeSize.width + 10 +\"px\";\n\t\t\t\tthis.containerNode.style.top=0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-right\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0 - nodeSize.width - 10 + \"px\";\n\t\t\t\tthis.containerNode.style.top = 0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-down\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0+\"px\";\n\t\t\t\tthis.containerNode.style.top = 0 - nodeSize.height - 10 + \"px\";\n\t\t\t}else{\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\tthis.slideAnim = dojo.lfx.html.slideTo(\n\t\t\t\tthis.containerNode,\n\t\t\t\t{ top: 0, left: 0 },\n\t\t\t\t450,\n\t\t\t\tnull,\n\t\t\t\tdojo.lang.hitch(this, function(nodes, anim){\n\t\t\t\t\tdojo.lang.setTimeout(dojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\/\/ we must hide the iframe in order to fade\n\t\t\t\t\t\t\/\/ TODO: figure out how to fade with a BackgroundIframe\n\t\t\t\t\t\tif(this.bgIframe){\n\t\t\t\t\t\t\tthis.bgIframe.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\/\/ can't do a fadeHide because we're fading the\n\t\t\t\t\t\t\/\/ inner node rather than the clipping node\n\t\t\t\t\t\tthis.fadeAnim = dojo.lfx.html.fadeOut(\n\t\t\t\t\t\t\tthis.containerNode,\n\t\t\t\t\t\t\t1000,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tdojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t})).play();\n\t\t\t\t\t}), this.showDelay);\n\t\t\t\t})).play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.default":{"_":{"meta":{"summary":"","parameters":{"msg":{"type":""},"messageType":{"type":""}},"src":"\t\t\t\tdojo.lang.setTimeout(50, dojo.lang.hitch(this, function(){\n\t\t\t\t\tthis.setContent(msg, messageType);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}else if(this.slideAnim){\n\t\t\t\tthis.slideAnim.stop();\n\t\t\t\tif(this.fadeAnim) this.fadeAnim.stop();\n\t\t\t}\n\t\t\tif(!msg){\n\t\t\t\tdojo.debug(this.widgetId + \".setContent() incoming content was null, ignoring.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\t\/\/ determine type of content and apply appropriately\n\t\t\tdojo.html.removeClass(this.containerNode, this.messageCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.warningCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.errorCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.fatalCssClass);\n\n\t\t\tdojo.html.clearOpacity(this.containerNode);\n\t\t\t\n\t\t\tif(msg instanceof String || typeof msg == \"string\"){\n\t\t\t\tthis.contentNode.innerHTML = msg;\n\t\t\t}else if(dojo.html.isNode(msg)){\n\t\t\t\tthis.contentNode.innerHTML = dojo.html.getContentAsString(msg);\n\t\t\t}else{\n\t\t\t\tdojo.raise(\"Toaster.setContent(): msg is of unknown type:\" + msg);\n\t\t\t}\n\n\t\t\tswitch(messageType){\n\t\t\t\tcase this.messageTypes.WARNING:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.warningCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.ERROR:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.errorCssClass);\n\t\t\t\t\tbreak\n\t\t\t\tcase this.messageTypes.FATAL:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.fatalCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.MESSAGE:\n\t\t\t\tdefault:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.messageCssClass);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t\/\/ now do funky animation of widget appearing from\n\t\t\t\/\/ bottom right of page and up\n\t\t\tthis.show();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up initial position of container node and slide-out direction\n\t\t\tif(this.positionDirection.indexOf(\"-up\") >= 0){\n\t\t\t\tthis.containerNode.style.left=0+\"px\";\n\t\t\t\tthis.containerNode.style.top=nodeSize.height + 10 + \"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-left\") >= 0){\n\t\t\t\tthis.containerNode.style.left=nodeSize.width + 10 +\"px\";\n\t\t\t\tthis.containerNode.style.top=0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-right\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0 - nodeSize.width - 10 + \"px\";\n\t\t\t\tthis.containerNode.style.top = 0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-down\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0+\"px\";\n\t\t\t\tthis.containerNode.style.top = 0 - nodeSize.height - 10 + \"px\";\n\t\t\t}else{\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\tthis.slideAnim = dojo.lfx.html.slideTo(\n\t\t\t\tthis.containerNode,\n\t\t\t\t{ top: 0, left: 0 },\n\t\t\t\t450,\n\t\t\t\tnull,\n\t\t\t\tdojo.lang.hitch(this, function(nodes, anim){\n\t\t\t\t\tdojo.lang.setTimeout(dojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\/\/ we must hide the iframe in order to fade\n\t\t\t\t\t\t\/\/ TODO: figure out how to fade with a BackgroundIframe\n\t\t\t\t\t\tif(this.bgIframe){\n\t\t\t\t\t\t\tthis.bgIframe.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\/\/ can't do a fadeHide because we're fading the\n\t\t\t\t\t\t\/\/ inner node rather than the clipping node\n\t\t\t\t\t\tthis.fadeAnim = dojo.lfx.html.fadeOut(\n\t\t\t\t\t\t\tthis.containerNode,\n\t\t\t\t\t\t\t1000,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tdojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t})).play();\n\t\t\t\t\t}), this.showDelay);\n\t\t\t\t})).play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.top":{"_":{"meta":{"summary":"","parameters":{"msg":{"type":""},"messageType":{"type":""}},"src":"\t\t\t\tdojo.lang.setTimeout(50, dojo.lang.hitch(this, function(){\n\t\t\t\t\tthis.setContent(msg, messageType);\n\t\t\t\t}));\n\t\t\t\treturn;\n\t\t\t}else if(this.slideAnim){\n\t\t\t\tthis.slideAnim.stop();\n\t\t\t\tif(this.fadeAnim) this.fadeAnim.stop();\n\t\t\t}\n\t\t\tif(!msg){\n\t\t\t\tdojo.debug(this.widgetId + \".setContent() incoming content was null, ignoring.\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!this.positionDirection || !dojo.lang.inArray(this.positionDirectionTypes, this.positionDirection)){\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\t\/\/ determine type of content and apply appropriately\n\t\t\tdojo.html.removeClass(this.containerNode, this.messageCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.warningCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.errorCssClass);\n\t\t\tdojo.html.removeClass(this.containerNode, this.fatalCssClass);\n\n\t\t\tdojo.html.clearOpacity(this.containerNode);\n\t\t\t\n\t\t\tif(msg instanceof String || typeof msg == \"string\"){\n\t\t\t\tthis.contentNode.innerHTML = msg;\n\t\t\t}else if(dojo.html.isNode(msg)){\n\t\t\t\tthis.contentNode.innerHTML = dojo.html.getContentAsString(msg);\n\t\t\t}else{\n\t\t\t\tdojo.raise(\"Toaster.setContent(): msg is of unknown type:\" + msg);\n\t\t\t}\n\n\t\t\tswitch(messageType){\n\t\t\t\tcase this.messageTypes.WARNING:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.warningCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.ERROR:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.errorCssClass);\n\t\t\t\t\tbreak\n\t\t\t\tcase this.messageTypes.FATAL:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.fatalCssClass);\n\t\t\t\t\tbreak;\n\t\t\t\tcase this.messageTypes.MESSAGE:\n\t\t\t\tdefault:\n\t\t\t\t\tdojo.html.addClass(this.containerNode, this.messageCssClass);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t\/\/ now do funky animation of widget appearing from\n\t\t\t\/\/ bottom right of page and up\n\t\t\tthis.show();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up initial position of container node and slide-out direction\n\t\t\tif(this.positionDirection.indexOf(\"-up\") >= 0){\n\t\t\t\tthis.containerNode.style.left=0+\"px\";\n\t\t\t\tthis.containerNode.style.top=nodeSize.height + 10 + \"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-left\") >= 0){\n\t\t\t\tthis.containerNode.style.left=nodeSize.width + 10 +\"px\";\n\t\t\t\tthis.containerNode.style.top=0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-right\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0 - nodeSize.width - 10 + \"px\";\n\t\t\t\tthis.containerNode.style.top = 0+\"px\";\n\t\t\t}else if(this.positionDirection.indexOf(\"-down\") >= 0){\n\t\t\t\tthis.containerNode.style.left = 0+\"px\";\n\t\t\t\tthis.containerNode.style.top = 0 - nodeSize.height - 10 + \"px\";\n\t\t\t}else{\n\t\t\t\tdojo.raise(this.widgetId + \".positionDirection is an invalid value: \" + this.positionDirection);\n\t\t\t}\n\n\t\t\tthis.slideAnim = dojo.lfx.html.slideTo(\n\t\t\t\tthis.containerNode,\n\t\t\t\t{ top: 0, left: 0 },\n\t\t\t\t450,\n\t\t\t\tnull,\n\t\t\t\tdojo.lang.hitch(this, function(nodes, anim){\n\t\t\t\t\tdojo.lang.setTimeout(dojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\/\/ we must hide the iframe in order to fade\n\t\t\t\t\t\t\/\/ TODO: figure out how to fade with a BackgroundIframe\n\t\t\t\t\t\tif(this.bgIframe){\n\t\t\t\t\t\t\tthis.bgIframe.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\/\/ can't do a fadeHide because we're fading the\n\t\t\t\t\t\t\/\/ inner node rather than the clipping node\n\t\t\t\t\t\tthis.fadeAnim = dojo.lfx.html.fadeOut(\n\t\t\t\t\t\t\tthis.containerNode,\n\t\t\t\t\t\t\t1000,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\tdojo.lang.hitch(this, function(evt){\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t})).play();\n\t\t\t\t\t}), this.showDelay);\n\t\t\t\t})).play();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.placeClip":{"_":{"meta":{"summary":"","src":"\t\t\tvar scroll = dojo.html.getScroll();\n\t\t\tvar view = dojo.html.getViewport();\n\n\t\t\tvar nodeSize = dojo.html.getMarginBox(this.containerNode);\n\n\t\t\t\/\/ sets up the size of the clipping node\n\t\t\tthis.clipNode.style.height = nodeSize.height+\"px\";\n\t\t\tthis.clipNode.style.width = nodeSize.width+\"px\";\n\n\t\t\t\/\/ sets up the position of the clipping node\n\t\t\tif(this.positionDirection.match(\/^t\/)){\n\t\t\t\tthis.clipNode.style.top = scroll.top+\"px\";\n\t\t\t}else if(this.positionDirection.match(\/^b\/)){\n\t\t\t\tthis.clipNode.style.top = (view.height - nodeSize.height - 2 + scroll.top)+\"px\";\n\t\t\t}\n\t\t\tif(this.positionDirection.match(\/^[tb]r-\/)){\n\t\t\t\tthis.clipNode.style.left = (view.width - nodeSize.width - 1 - scroll.left)+\"px\";\n\t\t\t}else if(this.positionDirection.match(\/^[tb]l-\/)){\n\t\t\t\tthis.clipNode.style.left = 0 + \"px\";\n\t\t\t}\n\n\t\t\tthis.clipNode.style.clip = \"rect(0px, \" + nodeSize.width + \"px, \" + nodeSize.height + \"px, 0px)\";\n\n\t\t\tif(dojo.render.html.ie){\n\t\t\t\tif(!this.bgIframe){\n\t\t\t\t\tthis.bgIframe = new dojo.html.BackgroundIframe(this.containerNode);\n\t\t\t\t\tthis.bgIframe.setZIndex(this.containerNode);\n\t\t\t\t}\n\t\t\t\tthis.bgIframe.onResized();\n\t\t\t\tthis.bgIframe.show();\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.onSelect":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.onScroll":{"_":{"meta":{"summary":"","src":"\t\t\tthis.placeClip();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.show":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.Toaster.superclass.show.call(this);\n\n\t\t\tthis.placeClip();\n\n\t\t\tif(!this._scrollConnected){\n\t\t\t\tthis._scrollConnected = true;\n\t\t\t\tdojo.event.connect(window, \"onscroll\", this, \"onScroll\");\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.Toaster.hide":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.Toaster.superclass.hide.call(this);\n\n\t\t\tif(this._scrollConnected){\n\t\t\t\tthis._scrollConnected = false;\n\t\t\t\tdojo.event.disconnect(window, \"onscroll\", this, \"onScroll\");\n\t\t\t}\n\n\t\t\tdojo.html.setOpacity(this.containerNode, 1.0);","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.Toggler":{"meta":{"requires":{"common":["dojo.widget.*","dojo.event.*"]},"methods":{"dojo.widget.Toggler":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget.Toolbar":{"meta":{"requires":{"common":["dojo.widget.*","dojo.html.style"]},"methods":{"dojo.widget.ToolbarContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.Toolbar":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.ToolbarItem":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}},"dojo.widget.ToolbarButtonGroup":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarItem"],"this_inherits":["dojo.widget.ToolbarItem"]}}},"dojo.widget.ToolbarButton":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarItem"],"this_inherits":["dojo.widget.ToolbarItem"]}}},"dojo.widget.ToolbarDialog":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarButton"],"this_inherits":["dojo.widget.ToolbarButton"]}}},"dojo.widget.ToolbarMenu":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarDialog"],"this_inherits":["dojo.widget.ToolbarDialog"]}}},"dojo.widget.ToolbarSeparator":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarItem"],"this_inherits":["dojo.widget.ToolbarItem"]}}},"dojo.widget.ToolbarSpace":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarSeparator"],"this_inherits":["dojo.widget.ToolbarSeparator"]}}},"dojo.widget.ToolbarSelect":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ToolbarItem"],"this_inherits":["dojo.widget.ToolbarItem"]}}},"dojo.widget.ToolbarItem.make":{"_":{"meta":{"summary":"","parameters":{"wh":{"type":""},"whIsType":{"type":""},"props":{"type":""}},"src":"\tvar item = null;\n\n\tif(wh instanceof Array) {\n\t\titem = dojo.widget.createWidget(\"ToolbarButtonGroup\", props);\n\t\titem.setName(wh[0]);\n\t\tfor(var i = 1; i < wh.length; i++) {\n\t\t\titem.addChild(wh[i]);\n\t\t}\n\t} else if(wh instanceof dojo.widget.ToolbarItem) {\n\t\titem = wh;\n\t} else if(wh instanceof dojo.uri.Uri) {\n\t\titem = dojo.widget.createWidget(\"ToolbarButton\",\n\t\t\tdojo.lang.mixin(props||{}, {icon: new dojo.widget.Icon(wh.toString())}));\n\t} else if(whIsType) {\n\t\titem = dojo.widget.createWidget(wh, props);\n\t} else if(typeof wh == \"string\" || wh instanceof String) {\n\t\tswitch(wh.charAt(0)) {\n\t\t\tcase \"|\":\n\t\t\tcase \"-\":\n\t\t\tcase \"\/\":\n\t\t\t\titem = dojo.widget.createWidget(\"ToolbarSeparator\", props);\n\t\t\t\tbreak;\n\t\t\tcase \" \":\n\t\t\t\tif(wh.length == 1) {\n\t\t\t\t\titem = dojo.widget.createWidget(\"ToolbarSpace\", props);\n\t\t\t\t} else {\n\t\t\t\t\titem = dojo.widget.createWidget(\"ToolbarFlexibleSpace\", props);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif(\/\\.(gif|jpg|jpeg|png)$\/i.test(wh)) {\n\t\t\t\t\titem = dojo.widget.createWidget(\"ToolbarButton\",\n\t\t\t\t\t\tdojo.lang.mixin(props||{}, {icon: new dojo.widget.Icon(wh.toString())}));\n\t\t\t\t} else {\n\t\t\t\t\titem = dojo.widget.createWidget(\"ToolbarButton\",\n\t\t\t\t\t\tdojo.lang.mixin(props||{}, {label: wh.toString()}));\n\t\t\t\t}\n\t\t}\n\t} else if(wh && wh.tagName && \/^img$\/i.test(wh.tagName)) {\n\t\titem = dojo.widget.createWidget(\"ToolbarButton\",\n\t\t\tdojo.lang.mixin(props||{}, {icon: wh}));\n\t} else {\n\t\titem = dojo.widget.createWidget(\"ToolbarButton\",\n\t\t\tdojo.lang.mixin(props||{}, {label: wh.toString()}));\n\t}\n\treturn item;"}}},"dojo.widget.ToolbarMenuItem":{"_":{"meta":{"summary":"","src":""}}},"dojo.widget.Icon":{"_":{"meta":{"summary":"","parameters":{"enabled":{"type":""},"disabled":{"type":""},"hover":{"type":""},"selected":{"type":""}},"src":"\tif(!arguments.length){\n\t\t\/\/ FIXME: should this be dojo.raise?\n\t\tthrow new Error(\"Icon must have at least an enabled state\");\n\t}\n\tvar states = [\"enabled\", \"disabled\", \"hover\", \"selected\"];\n\tvar currentState = \"enabled\";\n\tvar domNode = document.createElement(\"img\");\n\n\tthis.getState = function(){ return currentState; }\n\tthis.setState = function(value){\n\t\tif(dojo.lang.inArray(value, states)){\n\t\t\tif(this[value]){\n\t\t\t\tcurrentState = value;\n\t\t\t\tdomNode.setAttribute(\"src\", this[currentState].src);\n\t\t\t}\n\t\t}else{\n\t\t\tthrow new Error(\"Invalid state set on Icon (state: \" + value + \")\");\n\t\t}\n\t}\n\n\tthis.setSrc = function(state, value){\n\t\tif(\/^img$\/i.test(value.tagName)){\n\t\t\tthis[state] = value;\n\t\t}else if(typeof value == \"string\" || value instanceof String\n\t\t\t|| value instanceof dojo.uri.Uri){\n\t\t\tthis[state] = new Image();\n\t\t\tthis[state].src = value.toString();\n\t\t}\n\t\treturn this[state];\n\t}\n\n\tthis.setIcon = function(icon){\n\t\tfor(var i = 0; i < states.length; i++){\n\t\t\tif(icon[states[i]]){\n\t\t\t\tthis.setSrc(states[i], icon[states[i]]);\n\t\t\t}\n\t\t}\n\t\tthis.update();\n\t}\n\n\tthis.enable = function(){ this.setState(\"enabled\"); }\n\tthis.disable = function(){ this.setState(\"disabled\"); }\n\tthis.hover = function(){ this.setState(\"hover\"); }\n\tthis.select = function(){ this.setState(\"selected\"); }\n\n\tthis.getSize = function(){\n\t\treturn {\n\t\t\twidth: domNode.width||domNode.offsetWidth,\n\t\t\theight: domNode.height||domNode.offsetHeight\n\t\t};\n\t}\n\n\tthis.setSize = function(w, h){\n\t\tdomNode.width = w;\n\t\tdomNode.height = h;\n\t\treturn { width: w, height: h };\n\t}\n\n\tthis.getNode = function(){\n\t\treturn domNode;\n\t}\n\n\tthis.getSrc = function(state){\n\t\tif(state){ return this[state].src; }\n\t\treturn domNode.src||\"\";\n\t}\n\n\tthis.update = function(){\n\t\tthis.setState(currentState);\n\t}\n\n\tfor(var i = 0; i < states.length; i++){\n\t\tvar arg = arguments[i];\n\t\tvar state = states[i];\n\t\tthis[state] = null;\n\t\tif(!arg){ continue; }\n\t\tthis.setSrc(state, arg);\n\t}\n\n\tthis.enable();","this_variables":["getState","setState","setSrc","setIcon","enable","disable","select","getSize","setSize","getNode","getSrc","update"]}}},"dojo.widget.Icon.getState":{"_":{"meta":{"summary":"","src":"                             return currentState;   "}}},"dojo.widget.Icon.setState":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\tif(dojo.lang.inArray(value, states)){\n\t\t\tif(this[value]){\n\t\t\t\tcurrentState = value;\n\t\t\t\tdomNode.setAttribute(\"src\", this[currentState].src);\n\t\t\t}\n\t\t}else{\n\t\t\tthrow new Error(\"Invalid state set on Icon (state: \" + value + \")\");\n\t\t}"}}},"dojo.widget.Icon.setSrc":{"_":{"meta":{"summary":"","parameters":{"state":{"type":""},"value":{"type":""}},"src":"\t\tif(\/^img$\/i.test(value.tagName)){\n\t\t\tthis[state] = value;\n\t\t}else if(typeof value == \"string\" || value instanceof String\n\t\t\t|| value instanceof dojo.uri.Uri){\n\t\t\tthis[state] = new Image();\n\t\t\tthis[state].src = value.toString();\n\t\t}\n\t\treturn this[state];"}}},"dojo.widget.Icon.setIcon":{"_":{"meta":{"summary":"","parameters":{"icon":{"type":""}},"src":"\t\tfor(var i = 0; i < states.length; i++){\n\t\t\tif(icon[states[i]]){\n\t\t\t\tthis.setSrc(states[i], icon[states[i]]);\n\t\t\t}\n\t\t}\n\t\tthis.update();"}}},"dojo.widget.Icon.enable":{"_":{"meta":{"summary":"","src":"                           this.setState(\"enabled\");   "}}},"dojo.widget.Icon.disable":{"_":{"meta":{"summary":"","src":"                            this.setState(\"disabled\");   "}}},"dojo.widget.Icon.select":{"_":{"meta":{"summary":"","src":"                           this.setState(\"selected\");   "}}},"dojo.widget.Icon.getSize":{"_":{"meta":{"summary":"","src":"\t\treturn {\n\t\t\twidth: domNode.width||domNode.offsetWidth,\n\t\t\theight: domNode.height||domNode.offsetHeight\n\t\t};"}}},"dojo.widget.Icon.setSize":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\tdomNode.width = w;\n\t\tdomNode.height = h;\n\t\treturn { width: w, height: h };"}}},"dojo.widget.Icon.getNode":{"_":{"meta":{"summary":"","src":"\t\treturn domNode;"}}},"dojo.widget.Icon.getSrc":{"_":{"meta":{"summary":"","parameters":{"state":{"type":""}},"src":"\t\tif(state){ return this[state].src; }\n\t\treturn domNode.src||\"\";"}}},"dojo.widget.Icon.update":{"_":{"meta":{"summary":"","src":"\t\tthis.setState(currentState);"}}},"dojo.widget.Icon.make":{"_":{"meta":{"summary":"","parameters":{"a":{"type":""},"":{"type":""}},"src":"\tfor(var i = 0; i < arguments.length; i++){\n\t\tif(arguments[i] instanceof dojo.widget.Icon){\n\t\t\treturn arguments[i];\n\t\t}\n\t}\n\n\treturn new dojo.widget.Icon(a,b,c,d);"}}}}}},"dojo.widget.Tooltip":{"meta":{"requires":{"common":["dojo.widget.ContentPane","dojo.widget.Menu2","dojo.uri","dojo.widget.*","dojo.event","dojo.html.style","dojo.html.util","dojo.html.iframe"]},"methods":{"dojo.widget.Tooltip":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ContentPane"],"this_inherits":["dojo.widget.ContentPane"],"protovariables":{"isContainer":"","caption":"","showDelay":"","hideDelay":"","connectId":"","templateCssPath":"","connectNode":"","popupWidget":""}}}},"dojo.widget.Tooltip.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tif(this.caption != \"\"){\n\t\t\t\tthis.domNode.appendChild(document.createTextNode(this.caption));\n\t\t\t}\n\t\t\tthis.connectNode = dojo.byId(this.connectId);\t\t\n\t\t\tdojo.widget.Tooltip.superclass.fillInTemplate.call(this, args, frag);\n\n\t\t\t\/\/wrap this.domNode in a PopupContainer\n\t\t\t\/\/and pass animation setting to it\n\t\t\tthis.popupWidget = dojo.widget.createWidget(\"PopupContainer\", {toggle: this.toggle, toggleDuration: this.toggleDuration});\n\t\t\tthis.popupWidget.addChild(this);\n\t\t\tdojo.html.addClass(this.popupWidget.domNode, \"dojoTooltip\");\n\n\t\t\t\/\/copy style from input node to output node\n\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\tdojo.html.copyStyle(this.popupWidget.domNode, source);\n\n\t\t\t\/\/reset animation on this widget\n\t\t\tthis.toggle=\"plain\";\n\t\t\tthis.toggleDuration=150;\n\t\t\t\/\/re-create animation object\n\t\t\tthis.postMixInProperties();\n\n\t\t\tthis.popupWidget.domNode.style.display=\"none\";\n\n\t\t\tdojo.body().appendChild(this.popupWidget.domNode);","this_inherits":["dojo.widget.Tooltip.superclass.fillInTemplate"],"this":"dojo.widget.ContentPane"}}},"dojo.widget.ContentPane":{"_":{"meta":{"this_variables":["domNode.style.display","connectNode","popupWidget","toggle","toggleDuration","popupWidget.domNode.style.display","domNode.style.display","connectNode","popupWidget","toggle","toggleDuration","popupWidget.domNode.style.display","mouse","mouse","mouse"]}}},"dojo.widget.Tooltip.toggle":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tif(this.caption != \"\"){\n\t\t\t\tthis.domNode.appendChild(document.createTextNode(this.caption));\n\t\t\t}\n\t\t\tthis.connectNode = dojo.byId(this.connectId);\t\t\n\t\t\tdojo.widget.Tooltip.superclass.fillInTemplate.call(this, args, frag);\n\n\t\t\t\/\/wrap this.domNode in a PopupContainer\n\t\t\t\/\/and pass animation setting to it\n\t\t\tthis.popupWidget = dojo.widget.createWidget(\"PopupContainer\", {toggle: this.toggle, toggleDuration: this.toggleDuration});\n\t\t\tthis.popupWidget.addChild(this);\n\t\t\tdojo.html.addClass(this.popupWidget.domNode, \"dojoTooltip\");\n\n\t\t\t\/\/copy style from input node to output node\n\t\t\tvar source = this.getFragNodeRef(frag);\n\t\t\tdojo.html.copyStyle(this.popupWidget.domNode, source);\n\n\t\t\t\/\/reset animation on this widget\n\t\t\tthis.toggle=\"plain\";\n\t\t\tthis.toggleDuration=150;\n\t\t\t\/\/re-create animation object\n\t\t\tthis.postMixInProperties();\n\n\t\t\tthis.popupWidget.domNode.style.display=\"none\";\n\n\t\t\tdojo.body().appendChild(this.popupWidget.domNode);","this_inherits":["dojo.widget.Tooltip.superclass.fillInTemplate"],"this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.postCreate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.event.connect(this.connectNode, \"onmouseover\", this, \"onMouseOver\");\n\t\t\tdojo.widget.Tooltip.superclass.postCreate.call(this, args, frag);","this_inherits":["dojo.widget.Tooltip.superclass.postCreate"],"this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.onMouseOver":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis.mouse = {x: e.pageX, y: e.pageY};\n\t\n\t\t\tif(!this.showTimer){\n\t\t\t\tthis.showTimer = setTimeout(dojo.lang.hitch(this, \"show\"), this.showDelay);\n\t\t\t\tdojo.event.connect(document.documentElement, \"onmousemove\", this, \"onMouseMove\");\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.x":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis.mouse = {x: e.pageX, y: e.pageY};\n\n\t\t\tif(dojo.html.overElement(this.connectNode, e) || dojo.html.overElement(this.popupWidget.domNode, e)){\n\t\t\t\t\/\/ If the tooltip has been scheduled to be erased, cancel that timer\n\t\t\t\t\/\/ since we are hovering over element\/tooltip again\n\t\t\t\tif(this.hideTimer) {\n\t\t\t\t\tclearTimeout(this.hideTimer);\n\t\t\t\t\tdelete this.hideTimer;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t\/\/ mouse has been moved off the element\/tooltip\n\t\t\t\t\/\/ note: can't use onMouseOut to detect this because the \"explode\" effect causes\n\t\t\t\t\/\/ spurious onMouseOut\/onMouseOver events (due to interference from outline)\n\t\t\t\tif(this.showTimer){\n\t\t\t\t\tclearTimeout(this.showTimer);\n\t\t\t\t\tdelete this.showTimer;\n\t\t\t\t}\n\t\t\t\tif(this.popupWidget.isShowingNow && !this.hideTimer){\n\t\t\t\t\tthis.hideTimer = setTimeout(dojo.lang.hitch(this, \"hide\"), this.hideDelay);\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.onMouseMove":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tthis.mouse = {x: e.pageX, y: e.pageY};\n\n\t\t\tif(dojo.html.overElement(this.connectNode, e) || dojo.html.overElement(this.popupWidget.domNode, e)){\n\t\t\t\t\/\/ If the tooltip has been scheduled to be erased, cancel that timer\n\t\t\t\t\/\/ since we are hovering over element\/tooltip again\n\t\t\t\tif(this.hideTimer) {\n\t\t\t\t\tclearTimeout(this.hideTimer);\n\t\t\t\t\tdelete this.hideTimer;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t\/\/ mouse has been moved off the element\/tooltip\n\t\t\t\t\/\/ note: can't use onMouseOut to detect this because the \"explode\" effect causes\n\t\t\t\t\/\/ spurious onMouseOut\/onMouseOver events (due to interference from outline)\n\t\t\t\tif(this.showTimer){\n\t\t\t\t\tclearTimeout(this.showTimer);\n\t\t\t\t\tdelete this.showTimer;\n\t\t\t\t}\n\t\t\t\tif(this.popupWidget.isShowingNow && !this.hideTimer){\n\t\t\t\t\tthis.hideTimer = setTimeout(dojo.lang.hitch(this, \"hide\"), this.hideDelay);\n\t\t\t\t}\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.show":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.popupWidget.isShowingNow) { return; }\n\t\n\t\t\tdojo.widget.Tooltip.superclass.show.call(this);\n\t\t\t\n\t\t\tthis.popupWidget.open(this.mouse.x, this.mouse.y, this, [this.mouse.x, this.mouse.y], \"TL,TR,BL,BR\", [10,15]);","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.hide":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.popupWidget.isShowingNow) {\n\t\t\t\tif ( this.showTimer ) {\n\t\t\t\t\tclearTimeout(this.showTimer);\n\t\t\t\t\tdelete this.showTimer;\n\t\t\t\t}\n\t\t\t\tif ( this.hideTimer ) {\n\t\t\t\t\tclearTimeout(this.hideTimer);\n\t\t\t\t\tdelete this.hideTimer;\n\t\t\t\t}\n\t\t\t\tdojo.event.disconnect(document.documentElement, \"onmousemove\", this, \"onMouseMove\");\n\t\t\t\tthis.popupWidget.close();\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.onHide":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.widget.Tooltip.superclass.hide.call(this);","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.position":{"_":{"meta":{"summary":"","src":"\t\t\tthis.popupWidget.move(this.mouse.x, this.mouse.y, [10,15], \"TL,TR,BL,BR\");","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.onLoad":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.popupWidget.isShowingNow){\n\t\t\t\t\/\/ the tooltip has changed size due to downloaded contents, so reposition it\n\t\t\t\tthis.position();\n\t\t\t\tdojo.widget.Tooltip.superclass.onLoad.apply(this, arguments);\n\t\t\t}","this":"dojo.widget.ContentPane"}}},"dojo.widget.Tooltip.checkSize":{"_":{"meta":{"summary":"","src":"\t\t\t\/\/ checkSize() is called when the user has resized the browser window,\n\t\t\t\/\/ but that doesn't affect this widget (or this widget's children)\n\t\t\t\/\/ so it can be safely ignored","this":"dojo.widget.ContentPane"}}}}}},"dojo.widget.Tree":{"meta":{"requires":{"common":["dojo.widget.*","dojo.event.*","dojo.io.*","dojo.widget.HtmlWidget","dojo.widget.TreeNode","dojo.html.common","dojo.html.selection","dojo.widget.TreeBasicController","dojo.widget.TreeSelector"]},"methods":{"dojo.widget.Tree":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\n\tthis.eventNames = {};\n\n\tthis.tree = this;\n\tthis.DNDAcceptTypes = [];\n\tthis.actionsDisabled = [];","this_variables":["eventNames","tree","DNDAcceptTypes","actionsDisabled","controller","controller","selector","selector","DNDMode","expandLevel","menu","containerNode","state","lockLevel"],"inherits":["dojo.widget.HtmlWidget"],"protovariables":{"widgetType":"","eventNamesDefault":"","isContainer":"","DNDMode":"","lockLevel":"","strictFolders":"","DNDModes":"","BETWEEN":"","ONTO":"","DNDAcceptTypes":"","templateCssPath":"","templateString":"","isExpanded":"","isTree":"","controller":"","selector":"","menu":"","expandLevel":"","blankIconSrc":"","gridIconSrcT":"","gridIconSrcL":"","gridIconSrcV":"","gridIconSrcP":"","gridIconSrcC":"","gridIconSrcX":"","gridIconSrcY":"","gridIconSrcZ":"","expandIconSrcPlus":"","expandIconSrcMinus":"","expandIconSrcLoading":"","iconWidth":"","iconHeight":"","showGrid":"","showRootGrid":"","actions":""}}}},"dojo.widget.Tree.objectId":{"_":{"meta":{"summary":"","src":"\t\tvar info = {\n\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.actionIsDisabled":{"_":{"meta":{"summary":"","parameters":{"action":{"type":""}},"src":"\t\tvar _this = this;\n\t\treturn dojo.lang.inArray(_this.actionsDisabled, action)","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.getInfo":{"_":{"meta":{"summary":"","src":"\t\tvar info = {\n\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.widgetId":{"_":{"meta":{"summary":"","src":"\t\tvar info = {\n\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.initializeController":{"_":{"meta":{"summary":"","src":"\t\tif (this.controller != \"off\") {\n\t\t\tif (this.controller) {\n\t\t\t\tthis.controller = dojo.widget.byId(this.controller);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\/\/ create default controller here\n\t\t\t\tdojo.require(\"dojo.widget.TreeBasicController\");\n\t\t\t\tthis.controller = dojo.widget.createWidget(\"TreeBasicController\",\n\t\t\t\t\t{ DNDController: (this.DNDMode ? \"create\" : \"\"), dieWithTree: true }\n\t\t\t\t );\n\n\t\t\t}\n\t\t\tthis.controller.listenTree(this); \/\/ controller listens to my events\n\n\t\t} else {\n\t\t\tthis.controller = null;\n\t\t}","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.DNDController":{"_":{"meta":{"summary":"","src":"\t\tif (this.controller != \"off\") {\n\t\t\tif (this.controller) {\n\t\t\t\tthis.controller = dojo.widget.byId(this.controller);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\/\/ create default controller here\n\t\t\t\tdojo.require(\"dojo.widget.TreeBasicController\");\n\t\t\t\tthis.controller = dojo.widget.createWidget(\"TreeBasicController\",\n\t\t\t\t\t{ DNDController: (this.DNDMode ? \"create\" : \"\"), dieWithTree: true }\n\t\t\t\t );\n\n\t\t\t}\n\t\t\tthis.controller.listenTree(this); \/\/ controller listens to my events\n\n\t\t} else {\n\t\t\tthis.controller = null;\n\t\t}","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.initializeSelector":{"_":{"meta":{"summary":"","src":"\t\tif (this.selector != \"off\") {\n\t\t\tif (this.selector) {\n\t\t\t\tthis.selector = dojo.widget.byId(this.selector);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\/\/ create default controller here\n\t\t\t\tdojo.require(\"dojo.widget.TreeSelector\");\n\t\t\t\tthis.selector = dojo.widget.createWidget(\"TreeSelector\", {dieWithTree: true});\n\t\t\t}\n\n\t\t\tthis.selector.listenTree(this);\n\n\t\t} else {\n\t\t\tthis.selector = null;\n\t\t}","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.dieWithTree":{"_":{"meta":{"summary":"","src":"\t\tif (this.selector != \"off\") {\n\t\t\tif (this.selector) {\n\t\t\t\tthis.selector = dojo.widget.byId(this.selector);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t\/\/ create default controller here\n\t\t\t\tdojo.require(\"dojo.widget.TreeSelector\");\n\t\t\t\tthis.selector = dojo.widget.createWidget(\"TreeSelector\", {dieWithTree: true});\n\t\t\t}\n\n\t\t\tthis.selector.listenTree(this);\n\n\t\t} else {\n\t\t\tthis.selector = null;\n\t\t}","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tfor(name in this.eventNamesDefault) {\n\t\t\tif (dojo.lang.isUndefined(this.eventNames[name])) {\n\t\t\t\tthis.eventNames[name] = this.widgetId+\"\/\"+this.eventNamesDefault[name];\n\t\t\t}\n\t\t}\n\n\t\tfor(var i=0; i<this.actionsDisabled.length; i++) {\n\t\t\tthis.actionsDisabled[i] = this.actionsDisabled[i].toUpperCase();\n\t\t}\n\n\t\tif (this.DNDMode == \"off\") {\n\t\t\tthis.DNDMode = 0;\n\t\t} else if (this.DNDMode == \"between\") {\n\t\t\tthis.DNDMode = this.DNDModes.ONTO | this.DNDModes.BETWEEN;\n\t\t} else if (this.DNDMode == \"onto\") {\n\t\t\tthis.DNDMode = this.DNDModes.ONTO;\n\t\t}\n\n\t\tthis.expandLevel = parseInt(this.expandLevel);\n\n\t\tthis.initializeSelector();\n\t\tthis.initializeController();\n\n\t\tif (this.menu) {\n\t\t\tthis.menu = dojo.widget.byId(this.menu);\n\t\t\tthis.menu.listenTree(this);\n\t\t}\n\n\n\t\tthis.containerNode = this.domNode;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.postCreate":{"_":{"meta":{"summary":"","src":"\t\tthis.createDOMNode();","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.createDOMNode":{"_":{"meta":{"summary":"","src":"\t\tdojo.html.disableSelection(this.domNode);\n\n\t\tfor(var i=0; i<this.children.length; i++){\n\t\t\tthis.children[i].parent = this; \/\/ root nodes have tree as parent\n\n\t\t\tvar node = this.children[i].createDOMNode(this, 0);\n\n\n\t\t\tthis.domNode.appendChild(node);\n\t\t}\n\n\n\t\tif (!this.showRootGrid){\n\t\t\tfor(var i=0; i<this.children.length; i++){\n\t\t\t\tthis.children[i].expand();\n\t\t\t}\n\t\t}\n\n\t\tdojo.event.topic.publish(this.eventNames.treeCreate, { source: this } );","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.source":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.topic.publish(this.tree.eventNames.treeDestroy, { source: this } );\n\n\t\treturn dojo.widget.HtmlWidget.prototype.destroy.apply(this, arguments);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.destroy":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.topic.publish(this.tree.eventNames.treeDestroy, { source: this } );\n\n\t\treturn dojo.widget.HtmlWidget.prototype.destroy.apply(this, arguments);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.addChild":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"index":{"type":""}},"src":"\t\t\tchild: child,\n\t\t\tindex: index,\n\t\t\tparent: this,\n\t\t\t\/\/ remember if dom was already initialized\n\t\t\t\/\/ initialized => no createDOMNode => no createDOMNode event\n\t\t\tdomNodeInitialized: child.domNodeInitialized\n\t\t}\n\n\t\tthis.doAddChild.apply(this, arguments);\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.addChild, message);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.child":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""}},"src":"\t\tif (!child.parent) return;\n\n\t\tvar oldTree = child.tree;\n\t\tvar oldParent = child.parent;\n\n\t\tvar removedChild = this.doRemoveNode.apply(this, arguments);\n\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.removeNode,\n\t\t\t{ child: removedChild, tree: oldTree, parent: oldParent }\n\t\t);\n\n\t\treturn removedChild;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.index":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"index":{"type":""}},"src":"\t\t\tchild: child,\n\t\t\tindex: index,\n\t\t\tparent: this,\n\t\t\t\/\/ remember if dom was already initialized\n\t\t\t\/\/ initialized => no createDOMNode => no createDOMNode event\n\t\t\tdomNodeInitialized: child.domNodeInitialized\n\t\t}\n\n\t\tthis.doAddChild.apply(this, arguments);\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.addChild, message);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.parent":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"index":{"type":""}},"src":"\t\t\tchild: child,\n\t\t\tindex: index,\n\t\t\tparent: this,\n\t\t\t\/\/ remember if dom was already initialized\n\t\t\t\/\/ initialized => no createDOMNode => no createDOMNode event\n\t\t\tdomNodeInitialized: child.domNodeInitialized\n\t\t}\n\n\t\tthis.doAddChild.apply(this, arguments);\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.addChild, message);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.domNodeInitialized":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"index":{"type":""}},"src":"\t\t\tchild: child,\n\t\t\tindex: index,\n\t\t\tparent: this,\n\t\t\t\/\/ remember if dom was already initialized\n\t\t\t\/\/ initialized => no createDOMNode => no createDOMNode event\n\t\t\tdomNodeInitialized: child.domNodeInitialized\n\t\t}\n\n\t\tthis.doAddChild.apply(this, arguments);\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.addChild, message);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.doAddChild":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"index":{"type":""}},"src":"\t\tif (dojo.lang.isUndefined(index)) {\n\t\t\tindex = this.children.length;\n\t\t}\n\n\t\tif (!child.isTreeNode){\n\t\t\tdojo.raise(\"You can only add TreeNode widgets to a \"+this.widgetType+\" widget!\");\n\t\t\treturn;\n\t\t}\n\n\t\t\/\/ usually it is impossible to change \"isFolder\" state, but if anyone wants to add a child to leaf,\n\t\t\/\/ it is possible program-way.\n\t\tif (this.isTreeNode){\n\t\t\tif (!this.isFolder) { \/\/ just became a folder.\n\t\t\t\t\/\/dojo.debug(\"becoming folder \"+this);\n\t\t\t\tthis.setFolder();\n\t\t\t}\n\t\t}\n\n\t\t\/\/ adjust tree\n\t\tvar _this = this;\n\t\tdojo.lang.forEach(child.getDescendants(), function(elem) { elem.tree = _this.tree; });\n\n\t\t\/\/ fix parent\n\t\tchild.parent = this;\n\n\n\t\t\/\/ no dynamic loading for those who become parents\n\t\tif (this.isTreeNode) {\n\t\t\tthis.state = this.loadStates.LOADED;\n\t\t}\n\n\t\t\/\/ add new child into DOM after it was added into children\n\t\tif (index < this.children.length) { \/\/ children[] already has child\n\t\t\t\/\/dojo.debug(\"Inserting before \"+this.children[index].title);\n\t\t\tdojo.html.insertBefore(child.domNode, this.children[index].domNode);\n\t\t} else {\n\t\t\tthis.containerNode.appendChild(child.domNode);\n\t\t\tif (this.isExpanded && this.isTreeNode) {\n\t\t\t\t\/* When I add children to hidden containerNode => show container w\/ them *\/\n\t\t\t\tthis.showChildren();\n\t\t\t}\n\t\t}\n\n\n\t\tthis.children.splice(index, 0, child);\n\n\t\t\/\/dojo.debugShallow(this.children);\n\n\n\t\t\/\/ if node exists - adjust its depth, otherwise build it\n\t\tif (child.domNodeInitialized) {\n\t\t\tvar d = this.isTreeNode ? this.depth : -1;\n\t\t\tchild.adjustDepth( d - child.depth + 1 );\n\n\n\t\t\t\/\/ update icons to link generated dom with Tree => updateParentGrid\n\t\t\t\/\/ if I moved child from LastNode inside the tree => need to link it up'n'down =>\n\t\t\t\/\/ updateExpandGridColumn\n\t\t\t\/\/ if I change depth => need to update all grid..\n\t\t\tchild.updateIconTree();\n\t\t} else {\n\t\t\t\/\/dojo.debug(\"Create domnode \");\n\t\t\tchild.depth = this.isTreeNode ? this.depth+1 : 0;\n\t\t\tchild.createDOMNode(child.tree, child.depth);\n\t\t}\n\n\n\n\t\t\/\/ Use-case:\n\t\t\/\/ When previous sibling was created => it was last, no children after it\n\t\t\/\/ so it did not create link down => let's add it for all descendants\n\t\t\/\/ Use-case:\n\t\t\/\/ a child was moved down under the last node so last node should be updated\n\t\tvar prevSibling = child.getPreviousSibling();\n\t\tif (child.isLastNode() && prevSibling) {\n\t\t\tprevSibling.updateExpandGridColumn();\n\t\t}\n\n\n\t\t\/\/dojo.debug(\"Added child \"+child);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.makeBlankImg":{"_":{"meta":{"summary":"","src":"\t\tvar img = document.createElement('img');\n\n\t\timg.style.width = this.iconWidth + 'px';\n\t\timg.style.height = this.iconHeight + 'px';\n\t\timg.src = this.blankIconSrc;\n\t\timg.style.verticalAlign = 'middle';\n\n\t\treturn img;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.updateIconTree":{"_":{"meta":{"summary":"","src":"\t\t\tthis.updateIcons();\n\t\t}\n\n\t\tfor(var i=0; i<this.children.length; i++){\n\t\t\tthis.children[i].updateIconTree();\n\t\t}","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.toString":{"_":{"meta":{"summary":"","src":"\t\treturn \"[\"+this.widgetType+\" ID:\"+this.widgetId+\"]\"","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.move":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tvar oldTree = child.tree;\n\n\t\tthis.doMove.apply(this, arguments);\n\n\t\tvar newParent = child.parent;\n\t\tvar newTree = child.tree;\n\n\t\tvar message = {\n\t\t\t\toldParent: oldParent, oldTree: oldTree,\n\t\t\t\tnewParent: newParent, newTree: newTree,\n\t\t\t\tchild: child\n\t\t};\n\n\t\t\/* publish events here about structural changes for both source and target trees *\/\n\t\tdojo.event.topic.publish(oldTree.eventNames.moveFrom, message);\n\t\tdojo.event.topic.publish(newTree.eventNames.moveTo, message);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.oldParent":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tvar oldTree = child.tree;\n\n\t\tthis.doMove.apply(this, arguments);\n\n\t\tvar newParent = child.parent;\n\t\tvar newTree = child.tree;\n\n\t\tvar message = {\n\t\t\t\toldParent: oldParent, oldTree: oldTree,\n\t\t\t\tnewParent: newParent, newTree: newTree,\n\t\t\t\tchild: child\n\t\t};\n\n\t\t\/* publish events here about structural changes for both source and target trees *\/\n\t\tdojo.event.topic.publish(oldTree.eventNames.moveFrom, message);\n\t\tdojo.event.topic.publish(newTree.eventNames.moveTo, message);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.newParent":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tvar oldTree = child.tree;\n\n\t\tthis.doMove.apply(this, arguments);\n\n\t\tvar newParent = child.parent;\n\t\tvar newTree = child.tree;\n\n\t\tvar message = {\n\t\t\t\toldParent: oldParent, oldTree: oldTree,\n\t\t\t\tnewParent: newParent, newTree: newTree,\n\t\t\t\tchild: child\n\t\t};\n\n\t\t\/* publish events here about structural changes for both source and target trees *\/\n\t\tdojo.event.topic.publish(oldTree.eventNames.moveFrom, message);\n\t\tdojo.event.topic.publish(newTree.eventNames.moveTo, message);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.doMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tnewParent.doAddChild(child, index);","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.removeNode":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""}},"src":"\t\tif (!child.parent) return;\n\n\t\tvar oldTree = child.tree;\n\t\tvar oldParent = child.parent;\n\n\t\tvar removedChild = this.doRemoveNode.apply(this, arguments);\n\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.removeNode,\n\t\t\t{ child: removedChild, tree: oldTree, parent: oldParent }\n\t\t);\n\n\t\treturn removedChild;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.doRemoveNode":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""}},"src":"\t\tif (!child.parent) return;\n\n\t\tvar parent = child.parent;\n\n\t\tvar children = parent.children;\n\n\n\t\tvar index = child.getParentIndex();\n\t\tif (index < 0) {\n\t\t\tdojo.raise(\"Couldn't find node \"+child+\" for removal\");\n\t\t}\n\n\n\t\tchildren.splice(index,1);\n\t\tdojo.html.removeNode(child.domNode);\n\n\t\tif (parent.children.length == 0) {\n\t\t\tparent.containerNode.style.display = \"none\";\n\t\t}\n\n\t\t\/\/ if WAS last node (children.length decreased already) and has prevSibling\n\t\tif (index == children.length && index>0) {\n\t\t\tchildren[index-1].updateExpandGridColumn();\n\t\t}\n\t\t\/\/ if it WAS first node in WHOLE TREE -\n\t\t\/\/ update link up of its former lower neighbour(if exists still)\n\t\tif (parent instanceof dojo.widget.Tree && index == 0 && children.length>0) {\n\t\t\tchildren[0].updateExpandGrid();\n\t\t}\n\n\t\t\/\/parent.updateIconTree();\n\n\n\t\tchild.parent = child.tree = null;\n\n\t\treturn child;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.markLoading":{"_":{"meta":{"summary":"","src":"\t\t\/\/ no way to mark tree loading","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.unMarkLoading":{"_":{"meta":{"summary":"","src":"\t\t\/\/ no way to show that tree finished loading","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.lock":{"_":{"meta":{"summary":"","src":"\t\t!this.lockLevel && this.markLoading();\n\t\tthis.lockLevel++;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.unlock":{"_":{"meta":{"summary":"","src":"\t\tif (!this.lockLevel) {\n\t\t\tdojo.raise(\"unlock: not locked\");\n\t\t}\n\t\tthis.lockLevel--;\n\t\t!this.lockLevel && this.unMarkLoading();","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.isLocked":{"_":{"meta":{"summary":"","src":"\t\tvar node = this;\n\t\twhile (true) {\n\t\t\tif (node.lockLevel) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (node instanceof dojo.widget.Tree) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tnode = node.parent;\n\t\t}\n\n\t\treturn false;","this":"dojo.widget.Tree"}}},"dojo.widget.Tree.flushLock":{"_":{"meta":{"summary":"","src":"\t\tthis.lockLevel = 0;\n\t\tthis.unMarkLoading();","this":"dojo.widget.Tree"}}}}}},"dojo.widget.TreeBasicController":{"meta":{"requires":{"common":["dojo.event.*","dojo.json","dojo.io.*","dojo.dnd.TreeDragAndDrop"]},"methods":{"dojo.widget.TreeBasicController":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);","inherits":["dojo.widget.HtmlWidget"],"protovariables":{"widgetType":"","DNDController":"","dieWithTree":""},"this_variables":["DNDController","node","expandLevel","process"]}}},"handler":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"expandLevel":{"type":""}},"src":"\t\t\tthis.node = node;\n\t\t\tthis.expandLevel = expandLevel;\n\t\t\t\/\/ recursively expand opened node\n\t\t\tthis.process = function() {\n\t\t\t\t\/\/dojo.debug(\"Process \"+node+\" level \"+level);\n\t\t\t\tfor(var i=0; i<this.node.children.length; i++) {\n\t\t\t\t\tvar child = node.children[i];\n\n\t\t\t\t\t_this.expandToLevel(child, this.expandLevel);\n\t\t\t\t}\n\t\t\t};","this_variables":["node","expandLevel","process"]}}},"handler.process":{"_":{"meta":{"summary":"","src":"\t\t\t\t\tvar child = node.children[i];\n\n\t\t\t\t\t_this.expandToLevel(child, this.expandLevel);\n\t\t\t\t}"}}},"dojo.widget.TreeBasicController.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.require(\"dojo.dnd.TreeDragAndDrop\");\n\t\t\tthis.DNDController = new dojo.dnd.TreeDNDController(this);\n\t\t}","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.listenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tdojo.event.topic.subscribe(tree.eventNames.treeClick, this, \"onTreeClick\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.treeCreate, this, \"onTreeCreate\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.treeDestroy, this, \"onTreeDestroy\");\n\n\t\tif (this.DNDController) {\n\t\t\tthis.DNDController.listenTree(tree);\n\t\t}","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.unlistenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tdojo.event.topic.unsubscribe(tree.eventNames.createDOMNode, this, \"onCreateDOMNode\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.treeClick, this, \"onTreeClick\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.treeCreate, this, \"onTreeCreate\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.treeDestroy, this, \"onTreeDestroy\");","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.onTreeDestroy":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar tree = message.source;\n\n\t\tthis.unlistenTree(tree);\n\n\t\tif (this.dieWithTree) {\n\t\t\t\/\/alert(\"Killing myself \"+this.widgetId);\n\t\t\tthis.destroy();\n\t\t\t\/\/dojo.debug(\"done\");\n\t\t}","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.onCreateDOMNode":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar node = message.source;\n\n\n\t\tif (node.expandLevel > 0) {\n\t\t\tthis.expandToLevel(node, node.expandLevel);\n\t\t}","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.onTreeCreate":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar tree = message.source;\n\t\tvar _this = this;\n\t\tif (tree.expandLevel) {\n\t\t\tdojo.lang.forEach(tree.children,\n\t\t\t\tfunction(child) {\n\t\t\t\t\t_this.expandToLevel(child, tree.expandLevel-1)\n\t\t\t\t}\n\t\t\t);\n\t\t}","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.expandToLevel":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"level":{"type":""}},"src":"\t\tif (level == 0) return;\n\n\t\tvar children = node.children;\n\t\tvar _this = this;\n\n\t\tvar handler = function(node, expandLevel) {\n\t\t\tthis.node = node;\n\t\t\tthis.expandLevel = expandLevel;\n\t\t\t\/\/ recursively expand opened node\n\t\t\tthis.process = function() {\n\t\t\t\t\/\/dojo.debug(\"Process \"+node+\" level \"+level);\n\t\t\t\tfor(var i=0; i<this.node.children.length; i++) {\n\t\t\t\t\tvar child = node.children[i];\n\n\t\t\t\t\t_this.expandToLevel(child, this.expandLevel);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tvar h = new handler(node, level-1);\n\n\n\t\tthis.expand(node, false, h, h.process);","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.onTreeClick":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar node = message.source;\n\n\t\tif(node.isLocked()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (node.isExpanded){\n\t\t\tthis.collapse(node);\n\t\t} else {\n\t\t\tthis.expand(node);\n\t\t}","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.expand":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tnode.expand();\n\t\tif (callFunc) callFunc.apply(callObj, [node]);","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.collapse":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tnode.collapse();","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.canMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""}},"src":"\t\tif (child.actionIsDisabled(child.actions.MOVE)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t\/\/ if we move under same parent then no matter if ADDCHILD disabled for him\n\t\t\/\/ but if we move to NEW parent then check if action is disabled for him\n\t\t\/\/ also covers case for newParent being a non-folder in strict mode etc\n\t\tif (child.parent !== newParent && newParent.actionIsDisabled(newParent.actions.ADDCHILD)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t\/\/ Can't move parent under child. check whether new parent is child of \"child\".\n\t\tvar node = newParent;\n\t\twhile(node.isTreeNode) {\n\t\t\t\/\/dojo.debugShallow(node.title)\n\t\t\tif (node === child) {\n\t\t\t\t\/\/ parent of newParent is child\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tnode = node.parent;\n\t\t}\n\n\t\treturn true;","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.move":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\treturn false;\n\t\t}\n\n\t\tvar result = this.doMove(child, newParent, index);\n\n\t\tif (!result) return result;\n\n\t\tif (newParent.isTreeNode) {\n\t\t\tthis.expand(newParent);\n\t\t}\n\n\t\treturn result;","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.doMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tchild.tree.move(child, newParent, index);\n\n\t\treturn true;","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.canRemoveNode":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""}},"src":"\t\tif (child.actionIsDisabled(child.actions.REMOVE)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.removeNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tif (!this.canRemoveNode(node)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.doRemoveNode(node, callObj, callFunc);","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.doRemoveNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tnode.tree.removeNode(node);\n\n\t\tif (callFunc) {\n\t\t\tcallFunc.apply(dojo.lang.isUndefined(callObj) ? this : callObj, [node]);\n\t\t}","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.canCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""}},"src":"\t\tif (parent.actionIsDisabled(parent.actions.ADDCHILD)) return false;\n\n\t\treturn true;","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.createChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tif (!this.canCreateChild(parent, index, data)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.doCreateChild.apply(this, arguments);","this":"dojo.widget.TreeBasicController"}}},"dojo.widget.TreeBasicController.doCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar widgetType = data.widgetType ? data.widgetType : \"TreeNode\";\n\n\t\tvar newChild = dojo.widget.createWidget(widgetType, data);\n\n\t\tparent.addChild(newChild, index);\n\n\t\tthis.expand(parent);\n\n\t\tif (callFunc) {\n\t\t\tcallFunc.apply(callObj, [newChild]);\n\t\t}\n\n\t\treturn newChild;","this":"dojo.widget.TreeBasicController"}}}}}},"dojo.widget.TreeBasicControllerV3":{"meta":{"requires":{"common":["dojo.event.*","dojo.json","dojo.io.*","dojo.widget.TreeCommon","dojo.widget.TreeNodeV3","dojo.widget.TreeV3","dojo.widget.TreeTimeoutIterator"]},"methods":{"dojo.widget.TreeBasicControllerV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\t\n\tthis.listenedTrees = {};","this_variables":["listenedTrees","onExpandClickHandler"],"inherits":["dojo.widget.HtmlWidget","dojo.widget.TreeCommon"],"protovariables":{"widgetType":"","listenTreeEvents":"","batchExpandTimeout":""}}}},"filter":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"\t\t\treturn (elem instanceof dojo.widget.Widget) && elem.isFolder && elem.isExpanded;"}}},"filterFunc":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"\t\t\tvar res = elem.isFolder || elem.children && elem.children.length;\n\t\t\t\/\/dojo.debug(\"Filter \"+elem+ \" result:\"+res);\n\t\t\treturn res;"}}},"callFunc":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"iterator":{"type":""}},"src":"\t\t\t this.expand(node, true);\n\t\t\t iterator.forward();"}}},"dojo.widget.TreeBasicControllerV3.listenNodeFilter":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"                                    return elem.isFolder && elem instanceof dojo.widget.Widget   ","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.listenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\/\/dojo.event.connect(node.expandNode, \"onclick\", this, \"onExpandClick\");","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.unlistenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tdojo.event.browser.removeListener(node.expandNode, \"onclick\", this.onExpandClickHandler);\n\t\t\/\/dojo.event.disconnect(node.expandNode, \"onclick\", this, \"onExpandClick\");","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.onAfterSetFolder":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.onAfterUnsetFolder":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.unlistenNode(message.source);","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.initialize":{"_":{"meta":{"summary":"","src":"\t\tthis.onExpandClickHandler =  dojo.lang.hitch(this, this.onExpandClick)","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.getInfo":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"\t\treturn elem.getInfo();","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.onAfterChangeTree":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\t\tif (message.node.expandLevel > 0) {\n\t\t\t\tthis.expandToLevel(message.node, message.node.expandLevel);\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t\/\/dojo.profile.end(\"onTreeChange\");\n\t\t\treturn; \n\t\t}\n\t\t            \n\t\tif (!message.newTree || !this.listenedTrees[message.newTree.widgetId]) {\n\t\t\t\/\/ I got this message because node leaves me (oldtree)\n\t\t\t\/**\n\t\t\t * clean all folders that I listen. I don't listen to non-folders.\n\t\t\t *\/\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.unlistenNode);\n\t\t}\t\t\n\t\t\n\t\tif (!message.oldTree || !this.listenedTrees[message.oldTree.widgetId]) {\n\t\t\t\/\/ we have new node\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.listenNode);\n\t\t}\n\t\t\n\t\t\/\/dojo.profile.end(\"onTreeChange\");","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.onAfterTreeCreate":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar tree = message.source;\n\t\tvar _this = this;\n\t\tif (tree.expandLevel) {\t\t\t\t\t\t\t\t\n\t\t\t_this.expandToLevel(tree, tree.expandLevel)\n\t\t}","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.expandAll":{"_":{"meta":{"summary":"","parameters":{"nodeOrTree":{"type":""},"callback":{"type":""},"callobj":{"type":""}},"src":"\t\treturn this.expandToLevel(nodeOrTree, Number.POSITIVE_INFINITY, callback, callobj);","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.collapseAll":{"_":{"meta":{"summary":"","parameters":{"nodeOrTree":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tvar filter = function(elem) {\n\t\t\treturn (elem instanceof dojo.widget.Widget) && elem.isFolder && elem.isExpanded;\n\t\t}\n\t\t\n\t\tif (nodeOrTree.isTreeNode) {\t\t\n\t\t\tthis.processDescendants(nodeOrTree, filter, this.collapse);\n\t\t} else if (nodeOrTree.isTree) {\n\t\t\tdojo.lang.forEach(nodeOrTree.children,function(c) { _this.processDescendants(c, filter, _this.collapse) });\n\t\t}","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.expandToLevel":{"_":{"meta":{"summary":"","parameters":{"nodeOrTree":{"type":""},"level":{"type":""}},"src":"\t\tdojo.require(\"dojo.widget.TreeTimeoutIterator\");\n\t\t\n\t\tvar filterFunc = function(elem) {\n\t\t\tvar res = elem.isFolder || elem.children && elem.children.length;\n\t\t\t\/\/dojo.debug(\"Filter \"+elem+ \" result:\"+res);\n\t\t\treturn res;\n\t\t};\n\t\tvar callFunc = function(node, iterator) {\n\t\t\t this.expand(node, true);\n\t\t\t iterator.forward();\n\t\t}\n\t\t\t\n\t\tvar iterator = new dojo.widget.TreeTimeoutIterator(nodeOrTree, callFunc, this);\n\t\titerator.setFilter(filterFunc);\n\t\t\n\t\t\n\t\titerator.timeout = this.batchExpandTimeout;\n\t\t\n\t\t\/\/dojo.debug(\"here \"+nodeOrTree+\" level \"+level);\n\t\t\n\t\titerator.setMaxLevel(nodeOrTree.isTreeNode ? level-1 : level);\n\t\t\n\t\t\n\t\treturn iterator.start(nodeOrTree.isTreeNode);","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.getWidgetByNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tvar widgetId;\n\t\twhile (! (widgetId = node.widgetId) ) {\n\t\t\tnode = node.parentNode;\n\t\t}\n\t\treturn dojo.widget.byId(widgetId);","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.onExpandClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tif (node.isExpanded){\n\t\t\tthis.collapse(node);\n\t\t} else {\n\t\t\tthis.expand(node);\n\t\t}","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.expand":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t\tnode.expand(); \/\/ skip trees or non-folders\n\t\t}","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.collapse":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tnode.collapse();\t","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.canEditLabel":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tif (node.actionIsDisabled(parent.actions.EDIT)) return false;\n\n\t\treturn true;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.editLabelStart":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tif (!this.canEditLabel(node)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.doEditLabelStart.apply(this, arguments);","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.doEditLabelStart":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tnode.editLabelStart();\t\t","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.runStages":{"_":{"meta":{"summary":"","parameters":{"check":{"type":""},"prepare":{"type":""},"make":{"type":""},"finalize":{"type":""},"expose":{"type":""},"args":{"type":""}},"src":"\t\tif (check && !check.apply(this, args)) {\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tif (prepare && !prepare.apply(this, args)) {\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar result = make.apply(this, args);\n\t\t\n\t\t\n\t\tif (finalize) {\n\t\t\tfinalize.apply(this,args);\t\t\t\n\t\t}\n\t\t\t\n\t\tif (!result) {\n\t\t\treturn result;\n\t\t}\n\t\t\n\t\t\t\n\t\tif (expose) {\n\t\t\texpose.apply(this, args);\n\t\t}\n\t\t\n\t\treturn result;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.canClone":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""}},"src":"\t\treturn true;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.clone":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""}},"src":"\t\treturn this.runStages(\n\t\t\tthis.canClone, this.prepareClone, this.doClone, this.finalizeClone, this.exposeClone, arguments\n\t\t);\t\t\t","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.exposeClone":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""}},"src":"\t\tif (newParent.isTreeNode) {\n\t\t\tthis.expand(newParent);\n\t\t}","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.doClone":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""}},"src":"\t\tnewParent.addChild(cloned, index);\n\t\t\t\t\n\t\treturn cloned;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.canDetach":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""}},"src":"\t\tif (child.actionIsDisabled(child.actions.DETACH)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.detach":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\treturn this.runStages(\n\t\t\tthis.canDetach, this.prepareDetach, this.doDetach, this.finalizeDetach, this.exposeDetach, arguments\n\t\t);\t\t\t","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.doDetach":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tnode.detach();","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.canDestroy":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""}},"src":"\t\tif (child.parent && !this.canDetach(child)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.destroy":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\treturn this.runStages(\n\t\t\tthis.canDestroy, this.prepareDestroy, this.doDestroy, this.finalizeDestroy, this.exposeDestroy, arguments\n\t\t);\t\t\t","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.doDestroy":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tnode.destroy();","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.canMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""}},"src":"\t\tif (child.actionIsDisabled(child.actions.MOVE)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t\/\/ if we move under same parent then no matter if ADDCHILD disabled for him\n\t\t\/\/ but if we move to NEW parent then check if action is disabled for him\n\t\t\/\/ also covers case for newParent being a non-folder in strict mode etc\n\t\tif (child.parent !== newParent && newParent.actionIsDisabled(newParent.actions.ADDCHILD)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t\/\/ Can't move parent under child. check whether new parent is child of \"child\".\n\t\tvar node = newParent;\n\t\twhile(node.isTreeNode) {\n\t\t\t\/\/dojo.debugShallow(node.title)\n\t\t\tif (node === child) {\n\t\t\t\t\/\/ parent of newParent is child\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tnode = node.parent;\n\t\t}\n\n\t\treturn true;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.move":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":",..."}},"src":"\t\treturn this.runStages(this.canMove, this.prepareMove, this.doMove, this.finalizeMove, this.exposeMove, arguments);\t\t\t","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.doMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\treturn true;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.exposeMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""}},"src":"\t\tif (newParent.isTreeNode) {\n\t\t\tthis.expand(newParent);\n\t\t}","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.canCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""}},"src":"\t\tif (parent.actionIsDisabled(parent.actions.ADDCHILD)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.createChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""}},"src":"\t\treturn this.runStages(this.canCreateChild, this.prepareCreateChild, this.doCreateChild, this.finalizeCreateChild, this.exposeCreateChild, arguments);\t\t","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.doCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""}},"src":"\t\tvar newChild = parent.tree.createNode(data); \n\t\t\/\/var newChild = dojo.widget.createWidget(widgetType, data);\n\n\t\tparent.addChild(newChild, index);\n\n\t\treturn newChild;","this":"dojo.widget.TreeBasicControllerV3"}}},"dojo.widget.TreeBasicControllerV3.exposeCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""}},"src":"\t\tthis.expand(parent);","this":"dojo.widget.TreeBasicControllerV3"}}}}}},"dojo.widget.TreeCommon":{"meta":{"requires":{"common":["dojo.widget.*"]},"methods":{"dojo.widget.TreeCommon":{"_":{"meta":{"summary":"","src":"","protovariables":{"listenTreeEvents":"","listenedTrees":"","listenNodeFilter":""}}}},"dojo.widget.TreeCommon.listenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tif (this.listenedTrees[tree.widgetId]) {\n\t\t\treturn; \/\/ already listening\n\t\t}\n\t\t\n\t\tdojo.lang.forEach(this.listenTreeEvents, function(event) {\n\t\t\tvar eventHandler =  \"on\" + event.charAt(0).toUpperCase() + event.substr(1);\n\t\t\t\/\/dojo.debug(\"subscribe \"+tree.eventNames[event]+\" \"+eventHandler);\n\t\t\tdojo.event.topic.subscribe(tree.eventNames[event], _this, eventHandler);\n\t\t});\n\t\t\n\t\t\n\t\tvar filter;\n\t\t\n\t\tif (this.listenNodeFilter) {\t\t\t\n\t\t\tthis.processDescendants(tree, this.listenNodeFilter, this.listenNode, true);\n\t\t}\n\t\t\n\t\t\/**\n\t\t * remember that I listen to this tree. No unbinding\/binding\/deselection\n\t\t * needed when transfer between listened trees\n\t\t *\/\n\t\tthis.listenedTrees[tree.widgetId] = true;","returns":"already listening","this":"dojo.widget.TreeCommon"}}},"dojo.widget.TreeCommon.listenNode":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.TreeCommon"}}},"dojo.widget.TreeCommon.unlistenNode":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.TreeCommon"}}},"dojo.widget.TreeCommon.unlistenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""},"nodeFilter":{"type":""}},"src":"\t\tvar _this = this;\n\t\n\t\tif (!this.listenedTrees[tree.widgetId]) {\n\t\t\treturn; \n\t\t}\n\t\t\n\t\tdojo.lang.forEach(this.listenTreeEvents, function(event) {\n\t\t\tvar eventHandler =  \"on\" + event.charAt(0).toUpperCase() + event.substr(1);\n\t\t\tdojo.event.topic.unsubscribe(tree.eventNames[event], _this, eventHandler);\n\t\t});\n\t\t\n\t\t\n\t\tif (this.listenNodeFilter) {\n\t\t\tthis.processDescendants(tree, this.listenNodeFilter, this.unlistenNode, true);\n\t\t}\n\t\t\n\t\tdelete this.listenedTrees[tree.widgetId];","this":"dojo.widget.TreeCommon"}}},"dojo.widget.TreeCommon.domElement2TreeNode":{"_":{"meta":{"summary":"","parameters":{"domElement":{"type":""}},"src":"\t\twhile (domElement && !domElement.widgetId) {\n\t\t\tdomElement = domElement.parentNode;\n\t\t}\n\t\t\n\t\tif (!domElement) {\n\t\t\tdojo.raise(\"domElement2TreeNode couldnt detect widget\");\n\t\t}\n\t\t\n\t\treturn dojo.widget.byId(domElement.widgetId);","this":"dojo.widget.TreeCommon"}}},"dojo.widget.TreeCommon.processDescendants":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""},"filter":{"type":""},"func":{"type":""},"skipFirst":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tif (!skipFirst) {\n\t\t\tif (!filter.call(_this,elem)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfunc.call(_this,elem);\t        \n\t\t}\n\t\t\n\t\t\n\t\tvar stack = [elem]\n\t\twhile (elem = stack.pop()) {\n\t\t\tdojo.lang.forEach(elem.children, function(elem) {\n\t\t\t\tif (filter.call(_this, elem)) {\t\t\n\t\t\t\t\tfunc.call(_this, elem);\n\t\t\t\t\tstack.push(elem);\n\t\t\t\t}\n\t\t\t});\n\t\t}","this":"dojo.widget.TreeCommon"}}}}}},"dojo.widget.TreeContextMenu":{"meta":{"requires":{"common":["dojo.event.*","dojo.io.*","dojo.widget.Menu2"]},"methods":{"dojo.widget.TreeContextMenu":{"_":{"meta":{"summary":"","src":"\tdojo.widget.PopupMenu2.call(this);\n\n\tthis.listenedTrees = [];","this_variables":["listenedTrees"],"inherits":["dojo.widget.PopupMenu2"],"protovariables":{"widgetType":""}}}},"dojo.widget.TreeMenuItem":{"_":{"meta":{"summary":"","src":"\tdojo.widget.MenuItem2.call(this);","inherits":["dojo.widget.MenuItem2"],"protovariables":{"widgetType":"","treeActions":""},"this_variables":["treeActions"]}}},"dojo.widget.TreeContextMenu.open":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"parentMenu":{"type":""},"explodeSrc":{"type":""}},"src":"\t\tvar result = dojo.widget.PopupMenu2.prototype.open.apply(this, arguments);\n\n\t\t\/* publish many events here about structural changes *\/\n\t\tdojo.event.topic.publish(this.eventNames.open, { menu:this });\n\n\t\treturn result;","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.menu":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"parentMenu":{"type":""},"explodeSrc":{"type":""}},"src":"\t\tvar result = dojo.widget.PopupMenu2.prototype.open.apply(this, arguments);\n\n\t\t\/* publish many events here about structural changes *\/\n\t\tdojo.event.topic.publish(this.eventNames.open, { menu:this });\n\n\t\treturn result;","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.listenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tfor(var i=0; i<nodes.length; i++) {\n\t\t\tif (!nodes[i].isTreeNode) continue;\n\t\t\tthis.bindDomNode(nodes[i].labelNode);\n\t\t}\n\n\n\t\t\/* bind context menu to all nodes that will be created in the future (e.g loaded from server)*\/\n\t\tvar _this = this;\n\t\tdojo.event.topic.subscribe(tree.eventNames.createDOMNode, this, \"onCreateDOMNode\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.moveFrom, this, \"onMoveFrom\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.moveTo, this, \"onMoveTo\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.removeNode, this, \"onRemoveNode\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.addChild, this, \"onAddChild\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.treeDestroy, this, \"onTreeDestroy\");\n\n\t\tthis.listenedTrees.push(tree);","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.unlistenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tdojo.event.topic.unsubscribe(tree.eventNames.moveFrom, this, \"onMoveFrom\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.moveTo, this, \"onMoveTo\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.removeNode, this, \"onRemoveNode\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.addChild, this, \"onAddChild\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.treeDestroy, this, \"onTreeDestroy\");\n\n\t\tfor(var i=0; i<this.listenedTrees.length; i++){\n           if(this.listenedTrees[i] === tree){\n                   this.listenedTrees.splice(i, 1);\n                   break;\n           }\n\t\t}","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.onTreeDestroy":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.unlistenTree(message.source);","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.bindTreeNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\/\/dojo.debug(\"bind to \"+node);\n\t\tdojo.lang.forEach(node.getDescendants(),\n\t\t\tfunction(e) {_this.bindDomNode(e.labelNode); }\n\t\t);","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.unBindTreeNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\/\/dojo.debug(\"Unbind from \"+node);\n\t\tdojo.lang.forEach(node.getDescendants(),\n\t\t\tfunction(e) {_this.unBindDomNode(e.labelNode); }\n\t\t);","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.onCreateDOMNode":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.bindTreeNode(message.source);","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.onMoveFrom":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (!dojo.lang.inArray(this.listenedTrees, message.newTree)) {\n\t\t\tthis.unBindTreeNode(message.child);\n\t\t}","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.onMoveTo":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (dojo.lang.inArray(this.listenedTrees, message.newTree)) {\n\t\t\tthis.bindTreeNode(message.child);\n\t\t}","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.onRemoveNode":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.unBindTreeNode(message.child);","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeContextMenu.onAddChild":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (message.domNodeInitialized) {\n\t\t\t\/\/ dom node was there already => I did not process onNodeDomCreate\n\t\t\tthis.bindTreeNode(message.child);\n\t\t}","this":"dojo.widget.TreeContextMenu"}}},"dojo.widget.TreeMenuItem.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tthis.treeActions = this.treeActions.split(\",\");\n\t\tfor(var i=0; i<this.treeActions.length; i++) {\n\t\t\tthis.treeActions[i] = this.treeActions[i].toUpperCase();\n\t\t}","this":"dojo.widget.TreeMenuItem"}}},"dojo.widget.TreeMenuItem.getTreeNode":{"_":{"meta":{"summary":"","src":"\t\tvar menu = this;\n\n\t\twhile (! (menu instanceof dojo.widget.TreeContextMenu) ) {\n\t\t\tmenu = menu.parent;\n\t\t}\n\n\t\tvar source = menu.getTopOpenEvent().target;\n\n\t\twhile (!source.getAttribute('treeNode') && source.tagName != 'body') {\n\t\t\tsource = source.parentNode;\n\t\t}\n\t\tif (source.tagName == 'body') {\n\t\t\tdojo.raise(\"treeNode not detected\");\n\t\t}\n\t\tvar treeNode = dojo.widget.manager.getWidgetById(source.getAttribute('treeNode'));\n\n\t\treturn treeNode;","this":"dojo.widget.TreeMenuItem"}}},"dojo.widget.TreeMenuItem.menuOpen":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar treeNode = this.getTreeNode();\n\n\t\tthis.setDisabled(false); \/\/ enable by default\n\n\t\tvar _this = this;\n\t\tdojo.lang.forEach(_this.treeActions,\n\t\t\tfunction(action) {\n\t\t\t\t_this.setDisabled( treeNode.actionIsDisabled(action) );\n\t\t\t}\n\t\t);","this":"dojo.widget.TreeMenuItem"}}},"dojo.widget.TreeMenuItem.toString":{"_":{"meta":{"summary":"","src":"\t\treturn \"[\"+this.widgetType+\" node \"+this.getTreeNode()+\"]\";","this":"dojo.widget.TreeMenuItem"}}}}}},"dojo.widget.TreeContextMenuV3":{"meta":{"requires":{"common":["dojo.event.*","dojo.io.*","dojo.widget.Menu2","dojo.widget.TreeCommon"]},"methods":{"dojo.widget.TreeContextMenuV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.PopupMenu2.call(this);\n\n\tthis.listenedTrees = {};","this_variables":["listenedTrees"],"inherits":["dojo.widget.PopupMenu2","dojo.widget.TreeCommon"],"protovariables":{"widgetType":"","listenTreeEvents":""}}}},"dojo.widget.TreeMenuItemV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.MenuItem2.call(this);\n\t\n\tthis.treeActions = [];","this_variables":["treeActions"],"inherits":["dojo.widget.MenuItem2","dojo.widget.TreeCommon"],"protovariables":{"widgetType":"","treeActions":""}}}},"dojo.widget.TreeContextMenuV3.open":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"parentMenu":{"type":""},"explodeSrc":{"type":""}},"src":"\t\tvar result = dojo.widget.PopupMenu2.prototype.open.apply(this, arguments);\n\n\t\t\/* publish many events here about structural changes *\/\n\t\tdojo.event.topic.publish(this.eventNames.open, { menu:this });\n\n\t\treturn result;","this":"dojo.widget.TreeContextMenuV3"}}},"dojo.widget.TreeContextMenuV3.menu":{"_":{"meta":{"summary":"","parameters":{"x":{"type":""},"y":{"type":""},"parentMenu":{"type":""},"explodeSrc":{"type":""}},"src":"\t\tvar result = dojo.widget.PopupMenu2.prototype.open.apply(this, arguments);\n\n\t\t\/* publish many events here about structural changes *\/\n\t\tdojo.event.topic.publish(this.eventNames.open, { menu:this });\n\n\t\treturn result;","this":"dojo.widget.TreeContextMenuV3"}}},"dojo.widget.TreeContextMenuV3.listenNodeFilter":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"                                    return elem instanceof dojo.widget.Widget   ","this":"dojo.widget.TreeContextMenuV3"}}},"dojo.widget.TreeContextMenuV3.onBeforeTreeDestroy":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.unlistenTree(message.source);","this":"dojo.widget.TreeContextMenuV3"}}},"dojo.widget.TreeContextMenuV3.onAfterChangeTree":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\t\t\/\/ I got this message because node leaves me (oldtree)\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.unlistenNode);\n\t\t}\t\t\n\t\t\n\t\tif (!message.oldTree || !this.listenedTrees[message.oldTree.widgetId]) {\n\t\t\t\/\/ we have new node\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.listenNode);\n\t\t}\n\t\t\n\t\t\/\/dojo.profile.end(\"onTreeChange\");","this":"dojo.widget.TreeContextMenuV3"}}},"dojo.widget.TreeContextMenuV3.listenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tthis.bindDomNode(node.labelNode);","this":"dojo.widget.TreeContextMenuV3"}}},"dojo.widget.TreeContextMenuV3.unlistenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tthis.unBindDomNode(node.labelNode);","this":"dojo.widget.TreeContextMenuV3"}}},"dojo.widget.TreeMenuItemV3.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tfor(var i=0; i<this.treeActions.length; i++) {\n\t\t\tthis.treeActions[i] = this.treeActions[i].toUpperCase();\n\t\t}","this":"dojo.widget.TreeMenuItemV3"}}},"dojo.widget.TreeMenuItemV3.getTreeNode":{"_":{"meta":{"summary":"","src":"\t\tvar menu = this;\n\n\t\t\/\/ FIXME: change to dojo.widget[this.widgetType]\n\t\twhile (! (menu instanceof dojo.widget.TreeContextMenuV3) ) {\n\t\t\tmenu = menu.parent;\n\t\t}\n\n\t\tvar source = menu.getTopOpenEvent().target;\n\n\t\tvar treeNode = this.domElement2TreeNode(source);\n\t\t\n\t\treturn treeNode;","this":"dojo.widget.TreeMenuItemV3"}}},"dojo.widget.TreeMenuItemV3.menuOpen":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar treeNode = this.getTreeNode();\n\n\t\tthis.setDisabled(false); \/\/ enable by default\n\n\t\tvar _this = this;\n\t\tdojo.lang.forEach(_this.treeActions,\n\t\t\tfunction(action) {\n\t\t\t\t_this.setDisabled( treeNode.actionIsDisabled(action) );\n\t\t\t}\n\t\t);","this":"dojo.widget.TreeMenuItemV3"}}},"dojo.widget.TreeMenuItemV3.toString":{"_":{"meta":{"summary":"","src":"\t\treturn \"[\"+this.widgetType+\" node \"+this.getTreeNode()+\"]\";","this":"dojo.widget.TreeMenuItemV3"}}}}}},"dojo.widget.TreeControllerExtension":{"meta":{"methods":{"dojo.widget.TreeControllerExtension":{"_":{"meta":{"summary":"","src":"","this_variables":["node","savedIndices","process"]}}},"handler":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"savedIndices":{"type":""}},"src":"\t\t\tthis.node = node;                \n\t\t\tthis.savedIndices = savedIndices; \/\/[i];\n\t\t\t\/\/ recursively read next savedIndices level and apply to opened node\n\t\t\tthis.process = function() {\n\t\t\t\t\/\/dojo.debug(\"Callback applied for \"+this.node);\n\t\t\t\t_this.restoreExpandedIndices(this.node, this.savedIndices, field);\n\t\t\t};","this_variables":["node","savedIndices","process"]}}},"handler.process":{"_":{"meta":{"summary":"","src":""}}},"dojo.widget.TreeControllerExtension.saveExpandedIndices":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"field":{"type":""}},"src":"\t\tvar obj = {};\n\n\t\tfor(var i=0; i<node.children.length; i++) {\n\t\t\tif (node.children[i].isExpanded) {\n\t\t\t\tvar key = dojo.lang.isUndefined(field) ? i : node.children[i][field];\n\t\t\t\tobj[key] = this.saveExpandedIndices(node.children[i], field);\n\t\t\t}\n\t\t}\n\n\t\treturn obj;","this":"dojo.widget.TreeControllerExtension"}}},"dojo.widget.TreeControllerExtension.restoreExpandedIndices":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"savedIndices":{"type":""},"field":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar handler = function(node, savedIndices) {\n\t\t\tthis.node = node; \/\/.children[i];\n\t\t\tthis.savedIndices = savedIndices; \/\/[i];\n\t\t\t\/\/ recursively read next savedIndices level and apply to opened node\n\t\t\tthis.process = function() {\n\t\t\t\t\/\/dojo.debug(\"Callback applied for \"+this.node);\n\t\t\t\t_this.restoreExpandedIndices(this.node, this.savedIndices, field);\n\t\t\t};\n\t\t}\n\n\n\t\tfor(var i=0; i<node.children.length; i++) {\n\t\t\tvar child = node.children[i];\n\n\t\t\tvar found = false;\n\t\t\tvar key = -1;\n\n\t\t\t\/\/dojo.debug(\"Check \"+child)\n\t\t\t\/\/ process field set case\n\t\t\tif (dojo.lang.isUndefined(field) && savedIndices[i]) {\n\t\t\t\tfound = true;\n\t\t\t\tkey = i;\n\t\t\t}\n\n\t\t\t\/\/ process case when field is not set\n\t\t\tif (field) {\n\t\t\t\tfor(var key in savedIndices) {\n\t\t\t\t\t\/\/dojo.debug(\"Compare \"+key+\" \"+child[field])\n\t\t\t\t\tif (key == child[field]) {\n\t\t\t\t\t\tfound = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t\/\/ if we found anything - expand it\n\t\t\tif (found) {\n\t\t\t\t\/\/dojo.debug(\"Found at \"+key)\n\t\t\t\tvar h = new handler(child, savedIndices[key]);\n\t\t\t\t_this.expand(child, false, h, h.process);\n\t\t\t} else if (child.isExpanded) { \/\/ not found, so collapse\n\t\t\t\t\/\/dojo.debug(\"Collapsing all descendants \"+node.children[i])\n\t\t\t\tdojo.lang.forEach(child.getDescendants(), function(elem) { _this.collapse(elem); });\n\t\t\t\t\/\/this.collapse(node.children[i]);\n\t\t\t}\n\n\t\t}","this":"dojo.widget.TreeControllerExtension"}}}}}},"dojo.widget.TreeDemo":{"meta":{"requires":{"common":["dojo.Deferred"]}}},"dojo.widget.TreeDeselectOnDblselect":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.TreeSelectorV3"]},"methods":{"dojo.widget.TreeDeselectOnDblselect":{"_":{"meta":{"summary":"","src":"","inherits":["dojo.widget.HtmlWidget"],"protovariables":{"widgetType":"","selector":""},"this_variables":["selector"]}}},"dojo.widget.TreeDeselectOnDblselect.initialize":{"_":{"meta":{"summary":"","src":"\t\tthis.selector = dojo.widget.byId(this.selector);\n\t\t\/\/dojo.debug(\"OK \"+this.selector);\n\t\tdojo.event.topic.subscribe(this.selector.eventNames.dblselect, this, \"onDblselect\");\t\t","this":"dojo.widget.TreeDeselectOnDblselect"}}},"dojo.widget.TreeDeselectOnDblselect.onDblselect":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"","this":"dojo.widget.TreeDeselectOnDblselect"}}}}}},"dojo.widget.TreeDndControllerV3":{"meta":{"requires":{"common":["dojo.dnd.TreeDragAndDropV3"]},"methods":{"dojo.widget.TreeDndControllerV3":{"_":{"meta":{"summary":"","src":"\tthis.dragSources = {};\n\n\tthis.dropTargets = {};\n\t\n\tthis.listenedTrees = {};","this_variables":["dragSources","dropTargets","listenedTrees","treeController"],"inherits":["dojo.widget.HtmlWidget","dojo.widget.TreeCommon"],"protovariables":{"widgetType":"","listenTreeEvents":""}}}},"dojo.widget.TreeDndControllerV3.listenNodeFilter":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"                                    return elem instanceof dojo.widget.Widget    ","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""}},"src":"\t\tthis.treeController = dojo.lang.isString(args.controller) ? dojo.widget.byId(args.controller) : args.controller;\n\t\t\n\t\tif (!this.treeController) {\n\t\t\tdojo.raise(\"treeController must be declared\");\n\t\t}","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.onBeforeTreeDestroy":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.unlistenTree(message.source);","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.onAfterAddChild":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\t\/\/dojo.profile.end(\"Dnd addChild \"+message.child);","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.onAfterChangeTree":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (!message.oldTree) return;\n\t\t\n\t\tif (!message.newTree || !this.listenedTrees[message.newTree.widgetId]) {\t\t\t\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.unlistenNode);\n\t\t}\t\t\n\t\t\n\t\tif (!message.oldTree || !this.listenedTrees[message.oldTree.widgetId]) {\n\t\t\t\/\/ we have new node\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.listenNode);\t\n\t\t}\n\t\t\/\/dojo.profile.end(\"onTreeChange\");","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.listenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tif (this.dragSources[node.widgetId] || this.dropTargets[node.widgetId]) return;\n\n\t\n\t\t\/* I drag label, not domNode, because large domNodes are very slow to copy and large to drag *\/\n\n\t\tvar source = null;\n\t\tvar target = null;\n\n\t\n\t\tif (!node.actionIsDisabled(node.actions.MOVE)) {\n\t\t\t\/\/dojo.debug(\"reg source\")\n\t\t\t\n\t\t\t\/\/dojo.profile.start(\"Dnd source \"+node);\t\t\n\t\t\tvar source = this.makeDragSource(node);\n\t\t\t\/\/dojo.profile.end(\"Dnd source \"+node);\t\t\n\n\t\t\tthis.dragSources[node.widgetId] = source;\n\t\t}\n\n\t\t\/\/dojo.profile.start(\"Dnd target \"+node);\t\t\n\t\n\t\tvar target = this.makeDropTarget(node);\n\t\t\/\/dojo.profile.end(\"Dnd target \"+node);\t\t\n\n\t\tthis.dropTargets[node.widgetId] = target;\n\n\t\t\/\/dojo.profile.end(\"Dnd listenNode \"+node);\t\t","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.makeDragSource":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\treturn new dojo.dnd.TreeDragSourceV3(node.contentNode, this, node.tree.widgetId, node);","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.makeDropTarget":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\t return new dojo.dnd.TreeDropTargetV3(node.contentNode, this.treeController, node.tree.DndAcceptTypes, node);","this":"dojo.widget.TreeDndControllerV3"}}},"dojo.widget.TreeDndControllerV3.unlistenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tif (this.dragSources[node.widgetId]) {\n\t\t\tdojo.dnd.dragManager.unregisterDragSource(this.dragSources[node.widgetId]);\n\t\t\tdelete this.dragSources[node.widgetId];\n\t\t}\n\n\t\tif (this.dropTargets[node.widgetId]) {\n\t\t\tdojo.dnd.dragManager.unregisterDropTarget(this.dropTargets[node.widgetId]);\n\t\t\tdelete this.dropTargets[node.widgetId];\n\t\t}","this":"dojo.widget.TreeDndControllerV3"}}}}}},"dojo.widget.TreeDocIconExtension":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.TreeExtension"]},"methods":{"dojo.widget.TreeDocIconExtension":{"_":{"meta":{"summary":"","src":"\tdojo.widget.TreeExtension.call(this);\t","inherits":["dojo.widget.TreeExtension"],"protovariables":{"widgetType":"","templateCssPath":"","templateString":"","listenTreeEvents":""}}}},"dojo.widget.TreeDocIconExtension.listenNodeFilter":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"                                    return elem instanceof dojo.widget.Widget    ","this":"dojo.widget.TreeDocIconExtension"}}},"dojo.widget.TreeDocIconExtension.setNodeTypeClass":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tvar clazz = dojo.html.getClass(node.iconNode).replace(reg,'') + ' ' + node.tree.classPrefix+'Icon'+node.getNodeType();\n\t\tdojo.html.setClass(node.iconNode, clazz);\t\t","this":"dojo.widget.TreeDocIconExtension"}}},"dojo.widget.TreeDocIconExtension.onAfterSetFolder":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\t\t\/\/ on node-initialize time when folder is set there is no iconNode\n\t\t\t\/\/ this case will be processed in treeChange anyway\t\t\t\n\t\t\tthis.setNodeTypeClass(message.source);\n\t\t}","this":"dojo.widget.TreeDocIconExtension"}}},"dojo.widget.TreeDocIconExtension.onAfterUnsetFolder":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.setNodeTypeClass(message.source);","this":"dojo.widget.TreeDocIconExtension"}}},"dojo.widget.TreeDocIconExtension.listenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tdojo.html.setClass(node.iconNode, node.tree.classPrefix+\"Icon\"+' '+node.tree.classPrefix+'Icon'+node.getNodeType());\n\t\t\n\t\tnode.domNode.insertBefore(node.iconNode, node.contentNode);\n\t\t\n\t\t\/\/dojo.html.insertAfter(node.iconNode, node.expandNode);\n\t\t\n\t\t\/\/dojo.debug(\"listenNode out \"+node);","this":"dojo.widget.TreeDocIconExtension"}}},"dojo.widget.TreeDocIconExtension.onAfterChangeTree":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\t\/\/dojo.debug(message.node)\n\t\t\n\t\tif (!message.oldTree || !this.listenedTrees[message.oldTree.widgetId]) {\t\t\t\n\t\t\t\/\/ moving from old tree to our tree\n\t\t\tthis.processDescendants(message.node,\n\t\t\t\tthis.listenNodeFilter,\n\t\t\t\tthis.listenNode\n\t\t\t);\n\t\t}","this":"dojo.widget.TreeDocIconExtension"}}}}}},"dojo.widget.TreeEmphaseOnSelect":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.TreeSelectorV3"]},"methods":{"dojo.widget.TreeEmphaseOnSelect":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\tthis.saveSelected = {}","this_variables":["saveSelected","selector"],"inherits":["dojo.widget.HtmlWidget"],"protovariables":{"widgetType":"","selector":""}}}},"dojo.widget.TreeEmphaseOnSelect.initialize":{"_":{"meta":{"summary":"","src":"\t\tthis.selector = dojo.widget.byId(this.selector);\n\t\t\n\t\tdojo.event.topic.subscribe(this.selector.eventNames.select, this, \"onSelect\");\n\t\t\/\/dojo.event.topic.subscribe(this.selector.eventNames.listenNode, this, \"onDeselect\");\n\t\t\/\/dojo.event.topic.subscribe(this.selector.eventNames.unlistenNode, this, \"onDeselect\");\n\t\tdojo.event.topic.subscribe(this.selector.eventNames.deselect, this, \"onDeselect\");\t","this":"dojo.widget.TreeEmphaseOnSelect"}}},"dojo.widget.TreeEmphaseOnSelect.onSelect":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar domNode = message.node.labelNode;\n\t\t\n\t\tdojo.html.clearSelection(domNode);\n\t\t\n\n\t\tdojo.html.addClass(domNode, message.node.tree.classPrefix+'NodeEmphased');\n\t\t\/\/dojo.debug(\"after select \"+dojo.html.getClass(message.node.labelNode))","this":"dojo.widget.TreeEmphaseOnSelect"}}},"dojo.widget.TreeEmphaseOnSelect.onDeselect":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar domNode = message.node.labelNode;\n\t\t\n\t\t\/\/dojo.debug(dojo.html.getClass(message.node.labelNode))\t\t\n\t\tdojo.html.removeClass(domNode, message.node.tree.classPrefix+'NodeEmphased');","this":"dojo.widget.TreeEmphaseOnSelect"}}}}}},"dojo.widget.TreeExtension":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.TreeCommon"]},"methods":{"dojo.widget.TreeExtension":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\t\n\tthis.listenedTrees = {}","this_variables":["listenedTrees"],"inherits":["dojo.widget.HtmlWidget","dojo.widget.TreeCommon"]}}}}}},"dojo.widget.TreeLinkExtension":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.TreeExtension"]},"methods":{"dojo.widget.TreeLinkExtension":{"_":{"meta":{"summary":"","src":"\tdojo.widget.TreeExtension.call(this);\n\t\n\tthis.params = {}","this_variables":["params"],"inherits":["dojo.widget.TreeExtension"],"protovariables":{"widgetType":"","listenTreeEvents":""}}}},"dojo.widget.TreeLinkExtension.listenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tdojo.widget.TreeCommon.prototype.listenTree.call(this,tree);\n\t\t\n\t\tvar labelNode = tree.labelNodeTemplate;\n\t\tvar newLabel = this.makeALabel();\n\t\tdojo.html.setClass(newLabel, dojo.html.getClass(labelNode));\n\t\tlabelNode.parentNode.replaceChild(newLabel, labelNode);\t\t","this_inherits":["dojo.widget.TreeCommon.prototype.listenTree"],"this":"dojo.widget.TreeLinkExtension"}}},"dojo.widget.TreeLinkExtension.makeALabel":{"_":{"meta":{"summary":"","src":"\t\tvar newLabel = document.createElement(\"a\");\n\t\t\n\t\tfor(key in this.params) {\n\t\t\tif (key in {}) continue;\n\t\t\tnewLabel.setAttribute(key, this.params[key]);\n\t\t}\n\t\t\n\t\treturn newLabel;","this":"dojo.widget.TreeLinkExtension"}}},"dojo.widget.TreeLinkExtension.onAfterChangeTree":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\t\n\t\t\/\/ only for new nodes\n\t\tif (!message.oldTree) {\n\t\t\tthis.listenNode(message.node);\n\t\t}","this":"dojo.widget.TreeLinkExtension"}}},"dojo.widget.TreeLinkExtension.listenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tfor(key in node.object) {\n\t\t\tif (key in {}) continue;\n\t\t\tnode.labelNode.setAttribute(key, node.object[key]);\n\t\t}","this":"dojo.widget.TreeLinkExtension"}}}}}},"dojo.widget.TreeLoadingController":{"meta":{"requires":{"common":["dojo.widget.TreeBasicController","dojo.event.*","dojo.json","dojo.io.*"]},"methods":{"dojo.widget.TreeLoadingController":{"_":{"meta":{"summary":"","src":"\tdojo.widget.TreeBasicController.call(this);","inherits":["dojo.widget.TreeBasicController"],"protovariables":{"widgetType":"","RPCUrl":"","RPCActionParam":""},"this_variables":["RPCUrl"]}}},"handle":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""},"data":{"type":""},"evt":{"type":""}},"src":"\t\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\t\tfunction(t) { t.unlock() }\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(type == \"load\"){\n\t\t\t\tkw.load.call(this, data);\n\t\t\t}else{\n\t\t\t\tthis.RPCErrorHandler(type, data, evt);\n\t\t\t}","this_inherits":["kw.load"]}}},"dojo.widget.TreeLoadingController.RPCErrorHandler":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""},"obj":{"type":""},"evt":{"type":""}},"src":"\t\talert( \"RPC Error: \" + (obj.message||\"no message\"));","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.getRPCUrl":{"_":{"meta":{"summary":"","parameters":{"action":{"type":""}},"src":"\t\t\tvar dir = document.location.href.substr(0, document.location.href.lastIndexOf('\/'));\n\t\t\tvar localUrl = dir+\"\/\"+action;\n\t\t\t\/\/dojo.debug(localUrl);\n\t\t\treturn localUrl;\n\t\t}\n\n\t\tif (!this.RPCUrl) {\n\t\t\tdojo.raise(\"Empty RPCUrl: can't load\");\n\t\t}\n\n\t\treturn this.RPCUrl + ( this.RPCUrl.indexOf(\"?\") > -1 ? \"&\" : \"?\") + this.RPCActionParam+\"=\"+action;","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.loadProcessResponse":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"result":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tif (!dojo.lang.isUndefined(result.error)) {\n\t\t\tthis.RPCErrorHandler(\"server\", result.error);\n\t\t\treturn false;\n\t\t}\n\n\t\t\/\/dojo.debugShallow(result);\n\n\t\tvar newChildren = result;\n\n\t\tif (!dojo.lang.isArray(newChildren)) {\n\t\t\tdojo.raise('loadProcessResponse: Not array loaded: '+newChildren);\n\t\t}\n\n\t\tfor(var i=0; i<newChildren.length; i++) {\n\t\t\t\/\/ looks like dojo.widget.manager needs no special \"add\" command\n\t\t\tnewChildren[i] = dojo.widget.createWidget(node.widgetType, newChildren[i]);\n\t\t\tnode.addChild(newChildren[i]);\n\t\t}\n\n\n\t\t\/\/node.addAllChildren(newChildren);\n\n\t\tnode.state = node.loadStates.LOADED;\n\n\t\t\/\/dojo.debug(callFunc);\n\n\t\tif (dojo.lang.isFunction(callFunc)) {\n\t\t\tcallFunc.apply(dojo.lang.isUndefined(callObj) ? this : callObj, [node, newChildren]);\n\t\t}\n\t\t\/\/this.expand(node);","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.getInfo":{"_":{"meta":{"summary":"","parameters":{"obj":{"type":""}},"src":"\t\treturn obj.getInfo();","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.runRPC":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar handle = function(type, data, evt) {\n\t\t\t\/\/ unlock BEFORE any processing is done\n\t\t\t\/\/ so errorHandler may apply locking\n\t\t\tif (kw.lock) {\n\t\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\t\tfunction(t) { t.unlock() }\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(type == \"load\"){\n\t\t\t\tkw.load.call(this, data);\n\t\t\t}else{\n\t\t\t\tthis.RPCErrorHandler(type, data, evt);\n\t\t\t}\n\n\t\t}\n\n\t\tif (kw.lock) {\n\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\tfunction(t) { t.lock() }\n\t\t\t);\n\t\t}\n\n\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\thandle: dojo.lang.hitch(this, handle),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: true,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});","this_inherits":["kw.load"],"this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.url":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.handle":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar handle = function(type, data, evt) {\n\t\t\t\/\/ unlock BEFORE any processing is done\n\t\t\t\/\/ so errorHandler may apply locking\n\t\t\tif (kw.lock) {\n\t\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\t\tfunction(t) { t.unlock() }\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(type == \"load\"){\n\t\t\t\tkw.load.call(this, data);\n\t\t\t}else{\n\t\t\t\tthis.RPCErrorHandler(type, data, evt);\n\t\t\t}\n\n\t\t}\n\n\t\tif (kw.lock) {\n\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\tfunction(t) { t.lock() }\n\t\t\t);\n\t\t}\n\n\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\thandle: dojo.lang.hitch(this, handle),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: true,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});","this_inherits":["kw.load"],"this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.mimetype":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar handle = function(type, data, evt) {\n\t\t\t\/\/ unlock BEFORE any processing is done\n\t\t\t\/\/ so errorHandler may apply locking\n\t\t\tif (kw.lock) {\n\t\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\t\tfunction(t) { t.unlock() }\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(type == \"load\"){\n\t\t\t\tkw.load.call(this, data);\n\t\t\t}else{\n\t\t\t\tthis.RPCErrorHandler(type, data, evt);\n\t\t\t}\n\n\t\t}\n\n\t\tif (kw.lock) {\n\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\tfunction(t) { t.lock() }\n\t\t\t);\n\t\t}\n\n\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\thandle: dojo.lang.hitch(this, handle),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: true,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});","this_inherits":["kw.load"],"this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.preventCache":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar handle = function(type, data, evt) {\n\t\t\t\/\/ unlock BEFORE any processing is done\n\t\t\t\/\/ so errorHandler may apply locking\n\t\t\tif (kw.lock) {\n\t\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\t\tfunction(t) { t.unlock() }\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(type == \"load\"){\n\t\t\t\tkw.load.call(this, data);\n\t\t\t}else{\n\t\t\t\tthis.RPCErrorHandler(type, data, evt);\n\t\t\t}\n\n\t\t}\n\n\t\tif (kw.lock) {\n\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\tfunction(t) { t.lock() }\n\t\t\t);\n\t\t}\n\n\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\thandle: dojo.lang.hitch(this, handle),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: true,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});","this_inherits":["kw.load"],"this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.sync":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.content":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar handle = function(type, data, evt) {\n\t\t\t\/\/ unlock BEFORE any processing is done\n\t\t\t\/\/ so errorHandler may apply locking\n\t\t\tif (kw.lock) {\n\t\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\t\tfunction(t) { t.unlock() }\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(type == \"load\"){\n\t\t\t\tkw.load.call(this, data);\n\t\t\t}else{\n\t\t\t\tthis.RPCErrorHandler(type, data, evt);\n\t\t\t}\n\n\t\t}\n\n\t\tif (kw.lock) {\n\t\t\tdojo.lang.forEach(kw.lock,\n\t\t\t\tfunction(t) { t.lock() }\n\t\t\t);\n\t\t}\n\n\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\thandle: dojo.lang.hitch(this, handle),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: true,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});","this_inherits":["kw.load"],"this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.loadRemote":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.node":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.tree":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.load":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.lock":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.params":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\/\/dojo.debug(callFunc)\n\n\t\tthis.runRPC({\n\t\t\turl: this.getRPCUrl('getChildren'),\n\t\t\tload: function(result) {\n\t\t\t\t_this.loadProcessResponse(node, result, callObj, callFunc) ;\n\t\t\t},\n\t\t\tsync: sync,\n\t\t\tlock: [node],\n\t\t\tparams: params\n\t\t});","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.expand":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tif (node.state == node.loadStates.UNCHECKED && node.isFolder) {\n\n\t\t\tthis.loadRemote(node, sync,\n\t\t\t\tthis,\n\t\t\t\tfunction(node, newChildren) {\n\t\t\t\t\tthis.expand(node, sync, callObj, callFunc);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\tdojo.widget.TreeBasicController.prototype.expand.apply(this, arguments);","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.doMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\tthis.loadRemote(newParent, true);\n\t\t}\n\n\t\treturn dojo.widget.TreeBasicController.prototype.doMove.apply(this, arguments);","this":"dojo.widget.TreeLoadingController"}}},"dojo.widget.TreeLoadingController.doCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tthis.loadRemote(parent, true);\n\t\t}\n\n\t\treturn dojo.widget.TreeBasicController.prototype.doCreateChild.apply(this, arguments);","this":"dojo.widget.TreeLoadingController"}}}}}},"dojo.widget.TreeLoadingControllerV3":{"meta":{"requires":{"common":["dojo.widget.TreeBasicControllerV3","dojo.event.*","dojo.json","dojo.io.*","dojo.Deferred"]},"methods":{"dojo.Error":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""},"extra":{"type":""}},"src":"\tthis.message = message;\n\tthis.extra = extra;\n\tthis.stack = (new Error()).stack;\t","this_variables":["message","extra","stack"]}}},"dojo.CommunicationError":{"_":{"meta":{"summary":"","src":"\tdojo.Error.apply(this, arguments);\n\tthis.name=\"CommunicationError\"","this_variables":["name"],"inherits":["dojo.Error"]}}},"dojo.LockedError":{"_":{"meta":{"summary":"","src":"\tdojo.Error.apply(this, arguments);\n\tthis.name=\"LockedError\"","this_variables":["name"],"inherits":["dojo.Error"]}}},"dojo.FormatError":{"_":{"meta":{"summary":"","src":"\tdojo.Error.apply(this, arguments);\n\tthis.name=\"FormatError\"","this_variables":["name"],"inherits":["dojo.Error"]}}},"dojo.RpcError":{"_":{"meta":{"summary":"","src":"\tdojo.Error.apply(this, arguments);\n\tthis.name=\"RpcError\"","this_variables":["name"],"inherits":["dojo.Error"]}}},"dojo.widget.TreeLoadingControllerV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.TreeBasicControllerV3.call(this);","inherits":["dojo.widget.TreeBasicControllerV3"],"protovariables":{"widgetType":"","RpcUrl":"","RpcActionParam":"","batchExpandTimeout":""},"this_variables":["RpcUrl"]}}},"dojo.widget.TreeLoadingControllerV3.preventCache":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tvar deferred = new dojo.Deferred();\n\t\t\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\t\t\t\n\t\t\thandle: this.getDeferredBindHandler(deferred),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: this.preventCache,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.getDeferredBindHandler":{"_":{"meta":{"summary":" create callback that calls the Deferred's callback method","parameters":{"deferred":{"type":"dojo.rpc.Deferred"}},"src":"\t\t\tfunction(type, obj \/*,...*\/){\n\t\t\t\tfor(var i=0;i<arguments.length;i++) {\n\t\t\t\t\t\/\/dojo.debug(\"ARG \"+i+\" \\n\"+arguments[i]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (type==\"load\" ) {\n\t\t\t\t\/\/dojo.debug(\"GO \"+deferred);\n\t\t\t\t\t\n\t\t\t\t\tif(!dojo.lang.isUndefined(obj.error)){\n\t\t\t\t\t\tdeferred.errback(new RpcError(obj.error, obj));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tdeferred.callback(obj);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar extra = {}\t\t\t\t\n\t\t\t\tfor(var i=1; i<arguments.length;i++) {\n\t\t\t\t\tdojo.lang.mixin(extra, arguments[i]);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tvar result = new dojo.CommunicationError(arguments[1], extra);\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tdeferred.errback(result);\n\t\t\t\t\n\t\t\t}\n\t\t);","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.getRpcUrl":{"_":{"meta":{"summary":"","parameters":{"action":{"type":""}},"src":"\t\t\tvar dir = document.location.href.substr(0, document.location.href.lastIndexOf('\/'));\n\t\t\tvar localUrl = dir+\"\/local\/\"+action;\n\t\t\t\/\/dojo.debug(localUrl);\n\t\t\treturn localUrl;\t\n\t\t}\n\n\t\tif (!this.RpcUrl) {\n\t\t\tdojo.raise(\"Empty RpcUrl: can't load\");\n\t\t}\n\n\t\treturn this.RpcUrl + ( this.RpcUrl.indexOf(\"?\") > -1 ? \"&\" : \"?\") + this.RpcActionParam+\"=\"+action;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.loadProcessResponse":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"result":{"type":""}},"src":"\t\t\tthrow new dojo.FormatError('loadProcessResponse: Not array loaded: '+result);\n\t\t}\n\n\t\tnode.setChildren(result);","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.runRpc":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tvar deferred = new dojo.Deferred();\n\t\t\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\t\t\t\n\t\t\thandle: this.getDeferredBindHandler(deferred),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: this.preventCache,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.url":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('getChildren'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tdeferred.addCallback(function(res) { return _this.loadProcessResponse(node,res) });\n\t\t\n\t\t\t\t\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.handle":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tvar deferred = new dojo.Deferred();\n\t\t\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\t\t\t\n\t\t\thandle: this.getDeferredBindHandler(deferred),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: this.preventCache,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.mimetype":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tvar deferred = new dojo.Deferred();\n\t\t\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\t\t\t\n\t\t\thandle: this.getDeferredBindHandler(deferred),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: this.preventCache,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.sync":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('getChildren'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tdeferred.addCallback(function(res) { return _this.loadProcessResponse(node,res) });\n\t\t\n\t\t\t\t\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.content":{"_":{"meta":{"summary":"","parameters":{"kw":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tvar deferred = new dojo.Deferred();\n\t\t\n\t\tdojo.io.bind({\n\t\t\turl: kw.url,\t\t\t\n\t\t\thandle: this.getDeferredBindHandler(deferred),\n\t\t\tmimetype: \"text\/json\",\n\t\t\tpreventCache: this.preventCache,\n\t\t\tsync: kw.sync,\n\t\t\tcontent: { data: dojo.json.serialize(kw.params) }\n\t\t});\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.loadRemote":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('getChildren'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tdeferred.addCallback(function(res) { return _this.loadProcessResponse(node,res) });\n\t\t\n\t\t\t\t\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.node":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('getChildren'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tdeferred.addCallback(function(res) { return _this.loadProcessResponse(node,res) });\n\t\t\n\t\t\t\t\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.tree":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('getChildren'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tdeferred.addCallback(function(res) { return _this.loadProcessResponse(node,res) });\n\t\t\n\t\t\t\t\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.params":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t};\n\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('getChildren'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tdeferred.addCallback(function(res) { return _this.loadProcessResponse(node,res) });\n\t\t\n\t\t\t\t\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.expand":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar deferred = this.startProcessing(node);\n\t\t\n\t\tdeferred.addCallback(function() {\n\t\t\treturn _this.loadIfNeeded(node, sync);\n\t\t});\n\t\t\t\t\n\t\tdeferred.addCallback(function(res) {\n\t\t\t\/\/dojo.debug(\"Activated callback dojo.widget.TreeBasicControllerV3.prototype.expand(node); \"+res);\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.expand(node);\n\t\t\treturn res;\n\t\t});\n\t\t\n\t\tdeferred.addBoth(function(res) {\n\t\t\t_this.finishProcessing(node);\n\t\t\treturn res;\n\t\t});\n\t\t\n\t\t\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.loadIfNeeded":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tif (node.state == node.loadStates.UNCHECKED && node.isFolder && !node.children.length) {\n\t\t\t\/\/ populate deferred with other things to pre-do\n\t\t\tdeferred = this.loadRemote(node, sync);\t\t\t\n\t\t} else {\n\t\t\t\/* \"fake action\" here *\/\n\t\t\tdeferred = new dojo.Deferred();\n\t\t\tdeferred.callback();\n\t\t}\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.runStages":{"_":{"meta":{"summary":"","parameters":{"check":{"type":""},"prepare":{"type":""},"make":{"type":""},"finalize":{"type":""},"expose":{"type":""},"args":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tif (check && !check.apply(this, args)) {\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\tvar deferred = new dojo.Deferred();\n\t\t\n\t\tif (prepare) {\n\t\t\tdeferred.addCallback(function() {\n\t\t\t\treturn prepare.apply(_this, args);\n\t\t\t});\n\t\t}\n\t\t\n\t\tdeferred.callback();\n\t\t\n\t\t\n\t\t\/\/deferred.addCallback(function(res) { dojo.debug(\"Prepare fired \"+res); return res});\n\t\t\n\t\tvar _this = this;\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\treturn make.apply(_this, args);\n\t\t});\n\t\t\n\t\t\/\/deferred.addCallback(function(res) { dojo.debug(\"Main fired \"+res); return res});\n\t\t\n\t\tif (finalize) {\n\t\t\tdeferred.addBoth(function(res) {\n\t\t\t\tfinalize.apply(_this, args);\n\t\t\t\treturn res;\n\t\t\t});\n\t\t}\n\t\t\t\n\t\t\t\t\n\t\t\/\/ exposer does not affect result\n\t\tif (expose) {\n\t\t\tdeferred.addCallback(function(res) {\n\t\t\t\texpose.apply(_this, args);\n\t\t\t\treturn res;\n\t\t\t});\n\t\t}\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.startProcessing":{"_":{"meta":{"summary":"","src":"\t\tvar deferred = new dojo.Deferred();\n\t\t\n\t\tfor(var i=0;i<arguments.length;i++) {\n\t\t\tif (arguments[i].isLocked()) {\n\t\t\t\tdeferred.errback(new dojo.LockedError(\"item locked \"+arguments[i], arguments[i]));\n\t\t\t\t\/\/dojo.debug(\"startProcessing errback \"+arguments[i]);\n\t\t\t\treturn deferred;\n\t\t\t}\n\t\t\tif (arguments[i].isTreeNode) {\n\t\t\t\targuments[i].markProcessing();\n\t\t\t}\n\t\t\targuments[i].lock();\n\t\t}\n\t\t\t\t\n\t\t\/\/dojo.debug(\"startProcessing callback\");\n\t\t\t\t\n\t\tdeferred.callback();\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.finishProcessing":{"_":{"meta":{"summary":"","src":"\t\tfor(var i=0;i<arguments.length;i++) {\n\t\t\tif (!arguments[i].hasLock()) {\n\t\t\t\t\/\/ is not processed. probably we locked it and then met bad node in startProcessing\n\t\t\t\tcontinue; \n\t\t\t}\n\t\t\t\/\/dojo.debug(\"has lock\");\t\n\t\t\targuments[i].unlock();\n\t\t\tif (arguments[i].isTreeNode) {\n\t\t\t\targuments[i].unmarkProcessing();\n\t\t\t}\n\t\t}","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.prepareMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""}},"src":"\t\tvar deferred = this.startProcessing(parent);\n\t\tdeferred.addCallback(dojo.lang.hitch(this, function() {\n\t\t\treturn this.loadIfNeeded(newParent, sync);\n\t\t}));\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.finalizeMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""}},"src":"\t\tthis.finishProcessing(child, newParent);","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.prepareCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""},"sync":{"type":""}},"src":"\t\tvar deferred = this.startProcessing(parent);\n\t\tdeferred.addCallback(dojo.lang.hitch(this, function() {\n\t\t\treturn this.loadIfNeeded(parent, sync);\n\t\t}));\n\t\treturn deferred;","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.finalizeCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""}},"src":"\t\tthis.finishProcessing(parent);","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.prepareClone":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""},"sync":{"type":""}},"src":"\t\tvar deferred = this.startProcessing(child, newParent);\n\t\tdeferred.addCallback(dojo.lang.hitch(this, function() {\n\t\t\treturn this.loadIfNeeded(newParent, sync);\n\t\t}));\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeLoadingControllerV3"}}},"dojo.widget.TreeLoadingControllerV3.finalizeClone":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""}},"src":"\t\tthis.finishProcessing(child, newParent);","this":"dojo.widget.TreeLoadingControllerV3"}}}}}},"dojo.widget.TreeNode":{"meta":{"requires":{"common":["dojo.html.*","dojo.event.*","dojo.io.*"]},"methods":{"dojo.widget.TreeNode":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\n\tthis.actionsDisabled = [];","this_variables":["actionsDisabled","state","expandLevel","_markLoadingSavedIcon","expandIcon.src","expandIcon.src","_markLoadingSavedIcon","expandIcon.src","isFolder","tree","depth","imgs","expandIcon","childIcon","state","domNodeInitialized","isExpanded","expandIcon.src","childIcon.src","childIcon.style.display","isExpanded","isExpanded","titleNode.innerHTML","afterLabelNode.innerHTML"],"inherits":["dojo.widget.HtmlWidget"],"protovariables":{"widgetType":"","loadStates":"","actions":"","isContainer":"","lockLevel":"","templateString":"","childIconSrc":"","childIconFolderSrc":"","childIconDocumentSrc":"","childIcon":"","isTreeNode":"","afterLabel":"","afterLabelNode":"","expandIcon":"","title":"","object":"","labelNode":"","titleNode":"","imgs":"","expandLevel":"","tree":"","depth":"","isExpanded":"","state":"","domNodeInitialized":""}}}},"dojo.widget.TreeNode.objectId":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex(),\n\t\t\tisFolder: this.isFolder\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.isFolder":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex(),\n\t\t\tisFolder: this.isFolder\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.isFirstNode":{"_":{"meta":{"summary":"","src":"\t\treturn this.getParentIndex() == 0 ? true: false;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.true":{"_":{"meta":{"summary":"","src":"\t\treturn this.getParentIndex() == 0 ? true: false;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.isLastNode":{"_":{"meta":{"summary":"","src":"\t\treturn this.getParentIndex() == this.parent.children.length-1 ? true : false;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.lock":{"_":{"meta":{"summary":"","src":"                   return this.tree.lock.apply(this, arguments)    ","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.unlock":{"_":{"meta":{"summary":"","src":"                     return this.tree.unlock.apply(this, arguments)    ","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.isLocked":{"_":{"meta":{"summary":"","src":"                       return this.tree.isLocked.apply(this, arguments)    ","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.cleanLock":{"_":{"meta":{"summary":"","src":"                        return this.tree.cleanLock.apply(this, arguments)    ","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.actionIsDisabled":{"_":{"meta":{"summary":"","parameters":{"action":{"type":""}},"src":"\t\tvar _this = this;\n\n\t\tvar disabled = false;\n\n\t\tif (this.tree.strictFolders && action == this.actions.ADDCHILD && !this.isFolder) {\n\t\t\tdisabled = true;\n\t\t}\n\n\t\tif (dojo.lang.inArray(_this.actionsDisabled, action)) {\n\t\t\tdisabled = true;\n\t\t}\n\n\t\tif (this.isLocked()) {\n\t\t\tdisabled = true;\n\t\t}\n\n\t\treturn disabled;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.getInfo":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex(),\n\t\t\tisFolder: this.isFolder\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.widgetId":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex(),\n\t\t\tisFolder: this.isFolder\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.index":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex(),\n\t\t\tisFolder: this.isFolder\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tfor(var i=0; i<this.actionsDisabled.length; i++) {\n\t\t\tthis.actionsDisabled[i] = this.actionsDisabled[i].toUpperCase();\n\t\t}\n\n\t\tthis.expandLevel = parseInt(this.expandLevel);","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.adjustDepth":{"_":{"meta":{"summary":"","parameters":{"depthDiff":{"type":""}},"src":"\t\tfor(var i=0; i<this.children.length; i++) {\n\t\t\tthis.children[i].adjustDepth(depthDiff);\n\t\t}\n\n\t\tthis.depth += depthDiff;\n\n\t\tif (depthDiff>0) {\n\t\t\tfor(var i=0; i<depthDiff; i++) {\n\t\t\t\tvar img = this.tree.makeBlankImg();\n\t\t\t\tthis.imgs.unshift(img);\n\t\t\t\t\/\/dojo.debugShallow(this.domNode);\n\t\t\t\tdojo.html.insertBefore(this.imgs[0], this.domNode.firstChild);\n\n\t\t\t}\n\t\t}\n\t\tif (depthDiff<0) {\n\t\t\tfor(var i=0; i<-depthDiff;i++) {\n\t\t\t\tthis.imgs.shift();\n\t\t\t\tdojo.html.removeNode(this.domNode.firstChild);\n\t\t\t}\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.markLoading":{"_":{"meta":{"summary":"","src":"\t\tthis._markLoadingSavedIcon = this.expandIcon.src;\n\t\tthis.expandIcon.src = this.tree.expandIconSrcLoading;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.unMarkLoading":{"_":{"meta":{"summary":"","src":"\t\tif (!this._markLoadingSavedIcon) return;\n\n\t\tvar im = new Image();\n\t\tim.src = this.tree.expandIconSrcLoading;\n\n\t\t\/\/dojo.debug(\"Unmark \"+this.expandIcon.src+\" : \"+im.src);\n\t\tif (this.expandIcon.src == im.src) {\n\t\t\tthis.expandIcon.src = this._markLoadingSavedIcon;\n\t\t}\n\t\tthis._markLoadingSavedIcon = null;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.setFolder":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.connect(this.expandIcon, 'onclick', this, 'onTreeClick');\n\t\tthis.expandIcon.src = this.isExpanded ? this.tree.expandIconSrcMinus : this.tree.expandIconSrcPlus;\n\t\tthis.isFolder = true;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.createDOMNode":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""},"depth":{"type":""}},"src":"\t\tthis.tree = tree;\n\t\tthis.depth = depth;\n\n\n\t\t\/\/\n\t\t\/\/ add the tree icons\n\t\t\/\/\n\n\t\tthis.imgs = [];\n\n\t\tfor(var i=0; i<this.depth+1; i++){\n\n\t\t\tvar img = this.tree.makeBlankImg();\n\n\t\t\tthis.domNode.insertBefore(img, this.labelNode);\n\n\t\t\tthis.imgs.push(img);\n\t\t}\n\n\n\t\tthis.expandIcon = this.imgs[this.imgs.length-1];\n\n\n\t\tthis.childIcon = this.tree.makeBlankImg();\n\n\t\t\/\/ add to images before the title\n\t\tthis.imgs.push(this.childIcon);\n\n\t\tdojo.html.insertBefore(this.childIcon, this.titleNode);\n\n\t\t\/\/ node with children(from source html) becomes folder on build stage.\n\t\tif (this.children.length || this.isFolder) {\n\t\t\tthis.setFolder();\n\t\t}\n\t\telse {\n\t\t\t\/\/ leaves are always loaded\n\t\t\t\/\/dojo.debug(\"Set \"+this+\" state to loaded\");\n\t\t\tthis.state = this.loadStates.LOADED;\n\t\t}\n\n\t\tdojo.event.connect(this.childIcon, 'onclick', this, 'onIconClick');\n\n\n\t\t\/\/\n\t\t\/\/ create the child rows\n\t\t\/\/\n\n\n\t\tfor(var i=0; i<this.children.length; i++){\n\t\t\tthis.children[i].parent = this;\n\n\t\t\tvar node = this.children[i].createDOMNode(this.tree, this.depth+1);\n\n\t\t\tthis.containerNode.appendChild(node);\n\t\t}\n\n\n\t\tif (this.children.length) {\n\t\t\tthis.state = this.loadStates.LOADED;\n\t\t}\n\n\t\tthis.updateIcons();\n\n\t\tthis.domNodeInitialized = true;\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.createDOMNode, { source: this } );\n\n\t\treturn this.domNode;","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.source":{"_":{"meta":{"summary":"","src":"\t\tif (!this.isExpanded) return;\n\n\t\tthis.hideChildren();\n\t\tthis.isExpanded = false;\n\n\t\tthis.updateExpandIcon();\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.collapse, {source: this} );","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.onTreeClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tdojo.event.topic.publish(this.tree.eventNames.treeClick, { source: this, event: e });","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.onIconClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tdojo.event.topic.publish(this.tree.eventNames.iconClick, { source: this, event: e });","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.onTitleClick":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\tdojo.event.topic.publish(this.tree.eventNames.titleClick, { source: this, event: e });","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.markSelected":{"_":{"meta":{"summary":"","src":"\t\tdojo.html.addClass(this.titleNode, 'dojoTreeNodeLabelSelected');","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.unMarkSelected":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.updateExpandIcon":{"_":{"meta":{"summary":"","src":"\t\tif (this.isFolder){\n\t\t\tthis.expandIcon.src = this.isExpanded ? this.tree.expandIconSrcMinus : this.tree.expandIconSrcPlus;\n\t\t} else {\n\t\t\tthis.expandIcon.src = this.tree.blankIconSrc;\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.updateExpandGrid":{"_":{"meta":{"summary":"","src":"\t\tif (this.tree.showGrid){\n\t\t\tif (this.depth){\n\t\t\t\tthis.setGridImage(-2, this.isLastNode() ? this.tree.gridIconSrcL : this.tree.gridIconSrcT);\n\t\t\t}else{\n\t\t\t\tif (this.isFirstNode()){\n\t\t\t\t\tthis.setGridImage(-2, this.isLastNode() ? this.tree.gridIconSrcX : this.tree.gridIconSrcY);\n\t\t\t\t}else{\n\t\t\t\t\tthis.setGridImage(-2, this.isLastNode() ? this.tree.gridIconSrcL : this.tree.gridIconSrcT);\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tthis.setGridImage(-2, this.tree.blankIconSrc);\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.updateChildGrid":{"_":{"meta":{"summary":"","src":"\t\tif ((this.depth || this.tree.showRootGrid) && this.tree.showGrid){\n\t\t\tthis.setGridImage(-1, (this.children.length && this.isExpanded) ? this.tree.gridIconSrcP : this.tree.gridIconSrcC);\n\t\t}else{\n\t\t\tif (this.tree.showGrid && !this.tree.showRootGrid){\n\t\t\t\tthis.setGridImage(-1, (this.children.length && this.isExpanded) ? this.tree.gridIconSrcZ : this.tree.blankIconSrc);\n\t\t\t}else{\n\t\t\t\tthis.setGridImage(-1, this.tree.blankIconSrc);\n\t\t\t}\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.updateParentGrid":{"_":{"meta":{"summary":"","src":"\t\tvar parent = this.parent;\n\n\t\t\/\/dojo.debug(\"updateParentGrid \"+this);\n\n\t\tfor(var i=0; i<this.depth; i++){\n\n\t\t\t\/\/dojo.debug(\"Parent \"+parent);\n\n\t\t\tvar idx = this.imgs.length-(3+i);\n\t\t\tvar img = (this.tree.showGrid && !parent.isLastNode()) ? this.tree.gridIconSrcV : this.tree.blankIconSrc;\n\n\t\t\t\/\/dojo.debug(\"Image \"+img+\" for \"+idx);\n\n\t\t\tthis.setGridImage(idx, img);\n\n\t\t\tparent = parent.parent;\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.updateExpandGridColumn":{"_":{"meta":{"summary":"","src":"\t\tif (!this.tree.showGrid) return;\n\n\t\tvar _this = this;\n\n\t\tvar icon = this.isLastNode() ? this.tree.blankIconSrc : this.tree.gridIconSrcV;\n\n\t\tdojo.lang.forEach(_this.getDescendants(),\n\t\t\tfunction(node) { node.setGridImage(_this.depth, icon); }\n\t\t);\n\n\t\tthis.updateExpandGrid();","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.updateIcons":{"_":{"meta":{"summary":"","src":"\t\t\/\/\n\t\t\/\/ set the expand icon\n\t\t\/\/\n\n\n\t\t\/\/\n\t\t\/\/ set the child icon\n\t\t\/\/\n\t\tthis.buildChildIcon();\n\n\t\tthis.updateExpandGrid();\n\t\tthis.updateChildGrid();\n\t\tthis.updateParentGrid();\n\n\n\n\t\tdojo.profile.stop(\"updateIcons\")","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.buildChildIcon":{"_":{"meta":{"summary":"","src":"\t\t\tthis.childIcon.src = this.childIconSrc;\n\t\t}\n\t\tthis.childIcon.style.display = this.childIconSrc ? 'inline' : 'none';","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.setGridImage":{"_":{"meta":{"summary":"","parameters":{"idx":{"type":""},"src":{"type":""}},"src":"\t\tif (idx < 0){\n\t\t\tidx = this.imgs.length + idx;\n\t\t}\n\n\t\t\/\/if (idx >= this.imgs.length-2) return;\n\t\tthis.imgs[idx].style.backgroundImage = 'url(' + src + ')';","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.updateIconTree":{"_":{"meta":{"summary":"","src":"\t\tthis.tree.updateIconTree.call(this);","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.expand":{"_":{"meta":{"summary":"","src":"\t\tif (this.isExpanded) return;\n\n\t\tif (this.children.length) {\n\t\t\tthis.showChildren();\n\t\t}\n\n\t\tthis.isExpanded = true;\n\n\t\tthis.updateExpandIcon();\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.expand, {source: this} );","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.collapse":{"_":{"meta":{"summary":"","src":"\t\tif (!this.isExpanded) return;\n\n\t\tthis.hideChildren();\n\t\tthis.isExpanded = false;\n\n\t\tthis.updateExpandIcon();\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.collapse, {source: this} );","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.hideChildren":{"_":{"meta":{"summary":"","src":"\t\tthis.tree.toggleObj.hide(\n\t\t\tthis.containerNode, this.toggleDuration, this.explodeSrc, dojo.lang.hitch(this, \"onHide\")\n\t\t);\n\n\t\t\/* if dnd is in action, recalculate changed coordinates *\/\n\t\tif(dojo.exists(dojo, 'dnd.dragManager.dragObjects') && dojo.dnd.dragManager.dragObjects.length) {\n\t\t\tdojo.dnd.dragManager.cacheTargetLocations();\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.showChildren":{"_":{"meta":{"summary":"","src":"\t\tthis.tree.toggleObj.show(\n\t\t\tthis.containerNode, this.toggleDuration, this.explodeSrc, dojo.lang.hitch(this, \"onShow\")\n\t\t);\n\n\t\t\/* if dnd is in action, recalculate changed coordinates *\/\n\t\tif(dojo.exists(dojo, 'dnd.dragManager.dragObjects') && dojo.dnd.dragManager.dragObjects.length) {\n\t\t\tdojo.dnd.dragManager.cacheTargetLocations();\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.addChild":{"_":{"meta":{"summary":"","src":"\t\treturn this.tree.addChild.apply(this, arguments);","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.doAddChild":{"_":{"meta":{"summary":"","src":"\t\treturn this.tree.doAddChild.apply(this, arguments);","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.edit":{"_":{"meta":{"summary":"","parameters":{"props":{"type":""}},"src":"\t\tdojo.lang.mixin(this, props);\n\t\tif (props.title) {\n\t\t\tthis.titleNode.innerHTML = this.title;\n\t\t}\n\n\t\tif (props.afterLabel) {\n\t\t\tthis.afterLabelNode.innerHTML = this.afterLabel;\n\t\t}\n\n\t\tif (props.childIconSrc) {\n\t\t\tthis.buildChildIcon();\n\t\t}","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.removeNode":{"_":{"meta":{"summary":"","src":"                         return this.tree.removeNode.apply(this, arguments)    ","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.doRemoveNode":{"_":{"meta":{"summary":"","src":"                           return this.tree.doRemoveNode.apply(this, arguments)    ","this":"dojo.widget.TreeNode"}}},"dojo.widget.TreeNode.toString":{"_":{"meta":{"summary":"","src":"\t\treturn \"[\"+this.widgetType+\" Tree:\"+this.tree+\" ID:\"+this.widgetId+\" Title:\"+this.title+\"]\";","this":"dojo.widget.TreeNode"}}}}}},"dojo.widget.TreeNodeV3":{"meta":{"requires":{"common":["dojo.html.*","dojo.event.*","dojo.io.*"]},"methods":{"dojo.widget.TreeNodeV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\n\tthis.actionsDisabled = [];","this_variables":["actionsDisabled","tree","domNode","expandNode","contentNode","labelNode","domNode.widgetId","labelNode.innerHTML","isFolder","labelNode.innerHTML","isFolder","tree","isFolder","tree","containerNode","parent","tryLazyInit","isExpanded","isExpanded","labelNode.innerHTML"],"inherits":["dojo.widget.HtmlWidget"],"object_inherits":["dojo.widget.TreeWithNode"],"protovariables":{"widgetType":"","loadStates":"","actions":"","tryLazyInit":"","expandNode":"","labelNode":"","nodeType":"","cloneProperties":"","isTreeNode":"","object":"","title":"","isFolder":"","contentNode":"","expandClass":"","isExpanded":"","state":"","containerNode":""}}}},"dojo.widget.TreeNodeV3.getNodeType":{"_":{"meta":{"summary":"","src":"\t\tif (this.isFolder) return \"Folder\";\n\t\treturn this.nodeType;","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.clone":{"_":{"meta":{"summary":"","parameters":{"deep":{"type":""}},"src":"\t\tvar ret = new this.constructor();\n\t\t\n\t\t\/\/dojo.debug(\"start cloning props \"+this);\n\t\t\n\t\tfor(var i=0; i<this.cloneProperties.length; i++) {\n\t\t\tvar prop = this.cloneProperties[i];\n\t\t\t\/\/dojo.debug(\"cloning \"+prop+ \":\" +this[prop]);\n\t\t\tret[prop] = dojo.lang.shallowCopy(this[prop], true);\t\t\t\n\t\t}\n\t\t\n\t\tif (this.tree.unsetFolderOnEmpty && !deep && this.isFolder) {\n\t\t\tret.isFolder = false;\n\t\t}\n\t\t\n\t\t\/\/dojo.debug(\"cloned props \"+this);\n\t\t\n\t\tret.toggleObj = this.toggleObj;\n\t\t\n\t\tdojo.widget.manager.add(ret);\n\t\t\n\t\tret.tree = this.tree;\n\t\tret.buildRendering({},{});\n\t\tret.initialize({},{});\n\t\t\t\t\n\t\tif (deep && this.children.length) {\n\t\t\t\/\/dojo.debug(\"deeper copy start\");\n\t\t\tfor(var i=0; i<this.children.length; i++) {\n\t\t\t\tvar child = this.children[i];\n\t\t\t\t\/\/dojo.debug(\"copy child \"+child);\n\t\t\t\tif (child.clone) {\n\t\t\t\t\tret.children.push(child.clone(deep));\n\t\t\t\t} else {\n\t\t\t\t\tret.children.push(dojo.lang.shallowCopy(child, deep));\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/dojo.debug(\"deeper copy end\");\n\t\t\tret.setChildren(ret.children);\n\t\t}\n\t\t\n\t\t\n\t\t\t\t\n\t\treturn ret;","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.markProcessing":{"_":{"meta":{"summary":"","src":"\t\tdojo.html.addClass(this.expandNode, this.tree.classPrefix+'ExpandLoading');\t\t","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.unmarkProcessing":{"_":{"meta":{"summary":"","src":"\t\tdojo.html.removeClass(this.expandNode, this.tree.classPrefix+'ExpandLoading');\t\t","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.buildRendering":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"fragment":{"type":""},"parent":{"type":""}},"src":"\t\tif (args.tree) {\n\t\t\tthis.tree = dojo.lang.isString(args.tree) ? dojo.widget.manager.getWidgetById(args.tree) : args.tree;\t\t\t\n\t\t} else if (parent && parent.tree) {\n\t\t\tthis.tree = parent.tree;\n\t\t} \n\t\t\n\t\tif (!this.tree) {\n\t\t\tdojo.raise(\"Can't evaluate tree from arguments or parent\");\n\t\t}\n\t\t\n\t\t\n\t\t\/\/dojo.profile.start(\"buildRendering - cloneNode\");\n\t\t\n\t\tthis.domNode = this.tree.nodeTemplate.cloneNode(true);\n\t\tthis.expandNode = this.domNode.firstChild;\n        this.contentNode = this.domNode.childNodes[1];\n        this.labelNode = this.contentNode.firstChild;\n\n\t\t\/*\n\t\tthis.domNode = this.tree.nodeTemplate.cloneNode(false);\n\t\tthis.expandNode = this.tree.expandNodeTemplate.cloneNode(false);\n\t\tthis.labelNode = this.tree.labelNodeTemplate.cloneNode(false);\n\t\tthis.contentNode = this.tree.contentNodeTemplate.cloneNode(false);\n\t\t\n\t\tthis.domNode.appendChild(this.expandNode);\n\t\tthis.domNode.appendChild(this.contentNode);\n\t\tthis.contentNode.appendChild(this.labelNode);\n\t\t*\/\n\t\t\n\t\t\/\/dojo.profile.end(\"buildRendering - cloneNode\");\n\t\t\n\t\t\n\t\t\n\t\tthis.domNode.widgetId = this.widgetId;\n\t\t\n\t\t\/\/dojo.profile.start(\"buildRendering - innerHTML\");\n\t\tthis.labelNode.innerHTML = this.title;\n\t\t\/\/dojo.profile.end(\"buildRendering - innerHTML\");","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.objectId":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex()\t\t\t\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.getInfo":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex()\t\t\t\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.widgetId":{"_":{"meta":{"summary":"","src":"\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId,\n\t\t\tindex: this.getParentIndex()\t\t\t\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.index":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"dontPublishEvent":{"type":""}},"src":"\t\t\tthis.updateTree(parent.tree);\n\t\t}\n\t\t\n\t\tif (parent.isTreeNode) {\n\t\t\tif (!parent.isFolder) {\n\t\t\t\t\/\/dojo.debug(\"folderize parent \"+parent);\n\t\t\t\tparent.setFolder();\n\t\t\t\tparent.state = parent.loadStates.LOADED;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tvar siblingsCount = parent.children.length;\n\t\t\n\t\t\/\/ setFolder works BEFORE insertNode\n\t\tthis.insertNode(parent, index);\n\t\t\n\t\t\n\t\tthis.viewAddLayout();\n\t\n\t\t\n\t\t\/\/dojo.debug(\"siblings \"+parent.children);\n\t\t\n\t\tif (siblingsCount > 1) {\n\t\t\tif (index == 0 && parent.children[1] instanceof dojo.widget.Widget) {\n\t\t\t\tparent.children[1].viewUpdateLayout();\t\t\t\t\n\t\t\t}\n\t\t\tif (index == siblingsCount-1 && parent.children[siblingsCount-2] instanceof dojo.widget.Widget) {\n\t\t\t\tparent.children[siblingsCount-2].viewUpdateLayout();\t\t\t\n\t\t\t}\n\t\t} else if (parent.isTreeNode) {\n\t\t\t\/\/ added as the first child\n\t\t\t\/\/dojo.debug(\"added as first\");\n\t\t\tparent.viewSetHasChildren();\n\t\t}\n\t\t\n\t\tif (!dontPublishEvent) {\n\n\t\t\tvar message = {\n\t\t\t\tchild: this,\n\t\t\t\tindex: index,\n\t\t\t\tparent: parent\n\t\t\t}\n\t\t\t\t\n\t\t\tdojo.event.topic.publish(this.tree.eventNames.afterAddChild, message);\n\t\t}\n\n\t\t\/\/dojo.profile.end(\"addedTo\");","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.setFolder":{"_":{"meta":{"summary":"","src":"\t\tthis.viewSetExpand();\n\t\tif (!this.containerNode) { \/\/ maybe this node was unfolderized and still has container\n\t\t\tthis.viewAddContainer(); \/\/ all folders have container.\n\t\t}\n\t\t\/\/dojo.debug(\"publish \"+this.tree.eventNames.setFolder);\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterSetFolder, { source: this });","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.source":{"_":{"meta":{"summary":"","parameters":{"title":{"type":""}},"src":"\t\tthis.labelNode.innerHTML = this.title = title;\n\t\t\t\t\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterSetTitle, { source: this, title:title });","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""},"parent":{"type":""}},"src":"\t\t\tthis.isFolder = true;\n\t\t}\n\t\t\n\t\tif (this.children.length || this.isFolder) {\n\t\t\t\/\/dojo.debug(\"children found\");\n\t\t\t\/\/dojo.debug(this.children);\n\t\t\t\/\/dojo.debug(\"isFolder \"+args.isFolder);\n\t\t\t\n\t\t\t\/\/ viewSetExpand for Folder is set here also\n\t\t\tthis.setFolder();\t\t\t\n\t\t} else {\n\t\t\t\/\/ set expandicon for leaf \t\n\t\t\tthis.viewSetExpand();\n\t\t}\n\t\t\n\t\t\/\/dojo.debug(\"publish \"+this.tree.eventNames.changeTree);\n\t\t\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterChangeTree, {oldTree:null, newTree:this.tree, node:this} );\n\t\t\n\t\t\n\t\t\/\/dojo.profile.end(\"initialize\");\n\t\t\n\t\t\/\/dojo.debug(\"initialize out \"+this);\n\t\t\/\/dojo.debug(this+\" parent \"+parent);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.oldTree":{"_":{"meta":{"summary":"","parameters":{"newTree":{"type":""}},"src":"\t\tif (this.tree === newTree) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar oldTree = this.tree;\n\t\t\n\t\t\n\t\tdojo.lang.forEach(this.getDescendants(),\n\t\t\tfunction(elem) {\t\t\t\n\t\t\t\telem.tree = newTree;\t\t\t\n\t\t});\n\t\t\n\t\t\/**\n\t\t * UNTESTED\n\t\t * changes class prefix for all domnodes when moving between trees\n\t\t *\/\n\t\tif (oldTree.classPrefix != newTree.classPrefix) {\n\t\t\tvar stack = [this.domNode]\n\t\t\tvar elem;\n\t\t\tvar reg = new RegExp(\"(^|\\\\s)\"+oldTree.classPrefix, \"g\");\n\t\t\t\n\t\t\twhile (elem = stack.pop()) {\n\t\t\t\tfor(var i=0; i<elem.childNodes.length; i++) {\n\t\t\t\t\tvar childNode = elem.childNodes[i]\n\t\t\t\t\tif (childNode.nodeType != 1) continue;\n\t\t\t\t\t\/\/ change prefix for classes\n\t\t\t\t\tdojo.html.setClass(childNode, dojo.html.getClass(childNode).replace(reg, '$1'+newTree.classPrefix));\n\t\t\t\t\tstack.push(childNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tvar message = {oldTree:oldTree, newTree:newTree, node:this}\n\t\t\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterChangeTree, message );\t\t\n\t\tdojo.event.topic.publish(newTree.eventNames.afterChangeTree, message );","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.unsetFolder":{"_":{"meta":{"summary":"","src":"\t\tthis.isFolder = false;\n\t\tthis.viewSetExpand();\t\t\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterUnsetFolder, { source: this });","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.insertNode":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""}},"src":"\t\tif (!index) index = 0;\n\t\t\/\/dojo.debug(\"insertNode \"+this+\" parent \"+parent+\" before \"+index);\n\t\t\n\t\tif (index==0) {\n\t\t\tdojo.html.prependChild(this.domNode, parent.containerNode);\n\t\t} else {\n\t\t\tdojo.html.insertAfter(this.domNode, parent.children[index-1].domNode);\n\t\t}","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.updateTree":{"_":{"meta":{"summary":"","parameters":{"newTree":{"type":""}},"src":"\t\tif (this.tree === newTree) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar oldTree = this.tree;\n\t\t\n\t\t\n\t\tdojo.lang.forEach(this.getDescendants(),\n\t\t\tfunction(elem) {\t\t\t\n\t\t\t\telem.tree = newTree;\t\t\t\n\t\t});\n\t\t\n\t\t\/**\n\t\t * UNTESTED\n\t\t * changes class prefix for all domnodes when moving between trees\n\t\t *\/\n\t\tif (oldTree.classPrefix != newTree.classPrefix) {\n\t\t\tvar stack = [this.domNode]\n\t\t\tvar elem;\n\t\t\tvar reg = new RegExp(\"(^|\\\\s)\"+oldTree.classPrefix, \"g\");\n\t\t\t\n\t\t\twhile (elem = stack.pop()) {\n\t\t\t\tfor(var i=0; i<elem.childNodes.length; i++) {\n\t\t\t\t\tvar childNode = elem.childNodes[i]\n\t\t\t\t\tif (childNode.nodeType != 1) continue;\n\t\t\t\t\t\/\/ change prefix for classes\n\t\t\t\t\tdojo.html.setClass(childNode, dojo.html.getClass(childNode).replace(reg, '$1'+newTree.classPrefix));\n\t\t\t\t\tstack.push(childNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\tvar message = {oldTree:oldTree, newTree:newTree, node:this}\n\t\t\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterChangeTree, message );\t\t\n\t\tdojo.event.topic.publish(newTree.eventNames.afterChangeTree, message );","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.addedTo":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"dontPublishEvent":{"type":""}},"src":"\t\t\tthis.updateTree(parent.tree);\n\t\t}\n\t\t\n\t\tif (parent.isTreeNode) {\n\t\t\tif (!parent.isFolder) {\n\t\t\t\t\/\/dojo.debug(\"folderize parent \"+parent);\n\t\t\t\tparent.setFolder();\n\t\t\t\tparent.state = parent.loadStates.LOADED;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tvar siblingsCount = parent.children.length;\n\t\t\n\t\t\/\/ setFolder works BEFORE insertNode\n\t\tthis.insertNode(parent, index);\n\t\t\n\t\t\n\t\tthis.viewAddLayout();\n\t\n\t\t\n\t\t\/\/dojo.debug(\"siblings \"+parent.children);\n\t\t\n\t\tif (siblingsCount > 1) {\n\t\t\tif (index == 0 && parent.children[1] instanceof dojo.widget.Widget) {\n\t\t\t\tparent.children[1].viewUpdateLayout();\t\t\t\t\n\t\t\t}\n\t\t\tif (index == siblingsCount-1 && parent.children[siblingsCount-2] instanceof dojo.widget.Widget) {\n\t\t\t\tparent.children[siblingsCount-2].viewUpdateLayout();\t\t\t\n\t\t\t}\n\t\t} else if (parent.isTreeNode) {\n\t\t\t\/\/ added as the first child\n\t\t\t\/\/dojo.debug(\"added as first\");\n\t\t\tparent.viewSetHasChildren();\n\t\t}\n\t\t\n\t\tif (!dontPublishEvent) {\n\n\t\t\tvar message = {\n\t\t\t\tchild: this,\n\t\t\t\tindex: index,\n\t\t\t\tparent: parent\n\t\t\t}\n\t\t\t\t\n\t\t\tdojo.event.topic.publish(this.tree.eventNames.afterAddChild, message);\n\t\t}\n\n\t\t\/\/dojo.profile.end(\"addedTo\");","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.child":{"_":{"meta":{"summary":"","src":"\t\tif (!this.parent) return;\n\n\t\tvar oldParent = this.parent;\n\n\t\tthis.doDetach.apply(this, arguments);\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterDetach,\n\t\t\t{ child: this, tree: this.tree, parent: oldParent }\n\t\t);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.parent":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"dontPublishEvent":{"type":""}},"src":"\t\t\tthis.updateTree(parent.tree);\n\t\t}\n\t\t\n\t\tif (parent.isTreeNode) {\n\t\t\tif (!parent.isFolder) {\n\t\t\t\t\/\/dojo.debug(\"folderize parent \"+parent);\n\t\t\t\tparent.setFolder();\n\t\t\t\tparent.state = parent.loadStates.LOADED;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tvar siblingsCount = parent.children.length;\n\t\t\n\t\t\/\/ setFolder works BEFORE insertNode\n\t\tthis.insertNode(parent, index);\n\t\t\n\t\t\n\t\tthis.viewAddLayout();\n\t\n\t\t\n\t\t\/\/dojo.debug(\"siblings \"+parent.children);\n\t\t\n\t\tif (siblingsCount > 1) {\n\t\t\tif (index == 0 && parent.children[1] instanceof dojo.widget.Widget) {\n\t\t\t\tparent.children[1].viewUpdateLayout();\t\t\t\t\n\t\t\t}\n\t\t\tif (index == siblingsCount-1 && parent.children[siblingsCount-2] instanceof dojo.widget.Widget) {\n\t\t\t\tparent.children[siblingsCount-2].viewUpdateLayout();\t\t\t\n\t\t\t}\n\t\t} else if (parent.isTreeNode) {\n\t\t\t\/\/ added as the first child\n\t\t\t\/\/dojo.debug(\"added as first\");\n\t\t\tparent.viewSetHasChildren();\n\t\t}\n\t\t\n\t\tif (!dontPublishEvent) {\n\n\t\t\tvar message = {\n\t\t\t\tchild: this,\n\t\t\t\tindex: index,\n\t\t\t\tparent: parent\n\t\t\t}\n\t\t\t\t\n\t\t\tdojo.event.topic.publish(this.tree.eventNames.afterAddChild, message);\n\t\t}\n\n\t\t\/\/dojo.profile.end(\"addedTo\");","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.createSimple":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"parent":{"type":""}},"src":"\t\t\tvar tree = args.tree;\n\t\t} else if (parent) {\n\t\t\tvar tree = parent.tree;\n\t\t} else {\n\t\t\tdojo.raise(\"createSimple: can't evaluate tree\");\n\t\t}\n\t\ttree = dojo.widget.byId(tree);\n\t\t\n\t\t\/\/dojo.debug(tree);\n\t\t\n\t\tvar treeNode = new tree.defaultChildWidget(); \n\t\t\/\/dojo.profile.end(this.widgetType+\" createSimple constructor\");\n\t\t\n\t\t\/\/dojo.profile.start(this.widgetType+\" createSimple mixin\");\t\t\n\t\tfor(var x in args){ \/\/ fastMixIn\t\t\t\n\t\t\ttreeNode[x] = args[x];\n\t\t}\n\t\t\n\t\t\n\t\t\/\/dojo.profile.end(this.widgetType+\" createSimple mixin\");\n\t\t\n\t\t\t\t\n\t\t\/\/ HtmlWidget.postMixIn \n\t\ttreeNode.toggleObj = dojo.lfx.toggle[treeNode.toggle.toLowerCase()] || dojo.lfx.toggle.plain;\n\n\t\t\/\/dojo.profile.start(this.widgetType + \" manager\");\n\t\tdojo.widget.manager.add(treeNode);\n\t\t\/\/dojo.profile.end(this.widgetType + \" manager\");\n\t\t\n\t\t\/\/dojo.profile.start(this.widgetType + \" buildRendering\");\n\t\ttreeNode.buildRendering(args, {}, parent);\t\t\n\t\t\/\/dojo.profile.end(this.widgetType + \" buildRendering\");\n\t\t\n\t\ttreeNode.initialize(args, {}, parent);\n\t\t\n\t\t\/\/dojo.profile.end(this.widgetType+\"createSimple\");\n\t\tif (treeNode.parent) {\n\t\t\tdelete dojo.widget.manager.topWidgets[treeNode.widgetId];\n\t\t}\n\t\t\n\t\treturn treeNode;","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.viewUpdateLayout":{"_":{"meta":{"summary":"","src":"\t\tthis.viewAddLayout();\n\t\t\/\/dojo.profile.end(\"viewUpdateLayout\");\t","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.viewAddContainer":{"_":{"meta":{"summary":"","src":"\t\tthis.domNode.appendChild(this.containerNode);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.viewAddLayout":{"_":{"meta":{"summary":"","src":"\t\t\t\/\/dojo.debug(\"Parent isTree => add isTreeRoot\");\n\t\t\t\n\t\t\t\/\/ use setClass, not addClass for speed\n\t\t\tdojo.html.setClass(this.domNode, dojo.html.getClass(this.domNode) + ' '+this.tree.classPrefix+'IsRoot')\n\t\t}\n\t\t\/\/dojo.debug(this.parent.children.length);\n\t\t\/\/dojo.debug(this.parent.children[this.parent.children.length-1]);\n\t\tif (this.isLastNode()) {\n\t\t\t\/\/dojo.debug(\"Checked last node for \"+this);\n\t\t\t\/\/dojo.debug(\"Parent last is \"+this.parent.children[this.parent.children.length-1]);\n\t\t\t\/\/dojo.debug(\"last node => add isTreeLast for \"+this);\n\t\t\tdojo.html.setClass(this.domNode, dojo.html.getClass(this.domNode) + ' '+this.tree.classPrefix+'IsLast')\t\t\t\n\t\t}\n\t\t\/\/dojo.profile.end(\"viewAddLayout\");\n\t\t\/\/dojo.debug(\"viewAddLayout out\");","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.viewRemoveLayout":{"_":{"meta":{"summary":"","src":"\t\tdojo.html.removeClass(this.domNode, this.tree.classPrefix+\"IsLast\");\n\t\t\/\/dojo.profile.end(\"viewRemoveLayout\");","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.viewSetExpand":{"_":{"meta":{"summary":"","src":"\t\t\tvar expand = this.isExpanded ? this.tree.classPrefix+\"ExpandOpen\" : this.tree.classPrefix+\"ExpandClosed\";\n\t\t} else {\n\t\t\tvar expand = this.tree.classPrefix+\"ExpandLeaf\";\n\t\t}\n\t\tvar reg = new RegExp(\"(^|\\\\s)\"+this.tree.classPrefix+\"Expand\\\\w+\",'g');\t\t\t\n\t\t\t\t\n\t\tdojo.html.setClass(this.domNode, dojo.html.getClass(this.domNode).replace(reg,'') + ' '+expand);\n\t\t\/\/dojo.debug(dojo.html.getClass(this.domNode))\n\t\t\/\/dojo.profile.end(\"viewSetExpand\");","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.viewSetHasChildren":{"_":{"meta":{"summary":"","src":"\t\tvar reg = new RegExp(\"(^|\\\\s)\"+this.tree.classPrefix+\"Children\\\\w+\",'g');\t\t\t\n\t\t\n\t\tdojo.html.setClass(this.domNode, dojo.html.getClass(this.domNode).replace(reg,'') + ' '+clazz);\t\t","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.detach":{"_":{"meta":{"summary":"","src":"\t\tif (!this.parent) return;\n\n\t\tvar oldParent = this.parent;\n\n\t\tthis.doDetach.apply(this, arguments);\n\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterDetach,\n\t\t\t{ child: this, tree: this.tree, parent: oldParent }\n\t\t);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.doDetach":{"_":{"meta":{"summary":"","src":"\t\t\/\/dojo.debug(parent.containerNode.style.display)\n\t\t\n\t\tif (!parent) return;\n\t\t\n\t\tvar index = this.getParentIndex();\n\t\t\n\t\t\n\t\tthis.viewRemoveLayout();\n\t\t\n\t\tdojo.widget.DomWidget.prototype.removeChild.call(parent, this);\n\t\t\n\t\tvar siblingsCount = parent.children.length;\n\t\t\n\t\t\/\/dojo.debug(\"siblingsCount \"+siblingsCount);\n\t\t\n\t\tif (siblingsCount > 0) {\n\t\t\tif (index == 0) {\t\/\/ deleted first node => update new first\n\t\t\t\tparent.children[0].viewUpdateLayout();\t\t\n\t\t\t}\n\t\t\tif (index == siblingsCount) { \/\/ deleted last node\n\t\t\t\tparent.children[siblingsCount-1].viewUpdateLayout();\t\t\n\t\t\t}\n\t\t} else {\n\t\t\tif (parent.isTreeNode) {\n\t\t\t\tparent.viewSetHasChildren();\n\t\t\t}\n\t\t}\n\t\t\t\t\n\t\tif (this.tree.unsetFolderOnEmpty && !parent.children.length && parent.isTreeNode) {\n\t\t\tparent.unsetFolder();\n\t\t}\t\t\n\t\t\n\t\t\/\/dojo.debug(parent.containerNode.style.display)\n\t\t\n\t\tthis.parent = null;","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.destroy":{"_":{"meta":{"summary":"","src":"\t\tthis.detach();\n\t\t\n\t\tdojo.event.topic.publish(this.tree.eventNames.beforeDestroy, { source: this } );\n\n\t\treturn dojo.widget.HtmlWidget.prototype.destroy.apply(this, arguments);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.expand":{"_":{"meta":{"summary":"","src":"\t\tif (this.isExpanded) return;\n\n\n\t\tdojo.profile.start(\"expand \"+this);\n\t\t\n\t\t\/\/dojo.debug(\"expand in \"+this);\n\t\t\n\t\tdojo.profile.start(\"expand - lazy init \"+this);\n\t\tif (this.tryLazyInit) {\n\t\t\tthis.setChildren(this.children);\n\t\t\tthis.tryLazyInit = false;\n\t\t}\n\t\t\n\t\tdojo.profile.end(\"expand - lazy init \"+this);\n\t\t\n\t\t\n\t\tthis.isExpanded = true;\n\n\t\tthis.viewSetExpand();\n\n\t\tdojo.profile.start(\"expand - showChildren \"+this);\n\t\t\n\t\t\/**\n\t\t * no matter if I have children or not. need to show\/hide container anyway.\n\t\t * use case: empty folder is expanded => then child is added, container already shown all fine\n\t\t *\/\n\t\tthis.showChildren();\n\t\t\n\t\tdojo.profile.end(\"expand - showChildren \"+this);\n\t\t\n\t\t\n\t\t\/\/dojo.profile.start(\"expand - viewSetExpand \"+this);\n\t\t\t\t\n\t\t\/\/dojo.profile.end(\"expand - viewSetExpand \"+this);\n\n\t\t\/\/dojo.profile.start(\"expand - event \"+this);\n\n\t\t\n\t\t\/\/dojo.profile.end(\"expand - event \"+this);\n\t\t\n\t\tdojo.profile.end(\"expand \"+this);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.collapse":{"_":{"meta":{"summary":"","src":"\t\tif (!this.isExpanded) return;\n\n\t\t\n\t\tthis.isExpanded = false;\n\t\t\n\t\tthis.hideChildren();","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.hideChildren":{"_":{"meta":{"summary":"","src":"\t\tthis.tree.toggleObj.hide(\n\t\t\tthis.containerNode, this.toggleDuration, this.explodeSrc, dojo.lang.hitch(this, \"onHideChildren\")\n\t\t);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.showChildren":{"_":{"meta":{"summary":"","src":"\t\tthis.tree.toggleObj.show(\n\t\t\tthis.containerNode, this.toggleDuration, this.explodeSrc, dojo.lang.hitch(this, \"onShowChildren\")\n\t\t);","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.onShowChildren":{"_":{"meta":{"summary":"","src":"\t\tthis.onShow();\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterExpand, {source: this} );\t\t","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.onHideChildren":{"_":{"meta":{"summary":"","src":"\t\tthis.viewSetExpand();\n\t\tthis.onHide();\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterCollapse, {source: this} );","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.setTitle":{"_":{"meta":{"summary":"","parameters":{"title":{"type":""}},"src":"\t\tthis.labelNode.innerHTML = this.title = title;\n\t\t\t\t\n\t\tdojo.event.topic.publish(this.tree.eventNames.afterSetTitle, { source: this, title:title });","this":"dojo.widget.TreeNodeV3"}}},"dojo.widget.TreeNodeV3.toString":{"_":{"meta":{"summary":"","src":"\t\treturn '['+this.widgetType+', '+this.title+']';","this":"dojo.widget.TreeNodeV3"}}}}}},"dojo.widget.TreeRPCController":{"meta":{"requires":{"common":["dojo.event.*","dojo.json","dojo.io.*","dojo.widget.TreeLoadingController"]},"methods":{"dojo.widget.TreeRPCController":{"_":{"meta":{"summary":"","src":"\tdojo.widget.TreeLoadingController.call(this);","inherits":["dojo.widget.TreeLoadingController"],"protovariables":{"widgetType":""}}}},"dojo.widget.TreeRPCController.doMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\t\tvar success;\n\n\t\tthis.runRPC({\t\t\n\t\t\turl: this.getRPCUrl('move'),\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\tload: function(response){\n\t\t\t\tsuccess = this.doMoveProcessResponse(response, child, newParent, index) ;\n\t\t\t},\n\t\t\tsync: true,\n\t\t\tlock: [child, newParent],\n\t\t\tparams: params\n\t\t});\n\n\n\t\treturn success;","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.child":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\t\tvar success;\n\n\t\tthis.runRPC({\t\t\n\t\t\turl: this.getRPCUrl('move'),\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\tload: function(response){\n\t\t\t\tsuccess = this.doMoveProcessResponse(response, child, newParent, index) ;\n\t\t\t},\n\t\t\tsync: true,\n\t\t\tlock: [child, newParent],\n\t\t\tparams: params\n\t\t});\n\n\n\t\treturn success;","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.childTree":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\t\tvar success;\n\n\t\tthis.runRPC({\t\t\n\t\t\turl: this.getRPCUrl('move'),\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\tload: function(response){\n\t\t\t\tsuccess = this.doMoveProcessResponse(response, child, newParent, index) ;\n\t\t\t},\n\t\t\tsync: true,\n\t\t\tlock: [child, newParent],\n\t\t\tparams: params\n\t\t});\n\n\n\t\treturn success;","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.newParent":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\t\tvar success;\n\n\t\tthis.runRPC({\t\t\n\t\t\turl: this.getRPCUrl('move'),\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\tload: function(response){\n\t\t\t\tsuccess = this.doMoveProcessResponse(response, child, newParent, index) ;\n\t\t\t},\n\t\t\tsync: true,\n\t\t\tlock: [child, newParent],\n\t\t\tparams: params\n\t\t});\n\n\n\t\treturn success;","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.newParentTree":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\t\tvar success;\n\n\t\tthis.runRPC({\t\t\n\t\t\turl: this.getRPCUrl('move'),\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\tload: function(response){\n\t\t\t\tsuccess = this.doMoveProcessResponse(response, child, newParent, index) ;\n\t\t\t},\n\t\t\tsync: true,\n\t\t\tlock: [child, newParent],\n\t\t\tparams: params\n\t\t});\n\n\n\t\treturn success;","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.newIndex":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\t\tvar success;\n\n\t\tthis.runRPC({\t\t\n\t\t\turl: this.getRPCUrl('move'),\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\tload: function(response){\n\t\t\t\tsuccess = this.doMoveProcessResponse(response, child, newParent, index) ;\n\t\t\t},\n\t\t\tsync: true,\n\t\t\tlock: [child, newParent],\n\t\t\tparams: params\n\t\t});\n\n\n\t\treturn success;","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.url":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.load":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.sync":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\t\tvar success;\n\n\t\tthis.runRPC({\t\t\n\t\t\turl: this.getRPCUrl('move'),\n\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\tload: function(response){\n\t\t\t\tsuccess = this.doMoveProcessResponse(response, child, newParent, index) ;\n\t\t\t},\n\t\t\tsync: true,\n\t\t\tlock: [child, newParent],\n\t\t\tparams: params\n\t\t});\n\n\n\t\treturn success;","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.lock":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.params":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.doMoveProcessResponse":{"_":{"meta":{"summary":"","parameters":{"response":{"type":""},"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tif(!dojo.lang.isUndefined(response.error)){\n\t\t\tthis.RPCErrorHandler(\"server\", response.error);\n\t\t\treturn false;\n\t\t}\n\n\t\tvar args = [child, newParent, index];\n\t\treturn dojo.widget.TreeLoadingController.prototype.doMove.apply(this, args);","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.doRemoveNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t}\n\n\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('removeNode'),\n\t\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\t\tload: function(response){\n\t\t\t\t\tthis.doRemoveNodeProcessResponse(response, node, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [node]\n\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.node":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t}\n\n\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('removeNode'),\n\t\t\t\t\/* I hitch to get this.loadOkHandler *\/\n\t\t\t\tload: function(response){\n\t\t\t\t\tthis.doRemoveNodeProcessResponse(response, node, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [node]\n\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.tree":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.doRemoveNodeProcessResponse":{"_":{"meta":{"summary":"","parameters":{"response":{"type":""},"node":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tif(!dojo.lang.isUndefined(response.error)){\n\t\t\tthis.RPCErrorHandler(\"server\", response.error);\n\t\t\treturn false;\n\t\t}\n\n\t\tif(!response){ return false; }\n\n\t\tif(response == true){\n\t\t\t\/* change parent succeeded *\/\n\t\t\tvar args = [ node, callObj, callFunc ];\n\t\t\tdojo.widget.TreeLoadingController.prototype.doRemoveNode.apply(this, args);\n\n\t\t\treturn;\n\t\t}else if(dojo.lang.isObject(response)){\n\t\t\tdojo.raise(response.error);\n\t\t}else{\n\t\t\tdojo.raise(\"Invalid response \"+response)\n\t\t}","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.doCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.parent":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.index":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.data":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"output":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\t\tvar params = {\n\t\t\t\ttree: this.getInfo(parent.tree),\n\t\t\t\tparent: this.getInfo(parent),\n\t\t\t\tindex: index,\n\t\t\t\tdata: output\n\t\t\t}\n\n\t\t\tthis.runRPC({\n\t\t\t\turl: this.getRPCUrl('createChild'),\n\t\t\t\tload: function(response) {\n\t\t\t\t\t\/\/ suggested data is dead, fresh data from server is used\n\t\t\t\t\tthis.doCreateChildProcessResponse( response, parent, index, callObj, callFunc) \n\t\t\t\t},\n\t\t\t\tparams: params,\n\t\t\t\tlock: [parent]\n\t\t\t});","this":"dojo.widget.TreeRPCController"}}},"dojo.widget.TreeRPCController.doCreateChildProcessResponse":{"_":{"meta":{"summary":"","parameters":{"response":{"type":""},"parent":{"type":""},"index":{"type":""},"callObj":{"type":""},"callFunc":{"type":""}},"src":"\t\tif(!dojo.lang.isUndefined(response.error)){\n\t\t\tthis.RPCErrorHandler(\"server\",response.error);\n\t\t\treturn false;\n\t\t}\n\n\t\tif(!dojo.lang.isObject(response)){\n\t\t\tdojo.raise(\"Invalid result \"+response)\n\t\t}\n\n\t\tvar args = [parent, index, response, callObj, callFunc];\n\t\t\n\t\tdojo.widget.TreeLoadingController.prototype.doCreateChild.apply(this, args);","this":"dojo.widget.TreeRPCController"}}}}}},"dojo.widget.TreeRpcControllerV3":{"meta":{"requires":{"common":["dojo.event.*","dojo.json","dojo.io.*","dojo.widget.TreeLoadingControllerV3"]},"methods":{"dojo.widget.TreeRpcControllerV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.TreeLoadingControllerV3.call(this);","inherits":["dojo.widget.TreeLoadingControllerV3"],"protovariables":{"widgetType":""}}}},"dojo.widget.TreeRpcControllerV3.doMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\n\t\tvar deferred = this.runRpc({\t\t\n\t\t\turl: this.getRpcUrl('move'),\n\t\t\tsync: sync,\t\t\t\n\t\t\tparams: params\n\t\t});\n\n\t\tvar _this = this;\n\t\tvar args = arguments;\t\n\t\t\n\t\t\/\/deferred.addCallback(function(res) { dojo.debug(\"doMove fired \"+res); return res});\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doMove.apply(_this,args);\n\t\t});\n\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.child":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""},"deep":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.childTree":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\n\t\tvar deferred = this.runRpc({\t\t\n\t\t\turl: this.getRpcUrl('move'),\n\t\t\tsync: sync,\t\t\t\n\t\t\tparams: params\n\t\t});\n\n\t\tvar _this = this;\n\t\tvar args = arguments;\t\n\t\t\n\t\t\/\/deferred.addCallback(function(res) { dojo.debug(\"doMove fired \"+res); return res});\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doMove.apply(_this,args);\n\t\t});\n\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.newParent":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""},"deep":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.newParentTree":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\n\t\tvar deferred = this.runRpc({\t\t\n\t\t\turl: this.getRpcUrl('move'),\n\t\t\tsync: sync,\t\t\t\n\t\t\tparams: params\n\t\t});\n\n\t\tvar _this = this;\n\t\tvar args = arguments;\t\n\t\t\n\t\t\/\/deferred.addCallback(function(res) { dojo.debug(\"doMove fired \"+res); return res});\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doMove.apply(_this,args);\n\t\t});\n\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.newIndex":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""}},"src":"\t\t\t\/\/ where from\n\t\t\tchild: this.getInfo(child),\n\t\t\tchildTree: this.getInfo(child.tree),\n\t\t\t\/\/ where to\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tnewParentTree: this.getInfo(newParent.tree),\n\t\t\tnewIndex: index\n\t\t};\n\n\n\t\tvar deferred = this.runRpc({\t\t\n\t\t\turl: this.getRpcUrl('move'),\n\t\t\tsync: sync,\t\t\t\n\t\t\tparams: params\n\t\t});\n\n\t\tvar _this = this;\n\t\tvar args = arguments;\t\n\t\t\n\t\t\/\/deferred.addCallback(function(res) { dojo.debug(\"doMove fired \"+res); return res});\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doMove.apply(_this,args);\n\t\t});\n\n\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.url":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""},"node":{"type":""},"deep":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.sync":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""},"node":{"type":""},"deep":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.params":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"sync":{"type":""},"node":{"type":""},"deep":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.prepareDetach":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar deferred = this.startProcessing(node);\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.finalizeDetach":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tthis.finishProcessing(node);","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.doDetach":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t}\n\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('detach'),\n\t\t\tsync: sync,\n\t\t\tparams: params\t\t\t\n\t\t});\n\t\t\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doDetach.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.node":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t}\n\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('destroy'),\n\t\t\tsync: sync,\n\t\t\tparams: params\t\t\t\n\t\t});\n\t\t\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doDestroy.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.tree":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""},"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.prepareDestroy":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.finalizeDestroy":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tthis.finishProcessing(node);","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.doDestroy":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\tnode: this.getInfo(node),\n\t\t\ttree: this.getInfo(node.tree)\n\t\t}\n\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('destroy'),\n\t\t\tsync: sync,\n\t\t\tparams: params\t\t\t\n\t\t});\n\t\t\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doDestroy.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.doCreateChild":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\ttree: this.getInfo(parent.tree),\n\t\t\tparent: this.getInfo(parent),\n\t\t\tindex: index,\n\t\t\tdata: data\n\t\t}\n\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('createChild'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doCreateChild.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.parent":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\ttree: this.getInfo(parent.tree),\n\t\t\tparent: this.getInfo(parent),\n\t\t\tindex: index,\n\t\t\tdata: data\n\t\t}\n\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('createChild'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doCreateChild.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.index":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.data":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""},"index":{"type":""},"data":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\ttree: this.getInfo(parent.tree),\n\t\t\tparent: this.getInfo(parent),\n\t\t\tindex: index,\n\t\t\tdata: data\n\t\t}\n\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('createChild'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doCreateChild.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.doClone":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}},"dojo.widget.TreeRpcControllerV3.deep":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""},"deep":{"type":""},"sync":{"type":""}},"src":"\t\tvar params = {\n\t\t\tchild: this.getInfo(child),\n\t\t\tnewParent: this.getInfo(newParent),\n\t\t\tindex: index,\n\t\t\tdeep: deep ? true : false, \/\/ undefined -> false\n\t\t\ttree: this.getInfo(child.tree)\n\t\t}\n\t\t\n\t\t\n\t\tvar deferred = this.runRpc({\n\t\t\turl: this.getRpcUrl('clone'),\n\t\t\tsync: sync,\n\t\t\tparams: params\n\t\t});\n\t\t\n\t\tvar _this = this;\n\t\tvar args = arguments;\n\t\t\n\t\tdeferred.addCallback(function() {\t\t\t\n\t\t\tdojo.widget.TreeBasicControllerV3.prototype.doClone.apply(_this,args);\n\t\t});\n\t\t\n\t\t\t\t\t\t\n\t\treturn deferred;\t","this":"dojo.widget.TreeRpcControllerV3"}}}}}},"dojo.widget.TreeSelector":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.TreeSelector":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\n\n\tthis.eventNames = {};\n\n\tthis.listenedTrees = [];","this_variables":["eventNames","listenedTrees","selectedNode","selectedNode","selectedNode","selectedNode"],"inherits":["dojo.widget.HtmlWidget"],"protovariables":{"widgetType":"","selectedNode":"","dieWithTree":"","eventNamesDefault":""}}}},"dojo.widget.TreeSelector.initialize":{"_":{"meta":{"summary":"","src":"\t\tfor(name in this.eventNamesDefault) {\n\t\t\tif (dojo.lang.isUndefined(this.eventNames[name])) {\n\t\t\t\tthis.eventNames[name] = this.widgetId+\"\/\"+this.eventNamesDefault[name];\n\t\t\t}\n\t\t}","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.destroy":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.topic.publish(this.eventNames.destroy, { source: this } );\n\n\t\treturn dojo.widget.HtmlWidget.prototype.destroy.apply(this, arguments);","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.source":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.topic.publish(this.eventNames.destroy, { source: this } );\n\n\t\treturn dojo.widget.HtmlWidget.prototype.destroy.apply(this, arguments);","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.listenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tdojo.event.topic.subscribe(tree.eventNames.titleClick, this, \"select\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.iconClick, this, \"select\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.collapse, this, \"onCollapse\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.moveFrom, this, \"onMoveFrom\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.removeNode, this, \"onRemoveNode\");\n\t\tdojo.event.topic.subscribe(tree.eventNames.treeDestroy, this, \"onTreeDestroy\");\n\n\t\t\/* remember all my trees to deselect when element is movedFrom them *\/\n\t\tthis.listenedTrees.push(tree);","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.unlistenTree":{"_":{"meta":{"summary":"","parameters":{"tree":{"type":""}},"src":"\t\tdojo.event.topic.unsubscribe(tree.eventNames.titleClick, this, \"select\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.iconClick, this, \"select\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.collapse, this, \"onCollapse\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.moveFrom, this, \"onMoveFrom\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.removeNode, this, \"onRemoveNode\");\n\t\tdojo.event.topic.unsubscribe(tree.eventNames.treeDestroy, this, \"onTreeDestroy\");\n\n\n\t\tfor(var i=0; i<this.listenedTrees.length; i++){\n           if(this.listenedTrees[i] === tree){\n                   this.listenedTrees.splice(i, 1);\n                   break;\n           }\n\t\t}","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.onTreeDestroy":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.unlistenTree(message.source);\n\n\t\tif (this.dieWithTree) {\n\t\t\t\/\/dojo.debug(\"Killing myself \"+this.widgetId);\n\t\t\tthis.destroy();\n\t\t\t\/\/dojo.debug(\"done\");\n\t\t}","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.onCollapse":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (!this.selectedNode) return;\n\n\t\tvar node = message.source;\n\t\tvar parent = this.selectedNode.parent;\n\t\twhile (parent !== node && parent.isTreeNode) {\n\t\t\tparent = parent.parent;\n\t\t}\n\t\tif (parent.isTreeNode) {\n\t\t\tthis.deselect();\n\t\t}","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.select":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tvar node = message.source;\n\t\tvar e = message.event;\n\n\t\tif (this.selectedNode === node) {\n\t\t\tif(e.ctrlKey || e.shiftKey || e.metaKey){\n\t\t\t\t\/\/ If the node is currently selected, and they select it again while holding\n\t\t\t\t\/\/ down a meta key, it deselects it\n\t\t\t\tthis.deselect();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdojo.event.topic.publish(this.eventNames.dblselect, { node: node });\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.selectedNode) {\n\t\t\tthis.deselect();\n\t\t}\n\n\t\tthis.doSelect(node);\n\n\t\tdojo.event.topic.publish(this.eventNames.select, {node: node} );","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.node":{"_":{"meta":{"summary":"","src":"\t\tvar node = this.selectedNode;\n\n\t\tthis.selectedNode = null;\n\t\tnode.unMarkSelected();\n\t\tdojo.event.topic.publish(this.eventNames.deselect, {node: node} );","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.onMoveFrom":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (message.child !== this.selectedNode) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!dojo.lang.inArray(this.listenedTrees, message.newTree)) {\n\t\t\tthis.deselect();\n\t\t}","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.onRemoveNode":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (message.child !== this.selectedNode) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.deselect();","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.doSelect":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tnode.markSelected();\n\n\t\tthis.selectedNode = node;","this":"dojo.widget.TreeSelector"}}},"dojo.widget.TreeSelector.deselect":{"_":{"meta":{"summary":"","src":"\t\tvar node = this.selectedNode;\n\n\t\tthis.selectedNode = null;\n\t\tnode.unMarkSelected();\n\t\tdojo.event.topic.publish(this.eventNames.deselect, {node: node} );","this":"dojo.widget.TreeSelector"}}}}}},"dojo.widget.TreeSelectorV3":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.TreeCommon"]},"methods":{"dojo.widget.TreeSelectorV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\n\tthis.eventNames = {};\n\n\tthis.listenedTrees = {};\n\tthis.selectedNodes = [];","this_variables":["eventNames","listenedTrees","selectedNodes","onLabelClickHandler","onLabelDblClickHandler"],"inherits":["dojo.widget.HtmlWidget","dojo.widget.TreeCommon"],"protovariables":{"widgetType":"","listenTreeEvents":"","allowedMulti":"","eventNamesDefault":""}}}},"dojo.widget.TreeSelectorV3.listenNodeFilter":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""}},"src":"                                    return elem instanceof dojo.widget.Widget    ","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""}},"src":"\t\tfor(name in this.eventNamesDefault) {\n\t\t\tif (dojo.lang.isUndefined(this.eventNames[name])) {\n\t\t\t\tthis.eventNames[name] = this.widgetId+\"\/\"+this.eventNamesDefault[name];\n\t\t\t}\n\t\t}\n\t\t\n\t\tthis.onLabelClickHandler =  dojo.lang.hitch(this, this.onLabelClick);\n\t\tthis.onLabelDblClickHandler =  dojo.lang.hitch(this, this.onLabelDblClick);","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.listenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tif (dojo.render.html.ie) {\n\t\t\tdojo.event.browser.addListener(node.labelNode, \"ondblclick\", this.onLabelDblClickHandler);\n\t\t}\n\t\tdojo.event.topic.publish(this.eventNames.listenNode, { node: node });","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.node":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tvar index = dojo.lang.find(this.selectedNodes, node, true);\n\t\tif (index < 0) {\n\t\t\t\/\/dojo.debug(\"not selected\");\n\t\t\treturn; \/\/ not selected\n\t\t}\n\t\t\n\t\t\/\/dojo.debug(\"deselect \"+node);\n\t\t\n\t\t\n\t\tthis.selectedNodes.splice(index, 1);\n\t\tdojo.event.topic.publish(this.eventNames.deselect, {node: node} );\n\t\t\/\/dojo.debug(\"deselect\");","returns":"not selected","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.unlistenNode":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tif (dojo.render.html.ie) {\n\t\t\tdojo.event.browser.removeListener(node.labelNode, \"ondblclick\", this.onLabelDblClickHandler);\n\t\t}\n\t\tdojo.event.topic.publish(this.eventNames.unlistenNode, { node: node });","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.onAfterAddChild":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.onBeforeTreeDestroy":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.unlistenTree(message.source);","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.onAfterCollapse":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.deselectIfAncestorMatch(message.source);\t\t","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.onLabelDblClick":{"_":{"meta":{"summary":"","parameters":{"event":{"type":""}},"src":"\t\tthis.onLabelClick(event);\t\t\t","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.checkSpecialEvent":{"_":{"meta":{"summary":"","parameters":{"event":{"type":""}},"src":"\t\treturn event.ctrlKey;","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.onLabelClick":{"_":{"meta":{"summary":"","parameters":{"event":{"type":""}},"src":"\t\tvar node = this.domElement2TreeNode(event.target);\n\n\t\t\/\/dojo.debug(\"click \"+node+ \"special \"+this.checkSpecialEvent(event));\n\t\t\/\/dojo.html.setClass(event.target, \"TreeLabel TreeNodeEmphased\");\n\t\t\n\t\tif (dojo.lang.inArray(this.selectedNodes, node)) {\t\t\t\n\t\t\tif(this.checkSpecialEvent(event)){\t\t\t\t\n\t\t\t\t\/\/ If the node is currently selected, and they select it again while holding\n\t\t\t\t\/\/ down a meta key, it deselects it\n\t\t\t\tthis.deselect(node);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tvar _this = this;\n\t\t\tdojo.lang.forEach(this.selectedNodes, function(selectedNode) {\n\t\t\t\tif (selectedNode !== node) {\n\t\t\t\t\t_this.deselect(selectedNode);\n\t\t\t\t}\n\t\t\t});\n\t\t\tdojo.event.topic.publish(this.eventNames.dblselect, { node: node });\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t\/\/ if unselected node..\n\t\t\n\t\t\n\t\t\/\/ deselect all if no meta key or disallowed\n\t\tif (!this.checkSpecialEvent(event) || !this.allowedMulti) {\n\t\t\t\/\/dojo.debug(\"deselect All\");\n\t\t\tthis.deselectAll();\n\t\t}\n\t\t\n\t\t\/\/dojo.debug(\"select\");\n\n\t\tthis.select(node);","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.deselectIfAncestorMatch":{"_":{"meta":{"summary":"","parameters":{"ancestor":{"type":""}},"src":"\t\tdojo.lang.forEach(this.selectedNodes, function(node) {\n\t\t\tvar selectedNode = node;\n\t\t\twhile (node && node.isTreeNode) {\n\t\t\t\tif (node === ancestor) {\n\t\t\t\t\t_this.deselect(selectedNode); \n\t\t\t\t\treturn;\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tnode = node.parent;\n\t\t\t}\n\t\t});","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.onAfterChangeTree":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tif (!message.newTree || !this.listenedTrees[message.newTree.widgetId]) {\n\t\t\t\/\/ moving from our trfee to new one\n\t\t\t\n\t\t\tif (this.selectedNode && message.node.children) {\n\t\t\t\tthis.deselectIfAncestorMatch(message.node);\n\t\t\t}\n\t\t\t\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.unlistenNode);\t\t\t\t\t\n\t\t\t\n\t\t}\n\t\tif (!message.oldTree || !this.listenedTrees[message.oldTree.widgetId]) {\n\t\t\t\/\/dojo.debugShallow(\"listen! \"+this.listenedTrees);\n\t\t\t\/\/ moving from old tree to our tree\n\t\t\tthis.processDescendants(message.node, this.listenNodeFilter, this.listenNode);\t\t\t\n\t\t}","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.onAfterDetach":{"_":{"meta":{"summary":"","parameters":{"message":{"type":""}},"src":"\t\tthis.deselectIfAncestorMatch(message.child);\t\t","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.select":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tvar index = dojo.lang.find(this.selectedNodes, node, true);\n\t\t\n\t\tif (index >=0 ) {\n\t\t\treturn; \/\/ already selected\n\t\t}\n\t\t\n\t\t\/\/dojo.debug(\"select \"+node);\n\t\tthis.selectedNodes.push(node);\n\t\t\t\t\t\t\n\t\tdojo.event.topic.publish(this.eventNames.select, {node: node} );","returns":"already selected","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.deselect":{"_":{"meta":{"summary":"","parameters":{"node":{"type":""}},"src":"\t\tvar index = dojo.lang.find(this.selectedNodes, node, true);\n\t\tif (index < 0) {\n\t\t\t\/\/dojo.debug(\"not selected\");\n\t\t\treturn; \/\/ not selected\n\t\t}\n\t\t\n\t\t\/\/dojo.debug(\"deselect \"+node);\n\t\t\n\t\t\n\t\tthis.selectedNodes.splice(index, 1);\n\t\tdojo.event.topic.publish(this.eventNames.deselect, {node: node} );\n\t\t\/\/dojo.debug(\"deselect\");","returns":"not selected","this":"dojo.widget.TreeSelectorV3"}}},"dojo.widget.TreeSelectorV3.deselectAll":{"_":{"meta":{"summary":"","src":"\t\t\tthis.deselect(this.selectedNodes[0]);\n\t\t}","this":"dojo.widget.TreeSelectorV3"}}}}}},"dojo.widget.TreeTimeoutIterator":{"meta":{"requires":{"common":["dojo.event.*","dojo.json","dojo.io.*","dojo.widget.TreeCommon"]},"methods":{"dojo.widget.TreeTimeoutIterator":{"_":{"meta":{"summary":"","parameters":{"elem":{"type":""},"callFunc":{"type":""},"callObj":{"type":""}},"src":"\tvar _this = this;\n\t\n\tthis.currentParent = elem;\n\t\n\tthis.callFunc = callFunc;\n\tthis.callObj = callObj ? callObj: this;\n\tthis.stack = [];","this_variables":["currentParent","callFunc","callObj","stack","filterFunc","filterObj","maxStackDepth","finishFunc","finishObj","currentParent","currentIndex","currentParent","currentIndex"],"protovariables":{"maxStackDepth":"","stack":"","currentParent":"","currentIndex":""}}}},"dojo.widget.TreeTimeoutIterator.filterFunc":{"_":{"meta":{"summary":"","src":"                          return true    ","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.finishFunc":{"_":{"meta":{"summary":"","src":"                          return true    ","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.setFilter":{"_":{"meta":{"summary":"","parameters":{"func":{"type":""},"obj":{"type":""}},"src":"\t\tthis.filterFunc = func;\n\t\tthis.filterObj = obj;","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.setMaxLevel":{"_":{"meta":{"summary":"","parameters":{"level":{"type":""}},"src":"\t\tif (level<1) {\n\t\t\tdojo.raise(\"setMaxLevel: level=\"+level+\" should be >=1\");\n\t\t}\n\t\t\n\t\tthis.maxStackDepth = level-2;","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.forward":{"_":{"meta":{"summary":"","parameters":{"timeout":{"type":""}},"src":"\t\tvar _this = this;\n\t\t\n\t\tif (this.timeout) {\n\t\t\t\/\/ tid will be assigned at the end of outer func execution\n\t\t\tvar tid = setTimeout(function() {_this.processNext(); clearTimeout(tid); }, _this.timeout);\n\t\t} else {\n\t\t\treturn this.processNext();\n\t\t}","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.start":{"_":{"meta":{"summary":"","parameters":{"processFirst":{"type":""}},"src":"\t\tif (processFirst) {\n\t\t\treturn this.callFunc.call(this.callObj, this.currentParent, this);\t\t\t\n\t\t}\n\t\t\n\t\treturn this.processNext();","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.processNext":{"_":{"meta":{"summary":"","src":"\t\tvar _this = this;\n\t\t\n\t\tvar found;\n\t\t\n\t\tvar next;\n\t\t\t\n\t\t\n\t\twhile (true) {\n\t\t\tvar children = this.currentParent.children;\n\t\t\n\t\t\tif (children && children.length) {\n\t\t\n\t\t\t\t\/\/ look for a node that can be the next target\n\t\t\t\tdo {\t\t\t\t\t\n\t\t\t\t\tnext = children[this.currentIndex];\n\t\t\t\t\t\/\/dojo.debug(\"check \"+next);\n\t\t\t\t} while (this.currentIndex++ < children.length && !(found = this.filterFunc.call(this.filterObj,next)));\n\t\t\t\n\t\t\t\n\t\t\t\tif (found) {\n\t\t\t\t\t\/\/dojo.debug(\"found \"+next);\n\t\t\t\t\t\/\/ move to next node as new parent if depth is fine\n\t\t\t\t\t\/\/ I can't check current children to decide whether to move it or not,\n\t\t\t\t\t\/\/ because expand may populate children\t\t\t\t\t\n\t\t\t\t\tif (next.isFolder && this.stack.length <= this.maxStackDepth) {\n\t\t\t\t\t\tthis.moveParent(next,0);\n\t\t\t\t\t}\n\t\t\t\t\t\/\/dojo.debug(\"Run callFunc on \"+next);\n\t\t\t\t\treturn this.callFunc.call(this.callObj, next, this);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\t\n\t\t\tif (this.stack.length) {\n\t\t\t\tthis.popParent();\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t\n\t\t\tbreak;\n\t\t}\n\n\t\t\/**\n\t\t * couldn't find next node to process, finish here\n\t\t *\/\n\t\treturn this.finishFunc.call(this.finishObj);","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.setFinish":{"_":{"meta":{"summary":"","parameters":{"func":{"type":""},"obj":{"type":""}},"src":"\t\tthis.finishFunc = func;\n\t\tthis.finishObj = obj;","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.popParent":{"_":{"meta":{"summary":"","src":"\t\tvar p = this.stack.pop();\n\t\t\/\/dojo.debug(\"Pop \"+p[0]+\":\"+p[1]);\t\t\n\t\tthis.currentParent = p[0];\n\t\tthis.currentIndex = p[1];","this":"dojo.widget.TreeTimeoutIterator"}}},"dojo.widget.TreeTimeoutIterator.moveParent":{"_":{"meta":{"summary":"","parameters":{"nextParent":{"type":""},"nextIndex":{"type":""}},"src":"\t\tthis.currentParent = nextParent;\n\t\tthis.currentIndex = nextIndex;","this":"dojo.widget.TreeTimeoutIterator"}}}}}},"dojo.widget.TreeV3":{"meta":{"requires":{"common":["dojo.widget.TreeWithNode","dojo.widget.*","dojo.event.*","dojo.io.*","dojo.widget.HtmlWidget","dojo.widget.TreeNodeV3"]},"methods":{"dojo.widget.TreeV3":{"_":{"meta":{"summary":"","src":"\tdojo.widget.HtmlWidget.call(this);\n\n\tthis.eventNames = {};\n\t\n\tthis.DndAcceptTypes = [];\n\tthis.actionsDisabled = [];\n\t\n\tthis.listeners = [];\n\t\n\tthis.tree = this;","this_variables":["eventNames","DndAcceptTypes","actionsDisabled","listeners","tree","nodeTemplate","expandNodeTemplate","labelNodeTemplate","contentNodeTemplate","containerNodeTemplate","DndMode","defaultChildWidget","containerNode"],"inherits":["dojo.widget.HtmlWidget"],"object_inherits":["dojo.widget.TreeWithNode"],"protovariables":{"widgetType":"","DndMode":"","defaultChildWidget":"","eventNamesDefault":"","classPrefix":"","allowAddChildToLeaf":"","unsetFolderOnEmpty":"","DndModes":"","BETWEEN":"","ONTO":"","DndAcceptTypes":"","templateCssPath":"","templateString":"","isExpanded":"","isTree":"","icons":"","expandLoading":"","actions":""}}}},"dojo.widget.TreeV3.objectId":{"_":{"meta":{"summary":"","src":"\t\tvar info = {\n\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.createNode":{"_":{"meta":{"summary":"","parameters":{"data":{"type":""}},"src":"\t\tdata.tree = this.widgetId;\n\t\t\n\t\tif (data.widgetName) {\n\t\t\t\/\/ TODO: check if such widget has createSimple\n\t\t\treturn dojo.widget.createWidget(data.widgetName, data);\t\t\n\t\t} else if (this.defaultChildWidget.prototype.createSimple) {\t\t\t\n\t\t\treturn this.defaultChildWidget.prototype.createSimple(data);\t\t\t\t\t\n\t\t} else {\n\t\t\tvar ns = parent.tree.defaultChildWidget.prototype.namespace; \n\t\t\tvar wt = parent.tree.defaultChildWidget.prototype.widgetType; \n\n\t\t\treturn dojo.widget.createWidget(ns + \":\" + wt, data); \n\t\t}","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.makeNodeTemplate":{"_":{"meta":{"summary":"","src":"\t\tvar domNode = document.createElement(\"div\");\n\t\tdojo.html.setClass(domNode, this.classPrefix+\"Node \"+this.classPrefix+\"ExpandLeaf \"+this.classPrefix+\"ChildrenNo\");\t\t\n\t\tthis.nodeTemplate = domNode;\n\t\t\n\t\tvar expandNode = document.createElement(\"div\");\n\t\tdojo.html.setClass(expandNode, this.classPrefix+\"Expand\");\n\t\tthis.expandNodeTemplate = expandNode;\n\n\t\t\/\/ need <span> inside <div>\n\t\t\/\/ div for multiline support, span for styling exactly the text, not whole line\n\t\tvar labelNode = document.createElement(\"span\");\n\t\tdojo.html.setClass(labelNode, this.classPrefix+\"Label\");\n\t\tthis.labelNodeTemplate = labelNode;\n\t\t\n\t\tvar contentNode = document.createElement(\"div\");\n\t\tvar clazz = this.classPrefix+\"Content\";\n\t\t\n\t\t\/**\n\t\t * IE & Safari do not support min-height properly so I have to rely\n\t\t * on this hack\n\t\t * FIXME: do it in CSS only, remove iconHeight from code\n\t\t *\/\n\t\tif (dojo.render.html.ie) {\n\t\t\tclazz = clazz + ' ' + this.classPrefix+\"ContentIE\";\n\t\t}\t\t\n\t\tif (dojo.render.html.safari) {\n\t\t\tclazz = clazz + ' ' + this.classPrefix+\"ContentSafari\";\n\t\t}\n\t\t\t\t\n\t\tdojo.html.setClass(contentNode, clazz);\n\t\t\n\t\tthis.contentNodeTemplate = contentNode;\n\t\t\n\t\t\t\t\n\t\tdomNode.appendChild(expandNode);\n\t\tdomNode.appendChild(contentNode);\n\t\tcontentNode.appendChild(labelNode);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.makeContainerNodeTemplate":{"_":{"meta":{"summary":"","src":"\t\tvar div = document.createElement('div');\n\t\tdiv.style.display = 'none';\t\t\t\n\t\tdojo.html.setClass(div, this.classPrefix+\"Container\");\n\t\t\n\t\tthis.containerNodeTemplate = div;","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.getInfo":{"_":{"meta":{"summary":"","src":"\t\tvar info = {\n\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.widgetId":{"_":{"meta":{"summary":"","src":"\t\tvar info = {\n\t\t\twidgetId: this.widgetId,\n\t\t\tobjectId: this.objectId\n\t\t}\n\n\t\treturn info;","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.adjustEventNames":{"_":{"meta":{"summary":"","src":"\t\tfor(name in this.eventNamesDefault) {\n\t\t\tif (dojo.lang.isUndefined(this.eventNames[name])) {\n\t\t\t\tthis.eventNames[name] = this.widgetId+\"\/\"+this.eventNamesDefault[name];\n\t\t\t}\n\t\t}","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.adjustDndMode":{"_":{"meta":{"summary":"","src":"\t\tvar _this = this;\n\t\t\n\t\t\n\t\tvar DndMode = 0;\n\t\tdojo.lang.forEach(this.DndMode.split(';'),\n\t\t\tfunction(elem) {\n\t\t\t\tvar mode = _this.DndModes[dojo.string.trim(elem).toUpperCase()];\n\t\t\t\tif (mode) DndMode = DndMode | mode;\n\t\t\t}\n\t\t );\n\t\n\t\t\n\t\tthis.DndMode = DndMode;","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.destroy":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.topic.publish(this.tree.eventNames.beforeTreeDestroy, { source: this } );\n\n\t\treturn dojo.widget.HtmlWidget.prototype.destroy.apply(this, arguments);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.source":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.topic.publish(this.eventNames.afterTreeCreate, { source: this } );","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""}},"src":"\t\t\tthis.defaultChildWidget = dojo.widget.TreeNodeV3;\n\t\t} else {\n\t\t\tthis.defaultChildWidget = dojo.lang.getObjPathValue(args.defaultChildWidget);\n\t\t}\n\t\t\n\t\tthis.adjustEventNames();\n\t\tthis.adjustDndMode();\n\n\t\tthis.makeNodeTemplate();\n\t\tthis.makeContainerNodeTemplate();\n\t\t\n\t\t\/\/this.initializeSelector();\n\t\t\/\/this.initializeController();\n\t\t\/\/this.initializeMenu();\n\n\t\tthis.containerNode = this.domNode;\n\t\t\n\t\tdojo.html.setClass(this.domNode, this.classPrefix+\"Container\");\n\t\t\n\t\tvar _this = this;\n\t\t\n\t\t\/\/dojo.debug(this.listeners[1]);\n\t\t\t\t\t\t\n\t\t\n\t\tdojo.lang.forEach(this.listeners,\n\t\t\tfunction(elem) {\n\t\t\t\tvar t = dojo.widget.manager.getWidgetById(elem);\n\t\t\t\tif (! (t instanceof dojo.widget.Widget)) {\n\t\t\t\t\tdojo.raise(\"No listener found by widgetId for \"+elem);\n\t\t\t\t}\n\t\t\t\t\/\/dojo.debug(t)\n\t\t\t\tt.listenTree(_this)\n\t\t\t\t\n\t\t\t}\n\t\t);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.postCreate":{"_":{"meta":{"summary":"","src":"\t\tdojo.event.topic.publish(this.eventNames.afterTreeCreate, { source: this } );","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.move":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tvar oldParent = child.parent;\n\t\tvar oldTree = child.tree;\n\n\t\tthis.doMove.apply(this, arguments);\n\n\t\tvar newParent = child.parent;\n\t\tvar newTree = child.tree;\n\n\t\tvar message = {\n\t\t\t\toldParent: oldParent, oldTree: oldTree,\n\t\t\t\tnewParent: newParent, newTree: newTree,\n\t\t\t\tchild: child\n\t\t};\n\n\t\t\/* publish events here about structural changes for both source and target trees *\/\n\t\tdojo.event.topic.publish(oldTree.eventNames.afterMoveFrom, message);\n\t\tdojo.event.topic.publish(newTree.eventNames.afterMoveTo, message);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.oldParent":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tvar oldParent = child.parent;\n\t\tvar oldTree = child.tree;\n\n\t\tthis.doMove.apply(this, arguments);\n\n\t\tvar newParent = child.parent;\n\t\tvar newTree = child.tree;\n\n\t\tvar message = {\n\t\t\t\toldParent: oldParent, oldTree: oldTree,\n\t\t\t\tnewParent: newParent, newTree: newTree,\n\t\t\t\tchild: child\n\t\t};\n\n\t\t\/* publish events here about structural changes for both source and target trees *\/\n\t\tdojo.event.topic.publish(oldTree.eventNames.afterMoveFrom, message);\n\t\tdojo.event.topic.publish(newTree.eventNames.afterMoveTo, message);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.newParent":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tvar oldParent = child.parent;\n\t\tvar oldTree = child.tree;\n\n\t\tthis.doMove.apply(this, arguments);\n\n\t\tvar newParent = child.parent;\n\t\tvar newTree = child.tree;\n\n\t\tvar message = {\n\t\t\t\toldParent: oldParent, oldTree: oldTree,\n\t\t\t\tnewParent: newParent, newTree: newTree,\n\t\t\t\tchild: child\n\t\t};\n\n\t\t\/* publish events here about structural changes for both source and target trees *\/\n\t\tdojo.event.topic.publish(oldTree.eventNames.afterMoveFrom, message);\n\t\tdojo.event.topic.publish(newTree.eventNames.afterMoveTo, message);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.child":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\tvar oldParent = child.parent;\n\t\tvar oldTree = child.tree;\n\n\t\tthis.doMove.apply(this, arguments);\n\n\t\tvar newParent = child.parent;\n\t\tvar newTree = child.tree;\n\n\t\tvar message = {\n\t\t\t\toldParent: oldParent, oldTree: oldTree,\n\t\t\t\tnewParent: newParent, newTree: newTree,\n\t\t\t\tchild: child\n\t\t};\n\n\t\t\/* publish events here about structural changes for both source and target trees *\/\n\t\tdojo.event.topic.publish(oldTree.eventNames.afterMoveFrom, message);\n\t\tdojo.event.topic.publish(newTree.eventNames.afterMoveTo, message);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.doMove":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""},"newParent":{"type":""},"index":{"type":""}},"src":"\t\t\/\/dojo.debug(\"addChild \"+child+\" to \"+newParent+\" at \"+index);\n\n\t\tnewParent.doAddChild(child, index);","this":"dojo.widget.TreeV3"}}},"dojo.widget.TreeV3.toString":{"_":{"meta":{"summary":"","src":"\t\treturn \"[\"+this.widgetType+\" ID:\"+this.widgetId\t+\"]\"","this":"dojo.widget.TreeV3"}}}}}},"dojo.widget.Widget":{"meta":{"requires":{"common":["dojo.lang.func","dojo.lang.array","dojo.lang.extras","dojo.lang.declare","dojo.widget.Manager","dojo.event.*"]},"methods":{"dojo.widget.Widget":{"_":{"meta":{"summary":"","protovariables":{"parent":"","isTopLevel":"","isModal":"","isEnabled":"","isHidden":"","isContainer":"","widgetId":"","widgetType":"","namespace":""}}}},"dojo.widget.Widget.toString":{"_":{"meta":{"summary":"","src":"\t\treturn '[Widget ' + this.widgetType + ', ' + (this.widgetId || 'NO ID') + ']';          ","returns":"string","this":"null"}}},"dojo.widget.Widget.repr":{"_":{"meta":{"summary":"","src":"\t\treturn this.toString();","this":"null"}}},"dojo.widget.Widget.enable":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"null":{"_":{"meta":{"this_variables":["isEnabled","isEnabled","isHidden","isHidden","namespace"]}}},"dojo.widget.Widget.disable":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"dojo.widget.Widget.hide":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"dojo.widget.Widget.show":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"dojo.widget.Widget.onResized":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"dojo.widget.Widget.notifyChildrenOfResize":{"_":{"meta":{"summary":"","src":"\t\tfor(var i=0; i<this.children.length; i++){\n\t\t\tvar child = this.children[i];\n\t\t\t\/\/dojo.debug(this.widgetId + \" resizing child \" + child.widgetId);\n\t\t\tif( child.onResized ){\n\t\t\t\tchild.onResized();\n\t\t\t}\n\t\t}","this":"null"}}},"dojo.widget.Widget.create":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"fragment":{"type":""},"parentComp":{"type":""},"namespace":{"type":""}},"src":"\t\t\tthis.namespace = namespace;\n\t\t}\n\t\t\/\/ dojo.debug(this.widgetType, \"create\");\n\t\t\/\/dojo.profile.start(this.widgetType + \" satisfyPropertySets\");\n\t\tthis.satisfyPropertySets(args, fragment, parentComp);\n\t\t\/\/dojo.profile.end(this.widgetType + \" satisfyPropertySets\");\n\t\t\/\/ dojo.debug(this.widgetType, \"-> mixInProperties\");\n\t\t\/\/dojo.profile.start(this.widgetType + \" mixInProperties\");\n\t\tthis.mixInProperties(args, fragment, parentComp);\n\t\t\/\/dojo.profile.end(this.widgetType + \" mixInProperties\");\n\t\t\/\/ dojo.debug(this.widgetType, \"-> postMixInProperties\");\n\t\t\/\/dojo.profile.start(this.widgetType + \" postMixInProperties\");\n\t\tthis.postMixInProperties(args, fragment, parentComp);\n\t\t\/\/dojo.profile.end(this.widgetType + \" postMixInProperties\");\n\t\t\/\/ dojo.debug(this.widgetType, \"-> dojo.widget.manager.add\");\n\t\tdojo.widget.manager.add(this);\n\t\t\/\/ dojo.debug(this.widgetType, \"-> buildRendering\");\n\t\t\/\/dojo.profile.start(this.widgetType + \" buildRendering\");\n\t\tthis.buildRendering(args, fragment, parentComp);\n\t\t\/\/dojo.profile.end(this.widgetType + \" buildRendering\");\n\t\t\/\/ dojo.debug(this.widgetType, \"-> initialize\");\n\t\t\/\/dojo.profile.start(this.widgetType + \" initialize\");\n\t\tthis.initialize(args, fragment, parentComp);\n\t\t\/\/dojo.profile.end(this.widgetType + \" initialize\");\n\t\t\/\/ dojo.debug(this.widgetType, \"-> postInitialize\");\n\t\t\/\/ postinitialize includes subcomponent creation\n\t\t\/\/ profile is put directly to function\n\t\tthis.postInitialize(args, fragment, parentComp);\n\t\t\/\/ dojo.debug(this.widgetType, \"-> postCreate\");\n\t\t\/\/dojo.profile.start(this.widgetType + \" postCreate\");\n\t\tthis.postCreate(args, fragment, parentComp);\n\t\t\/\/dojo.profile.end(this.widgetType + \" postCreate\");\n\t\t\/\/ dojo.debug(this.widgetType, \"done!\");\n\t\t\n\t\t\/\/dojo.profile.end(this.widgetType + \" create\");\n\t\t\n\t\treturn this;","this":"null"}}},"dojo.widget.Widget.destroy":{"_":{"meta":{"summary":"","parameters":{"finalize":{"type":""}},"src":"\t\tthis.uninitialize();\n\t\tthis.destroyRendering(finalize);\n\t\tdojo.widget.manager.removeById(this.widgetId);","this":"null"}}},"dojo.widget.Widget.destroyChildren":{"_":{"meta":{"summary":"","src":"\t\twhile(this.children.length > 0){\n\t\t\tvar tc = this.children[0];\n\t\t\tthis.removeChild(tc);\n\t\t\ttc.destroy();\n\t\t}","this":"null"}}},"dojo.widget.Widget.getChildrenOfType":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""},"recurse":{"type":""}},"src":"\t\tvar ret = [];\n\t\tvar isFunc = dojo.lang.isFunction(type);\n\t\tif(!isFunc){\n\t\t\ttype = type.toLowerCase();\n\t\t}\n\t\tfor(var x=0; x<this.children.length; x++){\n\t\t\tif(isFunc){\n\t\t\t\tif(this.children[x] instanceof type){\n\t\t\t\t\tret.push(this.children[x]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(this.children[x].widgetType.toLowerCase() == type){\n\t\t\t\t\tret.push(this.children[x]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(recurse){\n\t\t\t\tret = ret.concat(this.children[x].getChildrenOfType(type, recurse));\n\t\t\t}\n\t\t}\n\t\treturn ret;","this":"null"}}},"dojo.widget.Widget.getDescendants":{"_":{"meta":{"summary":"","src":"\t\tvar result = [];\n\t\tvar stack = [this];\n\t\tvar elem;\n\t\twhile ((elem = stack.pop())){\n\t\t\tresult.push(elem);\n\t\t\t\/\/ a child may be data object without children field set (not widget)\n\t\t\tif (elem.children) {\n\t\t\t\tdojo.lang.forEach(elem.children, function(elem) { stack.push(elem); });\n\t\t\t}\n\t\t}\n\t\treturn result;","this":"null"}}},"dojo.widget.Widget.isFirstNode":{"_":{"meta":{"summary":"","src":"\t\treturn this === this.parent.children[0];","this":"null"}}},"dojo.widget.Widget.isLastNode":{"_":{"meta":{"summary":"","src":"\t\treturn this === this.parent.children[this.parent.children.length-1];","this":"null"}}},"dojo.widget.Widget.satisfyPropertySets":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""}},"src":"","this":"null"}}},"dojo.widget.Widget.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tif((args[\"fastMixIn\"])||(frag[\"fastMixIn\"])){\n\t\t\t\/\/ dojo.profile.start(\"mixInProperties_fastMixIn\");\n\t\t\t\/\/ fast mix in assumes case sensitivity, no type casting, etc...\n\t\t\t\/\/ dojo.lang.mixin(this, args);\n\t\t\tfor(var x in args){\n\t\t\t\tthis[x] = args[x];\n\t\t\t}\n\t\t\t\/\/ dojo.profile.end(\"mixInProperties_fastMixIn\");\n\t\t\treturn;\n\t\t}\n\t\t\/\/ dojo.profile.start(\"mixInProperties\");\n\t\t\/*\n\t\t * the actual mix-in code attempts to do some type-assignment based on\n\t\t * PRE-EXISTING properties of the \"this\" object. When a named property\n\t\t * of a propset is located, it is first tested to make sure that the\n\t\t * current object already \"has one\". Properties which are undefined in\n\t\t * the base widget are NOT settable here. The next step is to try to\n\t\t * determine type of the pre-existing property. If it's a string, the\n\t\t * property value is simply assigned. If a function, the property is\n\t\t * replaced with a \"new Function()\" declaration. If an Array, the\n\t\t * system attempts to split the string value on \";\" chars, and no\n\t\t * further processing is attempted (conversion of array elements to a\n\t\t * integers, for instance). If the property value is an Object\n\t\t * (testObj.constructor === Object), the property is split first on \";\"\n\t\t * chars, secondly on \":\" chars, and the resulting key\/value pairs are\n\t\t * assigned to an object in a map style. The onus is on the property\n\t\t * user to ensure that all property values are converted to the\n\t\t * expected type before usage.\n\t\t *\/\n\n\t\tvar undef;\n\n\t\t\/\/ NOTE: we cannot assume that the passed properties are case-correct\n\t\t\/\/ (esp due to some browser bugs). Therefore, we attempt to locate\n\t\t\/\/ properties for assignment regardless of case. This may cause\n\t\t\/\/ problematic assignments and bugs in the future and will need to be\n\t\t\/\/ documented with big bright neon lights.\n\n\t\t\/\/ FIXME: fails miserably if a mixin property has a default value of null in \n\t\t\/\/ a widget\n\n\t\t\/\/ NOTE: caching lower-cased args in the prototype is only \n\t\t\/\/ acceptable if the properties are invariant.\n\t\t\/\/ if we have a name-cache, get it\n\t\tvar lcArgs = dojo.widget.lcArgsCache[this.widgetType];\n\t\tif ( lcArgs == null ){\n\t\t\t\/\/ build a lower-case property name cache if we don't have one\n\t\t\tlcArgs = {};\n\t\t\tfor(var y in this){\n\t\t\t\tlcArgs[((new String(y)).toLowerCase())] = y;\n\t\t\t}\n\t\t\tdojo.widget.lcArgsCache[this.widgetType] = lcArgs;\n\t\t}\n\t\tvar visited = {};\n\t\tfor(var x in args){\n\t\t\tif(!this[x]){ \/\/ check the cache for properties\n\t\t\t\tvar y = lcArgs[(new String(x)).toLowerCase()];\n\t\t\t\tif(y){\n\t\t\t\t\targs[y] = args[x];\n\t\t\t\t\tx = y; \n\t\t\t\t}\n\t\t\t}\n\t\t\tif(visited[x]){ continue; }\n\t\t\tvisited[x] = true;\n\t\t\tif((typeof this[x]) != (typeof undef)){\n\t\t\t\tif(typeof args[x] != \"string\"){\n\t\t\t\t\tthis[x] = args[x];\n\t\t\t\t}else{\n\t\t\t\t\tif(dojo.lang.isString(this[x])){\n\t\t\t\t\t\tthis[x] = args[x];\n\t\t\t\t\t}else if(dojo.lang.isNumber(this[x])){\n\t\t\t\t\t\tthis[x] = new Number(args[x]); \/\/ FIXME: what if NaN is the result?\n\t\t\t\t\t}else if(dojo.lang.isBoolean(this[x])){\n\t\t\t\t\t\tthis[x] = (args[x].toLowerCase()==\"false\") ? false : true;\n\t\t\t\t\t}else if(dojo.lang.isFunction(this[x])){\n\n\t\t\t\t\t\t\/\/ FIXME: need to determine if always over-writing instead\n\t\t\t\t\t\t\/\/ of attaching here is appropriate. I suspect that we\n\t\t\t\t\t\t\/\/ might want to only allow attaching w\/ action items.\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/ RAR, 1\/19\/05: I'm going to attach instead of\n\t\t\t\t\t\t\/\/ over-write here. Perhaps function objects could have\n\t\t\t\t\t\t\/\/ some sort of flag set on them? Or mixed-into objects\n\t\t\t\t\t\t\/\/ could have some list of non-mutable properties\n\t\t\t\t\t\t\/\/ (although I'm not sure how that would alleviate this\n\t\t\t\t\t\t\/\/ particular problem)? \n\n\t\t\t\t\t\t\/\/ this[x] = new Function(args[x]);\n\n\t\t\t\t\t\t\/\/ after an IRC discussion last week, it was decided\n\t\t\t\t\t\t\/\/ that these event handlers should execute in the\n\t\t\t\t\t\t\/\/ context of the widget, so that the \"this\" pointer\n\t\t\t\t\t\t\/\/ takes correctly.\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/ argument that contains no punctuation other than . is \n\t\t\t\t\t\t\/\/ considered a function spec, not code\n\t\t\t\t\t\tif(args[x].search(\/[^\\w\\.]+\/i) == -1){\n\t\t\t\t\t\t\tthis[x] = dojo.evalObjPath(args[x], false);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tvar tn = dojo.lang.nameAnonFunc(new Function(args[x]), this);\n\t\t\t\t\t\t\tdojo.event.connect(this, x, this, tn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(dojo.lang.isArray(this[x])){ \/\/ typeof [] == \"object\"\n\t\t\t\t\t\tthis[x] = args[x].split(\";\");\n\t\t\t\t\t} else if (this[x] instanceof Date) {\n\t\t\t\t\t\tthis[x] = new Date(Number(args[x])); \/\/ assume timestamp\n\t\t\t\t\t}else if(typeof this[x] == \"object\"){ \n\t\t\t\t\t\t\/\/ FIXME: should we be allowing extension here to handle\n\t\t\t\t\t\t\/\/ other object types intelligently?\n\n\t\t\t\t\t\t\/\/ if we defined a URI, we probably want to allow plain strings\n\t\t\t\t\t\t\/\/ to override it\n\t\t\t\t\t\tif (this[x] instanceof dojo.uri.Uri){\n\n\t\t\t\t\t\t\tthis[x] = args[x];\n\t\t\t\t\t\t}else{\n\n\t\t\t\t\t\t\t\/\/ FIXME: unlike all other types, we do not replace the\n\t\t\t\t\t\t\t\/\/ object with a new one here. Should we change that?\n\t\t\t\t\t\t\tvar pairs = args[x].split(\";\");\n\t\t\t\t\t\t\tfor(var y=0; y<pairs.length; y++){\n\t\t\t\t\t\t\t\tvar si = pairs[y].indexOf(\":\");\n\t\t\t\t\t\t\t\tif((si != -1)&&(pairs[y].length>si)){\n\t\t\t\t\t\t\t\t\tthis[x][pairs[y].substr(0, si).replace(\/^\\s+|\\s+$\/g, \"\")] = pairs[y].substr(si+1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\t\/\/ the default is straight-up string assignment. When would\n\t\t\t\t\t\t\/\/ we ever hit this?\n\t\t\t\t\t\tthis[x] = args[x];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t\/\/ collect any extra 'non mixed in' args\n\t\t\t\tthis.extraArgs[x.toLowerCase()] = args[x];\n\t\t\t}\n\t\t}\n\t\t\/\/ dojo.profile.end(\"mixInProperties\");","this":"null"}}},"dojo.widget.Widget.postMixInProperties":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"dojo.widget.Widget.initialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"","this":"null"}}},"dojo.widget.Widget.postInitialize":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\treturn false;","this":"null"}}},"dojo.widget.Widget.postCreate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\treturn false;","this":"null"}}},"dojo.widget.Widget.uninitialize":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"dojo.widget.Widget.buildRendering":{"_":{"meta":{"summary":"","src":"\t\treturn false;","this":"null"}}},"dojo.widget.Widget.destroyRendering":{"_":{"meta":{"summary":"","src":"\t\treturn false;","this":"null"}}},"dojo.widget.Widget.cleanUp":{"_":{"meta":{"summary":"","src":"\t\treturn false;","this":"null"}}},"dojo.widget.Widget.addedTo":{"_":{"meta":{"summary":"","parameters":{"parent":{"type":""}},"src":"\t\t\/\/ this is just a signal that can be caught","this":"null"}}},"dojo.widget.Widget.addChild":{"_":{"meta":{"summary":"","parameters":{"child":{"type":""}},"src":"\t\treturn false;","this":"null"}}},"dojo.widget.Widget.removeChild":{"_":{"meta":{"summary":"","parameters":{"widget":{"type":""}},"src":"\t\tfor(var x=0; x<this.children.length; x++){\n\t\t\tif(this.children[x] === widget){\n\t\t\t\tthis.children.splice(x, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn widget;","this":"null"}}},"dojo.widget.Widget.resize":{"_":{"meta":{"summary":"","parameters":{"width":{"type":""},"height":{"type":""}},"src":"\t\tthis.setHeight(height);","this":"null"}}},"dojo.widget.Widget.setWidth":{"_":{"meta":{"summary":"","parameters":{"width":{"type":""}},"src":"\t\tif((typeof width == \"string\")&&(width.substr(-1) == \"%\")){\n\t\t\tthis.setPercentageWidth(width);\n\t\t}else{\n\t\t\tthis.setNativeWidth(width);\n\t\t}","this":"null"}}},"dojo.widget.Widget.setHeight":{"_":{"meta":{"summary":"","parameters":{"height":{"type":""}},"src":"\t\tif((typeof height == \"string\")&&(height.substr(-1) == \"%\")){\n\t\t\tthis.setPercentageHeight(height);\n\t\t}else{\n\t\t\tthis.setNativeHeight(height);\n\t\t}","this":"null"}}},"dojo.widget.Widget.setPercentageHeight":{"_":{"meta":{"summary":"","parameters":{"height":{"type":""}},"src":"","this":"null"}}},"dojo.widget.Widget.setNativeHeight":{"_":{"meta":{"summary":"","parameters":{"height":{"type":""}},"src":"","this":"null"}}},"dojo.widget.Widget.setPercentageWidth":{"_":{"meta":{"summary":"","parameters":{"width":{"type":""}},"src":"","this":"null"}}},"dojo.widget.Widget.setNativeWidth":{"_":{"meta":{"summary":"","parameters":{"width":{"type":""}},"src":"","this":"null"}}},"dojo.widget.Widget.getPreviousSibling":{"_":{"meta":{"summary":"","src":"\t\tvar idx = this.getParentIndex();\n \n\t\t \/\/ first node is idx=0 not found is idx<0\n\t\tif (idx<=0) return null;\n \n\t\treturn this.getSiblings()[idx-1];","this":"null"}}},"dojo.widget.Widget.getSiblings":{"_":{"meta":{"summary":"","src":"\t\treturn this.parent.children;","this":"null"}}},"dojo.widget.Widget.getParentIndex":{"_":{"meta":{"summary":"","src":"","this":"null"}}},"dojo.widget.Widget.getNextSibling":{"_":{"meta":{"summary":"","src":"\t\tvar idx = this.getParentIndex();\n \n\t\tif (idx == this.getSiblings().length-1) return null; \/\/ last node\n\t\tif (idx < 0) return null; \/\/ not found\n \n\t\treturn this.getSiblings()[idx+1];","returns":"mixed","this":"null"}}},"dojo.widget.tags.addParseTreeHandler":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""}},"src":"\tvar ltype = type.toLowerCase();\n\tthis[ltype] = function(fragment, widgetParser, parentComp, insertionIndex, localProps){\n\t\tvar _ltype = ltype;\n\t\tdojo.profile.start(_ltype);\n\t\tvar n = dojo.widget.buildWidgetFromParseTree(ltype, fragment, widgetParser, parentComp, insertionIndex, localProps);\n\t\tdojo.profile.end(_ltype);\n\t\t\n\t\treturn n;\n\t}"}}},"dojo.widget.buildWidgetFromParseTree":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""},"frag":{"type":""},"parser":{"type":""},"parentComp":{"type":""},"insertionIndex":{"type":""},"localProps":{"type":""}},"src":"\tstype = (stype.length == 2) ? stype[1] : type;\n\t\/\/ FIXME: we don't seem to be doing anything with this!\n\t\/\/ var propertySets = parser.getPropertySets(frag);\n\tvar localProperties = localProps || parser.parseProperties(frag[frag.namespace+\":\"+stype]);\n\t\/\/ var tic = new Date();\n\tvar twidget = dojo.widget.manager.getImplementation(stype,null,null,frag.namespace);\n\tif(!twidget){\n\t\tthrow new Error(\"cannot find \\\"\" + stype + \"\\\" widget\");\n\t}else if (!twidget.create){\n\t\tthrow new Error(\"\\\"\" + stype + \"\\\" widget object does not appear to implement *Widget\");\n\t}\n\tlocalProperties[\"dojoinsertionindex\"] = insertionIndex;\n\t\/\/ FIXME: we lose no less than 5ms in construction!\n\t\n\t\n\tvar ret = twidget.create(localProperties, frag, parentComp, frag.namespace);\n\t\/\/ dojo.debug(new Date() - tic);\n\t\n\t\/\/dojo.profile.end(\"buildWidgetFromParseTree\");\n\t\n\treturn ret;"}}},"dojo.widget.defineWidget":{"_":{"meta":{"summary":"","parameters":{"widgetClass":{"type":"string"},"renderer":{"type":"string"},"superclasses":{"type":"function||array"},"init":{"type":"function"},"props":{"type":"object"}},"src":"\t\tdojo.widget._defineWidget(arguments[0], arguments[3], arguments[1], arguments[4], arguments[2]);\n\t}else{\n\t\t\/\/ widgetClass\n\t\tvar args = [ arguments[0] ], p = 3;\n\t\tif(dojo.lang.isString(arguments[1])){\n\t\t\t\/\/ renderer, superclass\n\t\t\targs.push(arguments[1], arguments[2]);\n\t\t}else{\n\t\t\t\/\/ superclass\n\t\t\targs.push('', arguments[1]);\n\t\t\tp = 2;\n\t\t}\n\t\tif(dojo.lang.isFunction(arguments[p])){\n\t\t\t\/\/ init (function), props (object) \n\t\t\targs.push(arguments[p], arguments[p+1]);\n\t\t}else{\n\t\t\t\/\/ props (object) \n\t\t\targs.push(null, arguments[p]);\n\t\t}\n\t\tdojo.widget._defineWidget.apply(this, args);\n\t}"}}},"dojo.widget._defineWidget":{"_":{"meta":{"summary":"","parameters":{"widgetClass":{"type":"string"},"renderer":{"type":"string"},"superclasses":{"type":"function||array"},"init":{"type":"function"},"props":{"type":"object"}},"src":"\tvar type = namespace.pop(); \/\/ type <= WidgetName, namespace <= foo.bar.baz<.renderer>\n\tvar regx = \"\\\\.(\" + (renderer ? renderer + '|' : '') + dojo.widget.defineWidget.renderers + \")\\\\.\";\n\tvar r = widgetClass.search(new RegExp(regx));\n\tnamespace = (r < 0 ? namespace.join(\".\") : widgetClass.substr(0, r));\n\n\tdojo.widget.manager.registerWidgetPackage(namespace);\n\t\n\tvar pos = namespace.indexOf(\".\");\n\tvar nsName = (pos > -1) ? namespace.substring(0,pos) : namespace;\n\tdojo.widget.tags.addParseTreeHandler(nsName+\":\"+type.toLowerCase());\n\tif(nsName != \"dojo\"){\n\t\t\/\/ 2006\/06\/26 Providing a duplicate dojo handler is a deprecation\n\t\t\/\/ and should eventually be removed from code\n\t\tdojo.widget.tags.addParseTreeHandler(\"dojo:\"+type.toLowerCase());\n\t}\n\n\tprops=(props)||{};\n\tprops.widgetType = type;\n\tif((!init)&&(props[\"classConstructor\"])){\n\t\tinit = props.classConstructor;\n\t\tdelete props.classConstructor;\n\t}\n\tdojo.declare(widgetClass, superclasses, init, props);"}}}}}},"dojo.widget.Wizard":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.LayoutContainer","dojo.widget.ContentPane","dojo.event.*","dojo.html.style"]},"methods":{"dojo.widget.WizardContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.LayoutContainer"],"this_inherits":["dojo.widget.LayoutContainer"]}}},"dojo.widget.WizardPane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.ContentPane"],"this_inherits":["dojo.widget.ContentPane"]}}}}}},"dojo.widget.YahooMap":{"meta":{"requires":{"common":["dojo.event.*","dojo.math","dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"dojo.widget.YahooMap":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"]}}}}}},"dojo.widget._":{"meta":{"requires":{"common":["dojo.xml.Parse","dojo.widget.Widget","dojo.widget.Parse","dojo.widget.Manager","dojo.namespaces.dojo"],"browser":["dojo.widget.DomWidget","dojo.widget.HtmlWidget"],"dashboard":["dojo.widget.DomWidget","dojo.widget.HtmlWidget"],"svg":["dojo.widget.SvgWidget"],"rhino":["dojo.widget.SwtWidget"]}}},"dojo.widget.demoEngine.DemoContainer":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.widget.demoEngine.DemoPane","dojo.widget.demoEngine.SourcePane","dojo.widget.TabContainer"]},"methods":{"my.widget.demoEngine.DemoContainer":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":""}}}},"my.widget.demoEngine.DemoContainer.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.addClass(this.domNode,this.domNodeClass);\n\t\t\tdojo.html.addClass(this.tabNode, this.tabClass);\n\t\t\tdojo.html.addClass(this.returnImageNode, this.returnClass);\n\t\t\tthis.returnImageNode.src=this.returnImage;\n\n\t\t\tthis.tabContainer = dojo.widget.createWidget(\"TabContainer\",{},this.tabNode);\n\n\t\t\tthis.demoTab = dojo.widget.createWidget(\"DemoPane\",{});\n\t\t\tthis.tabContainer.addChild(this.demoTab);\n\n\t\t\tthis.sourceTab= dojo.widget.createWidget(\"SourcePane\",{});\n\t\t\tthis.tabContainer.addChild(this.sourceTab);\n\n\t\t\tdojo.html.setOpacity(this.domNode,0);\n\t\t\tdojo.html.hide(this.domNode);","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["returnImageNode.src","tabContainer","demoTab","sourceTab"]}}},"my.widget.demoEngine.DemoContainer.loadDemo":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\t\tthis.demoTab.setHref(url);\n\t\t\tthis.sourceTab.setHref(url);\n\t\t\tthis.showDemo();","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoContainer.setName":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""}},"src":"\t\t\tdojo.html.removeChildren(this.demoNameNode);\n\t\t\tthis.demoNameNode.appendChild(document.createTextNode(name));","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoContainer.setSummary":{"_":{"meta":{"summary":"","parameters":{"summary":{"type":""}},"src":"\t\t\tdojo.html.removeChildren(this.summaryNode);\n\t\t\tthis.summaryNode.appendChild(document.createTextNode(summary));","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoContainer.showSource":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.removeClass(this.demoButtonNode,this.selectedButtonClass);\n\t\t\tdojo.html.addClass(this.sourceButtonNode,this.selectedButtonClass);\n\t\t\tthis.tabContainer.selectTab(this.sourceTab);\t","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoContainer.showDemo":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.removeClass(this.sourceButtonNode,this.selectedButtonClass);\n\t\t\tdojo.html.addClass(this.demoButtonNode,this.selectedButtonClass);\n\t\t\tthis.tabContainer.selectTab(this.demoTab);","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoContainer.returnToDemos":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.debug(\"Return To Demos\");","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoContainer.show":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.setOpacity(this.domNode,1);\n\t\t\tdojo.html.show(this.domNode);\n\t\t\tthis.tabContainer.checkSize();","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.demoEngine.DemoItem":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"my.widget.demoEngine.DemoItem":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":""}}}},"my.widget.demoEngine.DemoItem.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.addClass(this.domNode,this.domNodeClass);\n\t\t\tdojo.html.addClass(this.summaryBoxNode, this.summaryBoxClass);\n\t\t\tdojo.html.addClass(this.screenshotTdNode, this.screenshotTdClass);\n\t\t\tdojo.html.addClass(this.summaryContainerNode, this.summaryContainerClass);\n\t\t\tdojo.html.addClass(this.summaryNode, this.summaryClass);\n\t\t\tdojo.html.addClass(this.viewDemoLinkNode, this.viewDemoLinkClass);\n\n\t\t\tthis.nameNode.appendChild(document.createTextNode(this.name));\n\t\t\tthis.descriptionNode.appendChild(document.createTextNode(this.description));\n\t\t\tthis.thumbnailImageNode.src = this.thumbnail;\n\t\t\tthis.thumbnailImageNode.name=this.name;\n\t\t\tthis.viewDemoImageNode.src = this.viewDemoImage;\n\t\t\tthis.viewDemoImageNode.name=this.name;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["thumbnailImageNode.src","thumbnailImageNode.name","viewDemoImageNode.src","viewDemoImageNode.name"]}}},"my.widget.demoEngine.DemoItem.onSelectDemo":{"_":{"meta":{"summary":"","src":"\t\t\t\/\/Attach to this to do something when a demo is selected","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.demoEngine.DemoNavigator":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.widget.Button","dojo.widget.demoEngine.DemoItem","dojo.io.*","dojo.lfx.*","dojo.lang.Common"]},"methods":{"my.widget.demoEngine.DemoNavigator":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":""}}}},"my.widget.demoEngine.DemoNavigator.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.addClass(this.domNode,this.domNodeClass);\n\t\t\tdojo.html.addClass(this.demoListWrapperNode,this.demoListWrapperClass);\n\t\t\tdojo.html.addClass(this.demoListContainerNode,this.demoListContainerClass);\n\n\t\t\tif (dojo.render.html.ie) {\n\t\t\t\tdojo.debug(\"render ie\");\n\t\t\t\tdojo.html.hide(this.demoListWrapperNode); \n\t\t\t} else {\n\t\t\t\tdojo.debug(\"render non-ie\");\n\t\t\t\tdojo.lfx.html.fadeHide(this.demoListWrapperNode, 0).play();\t\n\t\t\t}\n\n\t\t\tthis.getRegistry(this.demoRegistryUrl);\n\n\t\t\tthis.demoContainer = dojo.widget.createWidget(\"DemoContainer\",{returnImage: this.returnImage},this.demoNode);\n\t\t\tdojo.event.connect(this.demoContainer,\"returnToDemos\", this, \"returnToDemos\");\n\t\t\tthis.demoContainer.hide();","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["demoContainer","demoContainer","registry","registry.categories","registry.categories","demoListChildren"]}}},"my.widget.demoEngine.DemoNavigator.returnImage":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.addClass(this.domNode,this.domNodeClass);\n\t\t\tdojo.html.addClass(this.demoListWrapperNode,this.demoListWrapperClass);\n\t\t\tdojo.html.addClass(this.demoListContainerNode,this.demoListContainerClass);\n\n\t\t\tif (dojo.render.html.ie) {\n\t\t\t\tdojo.debug(\"render ie\");\n\t\t\t\tdojo.html.hide(this.demoListWrapperNode); \n\t\t\t} else {\n\t\t\t\tdojo.debug(\"render non-ie\");\n\t\t\t\tdojo.lfx.html.fadeHide(this.demoListWrapperNode, 0).play();\t\n\t\t\t}\n\n\t\t\tthis.getRegistry(this.demoRegistryUrl);\n\n\t\t\tthis.demoContainer = dojo.widget.createWidget(\"DemoContainer\",{returnImage: this.returnImage},this.demoNode);\n\t\t\tdojo.event.connect(this.demoContainer,\"returnToDemos\", this, \"returnToDemos\");\n\t\t\tthis.demoContainer.hide();","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.returnToDemos":{"_":{"meta":{"summary":"","src":"\t\t\tthis.demoContainer.hide();\n\t\t\tif (dojo.render.html.ie) {\n\t\t\t\tdojo.debug(\"render ie\");\n\t\t\t\tdojo.html.show(this.navigationContainer) ;\n\t\t\t} else {\t\n\t\t\t\tdojo.debug(\"render non-ie\");\n\t\t\t\tdojo.lfx.html.fadeShow(this.navigationContainer,250).play();\n\t\t\t}\n\n\t\t\t\/\/if (dojo.render.html.ie) {\n\t\t\t\/\/\tdojo.html.setOpacity(this.navigationContainer);\n\t\t\t\/\/}\n\n\t\t\tdojo.lang.forEach(this.categoriesChildren, dojo.lang.hitch(this, function(child){\n\t\t\t\tchild.checkSize();\n\t\t\t}));\n\n\t\t\tdojo.lang.forEach(this.demoListChildren, dojo.lang.hitch(this, function(child){\n\t\t\t\tchild.checkSize();\n\t\t\t}));","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.show":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.setOpacity(this.domNode,1);\n\t\t\t\/\/dojo.html.setOpacity(this.navigationContainer);\t\n\t\t\t\/\/dojo.html.show(this.navigationContainer);\n\t\t\tdojo.html.setOpacity(this.navigationContainer,1);\n\n\t\t\tdojo.lang.forEach(this.categoriesChildren, dojo.lang.hitch(this, function(child){\n\t\t\t\tchild.checkSize();\n\t\t\t}));\n\n\t\t\tdojo.lang.forEach(this.demoListChildren, dojo.lang.hitch(this, function(child){\n\t\t\t\tchild.checkSize();\n\t\t\t}));","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.getRegistry":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\t\tdojo.io.bind({\n\t\t\t\turl: url,\n\t\t\t\tload: dojo.lang.hitch(this,this.processRegistry),\n\t\t\t\tmimetype: \"text\/json\"\n\t\t\t});","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.url":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\t\tdojo.io.bind({\n\t\t\t\turl: url,\n\t\t\t\tload: dojo.lang.hitch(this,this.processRegistry),\n\t\t\t\tmimetype: \"text\/json\"\n\t\t\t});","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.load":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\t\tdojo.io.bind({\n\t\t\t\turl: url,\n\t\t\t\tload: dojo.lang.hitch(this,this.processRegistry),\n\t\t\t\tmimetype: \"text\/json\"\n\t\t\t});","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.mimetype":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\t\tdojo.io.bind({\n\t\t\t\turl: url,\n\t\t\t\tload: dojo.lang.hitch(this,this.processRegistry),\n\t\t\t\tmimetype: \"text\/json\"\n\t\t\t});","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.processRegistry":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""},"egistry":{"type":""},"":{"type":""}},"src":"\t\t\tdojo.debug(\"Processing Registry\");\n\t\t\tthis.registry = registry;\n\t\t\tdojo.lang.forEach(this.registry.navigation, dojo.lang.hitch(this,this.addCategory)); ","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.addCategory":{"_":{"meta":{"summary":"","parameters":{"category":{"type":""}},"src":"\t\t\t\tvar newCat = dojo.widget.createWidget(\"Button\",{caption: category.name});\n\n\t\t\t\tif(!dojo.lang.isObject(this.registry.categories)) {\n\t\t\t\t\tthis.registry.categories=function(){};\n\t\t\t\t}\n\n\t\t\t\tthis.registry.categories[category.name] = category;\n\t\t\t\tthis.categoriesChildren.push(newCat);\n\t\t\t\tthis.categoriesButtonsNode.appendChild(newCat.domNode);\t\n\t\t\t\tnewCat.domNode.categoryName = category.name;\n\t\t\t\tdojo.event.connect(newCat,\"onClick\", this, \"onSelectCategory\");","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.caption":{"_":{"meta":{"summary":"","parameters":{"category":{"type":""}},"src":"\t\t\t\tvar newCat = dojo.widget.createWidget(\"Button\",{caption: category.name});\n\n\t\t\t\tif(!dojo.lang.isObject(this.registry.categories)) {\n\t\t\t\t\tthis.registry.categories=function(){};\n\t\t\t\t}\n\n\t\t\t\tthis.registry.categories[category.name] = category;\n\t\t\t\tthis.categoriesChildren.push(newCat);\n\t\t\t\tthis.categoriesButtonsNode.appendChild(newCat.domNode);\t\n\t\t\t\tnewCat.domNode.categoryName = category.name;\n\t\t\t\tdojo.event.connect(newCat,\"onClick\", this, \"onSelectCategory\");","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.addDemo":{"_":{"meta":{"summary":"","parameters":{"demoName":{"type":""}},"src":"\t\t\tvar demo = this.registry.definitions[demoName];\n\n\t\t\tif (dojo.render.html.ie) {\n\t\t\t\tdojo.html.show(this.demoListWrapperNode) \n\t\t\t} else {\n\t\t\t\tdojo.lfx.html.fadeShow(this.demoListWrapperNode, 250).play();\n\t\t\t}\n\n\t\t\tvar newDemo = dojo.widget.createWidget(\"DemoItem\",{viewDemoImage: this.viewDemoImage, name: demoName, description: demo.description, thumbnail: demo.thumbnail});\n\t\t\tthis.demoListChildren.push(newDemo);\n\t\t\tthis.demoListContainerNode.appendChild(newDemo.domNode);\t\n\t\t\tdojo.event.connect(newDemo,\"onSelectDemo\",this,\"onSelectDemo\");","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.viewDemoImage":{"_":{"meta":{"summary":"","parameters":{"demoName":{"type":""}},"src":"\t\t\tvar demo = this.registry.definitions[demoName];\n\n\t\t\tif (dojo.render.html.ie) {\n\t\t\t\tdojo.html.show(this.demoListWrapperNode) \n\t\t\t} else {\n\t\t\t\tdojo.lfx.html.fadeShow(this.demoListWrapperNode, 250).play();\n\t\t\t}\n\n\t\t\tvar newDemo = dojo.widget.createWidget(\"DemoItem\",{viewDemoImage: this.viewDemoImage, name: demoName, description: demo.description, thumbnail: demo.thumbnail});\n\t\t\tthis.demoListChildren.push(newDemo);\n\t\t\tthis.demoListContainerNode.appendChild(newDemo.domNode);\t\n\t\t\tdojo.event.connect(newDemo,\"onSelectDemo\",this,\"onSelectDemo\");","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.onSelectCategory":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tcatName = e.currentTarget.categoryName;\t\n\t\t\tdojo.debug(\"Selected Category: \" + catName);\n\t\t\t\/\/Remove current list of demos\n\t\t\tdojo.lang.forEach(this.demoListChildren, function(child) {\n\t\t\t\t\tchild.destroy();\n\t\t\t});\n\t\t\tthis.demoListChildren=[];\n\n\t\t\t\/\/add demos from this cat\n\t\t\tdojo.lang.forEach(this.registry.categories[catName].demos, dojo.lang.hitch(this,function(demoName){\n\t\t\t\tthis.addDemo(demoName);\n\t\t\t}));","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoNavigator.onSelectDemo":{"_":{"meta":{"summary":"","parameters":{"e":{"type":""}},"src":"\t\t\tif (dojo.render.html.ie) {\n\t\t\t\tdojo.debug(\"render ie\");\n\t\t\t\tdojo.html.hide(this.navigationContainer) ;\n\t\t\t\tthis.demoContainer.show();\n\t\t\t\tthis.demoContainer.showDemo();\n\t\t\t} else {\n\t\t\t\tdojo.debug(\"render non-ie\");\n\t\t\t\tdojo.lfx.html.fadeHide(this.navigationContainer,250,null,dojo.lang.hitch(this, function() {\n\t\t\t\t\tthis.demoContainer.show();\t\n\t\t\t\t\tthis.demoContainer.showDemo();\n\t\t\t\t})).play();\n\t\t\t}\n\n\t\t\tthis.demoContainer.loadDemo(this.registry.definitions[e.target.name].url);\n\t\t\tthis.demoContainer.setName(e.target.name);\n\t\t\tthis.demoContainer.setSummary(this.registry.definitions[e.target.name].description);","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.demoEngine.DemoPane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget"]},"methods":{"my.widget.demoEngine.DemoPane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":""}}}},"my.widget.demoEngine.DemoPane.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.addClass(this.domNode,this.domNodeClass);\n\t\t\tdojo.debug(\"PostCreate\");\n\t\t\tthis._launchDemo();","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.DemoPane._launchDemo":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.debug(\"Launching Demo\");\n\t\t\tdojo.debug(this.demoNode);\n\t\t\tthis.demoNode.src=this.href;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["demoNode.src","href"]}}},"my.widget.demoEngine.DemoPane.setHref":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\t\tthis.href = url;\n\t\t\tthis._launchDemo();","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.demoEngine.SourcePane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.io.*"]},"methods":{"my.widget.demoEngine.SourcePane":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":""}}}},"my.widget.demoEngine.SourcePane.postCreate":{"_":{"meta":{"summary":"","src":"\t\t\tdojo.html.addClass(this.domNode,this.domNodeClass);\n\t\t\tdojo.debug(\"PostCreate\");","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.SourcePane.getSource":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.href) {\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\turl: this.href,\n\t\t\t\t\tload: dojo.lang.hitch(this, \"fillInSource\"),\n\t\t\t\t\tmimetype: \"text\/plain\"\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.SourcePane.url":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.href) {\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\turl: this.href,\n\t\t\t\t\tload: dojo.lang.hitch(this, \"fillInSource\"),\n\t\t\t\t\tmimetype: \"text\/plain\"\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.SourcePane.load":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.href) {\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\turl: this.href,\n\t\t\t\t\tload: dojo.lang.hitch(this, \"fillInSource\"),\n\t\t\t\t\tmimetype: \"text\/plain\"\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.SourcePane.mimetype":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.href) {\n\t\t\t\tdojo.io.bind({\n\t\t\t\t\turl: this.href,\n\t\t\t\t\tload: dojo.lang.hitch(this, \"fillInSource\"),\n\t\t\t\t\tmimetype: \"text\/plain\"\n\t\t\t\t});\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"my.widget.demoEngine.SourcePane.fillInSource":{"_":{"meta":{"summary":"","parameters":{"type":{"type":""},"source":{"type":""},"e":{"type":""}},"src":"\t\t\tthis.sourceNode.value=source;","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["sourceNode.value","href"]}}},"my.widget.demoEngine.SourcePane.setHref":{"_":{"meta":{"summary":"","parameters":{"url":{"type":""}},"src":"\t\t\tthis.href = url;\n\t\t\tthis.getSource();","this":"dojo.widget.HtmlWidget"}}}}}},"dojo.widget.demoEngine._":{"meta":{"requires":{"browser":["dojo.widget.demoEngine.DemoItem","dojo.widget.demoEngine.DemoNavigator","dojo.widget.demoEngine.DemoPane","dojo.widget.demoEngine.SourcePane","dojo.widget.demoEngine.DemoContainer"]}}},"dojo.widget.html.Console":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.widget.Console","dojo.uri.Uri","dojo.widget.TabContainer","dojo.widget.ContentPane","dojo.xml.Parse","dojo.html","dojo.style"]},"methods":{"dojo.widget.html.Console":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget","dojo.widget.Console"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"tabs":"","debugTab":"","input":"","templatePath":"","templateCssPath":""},"this_variables":["domNode.style.height","tabs","domNode.style.width","domNode.style.height"]}}},"dojo.widget.html.Console.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"frag":{"type":""}},"src":"\t\tvar source = this.getFragNodeRef(frag);\n\t\tdojo.html.copyStyle(this.domNode, source);\n\t\tif(!this.domNode.style.height){\n\t\t\tthis.domNode.style.height = \"100%\";\n\t\t}\n\n\t\tvar parser = new dojo.xml.Parse();\n\t\tif(!this.debug){\n\t\t\tthis.debugTab.parentNode.removeChild(this.debugTab);\n\t\t}\n\t\tvar tabs = parser.parseElement(this.tabs);\n\t\tthis.tabs = dojo.widget.getParser().createComponents(tabs);","this":"dojo.widget.html.Console"}}},"dojo.widget.html.Console.resizeTo":{"_":{"meta":{"summary":"","parameters":{"w":{"type":""},"h":{"type":""}},"src":"\t\tthis.domNode.style.width = w + \"px\";\n\t\tthis.domNode.style.height = (h - 15) + \"px\";","this":"dojo.widget.html.Console"}}},"dojo.widget.html.Console.runCommand":{"_":{"meta":{"summary":"","parameters":{"event":{"type":"Event"}},"src":"\t\tvar key = event.keyCode;\n\t\tvar target = event.target;\n\t\tif(key == \"3\" || key == \"13\"){\n\t\t\tthis.printCommand(target.value);\n\t\t\n\t\t\tvar oldPrint = dojo.hostenv.println;\n\t\t\tif(this.debug){\n\t\t\t\tdojo.hostenv.println = this.printDebug;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar result = eval(\"(\" + target.value + \")\");\n\t\t\t}catch(e){\n\t\t\t\tvar result = eval(target.value);\n\t\t\t}\n\t\t\tif(typeof result == \"string\"){\n\t\t\t\tresult = '\"' + result.toString() + '\"';\n\t\t\t}else if(dojo.lang.isArray(result)){\n\t\t\t\tresult = '[' + result.toString() + ']';\n\t\t\t}\n\t\t\tdojo.hostenv.println = oldPrint;\n\t\t\tthis.printResult(result);\n\n\t\t\ttarget.value = \"\";\n\t\t}","this":"dojo.widget.html.Console"}}},"dojo.widget.html.Console.printDebug":{"_":{"meta":{"summary":"","parameters":{"line":{"type":"string"}},"src":"\t\tvar debugTab = dojo.widget.byId(\"debugTab\");\n\t\tdebugTab.domNode.innerHTML += '<div class=\"dojoConsoleDebug\">' + line + \"<\/div>\";","this":"dojo.widget.html.Console"}}},"dojo.widget.html.Console.printCommand":{"_":{"meta":{"summary":"","parameters":{"command":{"type":"string"}},"src":"\t\tvar resultsTab = dojo.widget.byId(\"resultsTab\");\n\t\tresultsTab.domNode.innerHTML += '<div class=\"dojoConsoleCommand\">>>> ' + command + \"<\/div>\";","this":"dojo.widget.html.Console"}}},"dojo.widget.html.Console.printResult":{"_":{"meta":{"summary":"","parameters":{"result":{"type":"string"}},"src":"\t\tif(result){\n\t\t\tvar resultsTab = dojo.widget.byId(\"resultsTab\");\n\t\t\tresultsTab.domNode.innerHTML += '<div class=\"dojoConsoleResult\">' + result + \"<\/div>\";\n\t\t}","this":"dojo.widget.html.Console"}}}}}},"dojo.widget.html.DocPane":{"meta":{"requires":{"common":["dojo.widget.*","dojo.io.*","dojo.event.*","dojo.widget.HtmlWidget","dojo.widget.DocPane","dojo.widget.Editor2","dojo.widget.Dialog","dojo.html.common","dojo.html.display"]},"methods":{"dojo.widget.html.DocPane":{"_":{"meta":{"summary":"","src":"\tdojo.event.topic.subscribe(\"\/docs\/function\/results\", this, \"onDocResults\");\n\tdojo.event.topic.subscribe(\"\/docs\/package\/results\", this, \"onPkgResults\");\n\tdojo.event.topic.subscribe(\"\/docs\/function\/detail\", this, \"onDocSelectFunction\");"}}}}}},"dojo.widget.html.layout":{"meta":{"requires":{"common":["dojo.lang","dojo.string.extras","dojo.html.style","dojo.html.layout"]},"methods":{"dojo.widget.html.layout":{"_":{"meta":{"summary":"","parameters":{"container":{"type":""},"children":{"type":""},"layoutPriority":{"type":""}},"src":"\tdojo.html.addClass(container, \"dojoLayoutContainer\");\n\n\t\/\/ Copy children array and remove elements w\/out layout.\n\t\/\/ Also record each child's position in the input array, for sorting purposes.\n\tchildren = dojo.lang.filter(children, function(child, idx){\n\t\tchild.idx = idx;\n\t\treturn dojo.lang.inArray([\"top\",\"bottom\",\"left\",\"right\",\"client\",\"flood\"], child.layoutAlign)\n\t});\n\n\t\/\/ Order the children according to layoutPriority.\n\t\/\/ Multiple children w\/the same layoutPriority will be sorted by their position in the input array.\n\tif(layoutPriority && layoutPriority!=\"none\"){\n\t\tvar rank = function(child){\n\t\t\tswitch(child.layoutAlign){\n\t\t\t\tcase \"flood\":\n\t\t\t\t\treturn 1;\n\t\t\t\tcase \"left\":\n\t\t\t\tcase \"right\":\n\t\t\t\t\treturn (layoutPriority==\"left-right\") ? 2 : 3;\n\t\t\t\tcase \"top\":\n\t\t\t\tcase \"bottom\":\n\t\t\t\t\treturn (layoutPriority==\"left-right\") ? 3 : 2;\n\t\t\t\tdefault:\n\t\t\t\t\treturn 4;\n\t\t\t}\n\t\t};\n\t\tchildren.sort(function(a,b){\n\t\t\treturn (rank(a)-rank(b)) || (a.idx - b.idx);\n\t\t});\n\t}\n\n\t\/\/ remaining space (blank area where nothing has been written)\n\tvar f={\n\t\ttop: dojo.html.getPixelValue(container, \"padding-top\", true),\n\t\tleft: dojo.html.getPixelValue(container, \"padding-left\", true)\n\t};\n\tdojo.lang.mixin(f, dojo.html.getContentBox(container));\n\n\t\/\/ set positions\/sizes\n\tdojo.lang.forEach(children, function(child){\n\t\tvar elm=child.domNode;\n\t\tvar pos=child.layoutAlign;\n\t\t\/\/ set elem to upper left corner of unused space; may move it later\n\t\twith(elm.style){\n\t\t\tleft = f.left+\"px\";\n\t\t\ttop = f.top+\"px\";\n\t\t\tbottom = \"auto\";\n\t\t\tright = \"auto\";\n\t\t}\n\t\tdojo.html.addClass(elm, \"dojoAlign\" + dojo.string.capitalize(pos));\n\n\t\t\/\/ set size && adjust record of remaining space.\n\t\t\/\/ note that setting the width of a <div> may affect it's height.\n\t\t\/\/ TODO: same is true for widgets but need to implement API to support that\n\t\tif ( (pos==\"top\")||(pos==\"bottom\") ) {\n\t\t\tdojo.html.setMarginBox(elm, { width: f.width });\n\t\t\tvar h = dojo.html.getMarginBox(elm).height;\n\t\t\tf.height -= h;\n\t\t\tif(pos==\"top\"){\n\t\t\t\tf.top += h;\n\t\t\t}else{\n\t\t\t\telm.style.top = f.top + f.height + \"px\";\n\t\t\t}\n\t\t}else if(pos==\"left\" || pos==\"right\"){\n\t\t\tdojo.html.setMarginBox(elm, { height: f.height });\n\t\t\tvar w = dojo.html.getMarginBox(elm).width;\n\t\t\tf.width -= w;\n\t\t\tif(pos==\"left\"){\n\t\t\t\tf.left += w;\n\t\t\t}else{\n\t\t\t\telm.style.left = f.left + f.width + \"px\";\n\t\t\t}\n\t\t} else if(pos==\"flood\" || pos==\"client\"){\n\t\t\tdojo.html.setMarginBox(elm, { width: f.width, height: f.height });\n\t\t}\n\t\t\n\t\t\/\/ TODO: for widgets I want to call resizeTo(), but for top\/bottom\n\t\t\/\/ alignment I only want to set the width, and have the size determined\n\t\t\/\/ dynamically.  (The thinner you make a div, the more height it consumes.)\n\t\tif(child.onResized){\n\t\t\tchild.onResized();\n\t\t}\n\t});"}}}}}},"dojo.widget.html.stabile":{"meta":{"methods":{"dojo.widget.html.stabile.getState":{"_":{"meta":{"summary":"","parameters":{"id":{"type":""}},"src":"\tdojo.widget.html.stabile.setup();\n\treturn dojo.widget.html.stabile.widgetState[id];"}}},"dojo.widget.html.stabile.setState":{"_":{"meta":{"summary":"","parameters":{"id":{"type":""},"state":{"type":""},"isCommit":{"type":""}},"src":"\tdojo.widget.html.stabile.setup();\n\tdojo.widget.html.stabile.widgetState[id] = state;\n\tif(isCommit){\n\t\tdojo.widget.html.stabile.commit(dojo.widget.html.stabile.widgetState);\n\t}"}}},"dojo.widget.html.stabile.setup":{"_":{"meta":{"summary":"","src":"\tif(!dojo.widget.html.stabile.widgetState){\n\t\tvar text = dojo.widget.html.stabile.getStorage().value;\n\t\tdojo.widget.html.stabile.widgetState = text ? dj_eval(\"(\"+text+\")\") : {};\n\t}"}}},"dojo.widget.html.stabile.commit":{"_":{"meta":{"summary":"","parameters":{"state":{"type":""}},"src":"\tdojo.widget.html.stabile.getStorage().value = dojo.widget.html.stabile.description(state);"}}},"dojo.widget.html.stabile.description":{"_":{"meta":{"summary":"","parameters":{"v":{"type":""},"showAll":{"type":""}},"src":"\tvar describeThis = function() {\n\t\t return this.description(this, true);\n\t} \n\t\n\ttry {\n\n\t\tif(v===void(0)){\n\t\t\treturn \"undefined\";\n\t\t}\n\t\tif(v===null){\n\t\t\treturn \"null\";\n\t\t}\n\t\tif(typeof(v)==\"boolean\" || typeof(v)==\"number\"\n\t\t    || v instanceof Boolean || v instanceof Number){\n\t\t\treturn v.toString();\n\t\t}\n\n\t\tif(typeof(v)==\"string\" || v instanceof String){\n\t\t\t\/\/ Quote strings and their contents as required.\n\t\t\t\/\/ Replacing by $& fails in IE 5.0\n\t\t\tvar v1 = v.replace(dojo.widget.html.stabile._sqQuotables, \"\\\\$1\"); \n\t\t\tv1 = v1.replace(\/\\n\/g, \"\\\\n\");\n\t\t\tv1 = v1.replace(\/\\r\/g, \"\\\\r\");\n\t\t\t\/\/ Any other important special cases?\n\t\t\treturn \"'\"+v1+\"'\";\n\t\t}\n\n\t\tif(v instanceof Date){\n\t\t\t\/\/ Create a data constructor.\n\t\t\treturn \"new Date(\"+d.getFullYear+\",\"+d.getMonth()+\",\"+d.getDate()+\")\";\n\t\t}\n\n\t\tvar d;\n\t\tif(v instanceof Array || v.push){\n\t\t\t\/\/ \"push\" test needed for KHTML\/Safari, don't know why -cp\n\n\t\t\tif(depth>=dojo.widget.html.stabile.depthLimit)\n\t\t\t  return \"[ ... ]\";\n\n\t\t\td = \"[\";\n\t\t\tvar first = true;\n\t\t\tdojo.widget.html.stabile._depth++;\n\t\t\tfor(var i=0; i<v.length; i++){\n\t\t\t\t\/\/ Skip functions and undefined values\n\t\t\t\t\/\/ if(v[i]==undef || typeof(v[i])==\"function\")\n\t\t\t\t\/\/   continue;\n\t\t\t\tif(first){\n\t\t\t\t\tfirst = false;\n\t\t\t\t}else{\n\t\t\t\t\td += \",\";\n\t\t\t\t}\n\t\t\t\td+=arguments.callee(v[i], showAll);\n\t\t\t}\n\t\t\treturn d+\"]\";\n\t\t}\n\n\t\tif(v.constructor==Object\n\t\t    || v.toString==describeThis){\n\t\t\tif(depth>=dojo.widget.html.stabile.depthLimit)\n\t\t\t  return \"{ ... }\";\n\n\t\t\t\/\/ Instanceof Hash is good, or if we just use Objects,\n\t\t\t\/\/ we can say v.constructor==Object.\n\t\t\t\/\/ IE (5?) lacks hasOwnProperty, but perhaps objects do not always\n\t\t\t\/\/ have prototypes??\n\t\t\tif(typeof(v.hasOwnProperty)!=\"function\" && v.prototype){\n\t\t\t\tthrow new Error(\"description: \"+v+\" not supported by script engine\");\n\t\t\t}\n\t\t\tvar first = true;\n\t\t\td = \"{\";\n\t\t\tdojo.widget.html.stabile._depth++;\n\t\t\tfor(var key in v){\n\t\t\t\t\/\/ Skip values that are functions or undefined.\n\t\t\t\tif(v[key]==void(0) || typeof(v[key])==\"function\")\n\t\t\t\t\tcontinue;\n\t\t\t\tif(first){\n\t\t\t\t\tfirst = false;\n\t\t\t\t}else{\n\t\t\t\t\td += \", \";\n\t\t\t\t}\n\t\t\t\tvar kd = key;\n\t\t\t\t\/\/ If the key is not a legal identifier, use its description.\n\t\t\t\t\/\/ For strings this will quote the stirng.\n\t\t\t\tif(!kd.match(\/^[a-zA-Z_][a-zA-Z0-9_]*$\/)){\n\t\t\t\t\tkd = arguments.callee(key, showAll);\n\t\t\t\t}\n\t\t\t\td += kd+\": \"+arguments.callee(v[key], showAll);\n\t\t\t}\n\t\t\treturn d+\"}\";\n\t\t}\n\n\t\tif(showAll){\n\t\t\tif(dojo.widget.html.stabile._recur){\n\t\t\t\t\/\/ Save the original definitions of toString;\n\t\t\t\tvar objectToString = Object.prototype.toString;\n\t\t\t\treturn objectToString.apply(v, []);\n\t\t\t}else{\n\t\t\t\tdojo.widget.html.stabile._recur = true;\n\t\t\t\treturn v.toString();\n\t\t\t}\n\t\t}else{\n\t\t\t\/\/ log(\"Description? \"+v.toString()+\", \"+typeof(v));\n\t\t\tthrow new Error(\"Unknown type: \"+v);\n\t\t\treturn \"'unknown'\";\n\t\t}\n\n\t} finally {\n\t\t\/\/ Always restore the global current depth.\n\t\tdojo.widget.html.stabile._depth = depth;\n\t}"}}},"dojo.widget.html.stabile.getStorage":{"_":{"meta":{"summary":"","src":"\tif (dojo.widget.html.stabile.dataField) {\n\t\treturn dojo.widget.html.stabile.dataField;\n\t}\n\tvar form = document.forms._dojo_form;\n\treturn dojo.widget.html.stabile.dataField = form ? form.stabile : {value: \"\"};"}}}}}},"dojo.widget.svg.Chart":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.Chart","dojo.math","dojo.html","dojo.svg","dojo.graphics.color"]},"methods":{"dojo.widget.svg.Chart":{"_":{"meta":{"summary":"","src":"\tdojo.widget.Chart.call(this);\n\tdojo.widget.HtmlWidget.call(this);","inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":"","_isInitialized":"","hasData":"","vectorNode":"","plotArea":"","dataGroup":"","axisGroup":"","properties":"","height":"","width":"","plotType":"","padding":"","top":"","bottom":"","left":"","right":"","axes":"","plotAt":"","label":"","unitLabel":"","unitType":"","nUnitsToShow":"","range":"","max":"","y":""},"this_variables":["properties.","properties.padding.top","properties.padding.right","properties.padding.bottom","properties.padding.left","properties.axes.x.range.min","properties.axes.x.range.max","properties.axes.y.range.min","properties.axes.y.range.max","properties.axes.x.range","properties.axes.y.range","properties.axes.x.plotAt","properties.axes.y.plotAt","vectorNode","plotArea","dataGroup","axisGroup","_isInitialized","properties.","properties.padding.top","properties.padding.right","properties.padding.bottom","properties.padding.left","properties.axes.x.range.min","properties.axes.x.range.max","properties.axes.y.range.min","properties.axes.y.range.max","properties.axes.x.range","properties.axes.y.range","properties.axes.x.plotAt","properties.axes.y.plotAt","vectorNode","plotArea","dataGroup","axisGroup","_isInitialized","properties.","properties.padding.top","properties.padding.right","properties.padding.bottom","properties.padding.left","properties.axes.x.range.min","properties.axes.x.range.max","properties.axes.y.range.min","properties.axes.y.range.max","properties.axes.x.range","properties.axes.y.range","properties.axes.x.plotAt","properties.axes.y.plotAt","vectorNode","plotArea","dataGroup","axisGroup","_isInitialized","vectorNode"]}}},"dojo.widget.svg.Chart.Plotter.getX":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""},"chart":{"type":""}},"src":"\t\tvar v=parseFloat(value);\n\t\tvar min=chart.properties.axes.x.range.min;\n\t\tvar max=chart.properties.axes.x.range.max;\n\t\tvar ofst=0-min;\n\t\tmin+=ofst; max+=ofst; v+=ofst;\n\n\t\tvar xmin=chart.properties.padding.left;\n\t\tvar xmax=chart.properties.width-chart.properties.padding.right;\n\t\tvar x=(v*((xmax-xmin)\/max))+xmin;\n\t\treturn x;"}}},"dojo.widget.svg.Chart.Plotter.getY":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""},"chart":{"type":""}},"src":"\t\tvar v=parseFloat(value);\n\t\tvar max=chart.properties.axes.y.range.max;\n\t\tvar min=chart.properties.axes.y.range.min;\n\t\tvar ofst=0;\n\t\tif(min<0)ofst+=Math.abs(min);\n\t\tmin+=ofst; max+=ofst; v+=ofst;\n\t\t\n\t\tvar ymin=chart.properties.height-chart.properties.padding.bottom;\n\t\tvar ymax=chart.properties.padding.top;\n\t\tvar y=(((ymin-ymax)\/(max-min))*(max-v))+ymax;\n\t\treturn y;"}}},"dojo.widget.svg.Chart.Plotter.addPlotter":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""},"func":{"type":""}},"src":"\t\tplotters[name]=func;"}}},"dojo.widget.svg.Chart.Plotter.plot":{"_":{"meta":{"summary":"","parameters":{"series":{"type":""},"chart":{"type":""}},"src":"\t\tif (series.values.length==0) return;\n\t\tif (series.plotType && plotters[series.plotType]){\n\t\t\treturn plotters[series.plotType](series, chart);\n\t\t}\n\t\telse if (chart.plotType && plotters[chart.plotType]){\n\t\t\treturn plotters[chart.plotType](series, chart);\n\t\t}"}}},"dojo.widget.svg.Chart.x":{"_":{"meta":{"summary":"","src":"\t\tthis.parseData();\n\t\n\t\t\/\/\tbegin by grabbing the table, and reading it in.\n\t\tvar table=this.domNode.getElementsByTagName(\"table\")[0];\n\t\tif (!table) return;\n\t\t\n\t\tvar bRangeX=false;\n\t\tvar bRangeY=false;\n\t\t\n\t\t\/\/\tproperties off the table\n\t\tif (table.getAttribute(\"width\")) this.properties.width=table.getAttribute(\"width\");\n\t\tif (table.getAttribute(\"height\")) this.properties.height=table.getAttribute(\"height\");\n\t\tif (table.getAttribute(\"plotType\")) this.properties.plotType=table.getAttribute(\"plotType\");\n\t\tif (table.getAttribute(\"padding\")){\n\t\t\tif (table.getAttribute(\"padding\").indexOf(\",\") > -1)\n\t\t\t\tvar p=table.getAttribute(\"padding\").split(\",\"); \n\t\t\telse var p=table.getAttribute(\"padding\").split(\" \");\n\t\t\tif (p.length==1){\n\t\t\t\tvar pad=parseFloat(p[0]);\n\t\t\t\tthis.properties.padding.top=pad;\n\t\t\t\tthis.properties.padding.right=pad;\n\t\t\t\tthis.properties.padding.bottom=pad;\n\t\t\t\tthis.properties.padding.left=pad;\n\t\t\t} else if(p.length==2){\n\t\t\t\tvar padV=parseFloat(p[0]);\n\t\t\t\tvar padH=parseFloat(p[1]);\n\t\t\t\tthis.properties.padding.top=padV;\n\t\t\t\tthis.properties.padding.right=padH;\n\t\t\t\tthis.properties.padding.bottom=padV;\n\t\t\t\tthis.properties.padding.left=padH;\n\t\t\t} else if(p.length==4){\n\t\t\t\tthis.properties.padding.top=parseFloat(p[0]);\n\t\t\t\tthis.properties.padding.right=parseFloat(p[1]);\n\t\t\t\tthis.properties.padding.bottom=parseFloat(p[2]);\n\t\t\t\tthis.properties.padding.left=parseFloat(p[3]);\n\t\t\t}\n\t\t}\n\t\tif (table.getAttribute(\"rangeX\")){\n\t\t\tvar p=table.getAttribute(\"rangeX\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\tthis.properties.axes.x.range.min=parseFloat(p[0]);\n\t\t\tthis.properties.axes.x.range.max=parseFloat(p[1]);\n\t\t\tbRangeX=true;\n\t\t}\n\t\tif (table.getAttribute(\"rangeY\")){\n\t\t\tvar p=table.getAttribute(\"rangeY\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\tthis.properties.axes.y.range.min=parseFloat(p[0]);\n\t\t\tthis.properties.axes.y.range.max=parseFloat(p[1]);\n\t\t\tbRangeY=true;\n\t\t}\n\n\t\tvar thead=table.getElementsByTagName(\"thead\")[0];\n\t\tvar tbody=table.getElementsByTagName(\"tbody\")[0];\n\t\tif(!(thead&&tbody)) dojo.raise(\"dojo.widget.Chart: supplied table must define a head and a body.\");\n\n\t\t\/\/\tset up the series.\n\t\tvar columns=thead.getElementsByTagName(\"tr\")[0].getElementsByTagName(\"th\");\t\/\/\tshould be <tr><..>\n\t\t\n\t\t\/\/\tassume column 0 == X\n\t\tfor (var i=1; i<columns.length; i++){\n\t\t\tvar key=\"column\"+i;\n\t\t\tvar label=columns[i].innerHTML;\n\t\t\tvar plotType=columns[i].getAttribute(\"plotType\")||\"line\";\n\t\t\tvar color=columns[i].getAttribute(\"color\");\n\t\t\tvar ds=new dojo.widget.Chart.DataSeries(key,label,plotType,color);\n\t\t\tthis.series.push(ds);\n\t\t}\n\n\t\t\/\/\tok, get the values.\n\t\tvar rows=tbody.getElementsByTagName(\"tr\");\n\t\tvar xMin=Number.MAX_VALUE,xMax=Number.MIN_VALUE;\n\t\tvar yMin=Number.MAX_VALUE,yMax=Number.MIN_VALUE;\n\t\tvar ignore = [\n\t\t\t\"accesskey\",\"align\",\"bgcolor\",\"class\",\n\t\t\t\"colspan\",\"height\",\"id\",\"nowrap\",\n\t\t\t\"rowspan\",\"style\",\"tabindex\",\"title\",\n\t\t\t\"valign\",\"width\"\n\t\t];\n\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row=rows[i];\n\t\t\tvar cells=row.getElementsByTagName(\"td\");\n\t\t\tvar x=Number.MIN_VALUE;\n\t\t\tfor (var j=0; j<cells.length; j++){\n\t\t\t\tif (j==0){\n\t\t\t\t\tx=parseFloat(cells[j].innerHTML);\n\t\t\t\t\txMin=Math.min(xMin, x);\n\t\t\t\t\txMax=Math.max(xMax, x);\n\t\t\t\t} else {\n\t\t\t\t\tvar ds=this.series[j-1];\n\t\t\t\t\tvar y=parseFloat(cells[j].innerHTML);\n\t\t\t\t\tyMin=Math.min(yMin,y);\n\t\t\t\t\tyMax=Math.max(yMax,y);\n\t\t\t\t\tvar o={x:x, value:y};\n\t\t\t\t\tvar attrs=cells[j].attributes;\n\t\t\t\t\tfor(var k=0; k<attrs.length; k++){\n\t\t\t\t\t\tvar attr=attrs.item(k);\n\t\t\t\t\t\tvar bIgnore=false;\n\t\t\t\t\t\tfor (var l=0; l<ignore.length; l++){\n\t\t\t\t\t\t\tif (attr.nodeName.toLowerCase()==ignore[l]){\n\t\t\t\t\t\t\t\tbIgnore=true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!bIgnore) o[attr.nodeName]=attr.nodeValue;\n\t\t\t\t\t}\n\t\t\t\t\tds.add(o);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tfix the axes\n\t\tif(!bRangeX){\n\t\t\tthis.properties.axes.x.range={min:xMin, max:xMax};\n\t\t}\n\t\tif(!bRangeY){\n\t\t\tthis.properties.axes.y.range={min:yMin, max:yMax};\n\t\t}\n\n\t\t\/\/\twhere to plot the axes\n\t\tif (table.getAttribute(\"axisAt\")){\n\t\t\tvar p=table.getAttribute(\"axisAt\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\t\n\t\t\t\/\/\tx axis\n\t\t\tif (!isNaN(parseFloat(p[0]))){\n\t\t\t\tthis.properties.axes.x.plotAt=parseFloat(p[0]);\n\t\t\t} else if (p[0].toLowerCase()==\"ymin\"){\n\t\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.min;\n\t\t\t} else if (p[0].toLowerCase()==\"ymax\"){\n\t\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.max;\n\t\t\t}\n\n\t\t\t\/\/ y axis\n\t\t\tif (!isNaN(parseFloat(p[1]))){\n\t\t\t\tthis.properties.axes.y.plotAt=parseFloat(p[1]);\n\t\t\t} else if (p[1].toLowerCase()==\"xmin\"){\n\t\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.min;\n\t\t\t} else if (p[1].toLowerCase()==\"xmax\"){\n\t\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.max;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.min;\n\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.min;\n\t\t}\n\n\t\t\/\/\ttable values should be populated, now pop it off.\n\t\tthis.domNode.removeChild(table);\n\n\t\t\/\/\tget the width and the height.\n\/\/\t\tthis.properties.width=dojo.html.getInnerWidth(this.domNode);\n\/\/\t\tthis.properties.height=dojo.html.getInnerHeight(this.domNode);\n\n\t\t\/\/ ok, lets create the chart itself.\n\t\tdojo.svg.g.suspend();\t\t\n\t\tif(this.vectorNode) this.destroy();\n\t\tthis.vectorNode=document.createElementNS(dojo.svg.xmlns.svg, \"svg\");\n\t\tthis.vectorNode.setAttribute(\"width\", this.properties.width);\n\t\tthis.vectorNode.setAttribute(\"height\", this.properties.height);\n\n\t\t\/\/\tset up the clip path for the plot area.\n\t\tvar defs = document.createElementNS(dojo.svg.xmlns.svg, \"defs\");\n\t\tvar clip = document.createElementNS(dojo.svg.xmlns.svg, \"clipPath\");\n\t\tclip.setAttribute(\"id\",\"plotClip\"+this.widgetId);\n\t\tvar rect = document.createElementNS(dojo.svg.xmlns.svg, \"rect\");\t\t\n\t\trect.setAttribute(\"x\", this.properties.padding.left);\n\t\trect.setAttribute(\"y\", this.properties.padding.top);\n\t\trect.setAttribute(\"width\", this.properties.width-this.properties.padding.left-this.properties.padding.right);\n\t\trect.setAttribute(\"height\", this.properties.height-this.properties.padding.bottom-this.properties.padding.bottom);\n\t\tclip.appendChild(rect);\n\t\tdefs.appendChild(clip);\n\t\tthis.vectorNode.appendChild(defs);\n\n\t\t\/\/\tthe plot background.\n\t\tthis.plotArea = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.vectorNode.appendChild(this.plotArea);\n\t\tvar rect = document.createElementNS(dojo.svg.xmlns.svg, \"rect\");\t\t\n\t\trect.setAttribute(\"x\", this.properties.padding.left);\n\t\trect.setAttribute(\"y\", this.properties.padding.top);\n\t\trect.setAttribute(\"width\", this.properties.width-this.properties.padding.left-this.properties.padding.right);\n\t\trect.setAttribute(\"height\", this.properties.height-this.properties.padding.bottom-this.properties.padding.bottom);\n\t\trect.setAttribute(\"fill\", \"#fff\");\n\t\tthis.plotArea.appendChild(rect);\n\n\t\t\/\/\tdata group\n\t\tthis.dataGroup = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.dataGroup.setAttribute(\"style\",\"clip-path:url(#plotClip\"+this.widgetId+\");\");\n\t\tthis.plotArea.appendChild(this.dataGroup);\n\n\t\t\/\/\taxis group\n\t\tthis.axisGroup = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.plotArea.appendChild(this.axisGroup);\n\n\t\t\/\/\tx axis\n\t\tvar stroke=1;\n\t\tvar line = document.createElementNS(dojo.svg.xmlns.svg, \"line\");\n\t\tvar y=dojo.widget.svg.Chart.Plotter.getY(this.properties.axes.x.plotAt, this);\n\t\tline.setAttribute(\"y1\", y);\n\t\tline.setAttribute(\"y2\", y);\n\t\tline.setAttribute(\"x1\",this.properties.padding.left-stroke);\n\t\tline.setAttribute(\"x2\",this.properties.width-this.properties.padding.right);\n\t\tline.setAttribute(\"style\",\"stroke:#000;stroke-width:\"+stroke+\";\");\n\t\tthis.axisGroup.appendChild(line);\n\t\t\n\t\t\/\/\tx axis units.\n\t\t\/\/\t(min and max)\n\t\tvar textSize=10;\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left);\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom+textSize+2);\n\t\ttext.setAttribute(\"style\", \"text-anchor:middle;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.x.range.min),2)));\n\t\tthis.axisGroup.appendChild(text);\n\t\t\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.width-this.properties.padding.right-(textSize\/2));\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom+textSize+2);\n\t\ttext.setAttribute(\"style\", \"text-anchor:middle;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.x.range.max),2)));\n\t\tthis.axisGroup.appendChild(text);\t\n\t\t\n\t\t\/\/\ty axis\n\t\tvar line=document.createElementNS(dojo.svg.xmlns.svg, \"line\");\n\t\tvar x=dojo.widget.svg.Chart.Plotter.getX(this.properties.axes.y.plotAt, this);\n\t\tline.setAttribute(\"x1\", x);\n\t\tline.setAttribute(\"x2\", x);\n\t\tline.setAttribute(\"y1\", this.properties.padding.top);\n\t\tline.setAttribute(\"y2\", this.properties.height-this.properties.padding.bottom);\n\t\tline.setAttribute(\"style\", \"stroke:#000;stroke-width:\"+stroke+\";\");\n\t\tthis.axisGroup.appendChild(line);\n\n\t\t\/\/\ty axis units\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left-4);\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom);\n\t\ttext.setAttribute(\"style\", \"text-anchor:end;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.y.range.min),2)));\n\t\tthis.axisGroup.appendChild(text);\n\t\t\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left-4);\n\t\ttext.setAttribute(\"y\", this.properties.padding.top+(textSize\/2));\n\t\ttext.setAttribute(\"style\", \"text-anchor:end;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.y.range.max),2)));\n\t\tthis.axisGroup.appendChild(text);\t\n\n\t\tthis.domNode.appendChild(this.vectorNode);\n\t\tdojo.svg.g.resume();\n\n\t\t\/\/\tthis is last.\n\t\tthis.assignColors();\n\t\tthis._isInitialized=true;","this":"dojo.widget.svg.Chart"}}},"dojo.widget.svg.Chart.min":{"_":{"meta":{"summary":"","src":"\t\tthis.parseData();\n\t\n\t\t\/\/\tbegin by grabbing the table, and reading it in.\n\t\tvar table=this.domNode.getElementsByTagName(\"table\")[0];\n\t\tif (!table) return;\n\t\t\n\t\tvar bRangeX=false;\n\t\tvar bRangeY=false;\n\t\t\n\t\t\/\/\tproperties off the table\n\t\tif (table.getAttribute(\"width\")) this.properties.width=table.getAttribute(\"width\");\n\t\tif (table.getAttribute(\"height\")) this.properties.height=table.getAttribute(\"height\");\n\t\tif (table.getAttribute(\"plotType\")) this.properties.plotType=table.getAttribute(\"plotType\");\n\t\tif (table.getAttribute(\"padding\")){\n\t\t\tif (table.getAttribute(\"padding\").indexOf(\",\") > -1)\n\t\t\t\tvar p=table.getAttribute(\"padding\").split(\",\"); \n\t\t\telse var p=table.getAttribute(\"padding\").split(\" \");\n\t\t\tif (p.length==1){\n\t\t\t\tvar pad=parseFloat(p[0]);\n\t\t\t\tthis.properties.padding.top=pad;\n\t\t\t\tthis.properties.padding.right=pad;\n\t\t\t\tthis.properties.padding.bottom=pad;\n\t\t\t\tthis.properties.padding.left=pad;\n\t\t\t} else if(p.length==2){\n\t\t\t\tvar padV=parseFloat(p[0]);\n\t\t\t\tvar padH=parseFloat(p[1]);\n\t\t\t\tthis.properties.padding.top=padV;\n\t\t\t\tthis.properties.padding.right=padH;\n\t\t\t\tthis.properties.padding.bottom=padV;\n\t\t\t\tthis.properties.padding.left=padH;\n\t\t\t} else if(p.length==4){\n\t\t\t\tthis.properties.padding.top=parseFloat(p[0]);\n\t\t\t\tthis.properties.padding.right=parseFloat(p[1]);\n\t\t\t\tthis.properties.padding.bottom=parseFloat(p[2]);\n\t\t\t\tthis.properties.padding.left=parseFloat(p[3]);\n\t\t\t}\n\t\t}\n\t\tif (table.getAttribute(\"rangeX\")){\n\t\t\tvar p=table.getAttribute(\"rangeX\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\tthis.properties.axes.x.range.min=parseFloat(p[0]);\n\t\t\tthis.properties.axes.x.range.max=parseFloat(p[1]);\n\t\t\tbRangeX=true;\n\t\t}\n\t\tif (table.getAttribute(\"rangeY\")){\n\t\t\tvar p=table.getAttribute(\"rangeY\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\tthis.properties.axes.y.range.min=parseFloat(p[0]);\n\t\t\tthis.properties.axes.y.range.max=parseFloat(p[1]);\n\t\t\tbRangeY=true;\n\t\t}\n\n\t\tvar thead=table.getElementsByTagName(\"thead\")[0];\n\t\tvar tbody=table.getElementsByTagName(\"tbody\")[0];\n\t\tif(!(thead&&tbody)) dojo.raise(\"dojo.widget.Chart: supplied table must define a head and a body.\");\n\n\t\t\/\/\tset up the series.\n\t\tvar columns=thead.getElementsByTagName(\"tr\")[0].getElementsByTagName(\"th\");\t\/\/\tshould be <tr><..>\n\t\t\n\t\t\/\/\tassume column 0 == X\n\t\tfor (var i=1; i<columns.length; i++){\n\t\t\tvar key=\"column\"+i;\n\t\t\tvar label=columns[i].innerHTML;\n\t\t\tvar plotType=columns[i].getAttribute(\"plotType\")||\"line\";\n\t\t\tvar color=columns[i].getAttribute(\"color\");\n\t\t\tvar ds=new dojo.widget.Chart.DataSeries(key,label,plotType,color);\n\t\t\tthis.series.push(ds);\n\t\t}\n\n\t\t\/\/\tok, get the values.\n\t\tvar rows=tbody.getElementsByTagName(\"tr\");\n\t\tvar xMin=Number.MAX_VALUE,xMax=Number.MIN_VALUE;\n\t\tvar yMin=Number.MAX_VALUE,yMax=Number.MIN_VALUE;\n\t\tvar ignore = [\n\t\t\t\"accesskey\",\"align\",\"bgcolor\",\"class\",\n\t\t\t\"colspan\",\"height\",\"id\",\"nowrap\",\n\t\t\t\"rowspan\",\"style\",\"tabindex\",\"title\",\n\t\t\t\"valign\",\"width\"\n\t\t];\n\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row=rows[i];\n\t\t\tvar cells=row.getElementsByTagName(\"td\");\n\t\t\tvar x=Number.MIN_VALUE;\n\t\t\tfor (var j=0; j<cells.length; j++){\n\t\t\t\tif (j==0){\n\t\t\t\t\tx=parseFloat(cells[j].innerHTML);\n\t\t\t\t\txMin=Math.min(xMin, x);\n\t\t\t\t\txMax=Math.max(xMax, x);\n\t\t\t\t} else {\n\t\t\t\t\tvar ds=this.series[j-1];\n\t\t\t\t\tvar y=parseFloat(cells[j].innerHTML);\n\t\t\t\t\tyMin=Math.min(yMin,y);\n\t\t\t\t\tyMax=Math.max(yMax,y);\n\t\t\t\t\tvar o={x:x, value:y};\n\t\t\t\t\tvar attrs=cells[j].attributes;\n\t\t\t\t\tfor(var k=0; k<attrs.length; k++){\n\t\t\t\t\t\tvar attr=attrs.item(k);\n\t\t\t\t\t\tvar bIgnore=false;\n\t\t\t\t\t\tfor (var l=0; l<ignore.length; l++){\n\t\t\t\t\t\t\tif (attr.nodeName.toLowerCase()==ignore[l]){\n\t\t\t\t\t\t\t\tbIgnore=true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!bIgnore) o[attr.nodeName]=attr.nodeValue;\n\t\t\t\t\t}\n\t\t\t\t\tds.add(o);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tfix the axes\n\t\tif(!bRangeX){\n\t\t\tthis.properties.axes.x.range={min:xMin, max:xMax};\n\t\t}\n\t\tif(!bRangeY){\n\t\t\tthis.properties.axes.y.range={min:yMin, max:yMax};\n\t\t}\n\n\t\t\/\/\twhere to plot the axes\n\t\tif (table.getAttribute(\"axisAt\")){\n\t\t\tvar p=table.getAttribute(\"axisAt\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\t\n\t\t\t\/\/\tx axis\n\t\t\tif (!isNaN(parseFloat(p[0]))){\n\t\t\t\tthis.properties.axes.x.plotAt=parseFloat(p[0]);\n\t\t\t} else if (p[0].toLowerCase()==\"ymin\"){\n\t\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.min;\n\t\t\t} else if (p[0].toLowerCase()==\"ymax\"){\n\t\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.max;\n\t\t\t}\n\n\t\t\t\/\/ y axis\n\t\t\tif (!isNaN(parseFloat(p[1]))){\n\t\t\t\tthis.properties.axes.y.plotAt=parseFloat(p[1]);\n\t\t\t} else if (p[1].toLowerCase()==\"xmin\"){\n\t\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.min;\n\t\t\t} else if (p[1].toLowerCase()==\"xmax\"){\n\t\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.max;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.min;\n\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.min;\n\t\t}\n\n\t\t\/\/\ttable values should be populated, now pop it off.\n\t\tthis.domNode.removeChild(table);\n\n\t\t\/\/\tget the width and the height.\n\/\/\t\tthis.properties.width=dojo.html.getInnerWidth(this.domNode);\n\/\/\t\tthis.properties.height=dojo.html.getInnerHeight(this.domNode);\n\n\t\t\/\/ ok, lets create the chart itself.\n\t\tdojo.svg.g.suspend();\t\t\n\t\tif(this.vectorNode) this.destroy();\n\t\tthis.vectorNode=document.createElementNS(dojo.svg.xmlns.svg, \"svg\");\n\t\tthis.vectorNode.setAttribute(\"width\", this.properties.width);\n\t\tthis.vectorNode.setAttribute(\"height\", this.properties.height);\n\n\t\t\/\/\tset up the clip path for the plot area.\n\t\tvar defs = document.createElementNS(dojo.svg.xmlns.svg, \"defs\");\n\t\tvar clip = document.createElementNS(dojo.svg.xmlns.svg, \"clipPath\");\n\t\tclip.setAttribute(\"id\",\"plotClip\"+this.widgetId);\n\t\tvar rect = document.createElementNS(dojo.svg.xmlns.svg, \"rect\");\t\t\n\t\trect.setAttribute(\"x\", this.properties.padding.left);\n\t\trect.setAttribute(\"y\", this.properties.padding.top);\n\t\trect.setAttribute(\"width\", this.properties.width-this.properties.padding.left-this.properties.padding.right);\n\t\trect.setAttribute(\"height\", this.properties.height-this.properties.padding.bottom-this.properties.padding.bottom);\n\t\tclip.appendChild(rect);\n\t\tdefs.appendChild(clip);\n\t\tthis.vectorNode.appendChild(defs);\n\n\t\t\/\/\tthe plot background.\n\t\tthis.plotArea = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.vectorNode.appendChild(this.plotArea);\n\t\tvar rect = document.createElementNS(dojo.svg.xmlns.svg, \"rect\");\t\t\n\t\trect.setAttribute(\"x\", this.properties.padding.left);\n\t\trect.setAttribute(\"y\", this.properties.padding.top);\n\t\trect.setAttribute(\"width\", this.properties.width-this.properties.padding.left-this.properties.padding.right);\n\t\trect.setAttribute(\"height\", this.properties.height-this.properties.padding.bottom-this.properties.padding.bottom);\n\t\trect.setAttribute(\"fill\", \"#fff\");\n\t\tthis.plotArea.appendChild(rect);\n\n\t\t\/\/\tdata group\n\t\tthis.dataGroup = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.dataGroup.setAttribute(\"style\",\"clip-path:url(#plotClip\"+this.widgetId+\");\");\n\t\tthis.plotArea.appendChild(this.dataGroup);\n\n\t\t\/\/\taxis group\n\t\tthis.axisGroup = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.plotArea.appendChild(this.axisGroup);\n\n\t\t\/\/\tx axis\n\t\tvar stroke=1;\n\t\tvar line = document.createElementNS(dojo.svg.xmlns.svg, \"line\");\n\t\tvar y=dojo.widget.svg.Chart.Plotter.getY(this.properties.axes.x.plotAt, this);\n\t\tline.setAttribute(\"y1\", y);\n\t\tline.setAttribute(\"y2\", y);\n\t\tline.setAttribute(\"x1\",this.properties.padding.left-stroke);\n\t\tline.setAttribute(\"x2\",this.properties.width-this.properties.padding.right);\n\t\tline.setAttribute(\"style\",\"stroke:#000;stroke-width:\"+stroke+\";\");\n\t\tthis.axisGroup.appendChild(line);\n\t\t\n\t\t\/\/\tx axis units.\n\t\t\/\/\t(min and max)\n\t\tvar textSize=10;\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left);\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom+textSize+2);\n\t\ttext.setAttribute(\"style\", \"text-anchor:middle;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.x.range.min),2)));\n\t\tthis.axisGroup.appendChild(text);\n\t\t\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.width-this.properties.padding.right-(textSize\/2));\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom+textSize+2);\n\t\ttext.setAttribute(\"style\", \"text-anchor:middle;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.x.range.max),2)));\n\t\tthis.axisGroup.appendChild(text);\t\n\t\t\n\t\t\/\/\ty axis\n\t\tvar line=document.createElementNS(dojo.svg.xmlns.svg, \"line\");\n\t\tvar x=dojo.widget.svg.Chart.Plotter.getX(this.properties.axes.y.plotAt, this);\n\t\tline.setAttribute(\"x1\", x);\n\t\tline.setAttribute(\"x2\", x);\n\t\tline.setAttribute(\"y1\", this.properties.padding.top);\n\t\tline.setAttribute(\"y2\", this.properties.height-this.properties.padding.bottom);\n\t\tline.setAttribute(\"style\", \"stroke:#000;stroke-width:\"+stroke+\";\");\n\t\tthis.axisGroup.appendChild(line);\n\n\t\t\/\/\ty axis units\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left-4);\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom);\n\t\ttext.setAttribute(\"style\", \"text-anchor:end;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.y.range.min),2)));\n\t\tthis.axisGroup.appendChild(text);\n\t\t\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left-4);\n\t\ttext.setAttribute(\"y\", this.properties.padding.top+(textSize\/2));\n\t\ttext.setAttribute(\"style\", \"text-anchor:end;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.y.range.max),2)));\n\t\tthis.axisGroup.appendChild(text);\t\n\n\t\tthis.domNode.appendChild(this.vectorNode);\n\t\tdojo.svg.g.resume();\n\n\t\t\/\/\tthis is last.\n\t\tthis.assignColors();\n\t\tthis._isInitialized=true;","this":"dojo.widget.svg.Chart"}}},"dojo.widget.svg.Chart.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"rag":{"type":""}},"src":"\t\tthis.initialize();\n\t\tthis.render();","this":"dojo.widget.svg.Chart"}}},"dojo.widget.svg.Chart.parseData":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.svg.Chart"}}},"dojo.widget.svg.Chart.initialize":{"_":{"meta":{"summary":"","src":"\t\tthis.parseData();\n\t\n\t\t\/\/\tbegin by grabbing the table, and reading it in.\n\t\tvar table=this.domNode.getElementsByTagName(\"table\")[0];\n\t\tif (!table) return;\n\t\t\n\t\tvar bRangeX=false;\n\t\tvar bRangeY=false;\n\t\t\n\t\t\/\/\tproperties off the table\n\t\tif (table.getAttribute(\"width\")) this.properties.width=table.getAttribute(\"width\");\n\t\tif (table.getAttribute(\"height\")) this.properties.height=table.getAttribute(\"height\");\n\t\tif (table.getAttribute(\"plotType\")) this.properties.plotType=table.getAttribute(\"plotType\");\n\t\tif (table.getAttribute(\"padding\")){\n\t\t\tif (table.getAttribute(\"padding\").indexOf(\",\") > -1)\n\t\t\t\tvar p=table.getAttribute(\"padding\").split(\",\"); \n\t\t\telse var p=table.getAttribute(\"padding\").split(\" \");\n\t\t\tif (p.length==1){\n\t\t\t\tvar pad=parseFloat(p[0]);\n\t\t\t\tthis.properties.padding.top=pad;\n\t\t\t\tthis.properties.padding.right=pad;\n\t\t\t\tthis.properties.padding.bottom=pad;\n\t\t\t\tthis.properties.padding.left=pad;\n\t\t\t} else if(p.length==2){\n\t\t\t\tvar padV=parseFloat(p[0]);\n\t\t\t\tvar padH=parseFloat(p[1]);\n\t\t\t\tthis.properties.padding.top=padV;\n\t\t\t\tthis.properties.padding.right=padH;\n\t\t\t\tthis.properties.padding.bottom=padV;\n\t\t\t\tthis.properties.padding.left=padH;\n\t\t\t} else if(p.length==4){\n\t\t\t\tthis.properties.padding.top=parseFloat(p[0]);\n\t\t\t\tthis.properties.padding.right=parseFloat(p[1]);\n\t\t\t\tthis.properties.padding.bottom=parseFloat(p[2]);\n\t\t\t\tthis.properties.padding.left=parseFloat(p[3]);\n\t\t\t}\n\t\t}\n\t\tif (table.getAttribute(\"rangeX\")){\n\t\t\tvar p=table.getAttribute(\"rangeX\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\tthis.properties.axes.x.range.min=parseFloat(p[0]);\n\t\t\tthis.properties.axes.x.range.max=parseFloat(p[1]);\n\t\t\tbRangeX=true;\n\t\t}\n\t\tif (table.getAttribute(\"rangeY\")){\n\t\t\tvar p=table.getAttribute(\"rangeY\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\tthis.properties.axes.y.range.min=parseFloat(p[0]);\n\t\t\tthis.properties.axes.y.range.max=parseFloat(p[1]);\n\t\t\tbRangeY=true;\n\t\t}\n\n\t\tvar thead=table.getElementsByTagName(\"thead\")[0];\n\t\tvar tbody=table.getElementsByTagName(\"tbody\")[0];\n\t\tif(!(thead&&tbody)) dojo.raise(\"dojo.widget.Chart: supplied table must define a head and a body.\");\n\n\t\t\/\/\tset up the series.\n\t\tvar columns=thead.getElementsByTagName(\"tr\")[0].getElementsByTagName(\"th\");\t\/\/\tshould be <tr><..>\n\t\t\n\t\t\/\/\tassume column 0 == X\n\t\tfor (var i=1; i<columns.length; i++){\n\t\t\tvar key=\"column\"+i;\n\t\t\tvar label=columns[i].innerHTML;\n\t\t\tvar plotType=columns[i].getAttribute(\"plotType\")||\"line\";\n\t\t\tvar color=columns[i].getAttribute(\"color\");\n\t\t\tvar ds=new dojo.widget.Chart.DataSeries(key,label,plotType,color);\n\t\t\tthis.series.push(ds);\n\t\t}\n\n\t\t\/\/\tok, get the values.\n\t\tvar rows=tbody.getElementsByTagName(\"tr\");\n\t\tvar xMin=Number.MAX_VALUE,xMax=Number.MIN_VALUE;\n\t\tvar yMin=Number.MAX_VALUE,yMax=Number.MIN_VALUE;\n\t\tvar ignore = [\n\t\t\t\"accesskey\",\"align\",\"bgcolor\",\"class\",\n\t\t\t\"colspan\",\"height\",\"id\",\"nowrap\",\n\t\t\t\"rowspan\",\"style\",\"tabindex\",\"title\",\n\t\t\t\"valign\",\"width\"\n\t\t];\n\n\t\tfor(var i=0; i<rows.length; i++){\n\t\t\tvar row=rows[i];\n\t\t\tvar cells=row.getElementsByTagName(\"td\");\n\t\t\tvar x=Number.MIN_VALUE;\n\t\t\tfor (var j=0; j<cells.length; j++){\n\t\t\t\tif (j==0){\n\t\t\t\t\tx=parseFloat(cells[j].innerHTML);\n\t\t\t\t\txMin=Math.min(xMin, x);\n\t\t\t\t\txMax=Math.max(xMax, x);\n\t\t\t\t} else {\n\t\t\t\t\tvar ds=this.series[j-1];\n\t\t\t\t\tvar y=parseFloat(cells[j].innerHTML);\n\t\t\t\t\tyMin=Math.min(yMin,y);\n\t\t\t\t\tyMax=Math.max(yMax,y);\n\t\t\t\t\tvar o={x:x, value:y};\n\t\t\t\t\tvar attrs=cells[j].attributes;\n\t\t\t\t\tfor(var k=0; k<attrs.length; k++){\n\t\t\t\t\t\tvar attr=attrs.item(k);\n\t\t\t\t\t\tvar bIgnore=false;\n\t\t\t\t\t\tfor (var l=0; l<ignore.length; l++){\n\t\t\t\t\t\t\tif (attr.nodeName.toLowerCase()==ignore[l]){\n\t\t\t\t\t\t\t\tbIgnore=true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(!bIgnore) o[attr.nodeName]=attr.nodeValue;\n\t\t\t\t\t}\n\t\t\t\t\tds.add(o);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t\/\/\tfix the axes\n\t\tif(!bRangeX){\n\t\t\tthis.properties.axes.x.range={min:xMin, max:xMax};\n\t\t}\n\t\tif(!bRangeY){\n\t\t\tthis.properties.axes.y.range={min:yMin, max:yMax};\n\t\t}\n\n\t\t\/\/\twhere to plot the axes\n\t\tif (table.getAttribute(\"axisAt\")){\n\t\t\tvar p=table.getAttribute(\"axisAt\");\n\t\t\tif (p.indexOf(\",\")>-1) p=p.split(\",\");\n\t\t\telse p=p.split(\" \");\n\t\t\t\n\t\t\t\/\/\tx axis\n\t\t\tif (!isNaN(parseFloat(p[0]))){\n\t\t\t\tthis.properties.axes.x.plotAt=parseFloat(p[0]);\n\t\t\t} else if (p[0].toLowerCase()==\"ymin\"){\n\t\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.min;\n\t\t\t} else if (p[0].toLowerCase()==\"ymax\"){\n\t\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.max;\n\t\t\t}\n\n\t\t\t\/\/ y axis\n\t\t\tif (!isNaN(parseFloat(p[1]))){\n\t\t\t\tthis.properties.axes.y.plotAt=parseFloat(p[1]);\n\t\t\t} else if (p[1].toLowerCase()==\"xmin\"){\n\t\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.min;\n\t\t\t} else if (p[1].toLowerCase()==\"xmax\"){\n\t\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.max;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.properties.axes.x.plotAt=this.properties.axes.y.range.min;\n\t\t\tthis.properties.axes.y.plotAt=this.properties.axes.x.range.min;\n\t\t}\n\n\t\t\/\/\ttable values should be populated, now pop it off.\n\t\tthis.domNode.removeChild(table);\n\n\t\t\/\/\tget the width and the height.\n\/\/\t\tthis.properties.width=dojo.html.getInnerWidth(this.domNode);\n\/\/\t\tthis.properties.height=dojo.html.getInnerHeight(this.domNode);\n\n\t\t\/\/ ok, lets create the chart itself.\n\t\tdojo.svg.g.suspend();\t\t\n\t\tif(this.vectorNode) this.destroy();\n\t\tthis.vectorNode=document.createElementNS(dojo.svg.xmlns.svg, \"svg\");\n\t\tthis.vectorNode.setAttribute(\"width\", this.properties.width);\n\t\tthis.vectorNode.setAttribute(\"height\", this.properties.height);\n\n\t\t\/\/\tset up the clip path for the plot area.\n\t\tvar defs = document.createElementNS(dojo.svg.xmlns.svg, \"defs\");\n\t\tvar clip = document.createElementNS(dojo.svg.xmlns.svg, \"clipPath\");\n\t\tclip.setAttribute(\"id\",\"plotClip\"+this.widgetId);\n\t\tvar rect = document.createElementNS(dojo.svg.xmlns.svg, \"rect\");\t\t\n\t\trect.setAttribute(\"x\", this.properties.padding.left);\n\t\trect.setAttribute(\"y\", this.properties.padding.top);\n\t\trect.setAttribute(\"width\", this.properties.width-this.properties.padding.left-this.properties.padding.right);\n\t\trect.setAttribute(\"height\", this.properties.height-this.properties.padding.bottom-this.properties.padding.bottom);\n\t\tclip.appendChild(rect);\n\t\tdefs.appendChild(clip);\n\t\tthis.vectorNode.appendChild(defs);\n\n\t\t\/\/\tthe plot background.\n\t\tthis.plotArea = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.vectorNode.appendChild(this.plotArea);\n\t\tvar rect = document.createElementNS(dojo.svg.xmlns.svg, \"rect\");\t\t\n\t\trect.setAttribute(\"x\", this.properties.padding.left);\n\t\trect.setAttribute(\"y\", this.properties.padding.top);\n\t\trect.setAttribute(\"width\", this.properties.width-this.properties.padding.left-this.properties.padding.right);\n\t\trect.setAttribute(\"height\", this.properties.height-this.properties.padding.bottom-this.properties.padding.bottom);\n\t\trect.setAttribute(\"fill\", \"#fff\");\n\t\tthis.plotArea.appendChild(rect);\n\n\t\t\/\/\tdata group\n\t\tthis.dataGroup = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.dataGroup.setAttribute(\"style\",\"clip-path:url(#plotClip\"+this.widgetId+\");\");\n\t\tthis.plotArea.appendChild(this.dataGroup);\n\n\t\t\/\/\taxis group\n\t\tthis.axisGroup = document.createElementNS(dojo.svg.xmlns.svg, \"g\");\n\t\tthis.plotArea.appendChild(this.axisGroup);\n\n\t\t\/\/\tx axis\n\t\tvar stroke=1;\n\t\tvar line = document.createElementNS(dojo.svg.xmlns.svg, \"line\");\n\t\tvar y=dojo.widget.svg.Chart.Plotter.getY(this.properties.axes.x.plotAt, this);\n\t\tline.setAttribute(\"y1\", y);\n\t\tline.setAttribute(\"y2\", y);\n\t\tline.setAttribute(\"x1\",this.properties.padding.left-stroke);\n\t\tline.setAttribute(\"x2\",this.properties.width-this.properties.padding.right);\n\t\tline.setAttribute(\"style\",\"stroke:#000;stroke-width:\"+stroke+\";\");\n\t\tthis.axisGroup.appendChild(line);\n\t\t\n\t\t\/\/\tx axis units.\n\t\t\/\/\t(min and max)\n\t\tvar textSize=10;\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left);\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom+textSize+2);\n\t\ttext.setAttribute(\"style\", \"text-anchor:middle;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.x.range.min),2)));\n\t\tthis.axisGroup.appendChild(text);\n\t\t\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.width-this.properties.padding.right-(textSize\/2));\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom+textSize+2);\n\t\ttext.setAttribute(\"style\", \"text-anchor:middle;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.x.range.max),2)));\n\t\tthis.axisGroup.appendChild(text);\t\n\t\t\n\t\t\/\/\ty axis\n\t\tvar line=document.createElementNS(dojo.svg.xmlns.svg, \"line\");\n\t\tvar x=dojo.widget.svg.Chart.Plotter.getX(this.properties.axes.y.plotAt, this);\n\t\tline.setAttribute(\"x1\", x);\n\t\tline.setAttribute(\"x2\", x);\n\t\tline.setAttribute(\"y1\", this.properties.padding.top);\n\t\tline.setAttribute(\"y2\", this.properties.height-this.properties.padding.bottom);\n\t\tline.setAttribute(\"style\", \"stroke:#000;stroke-width:\"+stroke+\";\");\n\t\tthis.axisGroup.appendChild(line);\n\n\t\t\/\/\ty axis units\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left-4);\n\t\ttext.setAttribute(\"y\", this.properties.height-this.properties.padding.bottom);\n\t\ttext.setAttribute(\"style\", \"text-anchor:end;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.y.range.min),2)));\n\t\tthis.axisGroup.appendChild(text);\n\t\t\n\t\tvar text = document.createElementNS(dojo.svg.xmlns.svg, \"text\");\n\t\ttext.setAttribute(\"x\", this.properties.padding.left-4);\n\t\ttext.setAttribute(\"y\", this.properties.padding.top+(textSize\/2));\n\t\ttext.setAttribute(\"style\", \"text-anchor:end;font-size:\"+textSize+\"px;fill:#000;\");\n\t\ttext.appendChild(document.createTextNode(dojo.math.round(parseFloat(this.properties.axes.y.range.max),2)));\n\t\tthis.axisGroup.appendChild(text);\t\n\n\t\tthis.domNode.appendChild(this.vectorNode);\n\t\tdojo.svg.g.resume();\n\n\t\t\/\/\tthis is last.\n\t\tthis.assignColors();\n\t\tthis._isInitialized=true;","this":"dojo.widget.svg.Chart"}}},"dojo.widget.svg.Chart.destroy":{"_":{"meta":{"summary":"","src":"\t\twhile(this.domNode.childNodes.length>0){\n\t\t\tthis.domNode.removeChild(this.domNode.childNodes.item(0));\n\t\t}\n\t\tthis.vectorNode=this.plotArea=this.dataGroup=this.axisGroup=null;","this":"dojo.widget.svg.Chart"}}},"dojo.widget.svg.Chart.render":{"_":{"meta":{"summary":"","src":"\t\tdojo.svg.g.suspend();\n\t\t\n\t\tif (this.dataGroup){\n\t\t\twhile(this.dataGroup.childNodes.length>0){\n\t\t\t\tthis.dataGroup.removeChild(this.dataGroup.childNodes.item(0));\n\t\t\t}\n\t\t} else {\n\t\t\tthis.initialize();\n\t\t}\n\n\t\t\/\/\tthe remove\/append is an attempt to streamline the rendering, it's totally optional\n\/\/\t\tvar p=this.dataGroup.parentNode;\n\/\/\t\tp.removeChild(this.dataGroup);\n\t\tfor(var i=0; i<this.series.length; i++){\n\t\t\tdojo.widget.svg.Chart.Plotter.plot(this.series[i], this);\n\t\t}\n\/\/\t\tp.appendChild(this.dataGroup);\n\t\t\n\t\tdojo.svg.g.resume();","this":"dojo.widget.svg.Chart"}}}}}},"dojo.widget.validate":{"meta":{"requires":{"common":["dojo.widget.*","dojo.widget.HtmlWidget","dojo.widget.Manager","dojo.widget.Parse","dojo.xml.Parse","dojo.lang","dojo.validate.common","dojo.validate.datetime","dojo.validate.check","dojo.validate.web","dojo.validate.us"]},"methods":{"dojo.widget.validate.Textbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.HtmlWidget"],"this_inherits":["dojo.widget.HtmlWidget"],"protovariables":{"className":"","name":"","value":"","type":"","trim":"","uppercase":"","lowercase":"","ucFirst":"","digit":"","htmlfloat":"","templatePath":"","textbox":""},"this_variables":["textbox.value","lastCheckedValue","missingSpan.style.display","invalidSpan.style.display","rangeSpan.style.display","textbox.style.backgroundColor","textbox.style.backgroundColor","textbox.style.backgroundColor","textbox.isValid","textbox.isMissing","textbox.isInRange"]}}},"dojo.widget.validate.Textbox.filter":{"_":{"meta":{"summary":"","src":"\t\t\tif (this.trim) {\n\t\t\t\tthis.textbox.value = this.textbox.value.replace(\/(^\\s*|\\s*$)\/g, \"\");\n\t\t\t} \n\t\t\tif (this.uppercase) {\n\t\t\t\tthis.textbox.value = this.textbox.value.toUpperCase();\n\t\t\t} \n\t\t\tif (this.lowercase) {\n\t\t\t\tthis.textbox.value = this.textbox.value.toLowerCase();\n\t\t\t} \n\t\t\tif (this.ucFirst) {\n\t\t\t\tthis.textbox.value = this.textbox.value.replace(\/\\b\\w+\\b\/g, \n\t\t\t\t\tfunction(word) { return word.substring(0,1).toUpperCase() + word.substring(1).toLowerCase(); });\n\t\t\t} \n\t\t\tif (this.digit) {\n\t\t\t\tthis.textbox.value = this.textbox.value.replace(\/\\D\/g, \"\");\n\t\t\t} ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.HtmlWidget":{"_":{"meta":{"this_variables":["textbox.value"]}}},"dojo.widget.validate.Textbox.onfocus":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.validate.Textbox.onblur":{"_":{"meta":{"summary":"","src":"                       this.filter();    ","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.validate.Textbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\tdojo.widget.validate.Textbox.superclass.mixInProperties.apply(this, arguments);\n\t\t\tif ( localProperties[\"class\"] ) { \n\t\t\t\tthis.className = localProperties[\"class\"];\n\t\t\t}","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.validate.Textbox.fillInTemplate":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.HtmlWidget"}}},"dojo.widget.validate.ValidationTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.Textbox"],"this_inherits":["dojo.widget.validate.Textbox"],"protovariables":{"required":"","validColor":"","invalidColor":"","Class":"","size":"","maxlength":"","promptMessage":"","invalidMessage":"","missingMessage":"","rangeMessage":"","listenOnKeyPress":"","htmlfloat":"","lastCheckedValue":"","templatePath":"","invalidSpan":"","missingSpan":"","rangeSpan":""},"this_variables":["flags.signed","flags.min","flags.separator","flags.max","flags.allowDottedDecimal","flags.allowDottedHex","flags.allowDottedOctal","flags.allowDecimal","flags.allowHex","flags.allowIPv6","flags.allowHybrid","flags.format","flags.format","flags.amSymbol","flags.pmSymbol","flags.allowTerritories","flags.allowMilitary"]}}},"dojo.widget.validate.ValidationTextbox.getValue":{"_":{"meta":{"summary":"","src":"\t\t\treturn this.textbox.value;","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.setValue":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""}},"src":"\t\t\tthis.textbox.value = value;\n\t\t\tthis.update();","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.isValid":{"_":{"meta":{"summary":"","src":"                        return true;    ","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.isInRange":{"_":{"meta":{"summary":"","src":"                          return true;    ","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.isEmpty":{"_":{"meta":{"summary":"","src":"\t\t\treturn ( \/^\\s*$\/.test(this.textbox.value) );","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.isMissing":{"_":{"meta":{"summary":"","src":"\t\t\treturn ( this.required && this.isEmpty() );","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.update":{"_":{"meta":{"summary":"","src":"\t\t\tthis.lastCheckedValue = this.textbox.value;\n\t\t\tthis.missingSpan.style.display = \"none\";\n\t\t\tthis.invalidSpan.style.display = \"none\";\n\t\t\tthis.rangeSpan.style.display = \"none\";\n\t\n\t\t\tvar empty = this.isEmpty();\n\t\t\tvar valid = true;\n\t\t\tif(this.promptMessage != this.textbox.value){ \n\t\t\t\tvalid = this.isValid(); \n\t\t\t}\n\t\t\tvar missing = this.isMissing();\n\t\n\t\t\t\/\/ Display at most one error message\n\t\t\tif(missing){\n\t\t\t\tthis.missingSpan.style.display = \"\";\n\t\t\t}else if( !empty && !valid ){\n\t\t\t\tthis.invalidSpan.style.display = \"\";\n\t\t\t}else if( !empty && !this.isInRange() ){\n\t\t\t\tthis.rangeSpan.style.display = \"\";\n\t\t\t}\n\t\t\tthis.highlight();","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.highlight":{"_":{"meta":{"summary":"","src":"\t\t\t\tthis.textbox.style.backgroundColor = \"\";\n\t\t\t}else if ( this.isValid() && this.isInRange() ){\n\t\t\t\tthis.textbox.style.backgroundColor = this.validColor;\n\t\t\t}else if( this.textbox.value != this.promptMessage){ \n\t\t\t\tthis.textbox.style.backgroundColor = this.invalidColor;\n\t\t\t}","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.onfocus":{"_":{"meta":{"summary":"","src":"\t\t\tif ( !this.listenOnKeyPress) {\n\t\t\t    this.textbox.style.backgroundColor = \"\";\n\t\t\t}","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.onblur":{"_":{"meta":{"summary":"","src":"\t\t\tthis.filter();\n\t\t\tthis.update(); ","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.onkeyup":{"_":{"meta":{"summary":"","src":"\t\t\tif(this.listenOnKeyPress){ \n\t\t\t\t\/\/this.filter();  trim is problem if you have to type two words\n\t\t\t\tthis.update(); \n\t\t\t}else if (this.textbox.value != this.lastCheckedValue){\n\t\t\t    this.textbox.style.backgroundColor = \"\";\n\t\t\t}","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.ValidationTextbox.fillInTemplate":{"_":{"meta":{"summary":"","src":"\t\t\tthis.textbox.isMissing = function() { this.isMissing.call(this); };\n\t\t\tthis.textbox.isInRange = function() { this.isInRange.call(this); };\n\t\t\tthis.filter();\n\t\t\tthis.update(); ","this":"dojo.widget.validate.Textbox"}}},"dojo.widget.validate.IntegerTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"],"this_variables":["flags.places","flags.exponent","flags.eSigned","flags.min","flags.max","flags.cents","flags.symbol","flags.min","flags.max"]}}},"dojo.widget.validate.IntegerTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif((localProperties.signed == \"true\")||\n\t\t\t\t(localProperties.signed == \"always\")){\n\t\t\t\tthis.flags.signed = true;\n\t\t\t}else if((localProperties.signed == \"false\")||\n\t\t\t\t\t(localProperties.signed == \"never\")){\n\t\t\t\tthis.flags.signed = false;\n\t\t\t\tthis.flags.min = 0;\n\t\t\t}else{\n\t\t\t\tthis.flags.signed = [ true, false ]; \/\/ optional\n\t\t\t}\n\t\t\tif(localProperties.separator){ \n\t\t\t\tthis.flags.separator = localProperties.separator;\n\t\t\t}\n\t\t\tif(localProperties.min){ \n\t\t\t\tthis.flags.min = parseInt(localProperties.min);\n\t\t\t}\n\t\t\tif(localProperties.max){ \n\t\t\t\tthis.flags.max = parseInt(localProperties.max);\n\t\t\t}","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.IntegerTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isInteger(this.textbox.value, this.flags);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.IntegerTextbox.isInRange":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isInRange(this.textbox.value, this.flags);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.RealNumberTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.IntegerTextbox"],"this_inherits":["dojo.widget.validate.IntegerTextbox"]}}},"dojo.widget.validate.RealNumberTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.places ) { \n\t\t\t\tthis.flags.places = Number( localProperties.places );\n\t\t\t}\n\t\t\tif((localProperties.exponent == \"true\")||\n\t\t\t\t(localProperties.exponent == \"always\")){\n\t\t\t\tthis.flags.exponent = true;\n\t\t\t}else if((localProperties.exponent == \"false\")||(localProperties.exponent == \"never\")){\n\t\t\t\tthis.flags.exponent = false;\n\t\t\t}else{\n\t\t\t\tthis.flags.exponent = [ true, false ]; \/\/ optional\n\t\t\t}\n\t\t\tif((localProperties.esigned == \"true\")||(localProperties.esigned == \"always\")){\n\t\t\t\tthis.flags.eSigned = true;\n\t\t\t}else if((localProperties.esigned == \"false\")||(localProperties.esigned == \"never\")){\n\t\t\t\tthis.flags.eSigned = false;\n\t\t\t}else{\n\t\t\t\tthis.flags.eSigned = [ true, false ]; \/\/ optional\n\t\t\t}\n\t\t\tif(localProperties.min){ \n\t\t\t\tthis.flags.min = parseFloat(localProperties.min);\n\t\t\t}\n\t\t\tif(localProperties.max){ \n\t\t\t\tthis.flags.max = parseFloat(localProperties.max);\n\t\t\t}","this":"dojo.widget.validate.IntegerTextbox"}}},"dojo.widget.validate.RealNumberTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isRealNumber(this.textbox.value, this.flags);","this":"dojo.widget.validate.IntegerTextbox"}}},"dojo.widget.validate.RealNumberTextbox.isInRange":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isInRange(this.textbox.value, this.flags);","this":"dojo.widget.validate.IntegerTextbox"}}},"dojo.widget.validate.CurrencyTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.IntegerTextbox"],"this_inherits":["dojo.widget.validate.IntegerTextbox"]}}},"dojo.widget.validate.CurrencyTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.cents ) { \n\t\t\t\tthis.flags.cents = ( localProperties.cents == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.symbol ) { \n\t\t\t\tthis.flags.symbol = localProperties.symbol;\n\t\t\t}\n\t\t\tif(localProperties.min){ \n\t\t\t\tthis.flags.min = parseFloat(localProperties.min);\n\t\t\t}\n\t\t\tif(localProperties.max){ \n\t\t\t\tthis.flags.max = parseFloat(localProperties.max);\n\t\t\t}","this":"dojo.widget.validate.IntegerTextbox"}}},"dojo.widget.validate.CurrencyTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isCurrency(this.textbox.value, this.flags);","this":"dojo.widget.validate.IntegerTextbox"}}},"dojo.widget.validate.CurrencyTextbox.isInRange":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isInRange(this.textbox.value, this.flags);","this":"dojo.widget.validate.IntegerTextbox"}}},"dojo.widget.validate.IpAddressTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"],"this_variables":["flags.scheme","flags.allowIP","flags.allowLocal","flags.allowCC","flags.allowGeneric"]}}},"dojo.widget.validate.IpAddressTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.allowdotteddecimal ) { \n\t\t\t\tthis.flags.allowDottedDecimal = ( localProperties.allowdotteddecimal == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowdottedhex ) { \n\t\t\t\tthis.flags.allowDottedHex = ( localProperties.allowdottedhex == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowdottedoctal ) { \n\t\t\t\tthis.flags.allowDottedOctal = ( localProperties.allowdottedoctal == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowdecimal ) { \n\t\t\t\tthis.flags.allowDecimal = ( localProperties.allowdecimal == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowhex ) { \n\t\t\t\tthis.flags.allowHex = ( localProperties.allowhex == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowipv6 ) { \n\t\t\t\tthis.flags.allowIPv6 = ( localProperties.allowipv6 == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowhybrid ) { \n\t\t\t\tthis.flags.allowHybrid = ( localProperties.allowhybrid == \"true\" );\n\t\t\t}","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.IpAddressTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isIpAddress(this.textbox.value, this.flags);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.UrlTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.IpAddressTextbox"],"this_inherits":["dojo.widget.validate.IpAddressTextbox"],"this_variables":["flags.allowCruft"]}}},"dojo.widget.validate.UrlTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.scheme ) { \n\t\t\t\tthis.flags.scheme = ( localProperties.scheme == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowip ) { \n\t\t\t\tthis.flags.allowIP = ( localProperties.allowip == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowlocal ) { \n\t\t\t\tthis.flags.allowLocal = ( localProperties.allowlocal == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowcc ) { \n\t\t\t\tthis.flags.allowCC = ( localProperties.allowcc == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowgeneric ) { \n\t\t\t\tthis.flags.allowGeneric = ( localProperties.allowgeneric == \"true\" );\n\t\t\t}","this":"dojo.widget.validate.IpAddressTextbox"}}},"dojo.widget.validate.UrlTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isUrl(this.textbox.value, this.flags);","this":"dojo.widget.validate.IpAddressTextbox"}}},"dojo.widget.validate.EmailTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.UrlTextbox"],"this_inherits":["dojo.widget.validate.UrlTextbox"],"this_variables":["flags.listSeparator"]}}},"dojo.widget.validate.EmailTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.allowcruft ) { \n\t\t\t\tthis.flags.allowCruft = ( localProperties.allowcruft == \"true\" );\n\t\t\t}","this":"dojo.widget.validate.UrlTextbox"}}},"dojo.widget.validate.EmailTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isEmailAddress(this.textbox.value, this.flags);","this":"dojo.widget.validate.UrlTextbox"}}},"dojo.widget.validate.EmailListTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.EmailTextbox"],"this_inherits":["dojo.widget.validate.EmailTextbox"]}}},"dojo.widget.validate.EmailListTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.listseparator ) { \n\t\t\t\tthis.flags.listSeparator = localProperties.listseparator;\n\t\t\t}","this":"dojo.widget.validate.EmailTextbox"}}},"dojo.widget.validate.EmailListTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isEmailAddressList(this.textbox.value, this.flags);","this":"dojo.widget.validate.EmailTextbox"}}},"dojo.widget.validate.DateTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"]}}},"dojo.widget.validate.DateTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.format ) { \n\t\t\t\tthis.flags.format = localProperties.format;\n\t\t\t}","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.DateTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isValidDate(this.textbox.value, this.flags.format);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.TimeTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"]}}},"dojo.widget.validate.TimeTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.format ) { \n\t\t\t\tthis.flags.format = localProperties.format;\n\t\t\t}\n\t\t\tif ( localProperties.amsymbol ) { \n\t\t\t\tthis.flags.amSymbol = localProperties.amsymbol;\n\t\t\t}\n\t\t\tif ( localProperties.pmsymbol ) { \n\t\t\t\tthis.flags.pmSymbol = localProperties.pmsymbol;\n\t\t\t}","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.TimeTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.isValidTime(this.textbox.value, this.flags);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.UsStateTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"]}}},"dojo.widget.validate.UsStateTextbox.mixInProperties":{"_":{"meta":{"summary":"","parameters":{"localProperties":{"type":""},"frag":{"type":""}},"src":"\t\t\t\/\/ Get properties from markup attributes, and assign to flags object.\n\t\t\tif ( localProperties.allowterritories ) { \n\t\t\t\tthis.flags.allowTerritories = ( localProperties.allowterritories == \"true\" );\n\t\t\t}\n\t\t\tif ( localProperties.allowmilitary ) { \n\t\t\t\tthis.flags.allowMilitary = ( localProperties.allowmilitary == \"true\" );\n\t\t\t}","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.UsStateTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.us.isState(this.textbox.value, this.flags);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.UsZipTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"]}}},"dojo.widget.validate.UsZipTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.us.isZipCode(this.textbox.value);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.UsSocialSecurityNumberTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"]}}},"dojo.widget.validate.UsSocialSecurityNumberTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.us.isSocialSecurityNumber(this.textbox.value);","this":"dojo.widget.validate.ValidationTextbox"}}},"dojo.widget.validate.UsPhoneNumberTextbox":{"_":{"meta":{"summary":"","inherits":["dojo.widget.validate.ValidationTextbox"],"this_inherits":["dojo.widget.validate.ValidationTextbox"]}}},"dojo.widget.validate.UsPhoneNumberTextbox.isValid":{"_":{"meta":{"summary":"","src":"\t\t\treturn dojo.validate.us.isPhoneNumber(this.textbox.value);","this":"dojo.widget.validate.ValidationTextbox"}}}}}},"dojo.widget.vml.Chart":{"meta":{"requires":{"common":["dojo.widget.HtmlWidget","dojo.widget.Chart","dojo.math","dojo.html","dojo.graphics.color"]},"methods":{"dojo.widget.vml.Chart":{"_":{"meta":{"summary":"","src":"\tdojo.widget.Chart.call(this);\n\tdojo.widget.HtmlWidget.call(this);","inherits":["dojo.widget.HtmlWidget"],"protovariables":{"templatePath":"","templateCssPath":"","_isInitialized":"","hasData":"","vectorNode":"","plotArea":"","dataGroup":"","axisGroup":"","properties":"","height":"","width":"","plotType":"","padding":"","top":"","bottom":"","left":"","right":"","axes":"","x":"","plotAt":"","label":"","unitLabel":"","unitType":"","nUnitsToShow":"","range":"","min":"","max":"","y":""},"this_variables":["vectorNode","vectorNode.style.width","vectorNode.style.height","vectorNode.style.position","plotArea","plotArea.style.position","plotArea.style.backgroundColor","plotArea.style.top","plotArea.style.left","plotArea.style.width","plotArea.style.height","dataGroup","dataGroup.style.position","axisGroup","axisGroup.style.position","_isInitialized","vectorNode"]}}},"dojo.widget.vml.Chart.Plotter.getX":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""},"chart":{"type":""}},"src":"\t\tvar v=parseFloat(value);\n\t\tvar min=chart.properties.axes.x.range.min;\n\t\tvar max=chart.properties.axes.x.range.max;\n\t\tvar ofst=0-min;\n\t\tmin+=ofst; max+=ofst; v+=ofst;\n\n\t\tvar xmin=chart.properties.padding.left;\n\t\tvar xmax=chart.properties.width-chart.properties.padding.right;\n\t\tvar x=(v*((xmax-xmin)\/max))+xmin;\n\t\treturn x;"}}},"dojo.widget.vml.Chart.Plotter.getY":{"_":{"meta":{"summary":"","parameters":{"value":{"type":""},"chart":{"type":""}},"src":"\t\tvar v=parseFloat(value);\n\t\tvar max=chart.properties.axes.y.range.max;\n\t\tvar min=chart.properties.axes.y.range.min;\n\t\tvar ofst=0;\n\t\tif(min<0)ofst+=Math.abs(min);\n\t\tmin+=ofst; max+=ofst; v+=ofst;\n\t\t\n\t\tvar ymin=chart.properties.height-chart.properties.padding.bottom;\n\t\tvar ymax=chart.properties.padding.top;\n\t\tvar y=(((ymin-ymax)\/(max-min))*(max-v))+ymax;\n\t\treturn y;"}}},"dojo.widget.vml.Chart.Plotter.addPlotter":{"_":{"meta":{"summary":"","parameters":{"name":{"type":""},"func":{"type":""}},"src":"\t\tplotters[name]=func;"}}},"dojo.widget.vml.Chart.Plotter.plot":{"_":{"meta":{"summary":"","parameters":{"series":{"type":""},"chart":{"type":""}},"src":"\t\tif (series.values.length==0) return;\n\t\tif (series.plotType && plotters[series.plotType]){\n\t\t\treturn plotters[series.plotType](series, chart);\n\t\t}\n\t\telse if (chart.plotType && plotters[chart.plotType]){\n\t\t\treturn plotters[chart.plotType](series, chart);\n\t\t}"}}},"dojo.widget.vml.Chart.fillInTemplate":{"_":{"meta":{"summary":"","parameters":{"args":{"type":""},"rag":{"type":""}},"src":"\t\tthis.initialize();\n\t\tthis.render();","this":"dojo.widget.vml.Chart"}}},"dojo.widget.vml.Chart.parseData":{"_":{"meta":{"summary":"","src":"","this":"dojo.widget.vml.Chart"}}},"dojo.widget.vml.Chart.initialize":{"_":{"meta":{"summary":"","src":"\t\t\/\/ render the body of the chart, not the chart data.\n\t\tif(this.vectorNode){ this.destroy(); }\n\t\tthis.vectorNode=document.createElement(\"div\");\n\t\tthis.vectorNode.style.width=this.properties.width+\"px\";\n\t\tthis.vectorNode.style.height=this.properties.height+\"px\";\n\t\tthis.vectorNode.style.position=\"relative\";\n\t\tthis.domNode.appendChild(this.vectorNode);\n\n\t\tvar plotWidth=this.properties.width-this.properties.padding.left-this.properties.padding.right;\n\t\tvar plotHeight=this.properties.height-this.properties.padding.top-this.properties.padding.bottom;\n\n\t\tthis.plotArea=document.createElement(\"div\");\n\t\tthis.plotArea.style.position=\"absolute\";\n\t\tthis.plotArea.style.backgroundColor=\"#fff\";\n\t\tthis.plotArea.style.top=(this.properties.padding.top)-2+\"px\";\n\t\tthis.plotArea.style.left=(this.properties.padding.left-1)+\"px\";\n\t\tthis.plotArea.style.width=plotWidth+\"px\";\n\t\tthis.plotArea.style.height=plotHeight+\"px\";\n\t\tthis.vectorNode.appendChild(this.plotArea);\n\t\t\n\t\tthis.dataGroup=document.createElement(\"div\");\n\t\tthis.dataGroup.style.position=\"relative\";\n\t\tthis.plotArea.appendChild(this.dataGroup);\n\n\t\t\/\/\tclipping rects, what a fucking pain.\n\t\tvar bg=this.domNode.style.backgroundColor;\n\t\tvar r=document.createElement(\"v:rect\");\n\t\tr.setAttribute(\"fillcolor\", bg);\n\t\tr.setAttribute(\"stroked\", \"false\");\n\t\tr.style.position=\"absolute\";\n\t\tr.style.top=(-1*this.properties.padding.top)-1+\"px\";\n\t\tr.style.left=(-1*this.properties.padding.left)+\"px\";\n\t\tr.style.width=(this.properties.width-3)+\"px\";\n\t\tr.style.height=(this.properties.padding.top)-2+\"px\";\n\t\tthis.vectorNode.appendChild(r);\n\n\t\tr=document.createElement(\"v:rect\");\n\t\tr.setAttribute(\"fillcolor\", bg);\n\t\tr.setAttribute(\"stroked\", \"false\");\n\t\tr.style.position=\"absolute\";\n\t\tr.style.top=plotHeight-2+\"px\";\n\t\tr.style.left=(-1*this.properties.padding.left)+\"px\";\n\t\tr.style.width=(this.properties.width-3)+\"px\";\n\t\tr.style.height=(this.properties.padding.bottom)-2+\"px\"; \/\/ fixme: check this.\n\t\tthis.vectorNode.appendChild(r);\n\n\t\tr=document.createElement(\"v:rect\");\n\t\tr.setAttribute(\"fillcolor\", bg);\n\t\tr.setAttribute(\"stroked\", \"false\");\n\t\tr.style.position=\"absolute\";\n\t\tr.style.top=\"-2px\";\n\t\tr.style.left=(-1*this.properties.padding.left)+\"px\";\n\t\tr.style.width=(this.properties.padding.left-1)+\"px\";\n\t\tr.style.height=plotHeight+\"px\";\n\t\tthis.vectorNode.appendChild(r);\n\t\t\n\t\tr=document.createElement(\"v:rect\");\n\t\tr.setAttribute(\"fillcolor\", bg);\n\t\tr.setAttribute(\"stroked\", \"false\");\n\t\tr.style.position=\"absolute\";\n\t\tr.style.top=\"-2px\";\n\t\tr.style.right=(-1*this.properties.padding.right)+1+\"px\";\n\t\tr.style.width=(this.properties.padding.right-1)+\"px\";\n\t\tr.style.height=plotHeight+\"px\";\n\t\tthis.vectorNode.appendChild(r);\n\t\t\/\/\tend clipping rects.  god that sucks, i wish VML had clipping outside of that crap vmlframe...\n\n\t\tthis.axisGroup=document.createElement(\"div\");\n\t\tthis.axisGroup.style.position=\"relative\";\n\t\tthis.plotArea.appendChild(this.axisGroup);\n\n\t\tvar stroke=1;\n\n\t\t\/\/\tx axis\n\t\tvar line=document.createElement(\"v:line\");\n\t\tvar y=dojo.widget.vml.Chart.Plotter.getY(this.properties.axes.x.plotAt, this);\n\t\tline.setAttribute(\"from\", this.properties.padding.left-stroke + \",\" + y);\n\t\tline.setAttribute(\"to\", plotWidth + \",\" + y);\n\t\tline.style.position=\"absolute\";\n\t\tline.style.antialias=\"false\";\n\t\tline.setAttribute(\"strokecolor\", \"#666\");\n\t\tline.setAttribute(\"strokeweight\", stroke*2+\"px\");\n\t\tthis.axisGroup.appendChild(line);\n\n\t\t\/\/\ty axis\n\t\tvar line=document.createElement(\"v:line\");\n\t\tvar y=dojo.widget.vml.Chart.Plotter.getX(this.properties.axes.y.plotAt, this);\n\t\tline.setAttribute(\"from\", y+\",\"+this.properties.padding.top);\n\t\tline.setAttribute(\"to\", y+\",\"+this.properties.height-this.properties.padding.bottom);\n\t\tline.style.position=\"absolute\";\n\t\tline.style.antialias=\"false\";\n\t\tline.setAttribute(\"strokecolor\", \"#666\");\n\t\tline.setAttribute(\"strokeweight\", stroke*2+\"px\");\n\t\tthis.axisGroup.appendChild(line);\n\t\t\n\t\t\/\/\tlabels\n\t\tvar size=10;\n\n\t\t\/\/\tx axis labels.\n\t\tvar t=document.createElement(\"div\");\n\t\tt.style.position=\"absolute\";\n\t\tt.style.top=(this.properties.height-this.properties.padding.bottom+size+2)+\"px\";\n\t\tt.style.left=this.properties.padding.left+\"px\";\n\t\tt.style.fontFamily=\"sans-serif\";\n\t\tt.style.fontSize=size+\"px\";\n\t\tt.innerHTML=dojo.math.round(parseFloat(this.properties.axes.x.range.min),2);\n\t\tthis.axisGroup.appendChild(t);\n\n\t\tt=document.createElement(\"div\");\n\t\tt.style.position=\"absolute\";\n\t\tt.style.top=(this.properties.height-this.properties.padding.bottom+size+2)+\"px\";\n\t\tt.style.left=(this.properties.width-this.properties.padding.right-(size\/2))+\"px\";\n\t\tt.style.fontFamily=\"sans-serif\";\n\t\tt.style.fontSize=size+\"px\";\n\t\tt.innerHTML=dojo.math.round(parseFloat(this.properties.axes.x.range.max),2);\n\t\tthis.axisGroup.appendChild(t);\n\n\t\t\/\/\ty axis labels.\n\t\tt=document.createElement(\"div\");\n\t\tt.style.position=\"absolute\";\n\t\tt.style.top=-1*(size\/2)+\"px\";\n\t\tt.style.right=(plotWidth+4)+\"px\";\n\t\tt.style.fontFamily=\"sans-serif\";\n\t\tt.style.fontSize=size+\"px\";\n\t\tt.innerHTML=dojo.math.round(parseFloat(this.properties.axes.y.range.max),2);\n\t\tthis.axisGroup.appendChild(t);\n\t\t\n\t\tt=document.createElement(\"div\");\n\t\tt.style.position=\"absolute\";\n\t\tt.style.top=(this.properties.height-this.properties.padding.bottom)+\"px\";\n\t\tt.style.right=(plotWidth+4)+\"px\";\n\t\tt.style.fontFamily=\"sans-serif\";\n\t\tt.style.fontSize=size+\"px\";\n\t\tt.innerHTML=dojo.math.round(parseFloat(this.properties.axes.y.range.min),2);\n\t\tthis.axisGroup.appendChild(t);\n\t\t\n\t\t\/\/\tthis is last.\n\t\tthis.assignColors();\n\t\tthis._isInitialized=true;","this":"dojo.widget.vml.Chart"}}},"dojo.widget.vml.Chart.destroy":{"_":{"meta":{"summary":"","src":"\t\twhile(this.domNode.childNodes.length>0){\n\t\t\tthis.domNode.removeChild(this.domNode.childNodes[0]);\n\t\t}\n\t\tthis.vectorNode=this.plotArea=this.dataGroup=this.axisGroup=null;","this":"dojo.widget.vml.Chart"}}},"dojo.widget.vml.Chart.render":{"_":{"meta":{"summary":"","src":"\t\tif (this.dataGroup){\n\t\t\twhile(this.dataGroup.childNodes.length>0){\n\t\t\t\tthis.dataGroup.removeChild(this.dataGroup.childNodes[0]);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.initialize();\n\t\t}\n\t\tfor(var i=0; i<this.series.length; i++){\n\t\t\tdojo.widget.vml.Chart.Plotter.plot(this.series[i], this);\n\t\t}","this":"dojo.widget.vml.Chart"}}}}}}}